<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CSAEventTimeline.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.xva.margin</a> &gt; <span class="el_source">CSAEventTimeline.java</span></div><h1>CSAEventTimeline.java</h1><pre class="source lang-java linenums">
package org.drip.xva.margin;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * 
 *  This file is part of DRIP, a free-software/open-source library for buy/side financial/trading model
 *  	libraries targeting analysts and developers
 *  	https://lakshmidrip.github.io/DRIP/
 *  
 *  DRIP is composed of four main libraries:
 *  
 *  - DRIP Fixed Income - https://lakshmidrip.github.io/DRIP-Fixed-Income/
 *  - DRIP Asset Allocation - https://lakshmidrip.github.io/DRIP-Asset-Allocation/
 *  - DRIP Numerical Optimizer - https://lakshmidrip.github.io/DRIP-Numerical-Optimizer/
 *  - DRIP Statistical Learning - https://lakshmidrip.github.io/DRIP-Statistical-Learning/
 * 
 *  - DRIP Fixed Income: Library for Instrument/Trading Conventions, Treasury Futures/Options,
 *  	Funding/Forward/Overnight Curves, Multi-Curve Construction/Valuation, Collateral Valuation and XVA
 *  	Metric Generation, Calibration and Hedge Attributions, Statistical Curve Construction, Bond RV
 *  	Metrics, Stochastic Evolution and Option Pricing, Interest Rate Dynamics and Option Pricing, LMM
 *  	Extensions/Calibrations/Greeks, Algorithmic Differentiation, and Asset Backed Models and Analytics.
 * 
 *  - DRIP Asset Allocation: Library for model libraries for MPT framework, Black Litterman Strategy
 *  	Incorporator, Holdings Constraint, and Transaction Costs.
 * 
 *  - DRIP Numerical Optimizer: Library for Numerical Optimization and Spline Functionality.
 * 
 *  - DRIP Statistical Learning: Library for Statistical Evaluation and Machine Learning.
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * CSAEventTimeline holds the BCBS/IOSCO prescribed Events Time-line occurring Margin Period. The References
 *  are:
 *  
 *  - Andersen, L. B. G., M. Pykhtin, and A. Sokol (2017): Re-thinking Margin Period of Risk,
 *  	https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2902737, eSSRN.
 *  
 *  - Andersen, L. B. G., M. Pykhtin, and A. Sokol (2017): Credit Exposure in the Presence of Initial Margin,
 *  	https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2806156, eSSRN.
 *  
 *  - Anfuso, F., D. Aziz, P. Giltinan, and K Loukopoulus (2017): A Sound Modeling and Back-testing Framework
 *  	for Forecasting Initial Margin Requirements,
 *  	https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2716279, eSSRN.
 *  
 *  - BCBS (2015): Margin Requirements for Non-centrally Cleared Derivatives,
 *  	https://www.bis.org/bcbs/publ/d317.pdf.
 *  
 *  - Pykhtin, M. (2009): Modeling Credit Exposure for Collateralized Counter-parties, Journal of Credit
 *  	Risk, 5 (4) 3-27.
 * 
 * @author Lakshmi Krishnamurthy
 */

public class CSAEventTimeline
{
<span class="nc" id="L74">	private int _curePeriod = -1;</span>
<span class="nc" id="L75">	private int _marginFrequency = -1;</span>
<span class="nc" id="L76">	private java.lang.String _calendarSet = &quot;&quot;;</span>
<span class="nc" id="L77">	private org.drip.xva.margin.CSAEventDate _ed = null;</span>
<span class="nc" id="L78">	private org.drip.xva.margin.CSAEventDate _etd = null;</span>
<span class="nc" id="L79">	private org.drip.xva.margin.CSAEventDate _ped = null;</span>
<span class="nc" id="L80">	private org.drip.xva.margin.CSAEventDate _valuation = null;</span>
<span class="nc" id="L81">	private org.drip.xva.margin.CSAEventDate _lastHonored = null;</span>
<span class="nc" id="L82">	private org.drip.xva.margin.CSAEventDate _etdDesignation = null;</span>
<span class="nc" id="L83">	private org.drip.xva.margin.CSAEventDate _firstNonHonored = null;</span>
<span class="nc" id="L84">	private org.drip.xva.margin.CSAEventDate _edCommunication = null;</span>
<span class="nc" id="L85">	private org.drip.xva.margin.CSAEventDate _pedCommunication = null;</span>
<span class="nc" id="L86">	private org.drip.xva.margin.CSAEventDate _collateralTransferInitiation = null;</span>

	/**
	 * Construct a Standard Instance of CSAEventTimeline
	 * 
	 * @param valuationDate The Valuation Date
	 * @param pedLag PED Lag
	 * @param calendarSet The Calendar Set
	 * 
	 * @return The Standard Instance of CSAEventTimeline
	 */

	public static final CSAEventTimeline Standard (
		final org.drip.analytics.date.JulianDate valuationDate,
		final int pedLag,
		final java.lang.String calendarSet)
	{
<span class="nc bnc" id="L103" title="All 2 branches missed.">		if (null == valuationDate)</span>
		{
<span class="nc" id="L105">			return null;</span>
		}

<span class="nc" id="L108">		org.drip.xva.margin.CSAEventDate valuation = org.drip.xva.margin.CSAEventDateBuilder.Valuation</span>
<span class="nc" id="L109">			(valuationDate);</span>

<span class="nc bnc" id="L111" title="All 2 branches missed.">		if (null == valuation)</span>
		{
<span class="nc" id="L113">			return null;</span>
		}

<span class="nc" id="L116">		org.drip.xva.margin.CSAEventDate lastHonored = org.drip.xva.margin.CSAEventDateBuilder.LastHonored (</span>
			valuation,
			calendarSet
		);

<span class="nc bnc" id="L121" title="All 2 branches missed.">		if (null == lastHonored)</span>
		{
<span class="nc" id="L123">			return null;</span>
		}

<span class="nc" id="L126">		org.drip.xva.margin.CSAEventDate firstNonHonored =</span>
<span class="nc" id="L127">			org.drip.xva.margin.CSAEventDateBuilder.FirstNonHonored (</span>
				valuation,
				calendarSet,
				org.drip.xva.margin.CSAEventDateBuilder.MARGIN_FREQUENCY_DAILY
			);

<span class="nc bnc" id="L133" title="All 2 branches missed.">		if (null == firstNonHonored)</span>
		{
<span class="nc" id="L135">			return null;</span>
		}

<span class="nc" id="L138">		org.drip.xva.margin.CSAEventDate ped = org.drip.xva.margin.CSAEventDateBuilder.PED (</span>
<span class="nc" id="L139">			firstNonHonored.date().addBusDays (</span>
				pedLag,
				calendarSet
			)
		);

<span class="nc bnc" id="L145" title="All 2 branches missed.">		if (null == ped)</span>
		{
<span class="nc" id="L147">			return null;</span>
		}

<span class="nc" id="L150">		org.drip.xva.margin.CSAEventDate ed = org.drip.xva.margin.CSAEventDateBuilder.IMA2002ED (</span>
			ped,
			calendarSet
		);

<span class="nc bnc" id="L155" title="All 2 branches missed.">		if (null == ed)</span>
		{
<span class="nc" id="L157">			return null;</span>
		}

<span class="nc" id="L160">		org.drip.xva.margin.CSAEventDate etdDesignation =</span>
<span class="nc" id="L161">			org.drip.xva.margin.CSAEventDateBuilder.ETDDesignation (</span>
<span class="nc" id="L162">				ped.date().addBusDays (</span>
					org.drip.xva.margin.CSAEventDateBuilder.ETD_DESIGNATION_DELAY,
					calendarSet
				)
			);

<span class="nc bnc" id="L168" title="All 2 branches missed.">		if (null == etdDesignation)</span>
		{
<span class="nc" id="L170">			return null;</span>
		}

		try
		{
<span class="nc" id="L175">			return new CSAEventTimeline (</span>
				valuation,
				lastHonored,
<span class="nc" id="L178">				org.drip.xva.margin.CSAEventDateBuilder.RegularCollateralTransferInitiation (</span>
					lastHonored,
					calendarSet
				),
				firstNonHonored,
				ped,
<span class="nc" id="L184">				org.drip.xva.margin.CSAEventDateBuilder.PEDCommunication (</span>
<span class="nc" id="L185">					ped.date().addBusDays (</span>
						org.drip.xva.margin.CSAEventDateBuilder.PED_COMMUNICATION_DELAY,
						calendarSet
					)
				),
				ed,
<span class="nc" id="L191">				org.drip.xva.margin.CSAEventDateBuilder.EDCommunication (</span>
<span class="nc" id="L192">					ed.date().addBusDays (</span>
						org.drip.xva.margin.CSAEventDateBuilder.ED_COMMUNICATION_DELAY,
						calendarSet
					)
				),
				etdDesignation,
<span class="nc" id="L198">				org.drip.xva.margin.CSAEventDateBuilder.ETDDesignation (</span>
<span class="nc" id="L199">					etdDesignation.date().addBusDays (</span>
						org.drip.xva.margin.CSAEventDateBuilder.ETD_CALL_OUT_DELAY,
						calendarSet
					)
				),
				org.drip.xva.margin.CSAEventDateBuilder.MARGIN_FREQUENCY_DAILY,
				org.drip.xva.margin.CSAEventDateBuilder.CURE_PERIOD_IMA_2002,
				calendarSet
			);
		}
<span class="nc" id="L209">		catch (java.lang.Exception e)</span>
		{
<span class="nc" id="L211">			e.printStackTrace();</span>
		}

<span class="nc" id="L214">		return null;</span>
	}

	/**
	 * @param valuation The CSA Valuation Event Date
	 * @param lastHonored The CSA Last Honored Event Date
	 * @param collateralTransferInitiation The CSA Collateral Transfer Initiation Event Date
	 * @param firstNonHonored The CSA First Non-Honored Event Date
	 * @param ped The Potential Event of Default
	 * @param pedCommunication The Potential Event of Default Communication Date
	 * @param ed The Event of Default
	 * @param edCommunication The Event of Default Communication Date
	 * @param etdDesignation The Early Termination Designation Date
	 * @param etd The Early Termination Date
	 * @param marginFrequency The CSA Margin Frequency
	 * @param curePeriod The Client &quot;Failure To Pay&quot; Cure Period
	 * @param calendarSet The CSA Calendar Set
	 * 
	 * @throws java.lang.Exception Thrown if the Inputs are Invalid
	 */

	public CSAEventTimeline (
		final org.drip.xva.margin.CSAEventDate valuation,
		final org.drip.xva.margin.CSAEventDate lastHonored,
		final org.drip.xva.margin.CSAEventDate collateralTransferInitiation,
		final org.drip.xva.margin.CSAEventDate firstNonHonored,
		final org.drip.xva.margin.CSAEventDate ped,
		final org.drip.xva.margin.CSAEventDate pedCommunication,
		final org.drip.xva.margin.CSAEventDate ed,
		final org.drip.xva.margin.CSAEventDate edCommunication,
		final org.drip.xva.margin.CSAEventDate etdDesignation,
		final org.drip.xva.margin.CSAEventDate etd,
		final int marginFrequency,
		final int curePeriod,
		final java.lang.String calendarSet)
		throws java.lang.Exception
<span class="nc" id="L250">	{</span>
<span class="nc bnc" id="L251" title="All 24 branches missed.">		if (null == (_valuation = valuation) ||</span>
			null == (_lastHonored = lastHonored) ||
			null == (_collateralTransferInitiation = collateralTransferInitiation) ||
			null == (_firstNonHonored = firstNonHonored) ||
			null == (_ped = ped) ||
			null == (_pedCommunication = pedCommunication) ||
			null == (_ed = ed) ||
			null == (_edCommunication = edCommunication) ||
			null == (_etdDesignation = etdDesignation) ||
			null == (_etd = etd) ||
			0 &gt;= (_marginFrequency = marginFrequency) ||
			0 &gt;= (_curePeriod = curePeriod))
		{
<span class="nc" id="L264">			throw new java.lang.Exception (&quot;CSAEventTimeline Constructor =&gt; Invalid Inputs&quot;);</span>
		}

<span class="nc" id="L267">		_calendarSet = calendarSet;</span>
<span class="nc" id="L268">	}</span>

	/**
	 * Retrieve the CSA Calendar Set
	 * 
	 * @return The CSA Calendar Set
	 */

	public java.lang.String calendarSet()
	{
<span class="nc" id="L278">		return _calendarSet;</span>
	}

	/**
	 * Retrieve the CSA Margin Frequency
	 * 
	 * @return The CSA Margin Frequency
	 */

	public int marginFrequency()
	{
<span class="nc" id="L289">		return _marginFrequency;</span>
	}

	/**
	 * Retrieve the Client Cure Period
	 * 
	 * @return The Client Cure Period
	 */

	public int curePeriod()
	{
<span class="nc" id="L300">		return _curePeriod;</span>
	}

	/**
	 * Retrieve the Valuation Event Date
	 * 
	 * @return The Valuation Event Date
	 */

	public org.drip.xva.margin.CSAEventDate valuation()
	{
<span class="nc" id="L311">		return _valuation;</span>
	}

	/**
	 * Retrieve the Last Honored Event Date
	 * 
	 * @return The Last Honored Event Date
	 */

	public org.drip.xva.margin.CSAEventDate lastHonored()
	{
<span class="nc" id="L322">		return _lastHonored;</span>
	}

	/**
	 * Retrieve the Collateral Transfer Initiation Event Date
	 * 
	 * @return The Collateral Transfer Initiation Event Date
	 */

	public org.drip.xva.margin.CSAEventDate collateralTransferInitiation()
	{
<span class="nc" id="L333">		return _collateralTransferInitiation;</span>
	}

	/**
	 * Retrieve the First Non Honored Event Date
	 * 
	 * @return The First Non Honored Event Date
	 */

	public org.drip.xva.margin.CSAEventDate firstNonHonored()
	{
<span class="nc" id="L344">		return _firstNonHonored;</span>
	}

	/**
	 * Retrieve the PED Event Date
	 * 
	 * @return The PED Event Date
	 */

	public org.drip.xva.margin.CSAEventDate ped()
	{
<span class="nc" id="L355">		return _ped;</span>
	}

	/**
	 * Retrieve the PED Communication Event Date
	 * 
	 * @return The PED Communication Event Date
	 */

	public org.drip.xva.margin.CSAEventDate pedCommunication()
	{
<span class="nc" id="L366">		return _pedCommunication;</span>
	}

	/**
	 * Retrieve the ED Event Date
	 * 
	 * @return The ED Event Date
	 */

	public org.drip.xva.margin.CSAEventDate ed()
	{
<span class="nc" id="L377">		return _ed;</span>
	}

	/**
	 * Retrieve the ED Communication Event Date
	 * 
	 * @return The ED Communication Event Date
	 */

	public org.drip.xva.margin.CSAEventDate edCommunication()
	{
<span class="nc" id="L388">		return _edCommunication;</span>
	}

	/**
	 * Retrieve the ETD Designation Event Date
	 * 
	 * @return The ETD Designation Event Date
	 */

	public org.drip.xva.margin.CSAEventDate etdDesignation()
	{
<span class="nc" id="L399">		return _etdDesignation;</span>
	}

	/**
	 * Retrieve the ETD Event Date
	 * 
	 * @return The ETD Event Date
	 */

	public org.drip.xva.margin.CSAEventDate etd()
	{
<span class="nc" id="L410">		return _etd;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>