<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>TreasuryFuturesAPI.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.service.product</a> &gt; <span class="el_source">TreasuryFuturesAPI.java</span></div><h1>TreasuryFuturesAPI.java</h1><pre class="source lang-java linenums">
package org.drip.service.product;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2020 Lakshmi Krishnamurthy
 * Copyright (C) 2019 Lakshmi Krishnamurthy
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * 
 *  This file is part of DROP, an open-source library targeting analytics/risk, transaction cost analytics,
 *  	asset liability management analytics, capital, exposure, and margin analytics, valuation adjustment
 *  	analytics, and portfolio construction analytics within and across fixed income, credit, commodity,
 *  	equity, FX, and structured products. It also includes auxiliary libraries for algorithm support,
 *  	numerical analysis, numerical optimization, spline builder, model validation, statistical learning,
 *  	and computational support.
 *  
 *  	https://lakshmidrip.github.io/DROP/
 *  
 *  DROP is composed of three modules:
 *  
 *  - DROP Product Core - https://lakshmidrip.github.io/DROP-Product-Core/
 *  - DROP Portfolio Core - https://lakshmidrip.github.io/DROP-Portfolio-Core/
 *  - DROP Computational Core - https://lakshmidrip.github.io/DROP-Computational-Core/
 * 
 * 	DROP Product Core implements libraries for the following:
 * 	- Fixed Income Analytics
 * 	- Loan Analytics
 * 	- Transaction Cost Analytics
 * 
 * 	DROP Portfolio Core implements libraries for the following:
 * 	- Asset Allocation Analytics
 *  - Asset Liability Management Analytics
 * 	- Capital Estimation Analytics
 * 	- Exposure Analytics
 * 	- Margin Analytics
 * 	- XVA Analytics
 * 
 * 	DROP Computational Core implements libraries for the following:
 * 	- Algorithm Support
 * 	- Computation Support
 * 	- Function Analysis
 *  - Model Validation
 * 	- Numerical Analysis
 * 	- Numerical Optimizer
 * 	- Spline Builder
 *  - Statistical Learning
 * 
 * 	Documentation for DROP is Spread Over:
 * 
 * 	- Main                     =&gt; https://lakshmidrip.github.io/DROP/
 * 	- Wiki                     =&gt; https://github.com/lakshmiDRIP/DROP/wiki
 * 	- GitHub                   =&gt; https://github.com/lakshmiDRIP/DROP
 * 	- Repo Layout Taxonomy     =&gt; https://github.com/lakshmiDRIP/DROP/blob/master/Taxonomy.md
 * 	- Javadoc                  =&gt; https://lakshmidrip.github.io/DROP/Javadoc/index.html
 * 	- Technical Specifications =&gt; https://github.com/lakshmiDRIP/DROP/tree/master/Docs/Internal
 * 	- Release Versions         =&gt; https://lakshmidrip.github.io/DROP/version.html
 * 	- Community Credits        =&gt; https://lakshmidrip.github.io/DROP/credits.html
 * 	- Issues Catalog           =&gt; https://github.com/lakshmiDRIP/DROP/issues
 * 	- JUnit                    =&gt; https://lakshmidrip.github.io/DROP/junit/index.html
 * 	- Jacoco                   =&gt; https://lakshmidrip.github.io/DROP/jacoco/index.html
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * &lt;i&gt;TreasuryFuturesAPI&lt;/i&gt; demonstrates the Details behind the Pricing and the Scenario Runs behind a
 * Treasury Futures Contract.
 * 
 * &lt;br&gt;&lt;br&gt;
 *  &lt;ul&gt;
 *		&lt;li&gt;&lt;b&gt;Module &lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/ComputationalCore.md&quot;&gt;Computational Core Module&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Library&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/ComputationSupportLibrary.md&quot;&gt;Computation Support&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Project&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/service/README.md&quot;&gt;Environment, Product/Definition Containers, and Scenario/State Manipulation APIs&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Package&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/service/product/README.md&quot;&gt;Product Horizon PnL Attribution Decomposition&lt;/a&gt;&lt;/li&gt;
 *  &lt;/ul&gt;
 * &lt;br&gt;&lt;br&gt;
 *
 * @author Lakshmi Krishnamurthy
 */

<span class="nc" id="L98">public class TreasuryFuturesAPI {</span>

	/**
	 * Generate a Full Map Invocation of the Treasury Futures Run Use Case
	 * 
	 * @param strFuturesCode The Treasury Futures Code
	 * @param aiFuturesComponentTreasuryEffectiveDate Array of the Treasury Futures Component Effective Date
	 * @param aiFuturesComponentTreasuryMaturityDate Array of the Treasury Futures Component Maturity Date
	 * @param adblFuturesComponentTreasuryCoupon Array of the Treasury Futures Component Coupon
	 * @param adblFuturesComponentConversionFactor Array of the Treasury Futures Component Conversion Factor
	 * @param iSpotDate Spot Date
	 * @param astrFundingCurveDepositTenor Deposit Instruments Tenor (for Funding Curve)
	 * @param adblFundingCurveDepositQuote Deposit Instruments Quote (for Funding Curve)
	 * @param strFundingCurveDepositMeasure Deposit Instruments Measure (for Funding Curve)
	 * @param adblFundingCurveFuturesQuote Futures Instruments Tenor (for Funding Curve)
	 * @param strFundingCurveFuturesMeasure Futures Instruments Measure (for Funding Curve)
	 * @param astrFundingCurveFixFloatTenor Fix-Float Instruments Tenor (for Funding Curve)
	 * @param adblFundingCurveFixFloatQuote Fix-Float Instruments Quote (for Funding Curve)
	 * @param strFundingFixFloatMeasure Fix-Float Instruments Tenor (for Funding Curve)
	 * @param aiGovvieCurveTreasuryEffectiveDate Array of the Treasury Instrument Effective Date (for Treasury
	 * 		Curve)
	 * @param aiGovvieCurveTreasuryMaturityDate Array of the Treasury Instrument Maturity Date (for Treasury
	 * 		Curve)
	 * @param adblGovvieCurveTreasuryCoupon Array of the Treasury Instrument Coupon (for Treasury Curve)
	 * @param adblGovvieCurveTreasuryYield Array of the Treasury Instrument Yield (for Treasury Curve)
	 * @param strGovvieCurveTreasuryMeasure Treasury Instrument Measure (for Govvie Curve)
	 * @param adblFuturesComponentTreasuryPrice Array of the Treasury Futures Component Clean Prices
	 * 
	 * @return The Output Measure Map
	 */

	public static final java.util.Map&lt;java.lang.String, java.lang.Double&gt; ValuationMetrics (
		final java.lang.String strFuturesCode,
		final int[] aiFuturesComponentTreasuryEffectiveDate,
		final int[] aiFuturesComponentTreasuryMaturityDate,
		final double[] adblFuturesComponentTreasuryCoupon,
		final double[] adblFuturesComponentConversionFactor,
		final int iSpotDate,
		final java.lang.String[] astrFundingCurveDepositTenor,
		final double[] adblFundingCurveDepositQuote,
		final java.lang.String strFundingCurveDepositMeasure,
		final double[] adblFundingCurveFuturesQuote,
		final java.lang.String strFundingCurveFuturesMeasure,
		final java.lang.String[] astrFundingCurveFixFloatTenor,
		final double[] adblFundingCurveFixFloatQuote,
		final java.lang.String strFundingFixFloatMeasure,
		final int[] aiGovvieCurveTreasuryEffectiveDate,
		final int[] aiGovvieCurveTreasuryMaturityDate,
		final double[] adblGovvieCurveTreasuryCoupon,
		final double[] adblGovvieCurveTreasuryYield,
		final java.lang.String strGovvieCurveTreasuryMeasure,
		final double[] adblFuturesComponentTreasuryPrice)
	{
<span class="fc" id="L151">		org.drip.analytics.date.JulianDate dtSpot = null;</span>
<span class="fc" id="L152">		org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryMaturity = null;</span>
<span class="fc" id="L153">		org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryEffective = null;</span>
<span class="pc bpc" id="L154" title="1 of 2 branches missed.">		int iNumGovvieCurveMaturity = null == aiGovvieCurveTreasuryMaturityDate ? 0 :</span>
			aiGovvieCurveTreasuryMaturityDate.length;
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">		int iNumGovvieCurveEffective = null == aiGovvieCurveTreasuryEffectiveDate ? 0 :</span>
			aiGovvieCurveTreasuryEffectiveDate.length;
<span class="fc" id="L158">		java.lang.String[] astrTreasuryBenchmarkCode = new java.lang.String[] {&quot;01YON&quot;, &quot;02YON&quot;, &quot;03YON&quot;,</span>
			&quot;05YON&quot;, &quot;07YON&quot;, &quot;10YON&quot;, &quot;30YON&quot;};
<span class="fc" id="L160">		int iNumTreasuryBenchmark = astrTreasuryBenchmarkCode.length;</span>

<span class="pc bpc" id="L162" title="1 of 2 branches missed.">		if (null == adblFuturesComponentTreasuryPrice) return null;</span>

<span class="pc bpc" id="L164" title="1 of 2 branches missed.">		if (0 != iNumGovvieCurveMaturity)</span>
<span class="fc" id="L165">			adtGovvieCurveTreasuryMaturity = new org.drip.analytics.date.JulianDate[iNumGovvieCurveMaturity];</span>

<span class="pc bpc" id="L167" title="1 of 2 branches missed.">		if (0 != iNumGovvieCurveEffective)</span>
<span class="fc" id="L168">			adtGovvieCurveTreasuryEffective = new</span>
				org.drip.analytics.date.JulianDate[iNumGovvieCurveEffective];

<span class="fc" id="L171">		org.drip.param.market.CurveSurfaceQuoteContainer csqc = new</span>
			org.drip.param.market.CurveSurfaceQuoteContainer();

		try {
<span class="fc" id="L175">			dtSpot = new org.drip.analytics.date.JulianDate (iSpotDate);</span>

<span class="fc bfc" id="L177" title="All 2 branches covered.">			for (int i = 0; i &lt; iNumGovvieCurveMaturity; ++i)</span>
<span class="fc" id="L178">				adtGovvieCurveTreasuryMaturity[i] = new org.drip.analytics.date.JulianDate</span>
					(aiGovvieCurveTreasuryMaturityDate[i]);

<span class="fc bfc" id="L181" title="All 2 branches covered.">			for (int i = 0; i &lt; iNumGovvieCurveEffective; ++i)</span>
<span class="fc" id="L182">				adtGovvieCurveTreasuryEffective[i] = new org.drip.analytics.date.JulianDate</span>
					(aiGovvieCurveTreasuryEffectiveDate[i]);

<span class="pc bpc" id="L185" title="2 of 4 branches missed.">			if (null != adblGovvieCurveTreasuryYield &amp;&amp; adblGovvieCurveTreasuryYield.length ==</span>
				iNumTreasuryBenchmark) {
<span class="fc bfc" id="L187" title="All 2 branches covered.">				for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="fc" id="L188">					org.drip.param.quote.ProductMultiMeasure pmm = new</span>
						org.drip.param.quote.ProductMultiMeasure();

<span class="fc" id="L191">					pmm.addQuote (&quot;Yield&quot;, new org.drip.param.quote.MultiSided (&quot;mid&quot;,</span>
						adblGovvieCurveTreasuryYield[i]), true);

<span class="pc bpc" id="L194" title="1 of 2 branches missed.">					if (!csqc.setProductQuote (astrTreasuryBenchmarkCode[i], pmm)) return null;</span>
				}
			}
<span class="nc" id="L197">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L198">			e.printStackTrace();</span>

<span class="nc" id="L200">			return null;</span>
<span class="fc" id="L201">		}</span>

<span class="fc" id="L203">		org.drip.product.govvie.TreasuryFutures tsyFut =</span>
<span class="fc" id="L204">			org.drip.service.template.ExchangeInstrumentBuilder.TreasuryFutures (dtSpot, strFuturesCode,</span>
				aiFuturesComponentTreasuryEffectiveDate, aiFuturesComponentTreasuryMaturityDate,
					adblFuturesComponentTreasuryCoupon, adblFuturesComponentConversionFactor);

<span class="pc bpc" id="L208" title="1 of 2 branches missed.">		if (null == tsyFut) return null;</span>

<span class="fc" id="L210">		org.drip.product.definition.Bond[] aBond = tsyFut.basket();</span>

<span class="fc" id="L212">		int iNumFuturesComponent = adblFuturesComponentTreasuryPrice.length;</span>

<span class="fc bfc" id="L214" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumFuturesComponent; ++i) {</span>
<span class="fc" id="L215">			org.drip.param.quote.ProductMultiMeasure pmm = new org.drip.param.quote.ProductMultiMeasure();</span>

			try {
<span class="fc" id="L218">				pmm.addQuote (&quot;Price&quot;, new org.drip.param.quote.MultiSided (&quot;mid&quot;,</span>
					adblFuturesComponentTreasuryPrice[i]), true);
<span class="nc" id="L220">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L221">				e.printStackTrace();</span>

<span class="nc" id="L223">				return null;</span>
<span class="fc" id="L224">			}</span>

<span class="fc" id="L226">			csqc.setProductQuote (aBond[i].name(), pmm);</span>
		}

<span class="fc" id="L229">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding =</span>
<span class="fc" id="L230">			org.drip.service.template.LatentMarketStateBuilder.SmoothFundingCurve (dtSpot,</span>
<span class="fc" id="L231">				aBond[0].currency(), astrFundingCurveDepositTenor, adblFundingCurveDepositQuote,</span>
					strFundingCurveDepositMeasure, adblFundingCurveFuturesQuote,
						strFundingCurveFuturesMeasure, astrFundingCurveFixFloatTenor,
							adblFundingCurveFixFloatQuote, strFundingFixFloatMeasure);

<span class="fc" id="L236">		csqc.setFundingState (dcFunding);</span>

<span class="fc" id="L238">		org.drip.state.govvie.GovvieCurve gc =</span>
<span class="fc" id="L239">			org.drip.service.template.LatentMarketStateBuilder.ShapePreservingGovvieCurve (tsyFut.type(),</span>
				dtSpot, adtGovvieCurveTreasuryEffective, adtGovvieCurveTreasuryMaturity,
					adblGovvieCurveTreasuryCoupon, adblGovvieCurveTreasuryYield,
						strGovvieCurveTreasuryMeasure);

<span class="fc" id="L244">		csqc.setGovvieState (gc);</span>

<span class="fc" id="L246">		return tsyFut.value (org.drip.param.valuation.ValuationParams.Spot (dtSpot.julian()), null, csqc,</span>
			null);
	}

	/**
	 * Generate the Treasury Curve Tenor Key Rate Sensitivity/Duration
	 * 
	 * @param strFuturesCode The Treasury Futures Code
	 * @param aiFuturesComponentTreasuryEffectiveDate Array of the Treasury Futures Component Effective Date
	 * @param aiFuturesComponentTreasuryMaturityDate Array of the Treasury Futures Component Maturity Date
	 * @param adblFuturesComponentTreasuryCoupon Array of the Treasury Futures Component Coupon
	 * @param adblFuturesComponentConversionFactor Array of the Treasury Futures Component Conversion Factor
	 * @param iSpotDate Spot Date
	 * @param aiGovvieCurveTreasuryEffectiveDate Array of the Treasury Instrument Effective Date (for Treasury
	 * 		Curve)
	 * @param aiGovvieCurveTreasuryMaturityDate Array of the Treasury Instrument Maturity Date (for Treasury
	 * 		Curve)
	 * @param adblGovvieCurveTreasuryCoupon Array of the Treasury Instrument Coupon (for Treasury Curve)
	 * @param adblGovvieCurveTreasuryYield Array of the Treasury Instrument Yield (for Treasury Curve)
	 * @param strGovvieCurveTreasuryMeasure Treasury Instrument Measure (for Govvie Curve)
	 * @param adblFuturesComponentTreasuryPrice Array of the Treasury Futures Component Clean Prices
	 * 
	 * @return The Treasury Curve Tenor Sensitivity/Duration
	 */

	public static final java.util.Map&lt;java.lang.String, java.lang.Double&gt; KeyRateDuration (
		final java.lang.String strFuturesCode,
		final int[] aiFuturesComponentTreasuryEffectiveDate,
		final int[] aiFuturesComponentTreasuryMaturityDate,
		final double[] adblFuturesComponentTreasuryCoupon,
		final double[] adblFuturesComponentConversionFactor,
		final int iSpotDate,
		final int[] aiGovvieCurveTreasuryEffectiveDate,
		final int[] aiGovvieCurveTreasuryMaturityDate,
		final double[] adblGovvieCurveTreasuryCoupon,
		final double[] adblGovvieCurveTreasuryYield,
		final java.lang.String strGovvieCurveTreasuryMeasure,
		final double[] adblFuturesComponentTreasuryPrice)
	{
<span class="fc" id="L285">		double dblBaselineCTDOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L286">		org.drip.analytics.date.JulianDate dtSpot = null;</span>
<span class="fc" id="L287">		org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryMaturity = null;</span>
<span class="fc" id="L288">		org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryEffective = null;</span>
<span class="pc bpc" id="L289" title="1 of 2 branches missed.">		int iNumGovvieCurveMaturity = null == aiGovvieCurveTreasuryMaturityDate ? 0 :</span>
			aiGovvieCurveTreasuryMaturityDate.length;
<span class="pc bpc" id="L291" title="1 of 2 branches missed.">		int iNumGovvieCurveEffective = null == aiGovvieCurveTreasuryEffectiveDate ? 0 :</span>
			aiGovvieCurveTreasuryEffectiveDate.length;
<span class="fc" id="L293">		java.lang.String[] astrTreasuryBenchmarkCode = new java.lang.String[] {&quot;01YON&quot;, &quot;02YON&quot;, &quot;03YON&quot;,</span>
			&quot;05YON&quot;, &quot;07YON&quot;, &quot;10YON&quot;, &quot;30YON&quot;};
<span class="fc" id="L295">		int iNumTreasuryBenchmark = astrTreasuryBenchmarkCode.length;</span>
<span class="pc bpc" id="L296" title="1 of 2 branches missed.">		int iNumFuturesComponent = null == adblFuturesComponentTreasuryPrice ? 0 :</span>
			adblFuturesComponentTreasuryPrice.length;

<span class="pc bpc" id="L299" title="1 of 2 branches missed.">		if (0 == iNumFuturesComponent) return null;</span>

<span class="pc bpc" id="L301" title="1 of 2 branches missed.">		if (0 != iNumGovvieCurveMaturity)</span>
<span class="fc" id="L302">			adtGovvieCurveTreasuryMaturity = new org.drip.analytics.date.JulianDate[iNumGovvieCurveMaturity];</span>

<span class="pc bpc" id="L304" title="1 of 2 branches missed.">		if (0 != iNumGovvieCurveEffective)</span>
<span class="fc" id="L305">			adtGovvieCurveTreasuryEffective = new</span>
				org.drip.analytics.date.JulianDate[iNumGovvieCurveEffective];

<span class="fc" id="L308">		org.drip.param.market.CurveSurfaceQuoteContainer csqc = new</span>
			org.drip.param.market.CurveSurfaceQuoteContainer();

		try {
<span class="fc" id="L312">			dtSpot = new org.drip.analytics.date.JulianDate (iSpotDate);</span>

<span class="fc bfc" id="L314" title="All 2 branches covered.">			for (int i = 0; i &lt; iNumGovvieCurveMaturity; ++i)</span>
<span class="fc" id="L315">				adtGovvieCurveTreasuryMaturity[i] = new org.drip.analytics.date.JulianDate</span>
					(aiGovvieCurveTreasuryMaturityDate[i]);

<span class="fc bfc" id="L318" title="All 2 branches covered.">			for (int i = 0; i &lt; iNumGovvieCurveEffective; ++i)</span>
<span class="fc" id="L319">				adtGovvieCurveTreasuryEffective[i] = new org.drip.analytics.date.JulianDate</span>
					(aiGovvieCurveTreasuryEffectiveDate[i]);

<span class="pc bpc" id="L322" title="2 of 4 branches missed.">			if (null != adblGovvieCurveTreasuryYield &amp;&amp; adblGovvieCurveTreasuryYield.length ==</span>
				iNumTreasuryBenchmark) {
<span class="fc bfc" id="L324" title="All 2 branches covered.">				for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="fc" id="L325">					org.drip.param.quote.ProductMultiMeasure pmm = new</span>
						org.drip.param.quote.ProductMultiMeasure();

<span class="fc" id="L328">					pmm.addQuote (&quot;Yield&quot;, new org.drip.param.quote.MultiSided (&quot;mid&quot;,</span>
						adblGovvieCurveTreasuryYield[i]), true);

<span class="pc bpc" id="L331" title="1 of 2 branches missed.">					if (!csqc.setProductQuote (astrTreasuryBenchmarkCode[i], pmm)) return null;</span>
				}
			}
<span class="nc" id="L334">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L335">			e.printStackTrace();</span>

<span class="nc" id="L337">			return null;</span>
<span class="fc" id="L338">		}</span>

<span class="fc" id="L340">		org.drip.product.govvie.TreasuryFutures tsyFut =</span>
<span class="fc" id="L341">			org.drip.service.template.ExchangeInstrumentBuilder.TreasuryFutures (dtSpot, strFuturesCode,</span>
				aiFuturesComponentTreasuryEffectiveDate, aiFuturesComponentTreasuryMaturityDate,
					adblFuturesComponentTreasuryCoupon, adblFuturesComponentConversionFactor);

<span class="pc bpc" id="L345" title="1 of 2 branches missed.">		if (null == tsyFut) return null;</span>

<span class="fc" id="L347">		org.drip.product.definition.Bond[] aBond = tsyFut.basket();</span>

<span class="fc bfc" id="L349" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumFuturesComponent; ++i) {</span>
<span class="fc" id="L350">			org.drip.param.quote.ProductMultiMeasure pmm = new org.drip.param.quote.ProductMultiMeasure();</span>

			try {
<span class="fc" id="L353">				pmm.addQuote (&quot;Price&quot;, new org.drip.param.quote.MultiSided (&quot;mid&quot;,</span>
					adblFuturesComponentTreasuryPrice[i]), true);
<span class="nc" id="L355">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L356">				e.printStackTrace();</span>

<span class="nc" id="L358">				return null;</span>
<span class="fc" id="L359">			}</span>

<span class="pc bpc" id="L361" title="1 of 2 branches missed.">			if (!csqc.setProductQuote (aBond[i].name(), pmm)) return null;</span>
		}

<span class="fc" id="L364">		java.lang.String strTreasuryType = tsyFut.type();</span>

<span class="fc" id="L366">		if (!csqc.setGovvieState</span>
<span class="pc bpc" id="L367" title="1 of 2 branches missed.">			(org.drip.service.template.LatentMarketStateBuilder.ShapePreservingGovvieCurve (strTreasuryType,</span>
				dtSpot, adtGovvieCurveTreasuryEffective, adtGovvieCurveTreasuryMaturity,
					adblGovvieCurveTreasuryCoupon, adblGovvieCurveTreasuryYield,
						strGovvieCurveTreasuryMeasure)))
<span class="nc" id="L371">			return null;</span>

<span class="fc" id="L373">		org.drip.product.params.CTDEntry ctdEntry = tsyFut.cheapestToDeliverYield (iSpotDate,</span>
			adblFuturesComponentTreasuryPrice);

<span class="pc bpc" id="L376" title="1 of 2 branches missed.">		if (null == ctdEntry) return null;</span>

<span class="fc" id="L378">		org.drip.product.definition.Bond bondCTD = ctdEntry.bond();</span>

<span class="pc bpc" id="L380" title="1 of 2 branches missed.">		if (null == bondCTD) return null;</span>

<span class="fc" id="L382">		double dblCTDExpiryPrice = ctdEntry.forwardPrice();</span>

<span class="fc" id="L384">		org.drip.param.valuation.ValuationParams valParamsExpiry =</span>
<span class="fc" id="L385">			org.drip.param.valuation.ValuationParams.Spot (tsyFut.expiry().julian());</span>

		try {
<span class="pc bpc" id="L388" title="1 of 2 branches missed.">			if (!org.drip.numerical.common.NumberUtil.IsValid (dblBaselineCTDOAS = bondCTD.oasFromPrice</span>
<span class="fc" id="L389">				(valParamsExpiry, csqc, null, dblCTDExpiryPrice)))</span>
<span class="nc" id="L390">				return null;</span>
<span class="nc" id="L391">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L392">			e.printStackTrace();</span>

<span class="nc" id="L394">			return null;</span>
<span class="fc" id="L395">		}</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.govvie.GovvieCurve&gt;
<span class="fc" id="L398">			mapTenorGovvieCurve = org.drip.service.template.LatentMarketStateBuilder.BumpedGovvieCurve</span>
<span class="fc" id="L399">				(strTreasuryType, dtSpot, adtGovvieCurveTreasuryEffective, adtGovvieCurveTreasuryMaturity,</span>
					adblGovvieCurveTreasuryCoupon, adblGovvieCurveTreasuryYield,
						strGovvieCurveTreasuryMeasure,
							org.drip.service.template.LatentMarketStateBuilder.SHAPE_PRESERVING, 0.0001,
								false);

<span class="pc bpc" id="L405" title="2 of 4 branches missed.">		if (null == mapTenorGovvieCurve || iNumTreasuryBenchmark &gt; mapTenorGovvieCurve.size()) return null;</span>

<span class="fc" id="L407">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapKeyRateDuration = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

		for (java.util.Map.Entry&lt;java.lang.String, org.drip.state.govvie.GovvieCurve&gt; me :
<span class="fc bfc" id="L411" title="All 2 branches covered.">			mapTenorGovvieCurve.entrySet()) {</span>
<span class="fc" id="L412">			java.lang.String strKey = me.getKey();</span>

<span class="fc bfc" id="L414" title="All 2 branches covered.">			if (!strKey.contains (&quot;tsy&quot;)) continue;</span>

<span class="pc bpc" id="L416" title="1 of 2 branches missed.">			if (!csqc.setGovvieState (me.getValue())) return null;</span>

<span class="fc" id="L418">			org.drip.product.params.CTDEntry tenorCTDEntry = tsyFut.cheapestToDeliverYield (iSpotDate,</span>
				adblFuturesComponentTreasuryPrice);

<span class="pc bpc" id="L421" title="1 of 2 branches missed.">			if (null == tenorCTDEntry) return null;</span>

<span class="fc" id="L423">			org.drip.product.definition.Bond tenorBondCTD = tenorCTDEntry.bond();</span>

<span class="pc bpc" id="L425" title="1 of 2 branches missed.">			if (null == tenorBondCTD) return null;</span>

			try {
<span class="fc" id="L428">				mapKeyRateDuration.put (strKey, 10000. * (tenorBondCTD.priceFromOAS (valParamsExpiry, csqc,</span>
					null, dblBaselineCTDOAS) - dblCTDExpiryPrice) / dblCTDExpiryPrice);
<span class="nc" id="L430">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L431">				e.printStackTrace();</span>

<span class="nc" id="L433">				return null;</span>
<span class="fc" id="L434">			}</span>
<span class="fc" id="L435">		}</span>

<span class="fc" id="L437">		return mapKeyRateDuration;</span>
	}

	/**
	 * Returns Attribution for the Treasury Futures
	 * 
	 * @param strTreasuryCode The Treasury Code
	 * @param adtEffective Array of Effective Dates
	 * @param adtMaturity Array of Maturity Dates
	 * @param adblCoupon Array of Coupons
	 * @param adtExpiry Array of Futures Expiry Dates
	 * @param adtSpot Array of Spot Dates
	 * @param adblCleanPrice Array of Closing Clean Prices
	 * @param adblConversionFactor Array of the Conversion Factor
	 * 
	 * @return List of the Position Change Components
	 */

	public static final java.util.List&lt;org.drip.historical.attribution.PositionChangeComponents&gt;
		HorizonChangeAttribution (
			final java.lang.String strTreasuryCode,
			final org.drip.analytics.date.JulianDate[] adtEffective,
			final org.drip.analytics.date.JulianDate[] adtMaturity,
			final double[] adblCoupon,
			final org.drip.analytics.date.JulianDate[] adtExpiry,
			final org.drip.analytics.date.JulianDate[] adtSpot,
			final double[] adblCleanPrice,
			final double[] adblConversionFactor)
	{
<span class="nc" id="L466">		org.drip.product.credit.BondComponent[] aTreasury =</span>
<span class="nc" id="L467">			org.drip.service.template.TreasuryBuilder.FromCode (strTreasuryCode, adtEffective, adtMaturity,</span>
				adblCoupon);

<span class="nc bnc" id="L470" title="All 10 branches missed.">		if (null == aTreasury || null == adtExpiry || null == adtSpot || null == adblCleanPrice || null ==</span>
			adblConversionFactor)
<span class="nc" id="L472">			return null;</span>

<span class="nc" id="L474">		int iNumCloses = adtSpot.length;</span>
<span class="nc" id="L475">		int[] aiExpiryDate = new int[iNumCloses];</span>
<span class="nc" id="L476">		double[] adblYield = new double[iNumCloses];</span>
<span class="nc" id="L477">		double[] adblForwardAccrued = new double[iNumCloses];</span>
<span class="nc" id="L478">		double[] adblForwardCleanPrice = new double[iNumCloses];</span>
<span class="nc" id="L479">		double[] adblForwardModifiedDuration = new double[iNumCloses];</span>

<span class="nc bnc" id="L481" title="All 10 branches missed.">		if (1 &gt;= iNumCloses || iNumCloses != aTreasury.length || iNumCloses != adblCleanPrice.length ||</span>
			iNumCloses != adtExpiry.length || iNumCloses != adblConversionFactor.length)
<span class="nc" id="L483">			return null;</span>

<span class="nc" id="L485">		java.util.List&lt;org.drip.historical.attribution.PositionChangeComponents&gt; lsPCC = new</span>
			java.util.ArrayList&lt;org.drip.historical.attribution.PositionChangeComponents&gt;();

<span class="nc bnc" id="L488" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumCloses; ++i) {</span>
<span class="nc bnc" id="L489" title="All 2 branches missed.">			if (null == aTreasury[i]) return null;</span>

<span class="nc" id="L491">			org.drip.param.valuation.ValuationParams valParamsSpot =</span>
<span class="nc" id="L492">				org.drip.param.valuation.ValuationParams.Spot (adtSpot[i].julian());</span>

<span class="nc" id="L494">			org.drip.param.valuation.ValuationParams valParamsExpiry =</span>
<span class="nc" id="L495">				org.drip.param.valuation.ValuationParams.Spot (aiExpiryDate[i] = adtExpiry[i].julian());</span>

			try {
<span class="nc" id="L498">				adblForwardAccrued[i] = aTreasury[i].accrued (aiExpiryDate[i], null);</span>

<span class="nc" id="L500">				adblYield[i] = aTreasury[i].yieldFromPrice (valParamsSpot, null, null, adblCleanPrice[i]);</span>

<span class="nc" id="L502">				adblForwardCleanPrice[i] = aTreasury[i].priceFromYield (valParamsExpiry, null, null,</span>
					adblYield[i]);

<span class="nc" id="L505">				adblForwardModifiedDuration[i] = aTreasury[i].modifiedDurationFromPrice (valParamsExpiry,</span>
					null, null, adblForwardCleanPrice[i]) * 10000.;
<span class="nc" id="L507">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L508">				e.printStackTrace();</span>
<span class="nc" id="L509">			}</span>
		}

<span class="nc bnc" id="L512" title="All 2 branches missed.">		for (int i = 1; i &lt; iNumCloses; ++i) {</span>
<span class="nc bnc" id="L513" title="All 2 branches missed.">			if (adblConversionFactor[i] != adblConversionFactor[i - 1]) continue;</span>

<span class="nc" id="L515">			java.lang.String strCurrentBondName = aTreasury[i].name();</span>

<span class="nc" id="L517">			java.lang.String strPreviousBondName = aTreasury[i - 1].name();</span>

<span class="nc" id="L519">			double dblScaledPrice1 = (adblForwardCleanPrice[i - 1] + adblForwardAccrued[i - 1]) /</span>
				adblConversionFactor[i - 1];
<span class="nc" id="L521">			double dblScaledPrice2 = (adblForwardCleanPrice[i] + adblForwardAccrued[i]) /</span>
				adblConversionFactor[i];

			try {
<span class="nc" id="L525">				org.drip.historical.attribution.TreasuryFuturesMarketSnap tfpms1 = new</span>
					org.drip.historical.attribution.TreasuryFuturesMarketSnap (adtSpot[i - 1],
						dblScaledPrice1);

<span class="nc bnc" id="L529" title="All 2 branches missed.">				if (!tfpms1.setYieldMarketFactor (adblYield[i - 1], -1. * dblScaledPrice1 *</span>
<span class="nc bnc" id="L530" title="All 2 branches missed.">					adblForwardModifiedDuration[i - 1], 0.) || !tfpms1.setExpiryDate (adtExpiry[i - 1]) ||</span>
<span class="nc bnc" id="L531" title="All 2 branches missed.">						!tfpms1.setCTDName (strPreviousBondName) || !tfpms1.setCleanExpiryPrice</span>
<span class="nc bnc" id="L532" title="All 2 branches missed.">							(adblForwardCleanPrice[i - 1]) || !tfpms1.setConversionFactor</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">								(adblConversionFactor[i - 1]))</span>
<span class="nc" id="L534">					return null;</span>

<span class="nc" id="L536">				org.drip.historical.attribution.TreasuryFuturesMarketSnap tfpms2 = new</span>
					org.drip.historical.attribution.TreasuryFuturesMarketSnap (adtSpot[i],
						dblScaledPrice2);

<span class="nc bnc" id="L540" title="All 2 branches missed.">				if (!tfpms2.setYieldMarketFactor (adblYield[i], -1. * dblScaledPrice2 *</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">					adblForwardModifiedDuration[i], 0.) || !tfpms2.setExpiryDate (adtExpiry[i]) ||</span>
<span class="nc bnc" id="L542" title="All 2 branches missed.">						!tfpms2.setCTDName (strCurrentBondName) || !tfpms2.setCleanExpiryPrice</span>
<span class="nc bnc" id="L543" title="All 2 branches missed.">							(adblForwardCleanPrice[i]) || !tfpms2.setConversionFactor</span>
<span class="nc bnc" id="L544" title="All 2 branches missed.">								(adblConversionFactor[i]))</span>
<span class="nc" id="L545">					return null;</span>

<span class="nc" id="L547">				org.drip.historical.attribution.PositionChangeComponents pcc = new</span>
					org.drip.historical.attribution.PositionChangeComponents (false, tfpms1, tfpms2, 0.,
						null);

<span class="nc" id="L551">				lsPCC.add (pcc);</span>
<span class="nc" id="L552">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L553">				e.printStackTrace();</span>
<span class="nc" id="L554">			}</span>
		}

<span class="nc" id="L557">		return lsPCC;</span>
	}

	/**
	 * Generate the Horizon Treasury Curve Tenor Key Rate Sensitivity/Duration
	 * 
	 * @param strTreasuryType The Treasury Type
	 * @param adtEffective Array of Effective Dates
	 * @param adtMaturity Array of Maturity Dates
	 * @param adblCoupon Array of Coupons
	 * @param adtExpiry Array of Futures Expiry Dates
	 * @param adtSpot Array of Spot Dates
	 * @param adblCleanPrice Array of Closing Clean Prices
	 * @param astrBenchmarkTenor Array of Benchmark Tenors
	 * @param aadblGovvieCurveTreasuryYield Array of the Treasury Instrument Yield (for Treasury Curve)
	 * 
	 * @return The Treasury Curve Tenor Sensitivity/Duration
	 */

	public static final java.util.List&lt;org.drip.historical.sensitivity.TenorDurationNodeMetrics&gt;
		HorizonKeyRateDuration (
			final java.lang.String strTreasuryType,
			final org.drip.analytics.date.JulianDate[] adtEffective,
			final org.drip.analytics.date.JulianDate[] adtMaturity,
			final double[] adblCoupon,
			final org.drip.analytics.date.JulianDate[] adtExpiry,
			final org.drip.analytics.date.JulianDate[] adtSpot,
			final double[] adblCleanPrice,
			final java.lang.String[] astrBenchmarkTenor,
			final double[][] aadblGovvieCurveTreasuryYield)
	{
<span class="nc bnc" id="L588" title="All 8 branches missed.">		if (null == adtSpot || null == astrBenchmarkTenor || null == aadblGovvieCurveTreasuryYield || null ==</span>
			aadblGovvieCurveTreasuryYield[0])
<span class="nc" id="L590">			return null;</span>

<span class="nc" id="L592">		double dblExpiryCleanPrice = java.lang.Double.NaN;</span>
<span class="nc" id="L593">		double dblExpiryGSpread = java.lang.Double.NaN;</span>
<span class="nc" id="L594">		int iNumBenchmark = astrBenchmarkTenor.length;</span>
<span class="nc" id="L595">		double dblExpiryYield = java.lang.Double.NaN;</span>
<span class="nc" id="L596">		double dblSpotGSpread = java.lang.Double.NaN;</span>
<span class="nc" id="L597">		double dblSpotYield = java.lang.Double.NaN;</span>
<span class="nc" id="L598">		int iNumCloses = adtSpot.length;</span>

<span class="nc bnc" id="L600" title="All 4 branches missed.">		if (0 &gt;= iNumCloses || iNumCloses != aadblGovvieCurveTreasuryYield.length) return null;</span>

<span class="nc" id="L602">		java.util.List&lt;org.drip.historical.sensitivity.TenorDurationNodeMetrics&gt; lsTDNM = new</span>
			java.util.ArrayList&lt;org.drip.historical.sensitivity.TenorDurationNodeMetrics&gt;();

<span class="nc bnc" id="L605" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumCloses; ++i) {</span>
<span class="nc bnc" id="L606" title="All 4 branches missed.">			if (null == aadblGovvieCurveTreasuryYield[i] || iNumBenchmark !=</span>
				aadblGovvieCurveTreasuryYield[i].length)
<span class="nc" id="L608">				return null;</span>

<span class="nc" id="L610">			org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryEffective = new</span>
				org.drip.analytics.date.JulianDate[iNumBenchmark];
<span class="nc" id="L612">			org.drip.analytics.date.JulianDate[] adtGovvieCurveTreasuryMaturity = new</span>
				org.drip.analytics.date.JulianDate[iNumBenchmark];
<span class="nc" id="L614">			org.drip.historical.sensitivity.TenorDurationNodeMetrics tdnm = null;</span>
<span class="nc" id="L615">			double dblParallelKRD = 0.;</span>

<span class="nc bnc" id="L617" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumBenchmark; ++j) {</span>
<span class="nc" id="L618">				adtGovvieCurveTreasuryEffective[j] = adtSpot[i];</span>

<span class="nc" id="L620">				adtGovvieCurveTreasuryMaturity[j] = adtSpot[i].addTenor (astrBenchmarkTenor[j]);</span>
			}

<span class="nc" id="L623">			org.drip.state.govvie.GovvieCurve gc =</span>
				org.drip.service.template.LatentMarketStateBuilder.ShapePreservingGovvieCurve
<span class="nc" id="L625">					(strTreasuryType, adtSpot[i], adtGovvieCurveTreasuryEffective,</span>
						adtGovvieCurveTreasuryMaturity, aadblGovvieCurveTreasuryYield[i],
							aadblGovvieCurveTreasuryYield[i], &quot;Yield&quot;);

<span class="nc" id="L629">			org.drip.param.market.CurveSurfaceQuoteContainer csqc = new</span>
				org.drip.param.market.CurveSurfaceQuoteContainer();

<span class="nc bnc" id="L632" title="All 2 branches missed.">			if (!csqc.setGovvieState (gc)) continue;</span>

<span class="nc" id="L634">			org.drip.param.valuation.ValuationParams valParamsSpot =</span>
<span class="nc" id="L635">				org.drip.param.valuation.ValuationParams.Spot (adtSpot[i].julian());</span>

<span class="nc" id="L637">			org.drip.param.valuation.ValuationParams valParamsExpiry =</span>
<span class="nc" id="L638">				org.drip.param.valuation.ValuationParams.Spot (adtExpiry[i].julian());</span>

<span class="nc" id="L640">			org.drip.product.credit.BondComponent bondCTD =</span>
<span class="nc" id="L641">				org.drip.service.template.TreasuryBuilder.FromCode (strTreasuryType, adtEffective[i],</span>
					adtMaturity[i], adblCoupon[i]);

<span class="nc bnc" id="L644" title="All 2 branches missed.">			if (null == bondCTD) continue;</span>

			try {
<span class="nc" id="L647">				dblSpotGSpread = bondCTD.gSpreadFromPrice (valParamsSpot, csqc, null, adblCleanPrice[i]);</span>

<span class="nc" id="L649">				dblSpotYield = bondCTD.yieldFromPrice (valParamsSpot, csqc, null, adblCleanPrice[i]);</span>

<span class="nc" id="L651">				dblExpiryCleanPrice = bondCTD.priceFromGSpread (valParamsExpiry, csqc, null, dblSpotGSpread);</span>

<span class="nc" id="L653">				dblExpiryGSpread = bondCTD.gSpreadFromPrice (valParamsExpiry, csqc, null,</span>
					dblExpiryCleanPrice);

<span class="nc" id="L656">				dblExpiryYield = bondCTD.yieldFromPrice (valParamsExpiry, csqc, null, dblExpiryCleanPrice);</span>
<span class="nc" id="L657">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L658">				e.printStackTrace();</span>

<span class="nc" id="L660">				continue;</span>
<span class="nc" id="L661">			}</span>

			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.govvie.GovvieCurve&gt;
<span class="nc" id="L664">				mapTenorGovvieCurve = org.drip.service.template.LatentMarketStateBuilder.BumpedGovvieCurve</span>
<span class="nc" id="L665">					(strTreasuryType, adtSpot[i], adtGovvieCurveTreasuryEffective,</span>
						adtGovvieCurveTreasuryMaturity, aadblGovvieCurveTreasuryYield[i],
							aadblGovvieCurveTreasuryYield[i], &quot;Yield&quot;,
								org.drip.service.template.LatentMarketStateBuilder.SHAPE_PRESERVING, 0.0001,
									false);

<span class="nc bnc" id="L671" title="All 4 branches missed.">			if (null == mapTenorGovvieCurve || iNumBenchmark &gt; mapTenorGovvieCurve.size()) continue;</span>

			try {
<span class="nc" id="L674">				tdnm = new org.drip.historical.sensitivity.TenorDurationNodeMetrics (adtSpot[i]);</span>
<span class="nc" id="L675">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L676">				e.printStackTrace();</span>

<span class="nc" id="L678">				return null;</span>
<span class="nc" id="L679">			}</span>

<span class="nc" id="L681">			tdnm.setR1 (&quot;SpotGSpread&quot;, dblSpotGSpread);</span>

<span class="nc" id="L683">			tdnm.setR1 (&quot;ExpiryGSpread&quot;, dblExpiryGSpread);</span>

<span class="nc" id="L685">			tdnm.setR1 (&quot;SpotYield&quot;, dblSpotYield);</span>

<span class="nc" id="L687">			tdnm.setR1 (&quot;ExpiryYield&quot;, dblExpiryYield);</span>

<span class="nc" id="L689">			tdnm.setDate (&quot;ExpiryDate&quot;, adtExpiry[i]);</span>

<span class="nc" id="L691">			tdnm.setC1 (&quot;CTDName&quot;, bondCTD.name());</span>

<span class="nc" id="L693">			tdnm.setR1 (&quot;SpotCTDCleanPrice&quot;, adblCleanPrice[i]);</span>

<span class="nc" id="L695">			tdnm.setR1 (&quot;ExpiryCTDCleanPrice&quot;, dblExpiryCleanPrice);</span>

			for (java.util.Map.Entry&lt;java.lang.String, org.drip.state.govvie.GovvieCurve&gt; me :
<span class="nc bnc" id="L698" title="All 2 branches missed.">				mapTenorGovvieCurve.entrySet()) {</span>
<span class="nc" id="L699">				java.lang.String strKey = me.getKey();</span>

<span class="nc bnc" id="L701" title="All 2 branches missed.">				if (!strKey.contains (&quot;tsy&quot;)) continue;</span>

<span class="nc bnc" id="L703" title="All 2 branches missed.">				if (!csqc.setGovvieState (me.getValue())) return null;</span>

<span class="nc" id="L705">				double dblTenorKRD = java.lang.Double.NaN;</span>

				try {
<span class="nc" id="L708">					dblTenorKRD = -10000. * (bondCTD.priceFromGSpread (valParamsExpiry, csqc, null,</span>
						dblSpotGSpread) - dblExpiryCleanPrice) / dblExpiryCleanPrice;

<span class="nc bnc" id="L711" title="All 2 branches missed.">					if (!tdnm.addKRDNode (strKey, dblTenorKRD)) continue;</span>

<span class="nc" id="L713">					dblParallelKRD += dblTenorKRD;</span>
<span class="nc" id="L714">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L715">					e.printStackTrace();</span>

<span class="nc" id="L717">					return null;</span>
<span class="nc" id="L718">				}</span>
<span class="nc" id="L719">			}</span>

<span class="nc" id="L721">			tdnm.setR1 (&quot;ParallelKRD&quot;, dblParallelKRD);</span>

<span class="nc" id="L723">			lsTDNM.add (tdnm);</span>
		}

<span class="nc" id="L726">		return lsTDNM;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>