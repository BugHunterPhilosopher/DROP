<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BondComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.product.credit</a> &gt; <span class="el_source">BondComponent.java</span></div><h1>BondComponent.java</h1><pre class="source lang-java linenums">
package org.drip.product.credit;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2019 Lakshmi Krishnamurthy
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * Copyright (C) 2014 Lakshmi Krishnamurthy
 * Copyright (C) 2013 Lakshmi Krishnamurthy
 * Copyright (C) 2012 Lakshmi Krishnamurthy
 * Copyright (C) 2011 Lakshmi Krishnamurthy
 * 
 *  This file is part of DROP, an open-source library targeting risk, transaction costs, exposure, margin
 *  	calculations, and portfolio construction within and across fixed income, credit, commodity, equity,
 *  	FX, and structured products.
 *  
 *  	https://lakshmidrip.github.io/DROP/
 *  
 *  DROP is composed of three main modules:
 *  
 *  - DROP Analytics Core - https://lakshmidrip.github.io/DROP-Analytics-Core/
 *  - DROP Portfolio Core - https://lakshmidrip.github.io/DROP-Portfolio-Core/
 *  - DROP Numerical Core - https://lakshmidrip.github.io/DROP-Numerical-Core/
 * 
 * 	DROP Analytics Core implements libraries for the following:
 * 	- Fixed Income Analytics
 * 	- Asset Backed Analytics
 * 	- XVA Analytics
 * 	- Exposure and Margin Analytics
 * 
 * 	DROP Portfolio Core implements libraries for the following:
 * 	- Asset Allocation Analytics
 * 	- Transaction Cost Analytics
 * 
 * 	DROP Numerical Core implements libraries for the following:
 * 	- Statistical Learning Library
 * 	- Numerical Optimizer Library
 * 	- Machine Learning Library
 * 	- Spline Builder Library
 * 
 * 	Documentation for DROP is Spread Over:
 * 
 * 	- Main                     =&gt; https://lakshmidrip.github.io/DROP/
 * 	- Wiki                     =&gt; https://github.com/lakshmiDRIP/DROP/wiki
 * 	- GitHub                   =&gt; https://github.com/lakshmiDRIP/DROP
 * 	- Javadoc                  =&gt; https://lakshmidrip.github.io/DROP/Javadoc/index.html
 * 	- Technical Specifications =&gt; https://github.com/lakshmiDRIP/DROP/tree/master/Docs/Internal
 * 	- Release Versions         =&gt; https://lakshmidrip.github.io/DROP/version.html
 * 	- Community Credits        =&gt; https://lakshmidrip.github.io/DROP/credits.html
 * 	- Issues Catalog           =&gt; https://github.com/lakshmiDRIP/DROP/issues
 * 	- JUnit                    =&gt; https://lakshmidrip.github.io/DROP/junit/index.html
 * 	- Jacoco                   =&gt; https://lakshmidrip.github.io/DROP/jacoco/index.html
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * &lt;i&gt;BondComponent&lt;/i&gt; is the base class that extends CreditComponent abstract class and implements the
 * functionality behind bonds of all kinds. Bond static data is captured in a set of 11 container classes â€“
 * BondTSYParams, BondCouponParams, BondNotionalParams, BondFloaterParams, BondCurrencyParams,
 * BondIdentifierParams, CompCRValParams, BondCFTerminationEvent, BondFixedPeriodGenerationParams, and one
 * EmbeddedOptionSchedule object instance each for the call and the put objects. Each of these parameter set
 * can be set separately.
 * 
 * &lt;br&gt;&lt;br&gt;
 *  &lt;ul&gt;
 *		&lt;li&gt;&lt;b&gt;Project&lt;/b&gt;       = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/product&quot;&gt;Product&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Package&lt;/b&gt;       = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/product/credit&quot;&gt;Credit&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Specification&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/Docs/Internal/FixedIncome&quot;&gt;Fixed Income Analytics&lt;/a&gt;&lt;/li&gt;
 *  &lt;/ul&gt;
 * &lt;br&gt;&lt;br&gt;
 *
 * @author Lakshmi Krishnamurthy
 */

public class BondComponent extends org.drip.product.definition.Bond implements
	org.drip.product.definition.BondProduct
{
	private static final boolean s_bSuppressErrors = true;
	private static final boolean s_bYieldDFOffofCouponAccrualDCF = true;

	/*
	 * Width for calculating local forward rate width
	 */

	private static final int LOCAL_FORWARD_RATE_WIDTH = 1;

	/*
	 * Recovery Period discretization Mode
	 */

	private static final int s_iDiscretizationScheme =
		org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_DAY_STEP;

	/*
	 * Discount Curve to derive the zero curve off of
	 */

	private static final int ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE = 1;
	private static final int ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE = 2;

	/*
	 * Discount Curve to derive Bumped Prices
	 */

	private static final int PRICE_OFF_OF_FUNDING_CURVE = 1;
	private static final int PRICE_OFF_OF_TREASURY_CURVE = 2;
	// private static final int PRICE_OFF_OF_OVERNIGHT_CURVE = 3;

<span class="fc" id="L127">	private org.drip.product.params.BondStream _stream = null;</span>
<span class="fc" id="L128">	private org.drip.product.params.IdentifierSet _idParams = null;</span>
<span class="fc" id="L129">	private org.drip.product.params.CouponSetting _couponSetting = null;</span>
<span class="fc" id="L130">	private org.drip.product.params.CreditSetting _creditSetting = null;</span>
<span class="fc" id="L131">	private org.drip.product.params.FloaterSetting _floaterSetting = null;</span>
<span class="fc" id="L132">	private org.drip.product.params.NotionalSetting _notionalSetting = null;</span>
<span class="fc" id="L133">	private org.drip.product.params.QuoteConvention _quoteConvention = null;</span>
<span class="fc" id="L134">	private org.drip.product.params.TerminationSetting _terminationSetting = null;</span>
<span class="fc" id="L135">	private org.drip.product.params.TreasuryBenchmarks _treasuryBenchmarks = null;</span>

	/*
	 * Bond EOS Params
	 */

<span class="fc" id="L141">	protected org.drip.product.params.EmbeddedOptionSchedule _eosPut = null;</span>
<span class="fc" id="L142">	protected org.drip.product.params.EmbeddedOptionSchedule _eosCall = null;</span>

	private int terminationAdjust (
		final int iDate)
	{
<span class="fc bfc" id="L147" title="All 2 branches covered.">		org.drip.analytics.daycount.DateAdjustParams dap = null == _terminationSetting ? null :</span>
<span class="fc" id="L148">			_terminationSetting.dap();</span>

		try {
<span class="pc bpc" id="L151" title="1 of 2 branches missed.">			return null == dap ? iDate : dap.roll (iDate);</span>
<span class="nc" id="L152">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L153">			e.printStackTrace();</span>
		}

<span class="nc" id="L156">		return iDate;</span>
	}

	private double treasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L165" title="2 of 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L166">			throw new java.lang.Exception (&quot;BondComponent::treasuryBenchmarkYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L168">		java.lang.String strTsyBmk = null;</span>
<span class="fc" id="L169">		org.drip.param.definition.ProductQuote pqTsyBmkYield = null;</span>

<span class="pc bpc" id="L171" title="1 of 2 branches missed.">		if (null != _treasuryBenchmarks) strTsyBmk = _treasuryBenchmarks.primary();</span>

<span class="fc" id="L173">		int iValDate = valParams.valueDate();</span>

<span class="pc bpc" id="L175" title="3 of 4 branches missed.">		if (null == strTsyBmk || strTsyBmk.isEmpty())</span>
<span class="fc" id="L176">			strTsyBmk = org.drip.analytics.support.Helper.BaseTsyBmk (iValDate, iWorkoutDate);</span>

<span class="fc" id="L178">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; pqMap =</span>
<span class="fc" id="L179">			csqc.quoteMap();</span>

<span class="pc bpc" id="L181" title="2 of 6 branches missed.">		if (null != pqMap &amp;&amp; null != strTsyBmk &amp;&amp; !strTsyBmk.isEmpty())</span>
<span class="fc" id="L182">			pqTsyBmkYield = pqMap.get (strTsyBmk);</span>

<span class="fc bfc" id="L184" title="All 2 branches covered.">		if (null != pqTsyBmkYield) {</span>
<span class="fc" id="L185">			 org.drip.param.definition.Quote q = pqTsyBmkYield.quote (&quot;Yield&quot;);</span>

<span class="pc bpc" id="L187" title="1 of 2 branches missed.">			 if (null != q) return q.value (&quot;mid&quot;);</span>
		}

<span class="fc" id="L190">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L192" title="All 2 branches covered.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	private org.drip.param.valuation.WorkoutInfo exerciseCallYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L201" title="4 of 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosCall)
<span class="nc" id="L203">			return null;</span>

<span class="fc" id="L205">		int iValDate = valParams.valueDate();</span>

<span class="fc" id="L207">		int[] aiEOSDate = _eosCall.dates();</span>

<span class="fc" id="L209">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L211">		double[] adblEOSFactor = _eosCall.factors();</span>

<span class="fc" id="L213">		int iNoticePeriod = _eosCall.exerciseNoticePeriod();</span>

<span class="fc" id="L215">		int iExercise = -1;</span>
<span class="fc" id="L216">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="pc bpc" id="L217" title="1 of 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="fc" id="L220">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L221">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L224">			return null;</span>
<span class="fc" id="L225">		}</span>

<span class="fc bfc" id="L227" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="fc bfc" id="L228" title="All 4 branches covered.">			if (iValDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="fc" id="L231">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="fc bfc" id="L234" title="All 2 branches covered.">				if (dblYield &lt; dblExerciseYield) {</span>
<span class="fc" id="L235">					iExercise = i;</span>
<span class="fc" id="L236">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L238">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L240">			}</span>
		}

		try {
<span class="fc bfc" id="L244" title="All 2 branches covered.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L248">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L252">		return null;</span>
	}

	private org.drip.param.valuation.WorkoutInfo exercisePutYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L261" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosPut)
<span class="nc" id="L263">			return null;</span>

<span class="nc" id="L265">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L267">		int[] aiEOSDate = _eosPut.dates();</span>

<span class="nc" id="L269">		double[] adblEOSFactor = _eosPut.factors();</span>

<span class="nc" id="L271">		int iNoticePeriod = _eosPut.exerciseNoticePeriod();</span>

<span class="nc" id="L273">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L275">		int iExercise = -1;</span>
<span class="nc" id="L276">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L277" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L280">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L281">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L284">			return null;</span>
<span class="nc" id="L285">		}</span>

<span class="nc bnc" id="L287" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L288" title="All 4 branches missed.">			if (iValueDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValueDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L291">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L294" title="All 2 branches missed.">				if (dblYield &gt; dblExerciseYield) {</span>
<span class="nc" id="L295">					iExercise = i;</span>
<span class="nc" id="L296">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L298">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L300">			}</span>
		}

		try {
<span class="nc bnc" id="L304" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT);
<span class="nc" id="L308">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L312">		return null;</span>
	}

	private double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield,
		final boolean bApplyCouponExtension)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L325" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L326">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L328">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L330" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L331">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L333">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L334">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L335">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L336">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L337">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L338">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L339">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L340">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>

<span class="pc bpc" id="L342" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L343">			? 1. : notional (iValueDate);</span>

<span class="fc" id="L345">		int iFrequency = freq();</span>

<span class="fc" id="L347">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L349">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L351">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L353" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L355" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L356">			_quoteConvention.valuationCustomizationParams();</span>

<span class="fc bfc" id="L358" title="All 2 branches covered.">		if (null != vcp) {</span>
<span class="fc" id="L359">			strDC = vcp.yieldDayCount();</span>

<span class="fc" id="L361">			iFrequency = vcp.yieldFreq();</span>

<span class="fc" id="L363">			strCalendar = vcp.yieldCalendar();</span>

<span class="fc" id="L365">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="fc" id="L367">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L368" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L369">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L371">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L373">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L375">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L377">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L380">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L382" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L383">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L385" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L387" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L388">				bFirstPeriod = false;</span>

<span class="fc" id="L390">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L392">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L394">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L396">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L398" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L399">				iPeriodEndDate = iWorkoutDate;</span>
<span class="fc" id="L400">				bTerminateCouponFlow = true;</span>
			}

<span class="fc" id="L403">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L406" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L407">				throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; No PCM for &quot; + new</span>
<span class="nc" id="L408">					org.drip.analytics.date.JulianDate (iValueDate) + &quot; | &quot; + effectiveDate());</span>

<span class="fc bfc" id="L410" title="All 2 branches covered.">			if (null != vcp) {</span>
<span class="pc bpc" id="L411" title="1 of 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="fc" id="L412">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L414" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L415" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L416">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L419">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L422">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
					org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iPeriodPayDate, strDC,
<span class="fc" id="L425">						bApplyCpnEOMAdj, aap, strCalendar)) * cpcm.cumulative();</span>

<span class="fc" id="L427">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L429">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L431">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L433" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L434">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L435" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L436">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L439">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L441" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L442">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc bfc" id="L444" title="All 2 branches covered.">			dblCumulativePeriodPV += (period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="pc bpc" id="L445" title="1 of 2 branches missed.">				dblFlatForwardRate : cpcm.rate() + (bApplyCouponExtension ?</span>
<span class="pc" id="L446">					_couponSetting.couponRateExtension() : 0.)) * couponFactor (iPeriodEndDate) *</span>
						dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;

<span class="fc bfc" id="L449" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L450">		}</span>

		try {
<span class="fc bfc" id="L453" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L454">				valParams.cashPayDate();</span>
<span class="nc" id="L455">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L458">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L459">		}</span>

<span class="fc" id="L461">		double dblCleanPrice = (((dblCumulativePeriodPV + dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (</span>
			iFrequency,
			dblYield,
			s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (
					iValueDate,
					terminationAdjust (iWorkoutDate),
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
<span class="fc" id="L473">			) * notional (iWorkoutDate)) /</span>
<span class="fc" id="L474">			org.drip.analytics.support.Helper.Yield2DF (</span>
				iFrequency,
				dblYield,
<span class="fc" id="L477">				org.drip.analytics.daycount.Convention.YearFraction (</span>
					iValueDate,
					iCashPayDate,
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
			)
<span class="fc" id="L486">		) - accrued (</span>
			iValueDate,
			csqc
		)) / dblScalingNotional;

<span class="fc" id="L491">		return dblCleanPrice;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; calibMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L500">		double dblCleanPrice = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L502" title="1 of 2 branches missed.">		org.drip.param.definition.CalibrationParams calibParams = null == pricerParams ? null :</span>
<span class="fc" id="L503">			pricerParams.calibParams();</span>

<span class="pc bpc" id="L505" title="1 of 2 branches missed.">		if (null == calibParams) return null;</span>

<span class="fc" id="L507">		org.drip.param.valuation.WorkoutInfo wi = calibParams.workout();</span>

<span class="fc bfc" id="L509" title="All 2 branches covered.">		double dblExerciseFactor = null == wi ? 1. : wi.factor();</span>

<span class="fc bfc" id="L511" title="All 2 branches covered.">		int iExerciseDate = null == wi ? maturityDate().julian() : wi.date();</span>

<span class="fc" id="L513">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

		try {
<span class="fc bfc" id="L516" title="All 2 branches covered.">			dblCleanPrice = null == cc ? priceFromFundingCurve (valParams, csqc, iExerciseDate,</span>
<span class="fc" id="L517">				dblExerciseFactor, 0.) : priceFromCreditCurve (valParams, csqc, iExerciseDate,</span>
					dblExerciseFactor, 0., false);
<span class="nc" id="L519">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L522">			return null;</span>
<span class="fc" id="L523">		}</span>

<span class="pc bpc" id="L525" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblCleanPrice)) return null;</span>

<span class="fc" id="L527">		java.lang.String strCalibMeasure = calibParams.measure();</span>

<span class="fc" id="L529">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

<span class="fc bfc" id="L532" title="All 2 branches covered.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CleanPrice&quot;, &quot;FairCleanPrice&quot;, &quot;FairPrice&quot;, &quot;Price&quot;}, false)) {
<span class="fc" id="L534">			mapCalibMeasures.put (strCalibMeasure, dblCleanPrice);</span>

<span class="fc" id="L536">			return mapCalibMeasures;</span>
		}

<span class="pc bpc" id="L539" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;DirtyPrice&quot;, &quot;FairDirtyPrice&quot;}, false)) {
			try {
<span class="nc" id="L542">				mapCalibMeasures.put (strCalibMeasure, dblCleanPrice + accrued (valParams.valueDate(),</span>
					csqc));

<span class="nc" id="L545">				return mapCalibMeasures;</span>
<span class="nc" id="L546">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="pc bpc" id="L551" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;Yield&quot;, &quot;FairYield&quot;}, false)) {
			try {
<span class="fc" id="L554">				mapCalibMeasures.put (strCalibMeasure, yieldFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="fc" id="L557">				return mapCalibMeasures;</span>
<span class="nc" id="L558">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L563" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;TSYSpread&quot;, &quot;FairTSYSpread&quot;}, false)) {
			try {
<span class="nc" id="L566">				mapCalibMeasures.put (strCalibMeasure, tsySpreadFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L569">				return mapCalibMeasures;</span>
<span class="nc" id="L570">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L575" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;OAS&quot;, &quot;OASpread&quot;, &quot;OptionAdjustedSpread&quot;}, false)) {
			try {
<span class="nc" id="L578">				mapCalibMeasures.put (strCalibMeasure, oasFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L581">				return mapCalibMeasures;</span>
<span class="nc" id="L582">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L587" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;BondBasis&quot;, &quot;YieldBasis&quot;, &quot;YieldSpread&quot;}, false)) {
			try {
<span class="nc" id="L590">				mapCalibMeasures.put (strCalibMeasure, bondBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L593">				return mapCalibMeasures;</span>
<span class="nc" id="L594">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L599" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CreditBasis&quot;}, false)) {
<span class="nc bnc" id="L601" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L604">				mapCalibMeasures.put (strCalibMeasure, creditBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L607">				return mapCalibMeasures;</span>
<span class="nc" id="L608">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L613" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;PECS&quot;, &quot;ParEquivalentCDSSpread&quot;}, false)) {
<span class="nc bnc" id="L615" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L618">				mapCalibMeasures.put (strCalibMeasure, pecsFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L621">				return mapCalibMeasures;</span>
<span class="nc" id="L622">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc" id="L627">		return null;</span>
	}

	@Override public org.drip.param.valuation.WorkoutInfo exerciseYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L636" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L637">			return null;</span>

<span class="fc" id="L639">		int iMaturityDate = maturityDate().julian();</span>

		try {
<span class="pc bpc" id="L642" title="1 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L643">				return new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPrice (valParams,</span>
					csqc, vcp, iMaturityDate, 1., dblPrice), 1.,
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);

<span class="pc bpc" id="L647" title="3 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null != _eosPut)</span>
<span class="nc" id="L648">				return exercisePutYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="pc bpc" id="L650" title="2 of 4 branches missed.">			if (null != _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L651">				return exerciseCallYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc" id="L653">			org.drip.param.valuation.WorkoutInfo wiPut = exercisePutYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc" id="L656">			org.drip.param.valuation.WorkoutInfo wiCall = exerciseCallYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc bnc" id="L659" title="All 4 branches missed.">			if (null == wiPut || null == wiCall) return null;</span>

<span class="nc bnc" id="L661" title="All 2 branches missed.">			return wiPut.date() &lt; wiCall.date() ? wiPut : wiCall;</span>
<span class="nc" id="L662">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L666">		return null;</span>
	}

	private double indexRate (
		final int iValueDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.analytics.cashflow.CompositeFloatingPeriod cup)
		throws java.lang.Exception
	{
<span class="fc" id="L675">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState (fundingLabel());</span>

<span class="fc" id="L677">		int iFreq = freq();</span>

<span class="pc bpc" id="L679" title="1 of 2 branches missed.">		if (null != cup) {</span>
<span class="fc" id="L680">			org.drip.analytics.cashflow.ComposableUnitPeriod cupFirst = cup.periods().get (0);</span>

<span class="pc bpc" id="L682" title="1 of 2 branches missed.">			if (!(cupFirst instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod))</span>
<span class="nc" id="L683">				throw new java.lang.Exception (&quot;BondComponent::indexRate =&gt; Not a floater&quot;);</span>

<span class="fc" id="L685">			return ((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod) cupFirst).baseRate (csqc);</span>
		}

<span class="nc bnc" id="L688" title="All 2 branches missed.">		return dc.libor (iValueDate, 0 != iFreq ? iValueDate + 365 / iFreq : iValueDate +</span>
			LOCAL_FORWARD_RATE_WIDTH);
	}

	private org.drip.analytics.output.BondWorkoutMeasures workoutMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
	{
<span class="pc bpc" id="L699" title="2 of 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="fc" id="L701">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L703" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L705">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L707" title="All 2 branches covered.">		if (null == dcFunding) return null;</span>

<span class="fc bfc" id="L709" title="All 2 branches covered.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="fc bfc" id="L711" title="All 2 branches covered.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="fc" id="L712">			_creditSetting.recovery();</span>

<span class="fc bfc" id="L714" title="All 2 branches covered.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="fc bfc" id="L716" title="All 2 branches covered.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L718">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="fc" id="L720">		double dblAccrued01 = 0.;</span>
<span class="fc" id="L721">		double dblRecoveryPV = 0.;</span>
<span class="fc" id="L722">		boolean bPeriodZero = true;</span>
<span class="fc" id="L723">		double dblExpectedRecovery = 0.;</span>
<span class="fc" id="L724">		double dblCreditRiskyDirtyDV01 = 0.;</span>
<span class="fc" id="L725">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L726">		double dblCreditRiskyPrincipalPV = 0.;</span>
<span class="fc" id="L727">		double dblCreditRisklessDirtyDV01 = 0.;</span>
<span class="fc" id="L728">		double dblCreditRiskyDirtyCouponPV = 0.;</span>
<span class="fc" id="L729">		double dblCreditRisklessPrincipalPV = 0.;</span>
<span class="fc" id="L730">		double dblCreditRisklessDirtyCouponPV = 0.;</span>
<span class="fc" id="L731">		double dblFirstCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L732">		double dblCreditRiskyDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L733">		double dblFirstIndexRate = java.lang.Double.NaN;</span>
<span class="fc" id="L734">		double dblCreditRisklessDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L735">		double dblCreditRiskyParPV = java.lang.Double.NaN;</span>
<span class="fc" id="L736">		double dblFlatForwardCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L737">		double dblCreditRisklessParPV = java.lang.Double.NaN;</span>

<span class="fc bfc" id="L739" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L740">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L742" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

		try {
<span class="pc bpc" id="L745" title="1 of 2 branches missed.">			for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L746">				int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L748" title="All 2 branches covered.">				if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L750">				int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L752">				int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L754" title="All 2 branches covered.">				if (iWorkoutDate &lt;= iPeriodEndDate) {</span>
<span class="fc" id="L755">					bTerminateCouponFlow = true;</span>
<span class="fc" id="L756">					iPeriodEndDate = iWorkoutDate;</span>
				}

<span class="fc" id="L759">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L762" title="1 of 2 branches missed.">				if (null == cpcm) return null;</span>

<span class="fc bfc" id="L764" title="All 2 branches covered.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardCoupon))</span>
<span class="fc" id="L765">					dblFlatForwardCoupon = cpcm.rate();</span>

<span class="fc" id="L767">				double dblPeriodBaseRate = period.periods().get (0).baseRate (csqc);</span>

<span class="fc" id="L769">				double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="pc bpc" id="L771" title="1 of 2 branches missed.">				double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardCoupon : cpcm.rate();</span>

<span class="fc bfc" id="L773" title="All 2 branches covered.">				if (bPeriodZero) {</span>
<span class="fc" id="L774">					bPeriodZero = false;</span>
<span class="fc" id="L775">					dblFirstCoupon = dblPeriodCoupon;</span>

<span class="pc bpc" id="L777" title="1 of 2 branches missed.">					if (iPeriodStartDate &lt; iValueDate)</span>
<span class="fc" id="L778">						dblAccrued01 = 0.0001 * period.accrualDCF (iValueDate) * notional (iPeriodStartDate,</span>
							iValueDate);

<span class="fc bfc" id="L781" title="All 2 branches covered.">					if (null != _floaterSetting) dblFirstIndexRate = dblPeriodBaseRate;</span>
				}

<span class="fc" id="L784">				double dblPeriodCreditRisklessDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) *</span>
<span class="fc" id="L785">					dblPeriodAnnuity * notional (iPeriodStartDate);</span>

<span class="fc" id="L787">				double dblPeriodCreditRiskessPrincipalPV = (notional (iPeriodStartDate) - notional</span>
<span class="fc" id="L788">					(iPeriodEndDate)) * dblPeriodAnnuity;</span>

<span class="fc" id="L790">				double dblPeriodCreditRiskyDirtyDV01 = dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L791">				double dblPeriodCreditRiskyPrincipalPV = dblPeriodCreditRiskessPrincipalPV;</span>

<span class="pc bpc" id="L793" title="1 of 4 branches missed.">				if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L794" title="All 2 branches missed.">					double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
						iPeriodEndDate);

<span class="nc" id="L797">					dblPeriodCreditRiskyDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L798">					dblPeriodCreditRiskyPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L800" title="All 2 branches missed.">					for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
<span class="nc" id="L801">						valParams, pricerParams, terminationAdjust (iWorkoutDate), csqc)) {</span>
<span class="nc bnc" id="L802" title="All 2 branches missed.">						if (null == lqm) continue;</span>

<span class="nc" id="L804">						int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L806">						int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L808">						double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
							iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L811">						double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L813">						double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L814">							(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L816" title="All 2 branches missed.">						if (bAccrualOnDefault)</span>
<span class="nc" id="L817">							dblPeriodCreditRiskyDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival</span>
								* dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L820" title="All 2 branches missed.">						double dblRecovery = bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
							iSubPeriodEndDate) : dblProductRecovery;

<span class="nc" id="L823">						double dblSubPeriodExpRecovery = dblRecovery * dblSubPeriodSurvival *</span>
							dblSubPeriodNotional;
<span class="nc" id="L825">						dblRecoveryPV += dblSubPeriodExpRecovery * dblSubPeriodDF;</span>
<span class="nc" id="L826">						dblExpectedRecovery += dblSubPeriodExpRecovery;</span>
<span class="nc" id="L827">					}</span>
				}

<span class="fc" id="L830">				dblCreditRiskyDirtyDV01 += dblPeriodCreditRiskyDirtyDV01;</span>
<span class="fc" id="L831">				dblCreditRiskyPrincipalPV += dblPeriodCreditRiskyPrincipalPV;</span>
<span class="fc" id="L832">				dblCreditRisklessDirtyDV01 += dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L833">				dblCreditRisklessPrincipalPV += dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc" id="L835">				dblCreditRiskyDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRiskyDirtyDV01;

<span class="fc" id="L838">				dblCreditRisklessDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc" id="L841">				dblCreditRiskyDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRiskyDirtyDV01;
<span class="fc" id="L843">				dblCreditRisklessDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc bfc" id="L846" title="All 2 branches covered.">				if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L847">			}</span>
<span class="nc" id="L848">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L851">			return null;</span>
<span class="fc" id="L852">		}</span>

<span class="fc" id="L854">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>

		try {
<span class="fc bfc" id="L857" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L858">				valParams.cashPayDate();</span>
<span class="nc" id="L859">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L862">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L863">		}</span>

		try {
<span class="fc" id="L866">			double dblCashPayDF = dcFunding.df (iCashPayDate);</span>

<span class="fc" id="L868">			int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L870">			dblCreditRisklessParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate) *</span>
				dblWorkoutFactor;

<span class="pc bpc" id="L873" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams)</span>
<span class="nc" id="L874">				dblCreditRiskyParPV = dblCreditRisklessParPV * cc.survival (iMaturityDate);</span>

<span class="fc" id="L876">			org.drip.analytics.output.BondCouponMeasures bcmCreditRisklessDirty = new</span>
				org.drip.analytics.output.BondCouponMeasures (dblCreditRisklessDirtyDV01,
					dblCreditRisklessDirtyIndexCouponPV, dblCreditRisklessDirtyCouponPV,
						dblCreditRisklessDirtyCouponPV + dblCreditRisklessPrincipalPV +
							dblCreditRisklessParPV);

<span class="fc" id="L882">			double dblDefaultExposure = java.lang.Double.NaN;</span>
<span class="fc" id="L883">			double dblDefaultExposureNoRec = java.lang.Double.NaN;</span>
<span class="fc" id="L884">			double dblLossOnInstantaneousDefault = java.lang.Double.NaN;</span>
<span class="fc" id="L885">			org.drip.analytics.output.BondCouponMeasures bcmCreditRiskyDirty = null;</span>

<span class="pc bpc" id="L887" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc" id="L888">				double dblInitialNotional = notional (iValueDate);</span>

<span class="nc" id="L890">				double dblInitialRecovery = cc.recovery (iValueDate);</span>

<span class="nc" id="L892">				bcmCreditRiskyDirty = new org.drip.analytics.output.BondCouponMeasures</span>
					(dblCreditRiskyDirtyDV01, dblCreditRiskyDirtyIndexCouponPV, dblCreditRiskyDirtyCouponPV,
						dblCreditRiskyDirtyCouponPV + dblCreditRiskyPrincipalPV + dblCreditRiskyParPV);

<span class="nc" id="L896">				dblDefaultExposure = (dblDefaultExposureNoRec = dblInitialNotional) * dblInitialRecovery;</span>
<span class="nc" id="L897">				dblLossOnInstantaneousDefault = dblInitialNotional * (1. - dblInitialRecovery);</span>
			}

<span class="fc" id="L900">			return new org.drip.analytics.output.BondWorkoutMeasures (bcmCreditRiskyDirty,</span>
				bcmCreditRisklessDirty, dblCreditRiskyParPV, dblCreditRisklessParPV,
					dblCreditRiskyPrincipalPV, dblCreditRisklessPrincipalPV, dblRecoveryPV,
						dblExpectedRecovery, dblDefaultExposure, dblDefaultExposureNoRec,
							dblLossOnInstantaneousDefault, dblAccrued01, dblFirstCoupon, dblFirstIndexRate,
								dblCashPayDF);
<span class="nc" id="L906">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L910">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; rvMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice,
		final java.lang.String strPrefix)
	{
<span class="pc bpc" id="L922" title="1 of 2 branches missed.">		if (null == strPrefix) return null;</span>

<span class="fc" id="L924">		org.drip.analytics.output.BondRVMeasures bmRV = standardMeasures (valParams, pricerParams, csqc, vcp,</span>
			wi, dblPrice);

<span class="pc bpc" id="L927" title="1 of 2 branches missed.">		return null == bmRV ? null : bmRV.toMap (strPrefix);</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; fairMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L936">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L938">		org.drip.analytics.output.BondWorkoutMeasures bwmFair = workoutMeasures (valParams, pricerParams,</span>
			csqc, iMaturityDate, 1.);

<span class="pc bpc" id="L941" title="1 of 2 branches missed.">		if (null == bwmFair) return null;</span>

<span class="fc" id="L943">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = bwmFair.toMap (&quot;&quot;);</span>

<span class="fc" id="L945">		org.drip.analytics.output.BondCouponMeasures bcm = bwmFair.creditRiskyCleanbcm();</span>

<span class="pc bpc" id="L947" title="1 of 2 branches missed.">		double dblCreditRiskyPV = null == bcm ? java.lang.Double.NaN : bcm.pv();</span>

<span class="pc bpc" id="L949" title="1 of 2 branches missed.">		double dblPrice = !org.drip.quant.common.NumberUtil.IsValid (dblCreditRiskyPV) ?</span>
<span class="pc" id="L950">			bwmFair.creditRisklessCleanbcm().pv() : dblCreditRiskyPV;</span>

		try {
<span class="fc" id="L953">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, rvMeasures (valParams,</span>
				pricerParams, csqc, vcp, new org.drip.param.valuation.WorkoutInfo (iMaturityDate,
<span class="fc" id="L955">					yieldFromPrice (valParams, csqc, vcp, dblPrice / notional (valParams.valueDate())), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY), dblPrice, &quot;&quot;));

<span class="fc" id="L958">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L959">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Fair&quot;));</span>

<span class="fc" id="L961">			return mapMeasures;</span>
<span class="nc" id="L962">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L966">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; marketMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wiMarket)
	{
		try {
<span class="fc" id="L977">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = rvMeasures</span>
<span class="fc" id="L978">				(valParams, pricerParams, csqc, vcp, wiMarket, priceFromYield (valParams, csqc, vcp,</span>
<span class="fc" id="L979">					wiMarket.date(), wiMarket.factor(), wiMarket.yield()), &quot;&quot;);</span>

<span class="fc" id="L981">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L982">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Market&quot;));</span>

<span class="fc" id="L984">			return mapMeasures;</span>
<span class="nc" id="L985">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L989">		return null;</span>
	}

	private org.drip.analytics.cashflow.CompositePeriod currentPeriod (
		final int iDate)
	{
		try {
<span class="fc" id="L996">			return _stream.period (_stream.periodIndex (iDate));</span>
<span class="nc" id="L997">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1001">		return null;</span>
	}

	private double priceFromDiscountCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump,
		final int iDiscountCurveType)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1013" title="3 of 6 branches missed.">		if (null == valParams || null == csqc ||!org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L1014" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L1015">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L1017">		org.drip.state.discount.DiscountCurve dc = null;</span>

<span class="pc bpc" id="L1019" title="1 of 2 branches missed.">		if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="fc" id="L1020">			dc = csqc.fundingState (fundingLabel());</span>
<span class="nc bnc" id="L1021" title="All 2 branches missed.">		else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1022">			dc = csqc.govvieState (govvieLabel());</span>
		/* else if (PRICE_OFF_OF_OVERNIGHT_CURVE == iDiscountCurveType)
			dfe = csqc.overnightState (overnightLabel()); */

<span class="pc bpc" id="L1026" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1027">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No Discount Curve&quot;);</span>

<span class="fc" id="L1029">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L1031" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1032">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L1033">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L1034">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L1036">		double dblPV = 0.;</span>
<span class="fc" id="L1037">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L1038">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L1039">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L1041" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L1042">			? 1. : notional (iValueDate);</span>

<span class="fc bfc" id="L1044" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L1045">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L1047" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L1049" title="1 of 2 branches missed.">		if (0. != dblBump) {</span>
<span class="nc bnc" id="L1050" title="All 2 branches missed.">			if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1051">				dc = (org.drip.state.discount.MergedDiscountForwardCurve) dc.parallelShiftManifestMeasure</span>
<span class="nc" id="L1052">					(&quot;SwapRate&quot;, dblBump);</span>
<span class="nc bnc" id="L1053" title="All 2 branches missed.">			else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1054">				dc = (org.drip.state.govvie.GovvieCurve) dc.parallelShiftManifestMeasure (&quot;Yield&quot;, dblBump);</span>
		}

<span class="pc bpc" id="L1057" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1058">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromDiscountCurve =&gt; Cannot shift Discount Curve&quot;);

<span class="pc bpc" id="L1061" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1062">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L1064" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L1066">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L1068">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L1070">			int iNotionalEndDate = period.endDate();</span>

<span class="fc bfc" id="L1072" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L1073">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L1074">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L1075">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L1078">			org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L1081" title="1 of 2 branches missed.">			if (null == pcm)</span>
<span class="nc" id="L1082">				throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No PCM&quot;);</span>

<span class="fc" id="L1084">			double dblPeriodAnnuity = dc.df (iPeriodPayDate) * pcm.cumulative();</span>

<span class="fc" id="L1086">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L1088">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L1090">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L1092">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L1094" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L1095">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L1096" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L1097">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L1098" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L1100">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc bfc" id="L1102" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L1103">				dblFlatForwardRate = pcm.rate();</span>

<span class="pc bpc" id="L1105" title="1 of 2 branches missed.">			dblPV += period.accrualDCF (iAccrualEndDate) * dblPeriodAnnuity * (bApplyFlatForward ?</span>
<span class="fc" id="L1106">				dblFlatForwardRate : pcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L1108">			dblPV += (dblPeriodStartNotional - dblPeriodEndNotional) * dblPeriodAnnuity;</span>

<span class="fc bfc" id="L1110" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L1111">		}</span>

		try {
<span class="fc bfc" id="L1114" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L1115">				valParams.cashPayDate();</span>
<span class="nc" id="L1116">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1119">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L1120">		}</span>

<span class="fc" id="L1122">		return ((dblPV + dblWorkoutFactor * dc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L1123">			(iWorkoutDate)) / dc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	/**
	 * Constructor: Construct an empty bond object
	 */

	public BondComponent()
<span class="fc" id="L1131">	{</span>
<span class="fc" id="L1132">	}</span>

	@Override public double[] secTreasurySpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1138" title="All 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="nc" id="L1140">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1141">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1143" title="All 4 branches missed.">		if (null == mapTSYQuote || 0 == mapTSYQuote.size()) return null;</span>

<span class="nc bnc" id="L1145" title="All 2 branches missed.">		java.lang.String[] astrTreasuryBenchmark = null == _treasuryBenchmarks ? null :</span>
<span class="nc" id="L1146">			_treasuryBenchmarks.secondary();</span>

<span class="nc bnc" id="L1148" title="All 2 branches missed.">		int iNumTreasuryBenchmark = null == astrTreasuryBenchmark ? 0 : astrTreasuryBenchmark.length;</span>
<span class="nc" id="L1149">		double[] adblSecTSYSpread = new double[iNumTreasuryBenchmark];</span>

<span class="nc bnc" id="L1151" title="All 2 branches missed.">		if (0 == iNumTreasuryBenchmark) return null;</span>

<span class="nc bnc" id="L1153" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="nc" id="L1154">			org.drip.param.definition.ProductQuote pqTSYBenchmark = mapTSYQuote.get</span>
<span class="nc" id="L1155">				(astrTreasuryBenchmark[i]);</span>

<span class="nc bnc" id="L1157" title="All 2 branches missed.">			org.drip.param.definition.Quote q = null == pqTSYBenchmark ? null : pqTSYBenchmark.quote</span>
<span class="nc" id="L1158">				(&quot;Yield&quot;);</span>

<span class="nc bnc" id="L1160" title="All 2 branches missed.">			adblSecTSYSpread[i] = null == q ? java.lang.Double.NaN : q.value (&quot;mid&quot;);</span>
		}

<span class="nc" id="L1163">		return adblSecTSYSpread;</span>
	}

	@Override public double effectiveTreasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1173" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1174">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Bad val/mkt Params&quot;);

<span class="nc" id="L1177">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1179" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L1180">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Invalid Work-out!&quot;);

<span class="nc bnc" id="L1183" title="All 2 branches missed.">		java.lang.String strTreasuryBenchmark = null != _treasuryBenchmarks ? _treasuryBenchmarks.primary() :</span>
			null;

<span class="nc" id="L1186">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1188">		int iWorkoutDate = wi.date();</span>

<span class="nc bnc" id="L1190" title="All 4 branches missed.">		if (null == strTreasuryBenchmark || strTreasuryBenchmark.isEmpty())</span>
<span class="nc" id="L1191">			strTreasuryBenchmark = org.drip.analytics.support.Helper.BaseTsyBmk (iValueDate, iWorkoutDate);</span>

<span class="nc" id="L1193">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1194">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1196" title="All 2 branches missed.">		org.drip.param.definition.ProductQuote pqTSYBenchmark = null != mapTSYQuote &amp;&amp;</span>
<span class="nc bnc" id="L1197" title="All 4 branches missed.">			mapTSYQuote.containsKey (strTreasuryBenchmark) &amp;&amp; !strTreasuryBenchmark.isEmpty() ?</span>
<span class="nc" id="L1198">				mapTSYQuote.get (strTreasuryBenchmark) : null;</span>

<span class="nc bnc" id="L1200" title="All 2 branches missed.">		org.drip.param.definition.Quote q = null != pqTSYBenchmark ? pqTSYBenchmark.quote (&quot;Yield&quot;) : null;</span>

<span class="nc bnc" id="L1202" title="All 2 branches missed.">		if (null != q) return q.value (&quot;mid&quot;);</span>

<span class="nc" id="L1204">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());;</span>

<span class="nc bnc" id="L1206" title="All 2 branches missed.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	@Override public boolean setTreasuryBenchmark (
		final org.drip.product.params.TreasuryBenchmarks treasuryBenchmarks)
	{
<span class="pc bpc" id="L1212" title="1 of 2 branches missed.">		return null != (_treasuryBenchmarks = treasuryBenchmarks);</span>
	}

	@Override public org.drip.product.params.TreasuryBenchmarks treasuryBenchmark()
	{
<span class="nc" id="L1217">		return _treasuryBenchmarks;</span>
	}

	@Override public boolean setIdentifierSet (
		final org.drip.product.params.IdentifierSet idParams)
	{
<span class="pc bpc" id="L1223" title="1 of 2 branches missed.">		return null != (_idParams = idParams);</span>
	}

	@Override public org.drip.product.params.IdentifierSet identifierSet()
	{
<span class="nc" id="L1228">		return _idParams;</span>
	}

	@Override public boolean setCouponSetting (
		final org.drip.product.params.CouponSetting couponSetting)
	{
<span class="pc bpc" id="L1234" title="1 of 2 branches missed.">		return null != (_couponSetting = couponSetting);</span>
	}

	@Override public org.drip.product.params.CouponSetting couponSetting()
	{
<span class="nc" id="L1239">		return _couponSetting;</span>
	}

	@Override public boolean setFloaterSetting (
		final org.drip.product.params.FloaterSetting fltParams)
	{
<span class="fc bfc" id="L1245" title="All 2 branches covered.">		return null == (_floaterSetting = fltParams);</span>
	}

	@Override public org.drip.product.params.FloaterSetting floaterSetting()
	{
<span class="fc" id="L1250">		return _floaterSetting;</span>
	}

	@Override public boolean setMarketConvention (
		final org.drip.product.params.QuoteConvention quoteConvention)
	{
<span class="pc bpc" id="L1256" title="1 of 2 branches missed.">		return null == (_quoteConvention = quoteConvention);</span>
	}

	@Override public org.drip.product.params.QuoteConvention marketConvention()
	{
<span class="nc" id="L1261">		return _quoteConvention;</span>
	}

	@Override public boolean setCreditSetting (
		final org.drip.product.params.CreditSetting creditSetting)
	{
<span class="pc bpc" id="L1267" title="1 of 2 branches missed.">		return null == (_creditSetting = creditSetting);</span>
	}

	@Override public org.drip.product.params.CreditSetting creditSetting()
	{
<span class="nc" id="L1272">		return _creditSetting;</span>
	}

	@Override public boolean setTerminationSetting (
		final org.drip.product.params.TerminationSetting terminationSetting)
	{
<span class="pc bpc" id="L1278" title="1 of 2 branches missed.">		return null == (_terminationSetting = terminationSetting);</span>
	}

	@Override public org.drip.product.params.TerminationSetting terminationSetting()
	{
<span class="nc" id="L1283">		return _terminationSetting;</span>
	}

	@Override public boolean setStream (
		final org.drip.product.params.BondStream stream)
	{
<span class="pc bpc" id="L1289" title="1 of 2 branches missed.">		return null != (_stream = stream);</span>
	}

	@Override public org.drip.product.params.BondStream stream()
	{
<span class="fc" id="L1294">		return _stream;</span>
	}

	@Override public boolean setNotionalSetting (
		final org.drip.product.params.NotionalSetting notionalSetting)
	{
<span class="pc bpc" id="L1300" title="1 of 2 branches missed.">		return null == (_notionalSetting = notionalSetting);</span>
	}

	@Override public org.drip.product.params.NotionalSetting notionalSetting()
	{
<span class="nc" id="L1305">		return _notionalSetting;</span>
	}

	@Override public java.lang.String primaryCode()
	{
<span class="pc bpc" id="L1310" title="1 of 2 branches missed.">		return null == _idParams ? null : &quot;BOND.&quot; + _idParams.id();</span>
	}

	@Override public void setPrimaryCode (
		final java.lang.String strCode)
	{
		// _strCode = strCode;
<span class="nc" id="L1317">	}</span>

	@Override public java.lang.String[] secondaryCode()
	{
<span class="fc" id="L1321">		return new java.lang.String[] {_idParams.id()};</span>
	}

	@Override public java.lang.String isin()
	{
<span class="nc bnc" id="L1326" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.isin();</span>
	}

	@Override public java.lang.String cusip()
	{
<span class="nc bnc" id="L1331" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.cusip();</span>
	}

	@Override public java.lang.String name()
	{
<span class="pc bpc" id="L1336" title="1 of 2 branches missed.">		return null == _idParams ? null : _idParams.id();</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; couponCurrency()
	{
<span class="nc" id="L1341">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; mapCouponCurrency = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt;();

<span class="nc" id="L1344">		mapCouponCurrency.put (name(), _stream.couponCurrency());</span>

<span class="nc" id="L1346">		return mapCouponCurrency;</span>
	}

	@Override public java.lang.String payCurrency()
	{
<span class="fc" id="L1351">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String principalCurrency()
	{
<span class="nc" id="L1356">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public double notional (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1363" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1364">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1366">		return _notionalSetting.outstandingFactorSchedule().y (iDate);</span>
	}

	@Override public double notional (
		final int iStartDate,
		final int iEndDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1374" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1375">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1377">		return _notionalSetting.outstandingFactorSchedule().y (iStartDate, iEndDate);</span>
	}

	@Override public double initialNotional()
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1383" title="1 of 2 branches missed.">		if (null == _notionalSetting)</span>
<span class="nc" id="L1384">			throw new java.lang.Exception (&quot;BondComponent::initialNotional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1386">		return _notionalSetting.notionalAmount();</span>
	}

	public double couponFactor (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1393" title="1 of 2 branches missed.">		if (null == _couponSetting) return 1.;</span>

<span class="fc" id="L1395">		org.drip.quant.common.Array2D fsCoupon = _couponSetting.factorSchedule();</span>

<span class="fc bfc" id="L1397" title="All 2 branches covered.">		return null == fsCoupon ? 1. : fsCoupon.y (iDate);</span>
	}

	@Override public double recovery (
		final int iDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1405" title="All 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="nc bnc" id="L1407" title="All 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.recovery (iDate) : _creditSetting.recovery();</span>
	}

	@Override public double recovery (
		final int iStartDate,
		final int iEndDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1416" title="1 of 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="pc bpc" id="L1418" title="1 of 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iStartDate, iEndDate) :</span>
<span class="nc" id="L1419">			_creditSetting.recovery();</span>
	}

	@Override public org.drip.product.params.CreditSetting creditValuationParams()
	{
<span class="fc" id="L1424">		return _creditSetting;</span>
	}

	@Override public org.drip.analytics.output.CompositePeriodCouponMetrics couponMetrics (
		final int iAccrualEndDate,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="fc" id="L1432">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iAccrualEndDate);</span>

<span class="pc bpc" id="L1434" title="1 of 2 branches missed.">		if (null == cp) return null;</span>

<span class="fc" id="L1436">		java.util.List&lt;org.drip.analytics.output.UnitPeriodMetrics&gt; lsUPM = new</span>
			java.util.ArrayList&lt;org.drip.analytics.output.UnitPeriodMetrics&gt;();

		try {
<span class="fc" id="L1440">			lsUPM.add (new org.drip.analytics.output.UnitPeriodMetrics (cp.startDate(), cp.endDate(),</span>
<span class="fc" id="L1441">				cp.couponDCF(), cp.couponMetrics (valParams.valueDate(), csqc).rate(), new</span>
					org.drip.analytics.output.ConvexityAdjustment()));
<span class="nc" id="L1443">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L1444">			e.printStackTrace();</span>

<span class="nc" id="L1446">			return null;</span>
<span class="fc" id="L1447">		}</span>

<span class="fc" id="L1449">		return org.drip.analytics.output.CompositePeriodCouponMetrics.Create (lsUPM);</span>
	}

	@Override public int freq()
	{
<span class="fc" id="L1454">		return couponPeriods().get (0).freq();</span>
	}

	@Override public org.drip.state.identifier.EntityCDSLabel creditLabel()
	{
<span class="fc bfc" id="L1459" title="All 2 branches covered.">		if (null == _creditSetting) return null;</span>

<span class="fc" id="L1461">		java.lang.String strCreditCurveName = _creditSetting.creditCurveName();</span>

<span class="pc bpc" id="L1463" title="1 of 4 branches missed.">		return null == strCreditCurveName  || strCreditCurveName.isEmpty() ? null :</span>
<span class="fc" id="L1464">			org.drip.state.identifier.EntityCDSLabel.Standard (strCreditCurveName, currency());</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
			forwardLabel()
	{
<span class="pc bpc" id="L1471" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1473">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1475" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.ForwardLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
<span class="fc" id="L1478">			mapForwardLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;();

<span class="fc" id="L1481">		mapForwardLabel.put (</span>
<span class="fc" id="L1482">			name(),</span>
			(org.drip.state.identifier.ForwardLabel) floaterLabel
		);

<span class="fc" id="L1486">		return mapForwardLabel;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
			otcFixFloatLabel()
	{
<span class="pc bpc" id="L1493" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1495">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1497" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.OTCFixFloatLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
<span class="fc" id="L1500">			mapOTCFixFloatLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;();

<span class="fc" id="L1503">		mapOTCFixFloatLabel.put (</span>
<span class="fc" id="L1504">			name(),</span>
			(org.drip.state.identifier.OTCFixFloatLabel) floaterLabel
		);

<span class="fc" id="L1508">		return mapOTCFixFloatLabel;</span>
	}

	@Override public org.drip.state.identifier.FundingLabel fundingLabel()
	{
<span class="fc" id="L1513">		return org.drip.state.identifier.FundingLabel.Standard (payCurrency());</span>
	}

	@Override public org.drip.state.identifier.GovvieLabel govvieLabel()
	{
<span class="fc" id="L1518">		return org.drip.state.identifier.GovvieLabel.Standard</span>
<span class="fc" id="L1519">			(org.drip.market.issue.TreasurySettingContainer.CurrencyBenchmarkCode (payCurrency()));</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.FXLabel&gt;
		fxLabel()
	{
<span class="nc" id="L1525">		return null;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.VolatilityLabel&gt;
			volatilityLabel()
	{
<span class="nc" id="L1532">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate effectiveDate()
	{
<span class="fc" id="L1537">		return _stream.effective();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityDate()
	{
<span class="fc" id="L1542">		return _stream.maturity();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityPayDate()
	{
<span class="fc" id="L1547">		return new org.drip.analytics.date.JulianDate (terminationAdjust (maturityDate().julian()));</span>
	}

	@Override public org.drip.analytics.date.JulianDate firstCouponDate()
	{
<span class="fc" id="L1552">		return new org.drip.analytics.date.JulianDate (couponPeriods().get (0).endDate());</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; couponPeriods()
	{
<span class="fc" id="L1557">		return _stream.periods();</span>
	}

	@Override public org.drip.param.valuation.CashSettleParams cashSettleParams()
	{
<span class="nc bnc" id="L1562" title="All 2 branches missed.">		return null == _quoteConvention ? null : _quoteConvention.cashSettleParams();</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlow (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1570" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc) return null;</span>

<span class="nc" id="L1572">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1575" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1576" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1578">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1579">				(this, valParams, pricerParams, period.endDate(), csqc);</span>

<span class="nc bnc" id="L1581" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1582">		}</span>

<span class="nc" id="L1584">		return sLP;</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlowFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L1594" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc ||</span>
<span class="nc bnc" id="L1595" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1596">			return null;</span>

<span class="nc" id="L1598">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1600" title="All 2 branches missed.">		if (null == wi) return null;</span>

<span class="nc" id="L1602">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1604">		int iWorkoutDate = wi.date();</span>

<span class="nc" id="L1606">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1609" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1610" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1612">			int iPeriodEndDate = period.endDate();</span>

<span class="nc bnc" id="L1614" title="All 4 branches missed.">			if (null == period || iPeriodEndDate &lt; iValueDate) continue;</span>

<span class="nc bnc" id="L1616" title="All 2 branches missed.">			if (period.startDate() &gt; iWorkoutDate) break;</span>

<span class="nc" id="L1618">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1619">				(this, valParams, pricerParams, iPeriodEndDate, csqc);</span>

<span class="nc bnc" id="L1621" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1622">		}</span>

<span class="nc" id="L1624">		return sLP;</span>
	}

	@Override public boolean isFloater()
	{
<span class="fc bfc" id="L1629" title="All 2 branches covered.">		return null == _floaterSetting ? false : true;</span>
	}

	@Override public java.lang.String rateIndex()
	{
<span class="nc bnc" id="L1634" title="All 2 branches missed.">		return null == _floaterSetting ? &quot;&quot; : _floaterSetting.fri().fullyQualifiedName();</span>
	}

	@Override public double currentCoupon()
	{
<span class="nc bnc" id="L1639" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.currentFullCoupon();</span>
	}

	@Override public double floatSpread()
	{
<span class="pc bpc" id="L1644" title="1 of 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.spread();</span>
	}

	@Override public java.lang.String ticker()
	{
<span class="nc bnc" id="L1649" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.ticker();</span>
	}

	@Override public void setEmbeddedCallSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="pc bpc" id="L1655" title="2 of 4 branches missed.">		if (null == eos || eos.isPut()) return;</span>

<span class="fc" id="L1657">		_eosCall = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="fc" id="L1658">	}</span>

	@Override public void setEmbeddedPutSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="nc bnc" id="L1663" title="All 4 branches missed.">		if (null == eos || !eos.isPut()) return;</span>

<span class="nc" id="L1665">		_eosPut = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="nc" id="L1666">	}</span>

	@Override public boolean callable()
	{
<span class="fc bfc" id="L1670" title="All 2 branches covered.">		return null != _eosCall;</span>
	}

	@Override public boolean putable()
	{
<span class="pc bpc" id="L1675" title="1 of 2 branches missed.">		return null != _eosPut;</span>
	}

	@Override public boolean sinkable()
	{
<span class="nc bnc" id="L1680" title="All 2 branches missed.">		return null == _notionalSetting ? false : true;</span>
	}

	@Override public boolean variableCoupon()
	{
<span class="nc bnc" id="L1685" title="All 4 branches missed.">		return null == _couponSetting || null == _couponSetting.couponType() || !&quot;variable&quot;.equalsIgnoreCase</span>
<span class="nc bnc" id="L1686" title="All 2 branches missed.">			(_couponSetting.couponType()) ? false : true;</span>
	}

	@Override public boolean exercised()
	{
<span class="nc bnc" id="L1691" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.exercised();</span>
	}

	@Override public boolean defaulted()
	{
<span class="nc bnc" id="L1696" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.defaulted();</span>
	}

	@Override public boolean perpetual()
	{
<span class="nc bnc" id="L1701" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.perpetual();</span>
	}

	@Override public boolean tradeable (
		final org.drip.param.valuation.ValuationParams valParams)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1708" title="All 2 branches missed.">		if (null == valParams) throw new java.lang.Exception (&quot;BondComponent::tradeable =&gt; invalid Inputs&quot;);</span>

<span class="nc bnc" id="L1710" title="All 4 branches missed.">		return !_terminationSetting.exercised() &amp;&amp; !_terminationSetting.defaulted() &amp;&amp; valParams.valueDate()</span>
<span class="nc bnc" id="L1711" title="All 2 branches missed.">			&lt; maturityDate().julian();</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule callSchedule()
	{
<span class="fc" id="L1716">		return _eosCall;</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule putSchedule()
	{
<span class="fc" id="L1721">		return _eosPut;</span>
	}

	@Override public java.lang.String couponType()
	{
<span class="nc bnc" id="L1726" title="All 2 branches missed.">		return null == _couponSetting ? &quot;&quot; : _couponSetting.couponType();</span>
	}

	@Override public java.lang.String couponDC()
	{
<span class="pc bpc" id="L1731" title="1 of 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.couponDC();</span>
	}

	@Override public java.lang.String accrualDC()
	{
<span class="nc bnc" id="L1736" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.accrualDC();</span>
	}

	@Override public java.lang.String maturityType()
	{
<span class="nc bnc" id="L1741" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : maturityType();</span>
	}

	@Override public org.drip.analytics.date.JulianDate finalMaturity()
	{
<span class="nc bnc" id="L1746" title="All 2 branches missed.">		return null == _stream ? null : new org.drip.analytics.date.JulianDate (_stream.finalMaturityDate());</span>
	}

	@Override public java.lang.String calculationType()
	{
<span class="nc bnc" id="L1751" title="All 2 branches missed.">		return null == _quoteConvention ? &quot;&quot; : _quoteConvention.calculationType();</span>
	}

	@Override public double redemptionValue()
	{
<span class="nc bnc" id="L1756" title="All 2 branches missed.">		return null == _quoteConvention ? java.lang.Double.NaN : _quoteConvention.redemptionValue();</span>
	}

	@Override public java.lang.String currency()
	{
<span class="fc" id="L1761">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String redemptionCurrency()
	{
<span class="nc" id="L1766">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public boolean inFirstCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1773">		return _stream.firstPeriod().contains (iDate);</span>
	}

	@Override public boolean inLastCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1780">		return _stream.lastPeriod().contains (iDate);</span>
	}

	@Override public java.lang.String floatCouponConvention()
	{
<span class="nc bnc" id="L1785" title="All 2 branches missed.">		return null == _floaterSetting ? null : _floaterSetting.dayCount();</span>
	}

	@Override public org.drip.analytics.date.JulianDate periodFixingDate (
		final int iValueDate)
	{
<span class="nc bnc" id="L1791" title="All 4 branches missed.">		if (null == _floaterSetting || iValueDate &gt;= maturityDate().julian()) return null;</span>

<span class="nc bnc" id="L1793" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1794" title="All 2 branches missed.">			if (period.payDate() &lt; iValueDate) continue;</span>

<span class="nc" id="L1796">			org.drip.analytics.cashflow.ComposableUnitPeriod cup = period.periods().get (0);</span>

<span class="nc bnc" id="L1798" title="All 2 branches missed.">			if (!(cup instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)) continue;</span>

			try {
<span class="nc" id="L1801">				return new org.drip.analytics.date.JulianDate</span>
					(((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)
<span class="nc" id="L1803">						(cup)).referenceIndexPeriod().fixingDate());</span>
<span class="nc" id="L1804">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
<span class="nc" id="L1807">		}</span>

<span class="nc" id="L1809">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate previousCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="pc bpc" id="L1815" title="2 of 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="fc" id="L1818">			int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="fc bfc" id="L1820" title="All 2 branches covered.">			if (0 == iIndex) return new org.drip.analytics.date.JulianDate (_stream.period (0).startDate());</span>
			
<span class="fc" id="L1822">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex - 1);</span>

<span class="pc bpc" id="L1824" title="1 of 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1825">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1829">		return null;</span>
	}

	@Override public double previousCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1837" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1838">			throw new java.lang.Exception (&quot;BondComponent::previousCouponRate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1840">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1841">			(dt.julian()) - 1);</span>

<span class="nc bnc" id="L1843" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1844">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Cannot find previous period!&quot;);

<span class="nc" id="L1847">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1850" title="All 2 branches missed.">		if (null == cpcm)</span>
<span class="nc" id="L1851">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Invalid previous period metrics!&quot;);

<span class="nc" id="L1854">		return cpcm.rate();</span>
	}

	@Override public org.drip.analytics.date.JulianDate currentCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1860" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1863">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1864">				(dt.julian()));</span>

<span class="nc bnc" id="L1866" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1867">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1870">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate nextCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1876" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1879">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1880">				(dt.julian()) + 1);</span>

<span class="nc bnc" id="L1882" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1883">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1886">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseDateOfType (
		final org.drip.analytics.date.JulianDate dt,
		final boolean bPut)
	{
<span class="nc bnc" id="L1893" title="All 10 branches missed.">		if (null == dt || (bPut &amp;&amp; null == _eosPut) || (!bPut &amp;&amp; null == _eosCall)) return null;</span>

<span class="nc bnc" id="L1895" title="All 2 branches missed.">		org.drip.product.params.EmbeddedOptionSchedule eos = bPut ? _eosPut : _eosCall;</span>

<span class="nc" id="L1897">		int[] aiEOSExerciseDates = eos.dates();</span>

<span class="nc bnc" id="L1899" title="All 4 branches missed.">		if (null == eos || null == aiEOSExerciseDates) return null;</span>

<span class="nc" id="L1901">		int iNumExerciseDates = aiEOSExerciseDates.length;</span>

<span class="nc bnc" id="L1903" title="All 2 branches missed.">		if (0 == iNumExerciseDates) return null;</span>

<span class="nc bnc" id="L1905" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumExerciseDates; ++i) {</span>
<span class="nc bnc" id="L1906" title="All 2 branches missed.">			if (aiEOSExerciseDates[i] - dt.julian() &lt; eos.exerciseNoticePeriod())</span>
<span class="nc" id="L1907">				continue;</span>

			try {
<span class="nc bnc" id="L1910" title="All 2 branches missed.">				return new org.drip.analytics.output.ExerciseInfo (aiEOSExerciseDates[i], eos.factor (i),</span>
					bPut ? org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT :
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L1913">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1916">				return null;</span>
			}
		}

<span class="nc" id="L1920">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseInfo (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1926" title="All 2 branches missed.">		if (null == dt) return null;</span>

<span class="nc" id="L1928">		org.drip.analytics.output.ExerciseInfo neiNextCall = nextValidExerciseDateOfType (dt, false);</span>

<span class="nc" id="L1930">		org.drip.analytics.output.ExerciseInfo neiNextPut = nextValidExerciseDateOfType (dt, true);</span>

<span class="nc bnc" id="L1932" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null == neiNextPut) {</span>
			try {
<span class="nc" id="L1934">				return new org.drip.analytics.output.ExerciseInfo (maturityDate().julian(), 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L1936">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1939">				return null;</span>
			}
		}

<span class="nc bnc" id="L1943" title="All 4 branches missed.">		if (null != neiNextCall &amp;&amp; null == neiNextPut) return neiNextCall;</span>

<span class="nc bnc" id="L1945" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null != neiNextPut) return neiNextPut;</span>

<span class="nc bnc" id="L1947" title="All 2 branches missed.">		return neiNextCall.date() &lt; neiNextPut.date() ? neiNextCall : neiNextPut;</span>
	}

	@Override public double currentCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1955" title="All 4 branches missed.">		if (null == dt || null == csqc)</span>
<span class="nc" id="L1956">			throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc bnc" id="L1958" title="All 2 branches missed.">		if (null != _floaterSetting) {</span>
<span class="nc" id="L1959">			double dblCurrentFullCoupon = _floaterSetting.currentFullCoupon();</span>

<span class="nc bnc" id="L1961" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblCurrentFullCoupon))</span>
<span class="nc" id="L1962">				return dblCurrentFullCoupon;</span>
		}

<span class="nc" id="L1965">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (dt.julian(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1968" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1970">		return pcm.rate();</span>
	}

	@Override public double nextCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1978" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1979">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc" id="L1981">		int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="nc" id="L1983">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex + 1);</span>

<span class="nc bnc" id="L1985" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1986">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Cannot find next period!&quot;);</span>

<span class="nc" id="L1988">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1991" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1993">		return pcm.rate();</span>
	}

	@Override public double accrued (
		final int iDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2001">		org.drip.analytics.date.JulianDate dt = new org.drip.analytics.date.JulianDate (iDate);</span>

<span class="pc bpc" id="L2003" title="1 of 2 branches missed.">		if (iDate &gt;= maturityDate().julian())</span>
<span class="nc" id="L2004">			throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Val date &quot; + dt +</span>
<span class="nc" id="L2005">				&quot; greater than maturity &quot; + maturityDate());</span>

<span class="fc" id="L2007">		org.drip.param.valuation.ValuationParams valParams = new org.drip.param.valuation.ValuationParams</span>
			(dt, dt, &quot;&quot;);

<span class="fc bfc" id="L2010" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2011">			int iEndDate = period.endDate();</span>

<span class="fc" id="L2013">			int iStartDate = period.startDate();</span>

<span class="fc bfc" id="L2015" title="All 4 branches covered.">			if (iStartDate &lt; iDate &amp;&amp; iEndDate &gt;= iDate) {</span>
<span class="fc" id="L2016">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iEndDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L2019" title="1 of 2 branches missed.">				if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; No PCM&quot;);</span>

<span class="fc" id="L2021">				double dblCoupon = cpcm.rate();</span>

<span class="pc bpc" id="L2023" title="1 of 2 branches missed.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblCoupon))</span>
<span class="nc" id="L2024">					throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Invalid Coupon For &quot; + dt);</span>

<span class="fc" id="L2026">				return period.accrualDCF (iDate) * dblCoupon * notional (iStartDate) * couponFactor</span>
<span class="fc" id="L2027">					(iEndDate);</span>
			}
<span class="fc" id="L2029">		}</span>

<span class="fc" id="L2031">		return 0.;</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2041" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2042">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2044">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2046" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2047">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Val date &quot; +</span>
<span class="nc" id="L2048">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2049">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2051">		int iPeriodEndDate = 0;</span>
<span class="fc" id="L2052">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2053">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2054">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2055">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2057" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2058">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2060" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2062" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2063">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2065" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2067">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2069">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2071">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2072" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2074" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2075">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2076">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2077">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2080">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2083" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2084">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2086">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2088">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2090">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2092">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2094" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2095">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2096" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2097">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2098" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2100">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2102">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2103">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2105" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2106">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2108" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2109">				cpcm.rate()) * couponFactor (iPeriodEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2112">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2113">			iPeriodEndDate += (iAccrualEndDate - iAccrualStartDate);</span>
<span class="fc" id="L2114">			dblTimeWeightedTotalCashflow += iPeriodEndDate * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2116" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2117">		}</span>

<span class="fc" id="L2119">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2121">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2122">		dblTimeWeightedTotalCashflow += iPeriodEndDate * dblTerminalCashflow;</span>
<span class="fc" id="L2123">		return (int) (dblTimeWeightedTotalCashflow / dblTotalCashflow);</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2131">		return weightedAverageMaturityDate (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2141" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2142">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2144">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2146" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2147">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Val date &quot; +</span>
<span class="nc" id="L2148">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2149">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2151">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2152">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2153">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2154">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2155">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2157" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2158">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2160" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2162" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2163">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2165" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2167">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2169">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2171">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2172" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2174" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2175">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2176">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2177">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2180">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2183" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2184">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2186">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2188">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2190">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2192">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2194" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2195">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2196" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2197">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2198" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2200">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2202">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2203">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2205" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2206">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2208" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2209">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2212">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2213">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2214">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2216" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2217">		}</span>

<span class="fc" id="L2219">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2221">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2222">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2223">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2231">		return weightedAverageLife (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2241" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2242">			throw new java.lang.Exception</span>
				(&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Invalid Inputs&quot;);

<span class="fc" id="L2245">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2247" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2248">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2249">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2250">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2252">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2253">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2254">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2255">		double dblTimeWeightedTotalCashflow = 0.;</span>

<span class="pc bpc" id="L2257" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2258">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2260" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2262">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2264">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2266">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2267" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2269" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2270">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2271">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2272">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2275">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2277">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2279">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2280">				(iAccrualStartDate);</span>

<span class="fc" id="L2282">			double dblPeriodCashflow = dblPeriodStartNotional - dblPeriodEndNotional;</span>
<span class="fc" id="L2283">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>
<span class="fc" id="L2284">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2285">			dblPeriodEndTime += dblPeriodTimeWidth;</span>

<span class="fc bfc" id="L2287" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2288">		}</span>

<span class="fc" id="L2290">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2292">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2293">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2294">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2302">		return weightedAverageLifePrincipalOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2312" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2313">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2315">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2317" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2318">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2319">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2320">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2322">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2323">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2324">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2325">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2326">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2328" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2329">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2331" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2333" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2334">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2336" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2338">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2340">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2342">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2343" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2345" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2346">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2347">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2348">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2351">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2354" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2355">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2357">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2359">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2361">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2363">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2365" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2366">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2367" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2368">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2369" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2371">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2373">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2374">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2376" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2377">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2379" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2380">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L2382">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2383">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2384">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2386" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2387">		}</span>

<span class="fc" id="L2389">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2397">		return weightedAverageLifeCouponOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2407" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2408">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2410">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2412">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2414" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2415">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2417">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2418">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2419">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2420">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2421">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2423" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2424">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2426" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2428" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2429">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2431" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2433">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2435">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2437">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2438" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2440" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2441">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2442">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2443">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2446">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2449" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2450">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2452">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2454">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2456">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2458">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2460" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2461">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2462" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2463">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2464" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2466">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2468">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2469">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2471" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2472">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2474" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2475">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2476">					dblPeriodEndNotional) * cc.survival (iPeriodPayDate) * (1. - cc.effectiveRecovery</span>
<span class="fc" id="L2477">						(iPeriodStartDate, period.endDate()));</span>

<span class="fc" id="L2479">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2480">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2481">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2483" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2484">		}</span>

<span class="fc" id="L2486">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * cc.survival</span>
<span class="fc" id="L2487">			(iWorkoutDate) * (1. - cc.recovery (iWorkoutDate));</span>

<span class="fc" id="L2489">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2490">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2491">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2499">		return weightedAverageLifeLossOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2509" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2510">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2512">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2514">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2516" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2517">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2519">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2520">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2521">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2522">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2523">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2525" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2526">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2528" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2530" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2531">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2533" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2535">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2537">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2539">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2540" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2542" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2543">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2544">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2545">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2548">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2551" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2552">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2554">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2556">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2558">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2560">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2562" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2563">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2564" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2565">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2566" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2568">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2570">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2571">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2573" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2574">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc" id="L2576">			double dblPeriodSurvival = cc.survival (iPeriodPayDate);</span>

<span class="pc bpc" id="L2578" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2579">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional) * (dblPeriodSurvival * (1. - cc.effectiveRecovery
<span class="fc" id="L2581">						(iPeriodStartDate, iNotionalEndDate)) + 1. - dblPeriodSurvival);</span>

<span class="fc" id="L2583">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2584">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2585">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2587" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2588">		}</span>

<span class="fc" id="L2590">		double dblTerminalSurvival = cc.survival (iWorkoutDate);</span>

<span class="fc" id="L2592">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * (dblTerminalSurvival *</span>
<span class="fc" id="L2593">			(1. - cc.recovery (iWorkoutDate)) + 1. - dblTerminalSurvival);</span>

<span class="fc" id="L2595">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2596">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2597">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2605">		return weightedAverageLifeCredit (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double priceFromZeroCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iZeroCurveBaseDC,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2618" title="1 of 2 branches missed.">		if (null == valParams)</span>
<span class="nc" id="L2619">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2621">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2623" title="1 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == csqc || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L2624" title="2 of 4 branches missed.">			(dblWorkoutFactor) || !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="fc" id="L2625">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs &quot; + dblBump);</span>

<span class="fc" id="L2627">		double dblPV = 0.;</span>
<span class="fc" id="L2628">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2629">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L2630">		org.drip.state.discount.ZeroCurve zc = null;</span>
<span class="fc" id="L2631">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2632">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2634" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2635">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2637" title="1 of 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L2638">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="fc bfc" id="L2640" title="All 2 branches covered.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="fc" id="L2641">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2643" title="1 of 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc bfc" id="L2646" title="All 2 branches covered.">		org.drip.state.discount.DiscountCurve dcBase = ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE ==</span>
<span class="fc" id="L2647">			iZeroCurveBaseDC ? csqc.fundingState (fundingLabel()) : csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L2649" title="All 2 branches covered.">		if (null == dcBase)</span>
<span class="fc" id="L2650">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Discount Curve&quot;);</span>

		try {
<span class="fc bfc" id="L2653" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L2654">				valParams.cashPayDate();</span>
<span class="nc" id="L2655">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2658">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2659">		}</span>

<span class="fc" id="L2661">		java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; lsCompositePeriod = couponPeriods();</span>

		try {
<span class="fc" id="L2664">			zc = org.drip.state.curve.DerivedZeroRate.FromBaseCurve (freq(), couponDC(), currency(),</span>
<span class="pc bpc" id="L2665" title="1 of 4 branches missed.">				_stream.couponEOMAdjustment(), lsCompositePeriod, terminationAdjust (iWorkoutDate),</span>
					iValueDate, iCashPayDate, dcBase, dblBump, null == vcp ? (null == _quoteConvention ? null
<span class="pc" id="L2667">						: _quoteConvention.valuationCustomizationParams()) : vcp, new</span>
							org.drip.spline.params.SegmentCustomBuilderControl
								(org.drip.spline.stretch.MultiSegmentSequenceBuilder.BASIS_SPLINE_POLYNOMIAL,
									new org.drip.spline.basis.PolynomialFunctionSetParams (2),
<span class="fc" id="L2671">										org.drip.spline.params.SegmentInelasticDesignControl.Create (0, 2),</span>
											new org.drip.spline.params.ResponseScalingShapeControl (true, new
												org.drip.function.r1tor1.QuadraticRationalShapeControl (0.)),
													null));
<span class="nc" id="L2675">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L2676">			e.printStackTrace();</span>
<span class="fc" id="L2677">		}</span>

<span class="pc bpc" id="L2679" title="1 of 2 branches missed.">		if (null == zc)</span>
<span class="nc" id="L2680">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Cannot create shifted ZC&quot;);</span>

<span class="pc bpc" id="L2682" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : lsCompositePeriod) {</span>
<span class="fc" id="L2683">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2685" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2687">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2689">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2691">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L2693">			int iNotionalEndDate = iAccrualEndDate;</span>
<span class="fc" id="L2694">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2696">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc bfc" id="L2698" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2699">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2700">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2701">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2704">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START ==</span>
<span class="fc bfc" id="L2705" title="All 2 branches covered.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2706">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="fc" id="L2707">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END ==</span>
<span class="pc bpc" id="L2708" title="1 of 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2709">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc" id="L2710">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
<span class="nc bnc" id="L2711" title="All 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="nc" id="L2712">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2714">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2717" title="1 of 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2719" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2720">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2722" title="1 of 2 branches missed.">			dblPV += (period.accrualDCF (iAccrualEndDate) * (bApplyFlatForwardRate ? dblFlatForwardRate :</span>
<span class="fc" id="L2723">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2724">					dblPeriodEndNotional) * zc.df (iPeriodPayDate);</span>

<span class="fc bfc" id="L2726" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2727">		}</span>

<span class="fc" id="L2729">		return ((dblPV + dblWorkoutFactor * zc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L2730">			(iWorkoutDate)) / zc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	@Override public double priceFromFundingCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="fc" id="L2741">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_FUNDING_CURVE);
	}

	@Override public double priceFromTreasuryCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="nc" id="L2753">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_TREASURY_CURVE);
	}

	@Override public double priceFromCreditCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis,
		final boolean bFlat)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2766" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L2767" title="1 of 4 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblCreditBasis) || null == _creditSetting)</span>
<span class="fc" id="L2768">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2770">		org.drip.state.credit.CreditCurve ccIn = csqc.creditState (creditLabel());</span>

<span class="fc bfc" id="L2772" title="All 2 branches covered.">		if (null == ccIn)</span>
<span class="fc" id="L2773">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2775">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L2777" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L2778">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No funding curve&quot;);</span>

<span class="fc" id="L2780">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2782" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2783">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L2784">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2785">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="pc bpc" id="L2787" title="1 of 2 branches missed.">		double dblRecoveryToUse = !_creditSetting.useCurveRecovery() ? _creditSetting.recovery() :</span>
			java.lang.Double.NaN;

<span class="pc bpc" id="L2790" title="1 of 2 branches missed.">		org.drip.state.credit.CreditCurve cc = bFlat ? ccIn.flatCurve (dblCreditBasis, true,</span>
			dblRecoveryToUse) : (org.drip.state.credit.CreditCurve) ccIn.parallelShiftManifestMeasure
<span class="fc" id="L2792">				(&quot;SwapRate&quot;, dblCreditBasis);</span>

<span class="pc bpc" id="L2794" title="1 of 2 branches missed.">		if (null == cc)</span>
<span class="nc" id="L2795">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromCreditCurve =&gt; Cannot create adjusted Curve&quot;);

<span class="fc" id="L2798">		double dblPV = 0.;</span>
<span class="fc" id="L2799">		boolean bTerminateCashFlow = false;</span>
<span class="fc" id="L2800">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2801">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2803" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2804">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2806" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2807">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2809" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="fc" id="L2811">		org.drip.param.pricer.CreditPricerParams pricerParams = new org.drip.param.pricer.CreditPricerParams</span>
			(7, null, false, s_iDiscretizationScheme);

<span class="fc" id="L2814">		int iLossPayLag = _creditSetting.lossPayLag();</span>

<span class="fc" id="L2816">		boolean bAccrualOnDefault = _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L2818">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2820" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc bfc" id="L2821" title="All 2 branches covered.">			if (bTerminateCashFlow) continue;</span>

<span class="fc" id="L2823">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2825" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2827">			int iPeriodEndDate = period.endDate();</span>

<span class="fc bfc" id="L2829" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2830">				bTerminateCashFlow = true;</span>
<span class="fc" id="L2831">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2834">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L2836" title="All 2 branches covered.">			if (iPeriodStartDate &lt; iValueDate) iPeriodStartDate = iValueDate;</span>

<span class="fc" id="L2838">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2841" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2842">				throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2844" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2845">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2847" title="1 of 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="fc" id="L2849">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2851">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L2853">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L2855" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2856">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L2857" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2858">				dblCouponNotional = notional (iPeriodEndDate);</span>
<span class="nc bnc" id="L2859" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2861">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc" id="L2863">			dblPV += (period.accrualDCF (iPeriodEndDate) * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dcFunding.df
<span class="fc" id="L2865">					(iPeriodPayDate) * cpcm.cumulative() * cc.survival (iPeriodEndDate);</span>

<span class="fc bfc" id="L2867" title="All 2 branches covered.">			for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this, valParams,</span>
				pricerParams, iPeriodEndDate, csqc)) {
<span class="pc bpc" id="L2869" title="1 of 2 branches missed.">				if (null == lqm) continue;</span>

<span class="fc" id="L2871">				int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L2873">				int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L2875">				double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
					iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L2878">				double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L2880">				double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L2881">					(iSubPeriodEndDate);</span>

<span class="fc bfc" id="L2883" title="All 2 branches covered.">				if (bAccrualOnDefault)</span>
<span class="fc" id="L2884">					dblPV += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival * dblSubPeriodDF *</span>
						dblSubPeriodNotional * dblPeriodCoupon;

<span class="pc bpc" id="L2887" title="1 of 2 branches missed.">				dblPV += (_creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
<span class="pc" id="L2888">					iSubPeriodEndDate) : _creditSetting.recovery()) * dblSubPeriodSurvival *</span>
						dblSubPeriodNotional * dblSubPeriodDF;
<span class="fc" id="L2890">			}</span>
<span class="fc" id="L2891">		}</span>

		try {
<span class="pc bpc" id="L2894" title="1 of 2 branches missed.">			iCashPayDate = null == _quoteConvention ? valParams.cashPayDate() : _quoteConvention.settleDate</span>
<span class="fc" id="L2895">				(valParams);</span>
<span class="nc" id="L2896">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2899">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2900">		}</span>

<span class="fc" id="L2902">		return ((dblPV + dblWorkoutFactor * dcFunding.df (terminationAdjust (iWorkoutDate)) * cc.survival</span>
<span class="fc" id="L2903">			(iWorkoutDate) * notional (iWorkoutDate)) / dcFunding.df (iCashPayDate) - accrued (iValueDate,</span>
				csqc)) / dblScalingNotional;
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2916">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L2917">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2927">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2937" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2938">			throw new java.lang.Exception (&quot;BondComponent::aswFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Bond Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2941">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2953">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L2954">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2964">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2974" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2975">			throw new java.lang.Exception (&quot;BondComponent::aswFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Credit Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2978">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2990">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L2991">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3001">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3011" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3012">			throw new java.lang.Exception (&quot;BondComponent::aswFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3015">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3027">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3028">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3038">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3048" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3049">			throw new java.lang.Exception (&quot;BondComponent::aswFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3052">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3064">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L3065">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3075">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3085" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3086">			throw new java.lang.Exception (&quot;BondComponent::aswFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3089">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3101">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L3102">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3112">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3122" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3123">			throw new java.lang.Exception (&quot;BondComponent::aswFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3126">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3138">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L3139">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3149">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3159" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3160">			throw new java.lang.Exception (&quot;BondComponent::aswFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3163">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3175">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L3176">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3186">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3196" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3197">			throw new java.lang.Exception (&quot;BondComponent::aswFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3200">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3212">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3223">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3233" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3234">			throw new java.lang.Exception (&quot;BondComponent::aswFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3237">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3249">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L3250">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3260">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3270" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3271">			throw new java.lang.Exception (&quot;BondComponent::aswFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3274">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3286" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L3287" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L3288">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3290">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L3292" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L3293">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3295">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="pc bpc" id="L3298" title="1 of 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; No CPCM&quot;);</span>

<span class="fc" id="L3300">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L3302" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L3303">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3305">		return cpcm.rate() - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + 0.0001 *</span>
<span class="fc" id="L3306">			(dblWorkoutFactor - dblPrice) / dcFunding.parSwapDV01 (iWorkoutDate);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3316">		return aswFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double aswFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3326">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L3328" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3329">			throw new java.lang.Exception</span>
				(&quot;BondComponent::aswFromPriceToOptimalExercise =&gt; Can't determine Optimal Work-out&quot;);

<span class="nc" id="L3332">		return aswFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L3344">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="fc" id="L3345">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3355">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3365" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3366">			throw new java.lang.Exception (&quot;BondComponent::aswFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3369">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3381">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3392">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3402" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3403">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3406">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3418">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L3419">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3429">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3439" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3440">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3443">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3455">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L3456">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3466">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double aswFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3476" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3477">			throw new java.lang.Exception (&quot;BondComponent::aswFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3480">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3492">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L3493">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3503">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3513" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3514">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3517">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3529">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3530">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3540">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3550" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3551">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3554">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3566">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3567">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3578">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3589" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3590">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3593">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3606">		return bondBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3607">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3617">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3627" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3628">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3631">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3643">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L3644">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3654">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3664" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3665">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3668">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3680">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L3681">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3691">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3701" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3702">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3705">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3717">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L3718">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3728">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3738" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3739">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3742">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3754">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L3755">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3765">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3775" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3776">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3779">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3791">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L3792">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3802">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3812" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3813">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3816">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3828">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L3829">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3839">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3849" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3850">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3853">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3865">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L3866">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3876">		return bondBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double bondBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3886">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>
		
<span class="nc bnc" id="L3888" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3889">			throw new java.lang.Exception</span>
				(&quot;BondComponent::bondBasisFromPriceToOptimalExercise =&gt; cant calc Work-out info&quot;);

<span class="nc" id="L3892">		return bondBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3904">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L3905">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3915">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3925" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3926">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3929">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3941" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L3942">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L3944">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L3945">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3955">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3965" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3966">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3969">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3981">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3982">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3992">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4002" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4003">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4006">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4018">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L4019">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4029">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4039" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4040">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4043">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4055">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4056">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4066">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4076" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4077">			throw new java.lang.Exception (&quot;BondComponent::convexityFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4080">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4092">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L4093">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4103">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4113" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4114">			throw new java.lang.Exception (&quot;BondComponent::convexityFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4117">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4129">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4130">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4140">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4150" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4151">			throw new java.lang.Exception (&quot;BondComponent::convexityFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4154">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4166">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4167">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4178">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4189" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4190">			throw new java.lang.Exception (&quot;BondComponent::convexityFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Convexity from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4193">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4206">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4207">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4217">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4227" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4228">			throw new java.lang.Exception (&quot;BondComponent::convexityFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4231">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4243">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4244">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4254">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4264" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4265">			throw new java.lang.Exception (&quot;BondComponent::convexityFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4268">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4280">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4281">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4291">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4301" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4302">			throw new java.lang.Exception (&quot;BondComponent::convexityFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4305">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4317">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4318">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4328">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4338" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4339">			throw new java.lang.Exception (&quot;BondComponent::convexityFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4342">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4354">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4355">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4365">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4375" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4376">			throw new java.lang.Exception (&quot;BondComponent::convexityFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4379">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4391">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4392">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4402">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4412" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4413">			throw new java.lang.Exception (&quot;BondComponent::convexityFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4416">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4428">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4429">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4439">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4449" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4450">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4453">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L4465" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L4466">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc" id="L4468">		double dblYield = yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>

<span class="fc" id="L4470">		return (priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield - 0.0001) +</span>
<span class="fc" id="L4471">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001) - 2. *</span>
<span class="fc" id="L4472">				dblPrice) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4482">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4492" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4493">			throw new java.lang.Exception (&quot;BondComponent::calcConvexityFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4496">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4508">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L4509">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4519">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4529" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4530">			throw new java.lang.Exception (&quot;BondComponent::convexityFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4533">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4545">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L4546">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4556">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4566" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4567">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4570">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4582">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L4583">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4593">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4603" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4604">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4607">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4619">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L4620">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4630">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4640" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4641">			throw new java.lang.Exception (&quot;BondComponent::convexityFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4644">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4656">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4657">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4667">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4677" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4678">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Credit Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4681">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4693">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4694">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4704">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4714" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4715">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4718">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4730">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4731">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4742">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4753" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4754">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Credit Basis from Discnt Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4758">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4771">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4772">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4782">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4792" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4793">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4796">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4808">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4809">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4819">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4829" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4830">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4833">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4845">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4846">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4856">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4866" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4867">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4870">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4882">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4883">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4893">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4903" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4904">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4907">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4919">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4920">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4930">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4940" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4941">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4944">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4956">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4957">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4967">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4977" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4978">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4981">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4993">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4994">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5004">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5014" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5015">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5018">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5030">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, false);
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5041">		return creditBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double creditBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5051">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5053" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5054">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromPriceToOptimalExercise =&gt; cant calc Work-out&quot;);

<span class="nc" id="L5057">		return creditBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L5069">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5070">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5080">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5090" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5091">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5094">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5106">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L5107">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5117">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5127" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5128">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5131">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5143">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5144">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5154">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws	java.lang.Exception
	{
<span class="nc bnc" id="L5165" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5166">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5169">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5182">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L5183">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5193">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5203" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5204">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5207">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5219">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L5220">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5230">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5240" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5241">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5244">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5256">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5257">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5267">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5277" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5278">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5281">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5293">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5294">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5304">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5315" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5316">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Crdit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5320">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5333">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5334">			yieldFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5344">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5354" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5355">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromESpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5358">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5370">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5371">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5381">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5391" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5392">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromGSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5395">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5407">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5408">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5418">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5428" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5429">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromISpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5432">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5444">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5445">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5455">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5465" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5466">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromJSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5469">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5481">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5482">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5492">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5502" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5503">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromNSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5506">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5518">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L5519">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5529">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5539" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5540">			throw new java.lang.Exception (&quot;BondComponent::calcDiscountMarginFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5543">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5555">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L5556">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5566">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5576" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5577">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5580">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5592">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5593">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5603">		return discountMarginFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double discountMarginFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5613">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5615" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5616">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L5619">		return discountMarginFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5631">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5632">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5642">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5652" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5653">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromTSYSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5656">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L5668" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L5669">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5671">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L5673" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L5674">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5676">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L5678">		int iFreq = freq();</span>

<span class="fc" id="L5680">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L5682" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L5683">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L5685" title="1 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
<span class="fc" id="L5686">			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblYield - dcFunding.libor (iValueDate,</span>
<span class="fc" id="L5687">				((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblYield - indexRate (iValueDate, csqc,</span>
					(org.drip.analytics.cashflow.CompositeFloatingPeriod) cp);
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5698">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5708" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5709">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5712">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5724">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5725">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5735">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5746" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5747">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5751">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5764">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5765">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5775">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5785" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5786">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromZSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5789">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5801">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L5802">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5812">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5822" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5823">			throw new java.lang.Exception (&quot;BondComponent::durationFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5826">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5838">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L5839">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5849">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5859" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5860">			throw new java.lang.Exception (&quot;BondComponent::durationFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5863">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5875">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5876">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5886">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5896" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5897">			throw new java.lang.Exception (&quot;BondComponent::durationFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5900">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5912">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5913">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5924">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5935" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5936">			throw new java.lang.Exception (&quot;BondComponent::durationFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Duration from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5939">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5952">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L5953">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5963">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5973" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5974">			throw new java.lang.Exception (&quot;BondComponent::durationFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5977">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5989">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L5990">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6000">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6010" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6011">			throw new java.lang.Exception (&quot;BondComponent::durationFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6014">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6026">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6027">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6037">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6047" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6048">			throw new java.lang.Exception (&quot;BondComponent::durationFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6051">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6063">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6064">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6074">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6084" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6085">			throw new java.lang.Exception (&quot;BondComponent::durationFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6088">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6100">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6101">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6111">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6121" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6122">			throw new java.lang.Exception (&quot;BondComponent::durationFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6125">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6137">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6138">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6148">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6158" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6159">			throw new java.lang.Exception (&quot;BondComponent::durationFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6162">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6174">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6175">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6185">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6195" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6196">			throw new java.lang.Exception (&quot;BondComponent::durationFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6199">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6211">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6221">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6231" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6232">			throw new java.lang.Exception (&quot;BondComponent::durationFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6235">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6247">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6248">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6258">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6268" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6269">			throw new java.lang.Exception (&quot;BondComponent::durationFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6272">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6284">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6285">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6295">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6305" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6306">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6309">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6321">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6322">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6332">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6342" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6343">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6346">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6358">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L6359">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6369">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6379" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6380">			throw new java.lang.Exception (&quot;BondComponent::durationFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6383">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6395">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L6396">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6406">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6416" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6417">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6420">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6432">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L6433">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6443">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6453" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6454">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6457">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6469">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L6470">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6480">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6490" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6491">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6494">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6506">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6507">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6518">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6529" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6530">			throw new java.lang.Exception</span>
				(&quot;BondComponent::eSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc E Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6534">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6547">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L6548">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6558">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6568" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6569">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6572">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6584">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6585">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6595">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6605" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6606">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6609">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6621">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6622">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6632">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6642" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6643">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6646">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6658">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6659">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6669">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6679" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6680">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6683">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6695">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6696">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6706">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6716" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6717">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6720">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6732">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6733">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6743">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6753" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6754">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6757">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6769">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6780">		return eSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double eSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6790">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L6792" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L6793">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6796">		return eSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6808">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6809">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6819">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6829" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6830">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6833">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6845">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6846">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6856">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6866" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6867">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6870">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6882">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L6883">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6893">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double eSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6903" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6904">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6907">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6919">		return gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L6920">			(valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6930">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6940" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6941">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6944">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6956">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L6957">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6967">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6977" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6978">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6981">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6993">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L6994">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7004">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7014" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7015">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7018">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7030">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7031">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7042">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7053" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7054">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc G Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7057">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7070">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7071">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7081">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7091" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7092">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7095">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7107">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L7108">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7118">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7128" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7129">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7132">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7144">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7145">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7155">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7165" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7166">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7169">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7181">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7182">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7192">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7202" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7203">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7206">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7218">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7219">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7229">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7239" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7240">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7243">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7255">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7256">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7266">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7276" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7277">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7280">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7292">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7293">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7303">		return gSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double gSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7313">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7315" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7316">			throw new java.lang.Exception</span>
				(&quot;BondComponent::gSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7319">		return gSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7331">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7332">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7342">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7352" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7353">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7356">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7368" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield) ||</span>
<span class="pc bpc" id="L7369" title="1 of 2 branches missed.">			valParams.valueDate() &gt;= iWorkoutDate)</span>
<span class="nc" id="L7370">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7372">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L7374" title="All 2 branches covered.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7376">		return dblYield - gc.yield (iWorkoutDate);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7386">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7396" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7397">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7400">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7412">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7413">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7423">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7433" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7434">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7437">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7449">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7450">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7460">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double gSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7470" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7471">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7474">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7486">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7487">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7497">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7507" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7508">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7511">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7523">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L7524">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7534">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7544" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7545">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7548">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7560">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L7561">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7571">		return iSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7581" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7582">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7585">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7597">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7598">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7609">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7620" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7621">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc I Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7624">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7637">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7638">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7648">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7658" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7659">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7662">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7674">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L7675">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7685">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7695" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7696">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7699">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7711">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7712">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7722">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7732" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7733">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7736">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7748">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7749">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7759">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7769" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7770">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7773">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7785">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7786">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7796">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7806" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7807">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7810">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7822">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7823">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7833">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7843" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7844">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7847">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7859">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7860">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7870">		return iSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double iSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7880">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7882" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7883">			throw new java.lang.Exception</span>
				(&quot;BondComponent::iSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7886">		return iSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7898">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7899">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7909">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7919" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7920">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7923">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7935" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L7936">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7938">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L7940" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L7941">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7943">		return dblYield - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7953">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7963" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7964">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7967">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7979">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7980">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7990">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8000" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8001">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8004">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8016">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8017">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8027">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8037" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8038">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8041">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8053">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L8054">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8064">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8074" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8075">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8078">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8090">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L8091">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8101">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8111" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8112">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8115">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8127">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L8128">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8138">		return jSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8148" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8149">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8152">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8164">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8165">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8176">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8187" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8188">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc J Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8191">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8204">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L8205">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8215">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8225" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8226">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8229">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8241">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L8242">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8252">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8262" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8263">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8266">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8278">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L8279">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8289">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8299" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8300">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8303">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8315">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L8316">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8326">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8336" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8337">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8340">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8352">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L8353">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8363">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8373" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8374">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8377">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8389">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L8390">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8400">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8410" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8411">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8414">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8426">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L8427">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8437">		return jSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double jSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8447">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L8449" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L8450">			throw new java.lang.Exception</span>
				(&quot;BondComponent::jSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L8453">		return jSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8465">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L8466">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8476">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8486" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8487">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8490">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L8502" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L8503">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8505">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="pc bpc" id="L8507" title="1 of 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8509">		return dblYield - gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L8520">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8530" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8531">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8534">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8546">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L8547">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8557">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8567" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8568">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8571">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8583">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8584">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8594">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8604" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8605">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8608">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8620">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8621">			yieldFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8631">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8641" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8642">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8646">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8658">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8659">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8669">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8680" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8681">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8685">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8698">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8699">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8709">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8720" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8721">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8725">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8738">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8739">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8750">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8761" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8762">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8766">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8779">		return macaulayDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8780">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8790">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8800" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8801">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8805">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8817">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8818">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8828">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8838" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8839">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8843">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8855">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8856">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8866">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8876" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8877">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8881">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8893">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8894">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8904">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8915">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8919">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8931">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8932">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8942">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8952" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8953">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8957">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8969">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8970">			yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8980">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double mnacaulayDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8990" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8991">			throw new java.lang.Exception</span>
				(&quot;BondComponent::mnacaulayDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8995">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9007">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9008">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9018">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9028" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9029">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9033">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9045">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9046">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9056">		return macaulayDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double macaulayDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9066">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9068" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9069">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9072">		return macaulayDurationFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9084">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9085">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9095">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9106" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9107">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9111">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9124" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L9125">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9127">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L9129" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L9130">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9132">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L9133">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L9134">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L9135">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L9136">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L9137">		double dblCumulativePeriodDuration = 0.;</span>
<span class="fc" id="L9138">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L9139">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>
<span class="fc" id="L9140">		org.drip.analytics.cashflow.CompositePeriod periodRef = null;</span>

<span class="fc" id="L9142">		int iFrequency = freq();</span>

<span class="fc" id="L9144">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L9146">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L9148">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L9150" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L9152" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L9153">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L9155" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L9156">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L9158">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L9160">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L9162">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L9164">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L9165" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L9166">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L9168">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L9170">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L9172">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L9174">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L9177">		int iAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L9179" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L9180">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L9182" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L9184" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L9185">				bFirstPeriod = false;</span>

<span class="fc" id="L9187">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L9189">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L9191">			periodRef = period;</span>

<span class="fc" id="L9193">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L9195">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L9197" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L9198">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L9199">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L9202">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L9205" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L9206">				throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; No CPCM&quot;);</span>

<span class="pc bpc" id="L9208" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L9209" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L9210">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L9212" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L9213" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L9214">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L9217">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L9220">			double dblYearFract = org.drip.analytics.daycount.Convention.YearFraction (iValueDate,</span>
				iPeriodPayDate, strDC, bApplyCpnEOMAdj, aap, strCalendar);

<span class="fc" id="L9223">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L9224">				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract : dblYearFract) * cpcm.cumulative();</span>

<span class="fc" id="L9226">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L9228">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L9230">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L9232" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iAmortizationMode)</span>
<span class="fc" id="L9233">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L9234" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iAmortizationMode)</span>
<span class="fc" id="L9235">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L9236" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE == iAmortizationMode)</span>
<span class="nc" id="L9237">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L9239" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L9240">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L9242" title="1 of 2 branches missed.">			double dblCouponPV = period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="fc" id="L9243">				dblFlatForwardRate : cpcm.rate()) * couponFactor (iPeriodEndDate) * dblYieldAnnuity *</span>
					dblCouponNotional;

<span class="fc" id="L9246">			double dblPeriodNotionalPV = (dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;</span>
<span class="fc" id="L9247">			dblCumulativePeriodDuration += dblPeriodYearFract * (dblCouponPV + dblPeriodNotionalPV);</span>
<span class="fc" id="L9248">			dblCumulativePeriodPV += (dblCouponPV + dblPeriodNotionalPV);</span>

<span class="fc bfc" id="L9250" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L9251">		}</span>

<span class="pc bpc" id="L9253" title="1 of 2 branches missed.">		if (null != periodRef)</span>
<span class="fc" id="L9254">			aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, periodRef.endDate() -</span>
<span class="fc" id="L9255">				periodRef.startDate());</span>

<span class="fc" id="L9257">		double dblRedemptionPV = dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (iFrequency,</span>
			dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L9260">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate);</span>

<span class="fc" id="L9262">		return (dblCumulativePeriodDuration + dblPeriodYearFract * dblRedemptionPV) / (dblCumulativePeriodPV</span>
			+ dblRedemptionPV);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9273">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9283" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9284">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Macaulay Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9287">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9299">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9300">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9310">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9321" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9322">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9326">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9339">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9340">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9350">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9360" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9361">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9365">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9377">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9378">			priceFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9388">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9398" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9399">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9403">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9415">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9416">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9426">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9437" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9438">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9442">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9455">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9456">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9466">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9477" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9478">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9482">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9495">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9496">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9507">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9518" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9519">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9523">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9536">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9537">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9547">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9557" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9558">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9562">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9574">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9575">			priceFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9585">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9595" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9596">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9600">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9612">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9613">			priceFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9623">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9633" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9634">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9638">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9650">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9651">			priceFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9661">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9671" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9672">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9676">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9688">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9689">			priceFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9699">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9709" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9710">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9714">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9726">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9727">			priceFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9737">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9747" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9748">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9752">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9764">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9765">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9775">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9785" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9786">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9790">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9802" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L9803">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc bfc" id="L9805" title="All 2 branches covered.">		if (null == _floaterSetting)</span>
<span class="fc" id="L9806">			return (dblPrice - priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9807">				yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) + 0.0001)) /</span>
<span class="fc" id="L9808">					(dblPrice + accrued (valParams.valueDate(), csqc));</span>

<span class="fc" id="L9810">		return (dblPrice - priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9811">			discountMarginFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) +</span>
<span class="fc" id="L9812">				0.0001)) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9822">		return modifiedDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double modifiedDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9832">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9834" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9835">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9838">		return modifiedDurationFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9850">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9851">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9861">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9872" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9873">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9877">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9890">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9891">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9901">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9911" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9912">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Modified Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9915">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9927">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9928">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9938">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9949" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9950">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9954">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9967">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9968">			priceFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9978">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9989">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9993">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10005">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L10006">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10016">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10026" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10027">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10030">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10042">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L10043">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10053">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10063" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10064">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10067">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10079">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L10080">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10090">		return nSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10100" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10101">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10104">		return nSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10116">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L10117">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10128">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10139" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10140">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc N Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10143">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10156">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L10157">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10167">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10177" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10178">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10181">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10193">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L10194">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10204">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10214" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10215">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10218">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10230">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L10231">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10241">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10251" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10252">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10255">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10267">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L10268">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10278">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10288" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10289">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10292">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10304">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L10305">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10315">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10325" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10326">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10329">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10341">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L10342">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10352">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10362" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10363">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10366">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10378">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L10379">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10389">		return nSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double nSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10399">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10401" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10402">			throw new java.lang.Exception</span>
				(&quot;BondComponent::nSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L10405">		return nSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10417">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L10418">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10428">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10438" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10439">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10442">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L10454" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L10455">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10457">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L10459" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L10460">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10462">		return dblYield - dcFunding.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10472">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10482" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10483">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10486">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10498">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L10499">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10509">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10519" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10520">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10523">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10535">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L10536">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10546">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10556" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10557">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10560">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10572">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10583">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10593" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10594">			throw new java.lang.Exception (&quot;BondComponent::oasFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10597">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10609">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L10610">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10620">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10630" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10631">			throw new java.lang.Exception (&quot;BondComponent::oasFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10634">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10646">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L10647">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10657">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10667" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10668">			throw new java.lang.Exception (&quot;BondComponent::oasFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10671">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10683">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L10684">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10694">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10705">			throw new java.lang.Exception (&quot;BondComponent::oasFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10708">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10720">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L10721">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10731">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10741" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10742">			throw new java.lang.Exception (&quot;BondComponent::oasFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10745">		return oasFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10757">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L10758">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10768">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10778" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10779">			throw new java.lang.Exception (&quot;BondComponent::oasFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10782">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10794">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L10795">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10805">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10815" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10816">			throw new java.lang.Exception (&quot;BondComponent::oasFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10819">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10831">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L10832">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10842">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10852" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10853">			throw new java.lang.Exception (&quot;BondComponent::oasFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10856">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10868">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L10869">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10879">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10889" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10890">			throw new java.lang.Exception (&quot;BondComponent::oasFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10893">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10905">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10906">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10916">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10926" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10927">			throw new java.lang.Exception (&quot;BondComponent::oasFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10930">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10942">		return new BondCalibrator (this, false).calibrateOASFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10953">		return oasFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double oasFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10963">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10965" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10966">			throw new java.lang.Exception</span>
				(&quot;BondComponent::oasFromPriceToOptimalExercise - cant calc Work-out&quot;);

<span class="nc" id="L10969">		return oasFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10981">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L10982">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10992">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11002" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11003">			throw new java.lang.Exception (&quot;BondComponent::oasFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11006">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L11018">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L11019">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11029">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11039" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11040">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11043">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11055">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11056">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11066">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11076" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11077">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11080">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11092">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11093">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11103">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11113" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11114">			throw new java.lang.Exception (&quot;BondComponent::oasFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11117">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11129">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L11130">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11140">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11150" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11151">			throw new java.lang.Exception (&quot;BondComponent::pecsFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11154">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11166">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L11167">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11177">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11187" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11188">			throw new java.lang.Exception (&quot;BondComponent::pecsFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11191">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11203">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L11204">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11214">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11224" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11225">			throw new java.lang.Exception (&quot;BondComponent::pecsFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11228">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11240">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L11241">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11251">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11261" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11262">			throw new java.lang.Exception (&quot;BondComponent::pecsFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11265">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11277">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L11278">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11288">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11298" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11299">			throw new java.lang.Exception (&quot;BondComponent::pecsFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11302">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11314">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L11315">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11325">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11335" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11336">			throw new java.lang.Exception (&quot;BondComponent::pecsFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11339">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11351">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L11352">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11362">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11372" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11373">			throw new java.lang.Exception (&quot;BondComponent::pecsFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11376">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11388">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L11389">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11399">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11409" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11410">			throw new java.lang.Exception (&quot;BondComponent::pecsFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11413">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11425">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L11426">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11436">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11446" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11447">			throw new java.lang.Exception (&quot;BondComponent::pecsFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11450">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11462">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L11463">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11473">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11483" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11484">			throw new java.lang.Exception (&quot;BondComponent::pecsFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11487">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11499">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, true);
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11510">		return pecsFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double pecsFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11520">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L11522" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L11523">			throw new java.lang.Exception</span>
				(&quot;BondComponent::pecsFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L11526">		return pecsFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11538">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L11539">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11549">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11559" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11560">			throw new java.lang.Exception (&quot;BondComponent::pecsFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11563">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11575">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L11576">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11586">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11596" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11597">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11600">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11612">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11613">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11623">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11633" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11634">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11637">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11649">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11650">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11660">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11670" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11671">			throw new java.lang.Exception (&quot;BondComponent::pecsFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11674">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11686" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="nc bnc" id="L11687" title="All 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblASW))</span>
<span class="nc" id="L11688">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11690">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L11692" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L11693">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11695">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L11697" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L11698">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11700">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="nc bnc" id="L11703" title="All 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; No CPCM&quot;);</span>

<span class="nc" id="L11705">		return dblWorkoutFactor - 100. * dcFunding.parSwapDV01 (iWorkoutDate) * (dblASW +</span>
<span class="nc" id="L11706">			dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) - cpcm.rate());</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11716">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11726" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11727">			throw new java.lang.Exception (&quot;BondComponent::priceFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11730">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11742">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="fc" id="L11743">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11753">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11763" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11764">			throw new java.lang.Exception (&quot;BondComponent::priceFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11767">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11779">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblCreditBasis,</span>
			false);
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11790">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11800" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11801">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11804">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="fc" id="L11816">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L11817">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11828">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11839" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11840">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11843">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11856">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L11857">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11867">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11877" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11878">			throw new java.lang.Exception (&quot;BondComponent::priceFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11881">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11893">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L11894">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11904">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11915">			throw new java.lang.Exception (&quot;BondComponent::priceFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11918">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11930">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L11931">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11941">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11951" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11952">			throw new java.lang.Exception (&quot;BondComponent::priceFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11955">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11967">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L11968">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11978">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11989">			throw new java.lang.Exception (&quot;BondComponent::priceFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11992">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12004">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12005">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12015">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12025" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12026">			throw new java.lang.Exception (&quot;BondComponent::priceFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12029">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12041">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblOAS);
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12052">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12062" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12063">			throw new java.lang.Exception (&quot;BondComponent::priceFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12066">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12078">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblPECS, true);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12088">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12098" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12099">			throw new java.lang.Exception (&quot;BondComponent::priceFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12102">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12114">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="fc" id="L12115">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12125">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12135" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12136">			throw new java.lang.Exception (&quot;BondComponent::priceFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12139">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12151">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield, false);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12161">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12171" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12172">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc exercise px from yld for bonds w emb option&quot;);

<span class="nc" id="L12175">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12187">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L12188">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12198">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12208" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12209">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12212">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12224">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblZSpread);
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12235">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12245" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12246">			throw new java.lang.Exception (&quot;BondComponent::priceFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12249">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12261">		return tsySpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12262">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12272">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12282" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12283">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12286">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12298">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L12299">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12309">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12319" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12320">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12323">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12335">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12336">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12346">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12356" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12357">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12360">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12372">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12373">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12384">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12395" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12396">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc TSY Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12399">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12412">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L12413">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12423">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12433" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12434">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12437">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12449">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L12450">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12460">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12470" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12471">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12474">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12486">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L12487">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12497">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12507" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12508">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12511">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12523">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L12524">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12534">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12544" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12545">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12548">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12560">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12561">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12571">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12581" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12582">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12585">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12597">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L12598">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12608">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12618" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12619">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12622">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12634">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L12635">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12645">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12655" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12656">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12659">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12671">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L12672">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12682">		return tsySpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double tsySpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L12692">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L12694" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L12695">			throw new java.lang.Exception</span>
				(&quot;BondComponent::tsySpreadFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L12698">		return tsySpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12710">		return dblYield - treasuryBenchmarkYield (valParams, csqc, iWorkoutDate);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L12720">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12730" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12731">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12734">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12746">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12747">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12757">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12767" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12768">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12771">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12783">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L12784">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12794">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12804" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12805">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12808">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12820">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12821">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12831">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12841" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12842">			throw new java.lang.Exception (&quot;BondComponent::yieldFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12845">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12857" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblBondBasis))</span>
<span class="nc" id="L12858">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasis =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L12860">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L12861">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblBondBasis;</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L12871">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12881" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12882">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12885">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12897">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L12898">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12908">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12918" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12919">			throw new java.lang.Exception (&quot;BondComponent::yieldFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12922">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12934" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L12935" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblDiscountMargin))</span>
<span class="nc" id="L12936">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12938">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L12940" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L12941">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12943">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L12945">		int iFreq = freq();</span>

<span class="fc" id="L12947">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L12949" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L12950">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L12952" title="2 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblDiscountMargin + dcFunding.libor
<span class="fc" id="L12954">				(iValueDate, ((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblDiscountMargin + indexRate</span>
<span class="fc" id="L12955">					(iValueDate, csqc, (org.drip.analytics.cashflow.CompositeFloatingPeriod) currentPeriod</span>
<span class="fc" id="L12956">						(iValueDate));</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12966">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12977">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12990">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L12991">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblESpread));
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13002">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13012" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13013">			throw new java.lang.Exception (&quot;BondComponent::yieldFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13016">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13028" title="All 6 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblGSpread) || valParams.valueDate() &gt;= iWorkoutDate</span>
			|| null == csqc)
<span class="nc" id="L13030">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13032">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13034" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13036">		return gc.yield (iWorkoutDate) + dblGSpread;</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13046">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13056" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13057">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13060">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13072" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13073" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblISpread))</span>
<span class="nc" id="L13074">			throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13076">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13077">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13079" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13081">		return dc.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblISpread;</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13091">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13101">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13113" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13114" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblJSpread))</span>
<span class="nc" id="L13115">			throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13117">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13119" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13121">		return dblJSpread + gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13132">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13142">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13154" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13155" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblNSpread))</span>
<span class="nc" id="L13156">			throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13158">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13159">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13161" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13163">		return dc.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblNSpread;</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13173">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13183">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13195">		return yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13206">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13216" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13217">			throw new java.lang.Exception (&quot;BondComponent::yieldFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13220">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13232">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L13233">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13243">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13253" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13254">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13257">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13269">		return new BondCalibrator (this, false).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13280">		return yieldFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13290">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13292" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13293">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13296">		return wi.yield();</span>
	}

	@Override public double yieldFromPriceTC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13308">		return new BondCalibrator (this, true).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13321" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblTSYSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13323">			throw new java.lang.Exception (&quot;BondComponent::calcYieldFromTSYSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13325">		return treasuryBenchmarkYield (valParams, csqc, iWorkoutDate) + dblTSYSpread;</span>
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13335">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13345" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13346">			throw new java.lang.Exception (&quot;BondComponent::yieldFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13349">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13361" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYieldSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13363">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13365">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L13366">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblYieldSpread;</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L13376">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13386" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13387">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13390">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13402">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L13403">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblZSpread));
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13414">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13424" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13425">			throw new java.lang.Exception (&quot;BondComponent::yieldFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13428">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13440">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13441">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13451">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13461" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13462">			throw new java.lang.Exception (&quot;BondComponent::yield01FromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13465">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13477">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L13478">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13488">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13498" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13499">			throw new java.lang.Exception (&quot;BondComponent::yield01FromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13502">		return yield01FromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13514">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L13515">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13525">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13535" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13536">			throw new java.lang.Exception (&quot;BondComponent::yield01FromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13539">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13551">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13552">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13563">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13574" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13575">			throw new java.lang.Exception (&quot;BondComponent::yield01FromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Yield01 from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13578">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13591">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L13592">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13602">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13612" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13613">			throw new java.lang.Exception (&quot;BondComponent::yield01FromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13616">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13628">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L13629">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13639">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13649" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13650">			throw new java.lang.Exception (&quot;BondComponent::yield01FromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13653">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13665">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L13666">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13676">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13686" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13687">			throw new java.lang.Exception (&quot;BondComponent::yield01FromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13690">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13702">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L13703">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13713">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13723" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13724">			throw new java.lang.Exception (&quot;BondComponent::yield01FromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13727">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13739">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L13740">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13750">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13760" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13761">			throw new java.lang.Exception (&quot;BondComponent::yield01FromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13764">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13776">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L13777">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13787">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13797" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13798">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13801">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13813">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L13814">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13824">		return yield01FromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13834">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13836" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13837">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13840">		return yield01FromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13852">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L13853">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13863">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13873" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13874">			throw new java.lang.Exception (&quot;BondComponent::yield01FromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13877">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13889" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L13890">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13892">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield) -</span>
<span class="fc" id="L13893">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L13903">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13913" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13914">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13917">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13929">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L13930">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13940">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13950" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13951">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13954">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13966">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L13967">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13977">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13987" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13988">			throw new java.lang.Exception (&quot;BondComponent::yield01FromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13991">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14003">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L14004">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14014">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14024" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14025">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14028">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14040">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14041">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14051">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14061" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14062">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromBondBasisToOptimalExercise =&gt; &quot;</span>
				+ &quot;Cant calc Yield Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14065">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14077">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14078">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14088">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14099" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14100">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromCreditBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Yield Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14103">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14116">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14117">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14128">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14139" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14140">			throw new java.lang.Exception</span>
				(&quot;BondComponent::yieldSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Yield Spread from Disc Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14144">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14157">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L14158">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14168">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14178" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14179">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14182">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14194">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L14195">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14205">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14215" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14216">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14219">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14231">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L14232">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14242">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14252" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14253">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14256">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14268">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L14269">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14279">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14289" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14290">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14293">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14305">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L14306">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14316">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14326" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14327">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14330">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14342">		return yieldSpreadFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L14343">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14353">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14363" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14364">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14367">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14379">		return yieldSpreadFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L14380">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14390">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14400" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14401">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14404">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14416">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L14417">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14427">		return yieldSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14437">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14439" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14440">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14443">		return yieldSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14455">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14456">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14466">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14476" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14477">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14480">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14492" title="All 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L14493">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L14495">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14496">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14506">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14516" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14517">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14520">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14532">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L14533">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14543">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14553" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14554">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14557">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14569">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L14570">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14580">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14590" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14591">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14594">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14606">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L14607">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14617">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14627" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14628">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14631">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14643">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L14644">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14654">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14664" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14665">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14668">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14680">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14681">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14692">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14703" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14704">			throw new java.lang.Exception</span>
				(&quot;BondComponent::zSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Z Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14708">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14721">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L14722">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14732">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14742" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14743">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14746">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14758">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L14759">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14769">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14779" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14780">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14783">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14795">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L14796">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14806">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14816" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14817">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14820">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14832">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L14833">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14843">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14853" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14854">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14857">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14869">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L14870">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14880">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14890" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14891">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14894">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14906">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L14907">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14917">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14927" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14928">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14931">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14943">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14954">		return zSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double zSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14964">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14966" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14967">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14970">		return zSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14982">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L14983">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14993">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15003" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15004">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15007">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L15019">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L15020">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L15030">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15040" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15041">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15044">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15056">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L15057">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15067">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double zSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15077" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15078">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15081">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public org.drip.analytics.output.BondRVMeasures standardMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice)
	{
<span class="pc bpc" id="L15092" title="3 of 6 branches missed.">		if (null == valParams || null == csqs || null == wi || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L15093" title="1 of 2 branches missed.">			(dblPrice))</span>
<span class="nc" id="L15094">			return null;</span>

<span class="fc" id="L15096">		int iWorkoutDate = wi.date();</span>

<span class="fc" id="L15098">		double dblWorkoutYield = wi.yield();</span>

<span class="fc" id="L15100">		double dblWorkoutFactor = wi.factor();</span>

<span class="pc bpc" id="L15102" title="1 of 2 branches missed.">		if (valParams.valueDate() &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L15104">		double dblASW = java.lang.Double.NaN;</span>
<span class="fc" id="L15105">		double dblPECS = java.lang.Double.NaN;</span>
<span class="fc" id="L15106">		double dblGSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15107">		double dblISpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15108">		double dblYield01 = java.lang.Double.NaN;</span>
<span class="fc" id="L15109">		double dblZSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15110">		double dblOASpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15111">		double dblBondBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15112">		double dblConvexity = java.lang.Double.NaN;</span>
<span class="fc" id="L15113">		double dblTSYSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15114">		double dblCreditBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15115">		double dblDiscountMargin = java.lang.Double.NaN;</span>
<span class="fc" id="L15116">		double dblMacaulayDuration = java.lang.Double.NaN;</span>
<span class="fc" id="L15117">		double dblModifiedDuration = java.lang.Double.NaN;</span>

		try {
<span class="fc" id="L15120">			dblDiscountMargin = discountMarginFromYield (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblWorkoutYield);
<span class="nc" id="L15122">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15124">		}</span>

<span class="fc bfc" id="L15126" title="All 2 branches covered.">		if (null == _floaterSetting) {</span>
			try {
<span class="fc" id="L15128">				dblZSpread = zSpreadFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
					dblPrice);
<span class="nc" id="L15130">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15132">			}</span>
		}

		try {
<span class="fc" id="L15136">			dblOASpread = oasFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15137">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15139">		}</span>

		try {
<span class="fc" id="L15142">			dblISpread = iSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15144">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15146">		}</span>

		try {
<span class="fc" id="L15149">			dblGSpread = gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15151">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15153">		}</span>

		try {
<span class="fc" id="L15156">			dblTSYSpread = tsySpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15158">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15160">		}</span>

		try {
<span class="fc" id="L15163">			dblMacaulayDuration = macaulayDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15165">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15167">		}</span>

		try {
<span class="fc" id="L15170">			dblModifiedDuration = modifiedDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15172">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15174">		}</span>

		try {
<span class="fc" id="L15177">			dblASW = aswFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15178">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15180">		}</span>

		try {
<span class="fc" id="L15183">			dblConvexity = convexityFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="nc" id="L15185">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15187">		}</span>

		try {
<span class="fc" id="L15190">			dblCreditBasis = creditBasisFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="fc" id="L15192">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15194">		}</span>

		try {
			// dblPECS = pecsFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);
		} catch (java.lang.Exception e) {
			if (!s_bSuppressErrors) e.printStackTrace();
		}

		try {
<span class="fc" id="L15203">			dblBondBasis = bondBasisFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15205">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15207">		}</span>

		try {
<span class="fc" id="L15210">			dblYield01 = yield01FromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15212">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15214">		}</span>

		try {
<span class="fc" id="L15217">			return new org.drip.analytics.output.BondRVMeasures (dblPrice, dblBondBasis, dblZSpread,</span>
				dblGSpread, dblISpread, dblOASpread, dblTSYSpread, dblDiscountMargin, dblASW, dblCreditBasis,
					dblPECS, dblYield01, dblModifiedDuration, dblMacaulayDuration, dblConvexity, wi);
<span class="nc" id="L15220">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L15224">		return null;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; value (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="pc bpc" id="L15233" title="2 of 4 branches missed.">		if (null == valParams || null == csqs) return null;</span>

<span class="fc bfc" id="L15235" title="All 2 branches covered.">		if (null != pricerParams) {</span>
<span class="fc" id="L15236">			org.drip.param.definition.CalibrationParams calibParams = pricerParams.calibParams();</span>

<span class="fc bfc" id="L15238" title="All 2 branches covered.">			if (null != calibParams) {</span>
<span class="fc" id="L15239">				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures =</span>
<span class="fc" id="L15240">					calibMeasures (valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15242" title="2 of 4 branches missed.">				if (null != mapCalibMeasures &amp;&amp; mapCalibMeasures.containsKey (calibParams.measure()))</span>
<span class="fc" id="L15243">					return mapCalibMeasures;</span>
			}
		}

<span class="fc" id="L15247">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = fairMeasures</span>
<span class="fc" id="L15248">			(valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15250" title="1 of 2 branches missed.">		if (null == mapMeasures) return null;</span>

<span class="fc" id="L15252">		java.lang.String strName = name();</span>

<span class="fc" id="L15254">		org.drip.param.definition.ProductQuote pq = csqs.productQuote (strName);</span>

<span class="fc bfc" id="L15256" title="All 2 branches covered.">		if (null == pq) return mapMeasures;</span>

<span class="fc" id="L15258">		int iMaturityDate = maturityDate().julian();</span>

<span class="pc bpc" id="L15260" title="1 of 2 branches missed.">		if (null == _floaterSetting) {</span>
<span class="fc" id="L15261">			double dblParSpread = (mapMeasures.get (&quot;FairDirtyPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15262">				mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairDirtyDV01&quot;);</span>

<span class="fc" id="L15264">			mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15266">			mapMeasures.put (&quot;FairParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15267">		} else {</span>
<span class="nc bnc" id="L15268" title="All 2 branches missed.">			double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15269">				mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15270">					(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15272">			double dblZeroDiscountMargin = (mapMeasures.get (&quot;FairCleanPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15273">				dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15274">					(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15276">			mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15278">			mapMeasures.put (&quot;FairZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
		}

<span class="fc" id="L15281">		org.drip.param.valuation.WorkoutInfo wiMarket = null;</span>

<span class="pc bpc" id="L15283" title="1 of 2 branches missed.">		if (pq.containsQuote (&quot;Price&quot;)) {</span>
<span class="fc" id="L15284">			double dblMarketPrice = pq.quote (&quot;Price&quot;).value (&quot;mid&quot;);</span>

<span class="fc" id="L15286">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblMarketPrice);</span>

<span class="fc" id="L15288">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblMarketPrice);</span>
<span class="pc bnc" id="L15289" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CleanPrice&quot;)) {</span>
<span class="nc" id="L15290">			double dblCleanMarketPrice = pq.quote (&quot;CleanPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15292">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblCleanMarketPrice);</span>

<span class="nc" id="L15294">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblCleanMarketPrice);</span>
<span class="nc bnc" id="L15295" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;QuotedMargin&quot;)) {</span>
<span class="nc" id="L15296">			double dblQuotedMargin = pq.quote (&quot;QuotedMargin&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15298">			mapMeasures.put (&quot;MarketInputType=QuotedMargin&quot;, dblQuotedMargin);</span>

			try {
<span class="nc" id="L15301">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, priceFromDiscountMargin (valParams,</span>
					csqs, vcp, dblQuotedMargin));
<span class="nc" id="L15303">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15305">			}</span>
<span class="nc bnc" id="L15306" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;DirtyPrice&quot;)) {</span>
			try {
<span class="nc" id="L15308">				double dblDirtyMarketPrice = pq.quote (&quot;DirtyPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15310">				mapMeasures.put (&quot;MarketInputType=DirtyPrice&quot;, dblDirtyMarketPrice);</span>

<span class="nc" id="L15312">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblDirtyMarketPrice - accrued</span>
<span class="nc" id="L15313">					(valParams.valueDate(), csqs));</span>
<span class="nc" id="L15314">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15317">				wiMarket = null;</span>
<span class="nc" id="L15318">			}</span>
<span class="nc bnc" id="L15319" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;TSYSpread&quot;)) {</span>
			try {
<span class="nc" id="L15321">				double dblTSYSpread = pq.quote (&quot;TSYSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15323">				mapMeasures.put (&quot;MarketInputType=TSYSpread&quot;, dblTSYSpread);</span>

<span class="nc" id="L15325">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, treasuryBenchmarkYield</span>
<span class="nc" id="L15326">					(valParams, csqs, iMaturityDate) + dblTSYSpread, 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15328">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15331">				wiMarket = null;</span>
<span class="nc" id="L15332">			}</span>
<span class="nc bnc" id="L15333" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;Yield&quot;)) {</span>
			try {
<span class="nc" id="L15335">				double dblYield = pq.quote (&quot;Yield&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15337">				mapMeasures.put (&quot;MarketInputType=Yield&quot;, dblYield);</span>

<span class="nc" id="L15339">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, dblYield, 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15341">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15344">				wiMarket = null;</span>
<span class="nc" id="L15345">			}</span>
<span class="nc bnc" id="L15346" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ZSpread&quot;)) {</span>
			try {
<span class="nc" id="L15348">				double dblZSpread = pq.quote (&quot;ZSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15350">				mapMeasures.put (&quot;MarketInputType=ZSpread&quot;, dblZSpread);</span>

<span class="nc" id="L15352">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromZSpread</span>
<span class="nc" id="L15353">					(valParams, csqs, vcp, dblZSpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15355">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15358">				wiMarket = null;</span>
<span class="nc" id="L15359">			}</span>
<span class="nc bnc" id="L15360" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ISpread&quot;)) {</span>
			try {
<span class="nc" id="L15362">				double dblISpread = pq.quote (&quot;ISpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15364">				mapMeasures.put (&quot;MarketInputType=ISpread&quot;, dblISpread);</span>

<span class="nc" id="L15366">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromISpread</span>
<span class="nc" id="L15367">					(valParams, csqs, vcp, dblISpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15369">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15372">				wiMarket = null;</span>
<span class="nc" id="L15373">			}</span>
<span class="nc bnc" id="L15374" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CreditBasis&quot;)) {</span>
			try {
<span class="nc" id="L15376">				double dblCreditBasis = pq.quote (&quot;CreditBasis&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15378">				mapMeasures.put (&quot;MarketInputType=CreditBasis&quot;, dblCreditBasis);</span>

<span class="nc" id="L15380">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromCreditBasis</span>
<span class="nc" id="L15381">					(valParams, csqs, vcp, dblCreditBasis), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15383">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15386">				wiMarket = null;</span>
<span class="nc" id="L15387">			}</span>
<span class="nc bnc" id="L15388" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;PECS&quot;)) {</span>
			try {
<span class="nc" id="L15390">				double dblCreditBasis = pq.quote (&quot;PECS&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15392">				mapMeasures.put (&quot;MarketInputType=PECS&quot;, dblCreditBasis);</span>

<span class="nc" id="L15394">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPECS (valParams,</span>
					csqs, vcp, dblCreditBasis), 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15396">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15399">				wiMarket = null;</span>
<span class="nc" id="L15400">			}</span>
		}

<span class="pc bpc" id="L15403" title="1 of 2 branches missed.">		if (null != wiMarket) {</span>
<span class="fc" id="L15404">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapWorkoutMeasures =</span>
<span class="fc" id="L15405">				marketMeasures (valParams, pricerParams, csqs, vcp, wiMarket);</span>

<span class="pc bpc" id="L15407" title="1 of 2 branches missed.">			if (null == _floaterSetting) {</span>
<span class="fc" id="L15408">				double dblParSpread = (mapWorkoutMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15409">					mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairCleanDV01&quot;);</span>

<span class="fc" id="L15411">				mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15413">				mapMeasures.put (&quot;MarketParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15414">			} else {</span>
<span class="nc bnc" id="L15415" title="All 2 branches missed.">				double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15416">					mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15417">						(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15419">				double dblZeroDiscountMargin = (mapMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15420">					dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15421">						(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15423">				mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15425">				mapMeasures.put (&quot;MarketZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
			}

<span class="fc" id="L15428">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapWorkoutMeasures);</span>

<span class="fc" id="L15430">			org.drip.state.credit.CreditCurve cc = csqs.creditState (creditLabel());</span>

<span class="pc bpc" id="L15432" title="1 of 2 branches missed.">			if (null != mapMeasures.get (&quot;FairYield&quot;)) {</span>
<span class="fc" id="L15433">				org.drip.param.market.CurveSurfaceQuoteContainer csqsMarket =</span>
					org.drip.param.creator.MarketParamsBuilder.Create
<span class="fc" id="L15435">						((org.drip.state.discount.MergedDiscountForwardCurve) csqs.fundingState</span>
<span class="fc" id="L15436">							(fundingLabel()).parallelShiftQuantificationMetric (wiMarket.yield() -</span>
<span class="fc" id="L15437">								mapMeasures.get (&quot;FairYield&quot;)), csqs.govvieState (govvieLabel()), cc,</span>
<span class="fc" id="L15438">									strName, csqs.productQuote (strName), csqs.quoteMap(), csqs.fixings());</span>

<span class="pc bpc" id="L15440" title="1 of 2 branches missed.">				if (null != csqsMarket) {</span>
<span class="fc" id="L15441">					org.drip.analytics.output.BondWorkoutMeasures bwmMarket = workoutMeasures (valParams,</span>
<span class="fc" id="L15442">						pricerParams, csqsMarket, wiMarket.date(), wiMarket.factor());</span>

<span class="pc bpc" id="L15444" title="1 of 2 branches missed.">					if (null != bwmMarket) {</span>
<span class="nc" id="L15445">						org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMarketMeasures</span>
<span class="nc" id="L15446">							= bwmMarket.toMap (&quot;&quot;);</span>

<span class="nc" id="L15448">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMarketMeasures,</span>
<span class="nc" id="L15449">							org.drip.quant.common.CollectionUtil.PrefixKeys (mapMarketMeasures, &quot;Market&quot;));</span>

<span class="nc" id="L15451">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapMarketMeasures);</span>
					}
				}
			}
		}

<span class="fc" id="L15457">		return mapMeasures;</span>
	}

	@Override public java.util.Set&lt;java.lang.String&gt; measureNames()
	{
<span class="nc" id="L15462">		java.util.Set&lt;java.lang.String&gt; setstrMeasureNames = new java.util.TreeSet&lt;java.lang.String&gt;();</span>

<span class="nc" id="L15464">		setstrMeasureNames.add (&quot;Accrued&quot;);</span>

<span class="nc" id="L15466">		setstrMeasureNames.add (&quot;Accrued01&quot;);</span>

<span class="nc" id="L15468">		setstrMeasureNames.add (&quot;AssetSwapSpread&quot;);</span>

<span class="nc" id="L15470">		setstrMeasureNames.add (&quot;ASW&quot;);</span>

<span class="nc" id="L15472">		setstrMeasureNames.add (&quot;BondBasis&quot;);</span>

<span class="nc" id="L15474">		setstrMeasureNames.add (&quot;CleanCouponPV&quot;);</span>

<span class="nc" id="L15476">		setstrMeasureNames.add (&quot;CleanDV01&quot;);</span>

<span class="nc" id="L15478">		setstrMeasureNames.add (&quot;CleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15480">		setstrMeasureNames.add (&quot;CleanPrice&quot;);</span>

<span class="nc" id="L15482">		setstrMeasureNames.add (&quot;CleanPV&quot;);</span>

<span class="nc" id="L15484">		setstrMeasureNames.add (&quot;Convexity&quot;);</span>

<span class="nc" id="L15486">		setstrMeasureNames.add (&quot;CreditRisklessParPV&quot;);</span>

<span class="nc" id="L15488">		setstrMeasureNames.add (&quot;CreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15490">		setstrMeasureNames.add (&quot;CreditRiskyParPV&quot;);</span>

<span class="nc" id="L15492">		setstrMeasureNames.add (&quot;CreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15494">		setstrMeasureNames.add (&quot;CreditBasis&quot;);</span>

<span class="nc" id="L15496">		setstrMeasureNames.add (&quot;DiscountMargin&quot;);</span>

<span class="nc" id="L15498">		setstrMeasureNames.add (&quot;DefaultExposure&quot;);</span>

<span class="nc" id="L15500">		setstrMeasureNames.add (&quot;DefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15502">		setstrMeasureNames.add (&quot;DirtyCouponPV&quot;);</span>

<span class="nc" id="L15504">		setstrMeasureNames.add (&quot;DirtyDV01&quot;);</span>

<span class="nc" id="L15506">		setstrMeasureNames.add (&quot;DirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15508">		setstrMeasureNames.add (&quot;DirtyPrice&quot;);</span>

<span class="nc" id="L15510">		setstrMeasureNames.add (&quot;DirtyPV&quot;);</span>

<span class="nc" id="L15512">		setstrMeasureNames.add (&quot;Duration&quot;);</span>

<span class="nc" id="L15514">		setstrMeasureNames.add (&quot;DV01&quot;);</span>

<span class="nc" id="L15516">		setstrMeasureNames.add (&quot;ExpectedRecovery&quot;);</span>

<span class="nc" id="L15518">		setstrMeasureNames.add (&quot;FairAccrued&quot;);</span>

<span class="nc" id="L15520">		setstrMeasureNames.add (&quot;FairAccrued01&quot;);</span>

<span class="nc" id="L15522">		setstrMeasureNames.add (&quot;FairAssetSwapSpread&quot;);</span>

<span class="nc" id="L15524">		setstrMeasureNames.add (&quot;FairASW&quot;);</span>

<span class="nc" id="L15526">		setstrMeasureNames.add (&quot;FairBondBasis&quot;);</span>

<span class="nc" id="L15528">		setstrMeasureNames.add (&quot;FairCleanCouponPV&quot;);</span>

<span class="nc" id="L15530">		setstrMeasureNames.add (&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15532">		setstrMeasureNames.add (&quot;FairCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15534">		setstrMeasureNames.add (&quot;FairCleanPrice&quot;);</span>

<span class="nc" id="L15536">		setstrMeasureNames.add (&quot;FairCleanPV&quot;);</span>

<span class="nc" id="L15538">		setstrMeasureNames.add (&quot;FairConvexity&quot;);</span>

<span class="nc" id="L15540">		setstrMeasureNames.add (&quot;FairCreditBasis&quot;);</span>

<span class="nc" id="L15542">		setstrMeasureNames.add (&quot;FairCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15544">		setstrMeasureNames.add (&quot;FairCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15546">		setstrMeasureNames.add (&quot;FairCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15548">		setstrMeasureNames.add (&quot;FairCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15550">		setstrMeasureNames.add (&quot;FairDefaultExposure&quot;);</span>

<span class="nc" id="L15552">		setstrMeasureNames.add (&quot;FairDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15554">		setstrMeasureNames.add (&quot;FairDirtyCouponPV&quot;);</span>

<span class="nc" id="L15556">		setstrMeasureNames.add (&quot;FairDirtyDV01&quot;);</span>

<span class="nc" id="L15558">		setstrMeasureNames.add (&quot;FairDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15560">		setstrMeasureNames.add (&quot;FairDirtyPrice&quot;);</span>

<span class="nc" id="L15562">		setstrMeasureNames.add (&quot;FairDirtyPV&quot;);</span>

<span class="nc" id="L15564">		setstrMeasureNames.add (&quot;FairDiscountMargin&quot;);</span>

<span class="nc" id="L15566">		setstrMeasureNames.add (&quot;FairDuration&quot;);</span>

<span class="nc" id="L15568">		setstrMeasureNames.add (&quot;FairDV01&quot;);</span>

<span class="nc" id="L15570">		setstrMeasureNames.add (&quot;FairExpectedRecovery&quot;);</span>

<span class="nc" id="L15572">		setstrMeasureNames.add (&quot;FairFirstIndexRate&quot;);</span>

<span class="nc" id="L15574">		setstrMeasureNames.add (&quot;FairGSpread&quot;);</span>

<span class="nc" id="L15576">		setstrMeasureNames.add (&quot;FairISpread&quot;);</span>

<span class="nc" id="L15578">		setstrMeasureNames.add (&quot;FairLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15580">		setstrMeasureNames.add (&quot;FairMacaulayDuration&quot;);</span>

<span class="nc" id="L15582">		setstrMeasureNames.add (&quot;FairModifiedDuration&quot;);</span>

<span class="nc" id="L15584">		setstrMeasureNames.add (&quot;FairOAS&quot;);</span>

<span class="nc" id="L15586">		setstrMeasureNames.add (&quot;FairOASpread&quot;);</span>

<span class="nc" id="L15588">		setstrMeasureNames.add (&quot;FairOptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15590">		setstrMeasureNames.add (&quot;FairParPV&quot;);</span>

<span class="nc" id="L15592">		setstrMeasureNames.add (&quot;FairParSpread&quot;);</span>

<span class="nc" id="L15594">		setstrMeasureNames.add (&quot;FairPECS&quot;);</span>

<span class="nc" id="L15596">		setstrMeasureNames.add (&quot;FairPrice&quot;);</span>

<span class="nc" id="L15598">		setstrMeasureNames.add (&quot;FairPrincipalPV&quot;);</span>

<span class="nc" id="L15600">		setstrMeasureNames.add (&quot;FairPV&quot;);</span>

<span class="nc" id="L15602">		setstrMeasureNames.add (&quot;FairRecoveryPV&quot;);</span>

<span class="nc" id="L15604">		setstrMeasureNames.add (&quot;FairRisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15606">		setstrMeasureNames.add (&quot;FairRisklessCleanDV01&quot;);</span>

<span class="nc" id="L15608">		setstrMeasureNames.add (&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15610">		setstrMeasureNames.add (&quot;FairRisklessCleanPV&quot;);</span>

<span class="nc" id="L15612">		setstrMeasureNames.add (&quot;FairRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15614">		setstrMeasureNames.add (&quot;FairRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15616">		setstrMeasureNames.add (&quot;FairRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15618">		setstrMeasureNames.add (&quot;FairRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15620">		setstrMeasureNames.add (&quot;FairRiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15622">		setstrMeasureNames.add (&quot;FairRiskyCleanDV01&quot;);</span>

<span class="nc" id="L15624">		setstrMeasureNames.add (&quot;FairRiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15626">		setstrMeasureNames.add (&quot;FairRiskyCleanPV&quot;);</span>

<span class="nc" id="L15628">		setstrMeasureNames.add (&quot;FairRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15630">		setstrMeasureNames.add (&quot;FairRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15632">		setstrMeasureNames.add (&quot;FairRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15634">		setstrMeasureNames.add (&quot;FairRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15636">		setstrMeasureNames.add (&quot;FairTSYSpread&quot;);</span>

<span class="nc" id="L15638">		setstrMeasureNames.add (&quot;FairWorkoutDate&quot;);</span>

<span class="nc" id="L15640">		setstrMeasureNames.add (&quot;FairWorkoutFactor&quot;);</span>

<span class="nc" id="L15642">		setstrMeasureNames.add (&quot;FairWorkoutType&quot;);</span>

<span class="nc" id="L15644">		setstrMeasureNames.add (&quot;FairWorkoutYield&quot;);</span>

<span class="nc" id="L15646">		setstrMeasureNames.add (&quot;FairYield&quot;);</span>

<span class="nc" id="L15648">		setstrMeasureNames.add (&quot;FairYield01&quot;);</span>

<span class="nc" id="L15650">		setstrMeasureNames.add (&quot;FairYieldBasis&quot;);</span>

<span class="nc" id="L15652">		setstrMeasureNames.add (&quot;FairYieldSpread&quot;);</span>

<span class="nc" id="L15654">		setstrMeasureNames.add (&quot;FairZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15656">		setstrMeasureNames.add (&quot;FairZSpread&quot;);</span>

<span class="nc" id="L15658">		setstrMeasureNames.add (&quot;FirstCouponRate&quot;);</span>

<span class="nc" id="L15660">		setstrMeasureNames.add (&quot;FirstIndexRate&quot;);</span>

<span class="nc" id="L15662">		setstrMeasureNames.add (&quot;GSpread&quot;);</span>

<span class="nc" id="L15664">		setstrMeasureNames.add (&quot;ISpread&quot;);</span>

<span class="nc" id="L15666">		setstrMeasureNames.add (&quot;LossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15668">		setstrMeasureNames.add (&quot;MacaulayDuration&quot;);</span>

<span class="nc" id="L15670">		setstrMeasureNames.add (&quot;MarketAccrued&quot;);</span>

<span class="nc" id="L15672">		setstrMeasureNames.add (&quot;MarketAccrued01&quot;);</span>

<span class="nc" id="L15674">		setstrMeasureNames.add (&quot;MarketCleanCouponPV&quot;);</span>

<span class="nc" id="L15676">		setstrMeasureNames.add (&quot;MarketCleanDV01&quot;);</span>

<span class="nc" id="L15678">		setstrMeasureNames.add (&quot;MarketCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15680">		setstrMeasureNames.add (&quot;MarketCleanPrice&quot;);</span>

<span class="nc" id="L15682">		setstrMeasureNames.add (&quot;MarketCleanPV&quot;);</span>

<span class="nc" id="L15684">		setstrMeasureNames.add (&quot;MarketCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15686">		setstrMeasureNames.add (&quot;MarketCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15688">		setstrMeasureNames.add (&quot;MarketCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15690">		setstrMeasureNames.add (&quot;MarketCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15692">		setstrMeasureNames.add (&quot;MarketDefaultExposure&quot;);</span>

<span class="nc" id="L15694">		setstrMeasureNames.add (&quot;MarketDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15696">		setstrMeasureNames.add (&quot;MarketDirtyCouponPV&quot;);</span>

<span class="nc" id="L15698">		setstrMeasureNames.add (&quot;MarketDirtyDV01&quot;);</span>

<span class="nc" id="L15700">		setstrMeasureNames.add (&quot;MarketDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15702">		setstrMeasureNames.add (&quot;MarketDirtyPrice&quot;);</span>

<span class="nc" id="L15704">		setstrMeasureNames.add (&quot;MarketDirtyPV&quot;);</span>

<span class="nc" id="L15706">		setstrMeasureNames.add (&quot;MarketDV01&quot;);</span>

<span class="nc" id="L15708">		setstrMeasureNames.add (&quot;MarketExpectedRecovery&quot;);</span>

<span class="nc" id="L15710">		setstrMeasureNames.add (&quot;MarketFirstCouponRate&quot;);</span>

<span class="nc" id="L15712">		setstrMeasureNames.add (&quot;MarketFirstIndexRate&quot;);</span>

<span class="nc" id="L15714">		setstrMeasureNames.add (&quot;MarketInputType=CleanPrice&quot;);</span>

<span class="nc" id="L15716">		setstrMeasureNames.add (&quot;MarketInputType=CreditBasis&quot;);</span>

<span class="nc" id="L15718">		setstrMeasureNames.add (&quot;MarketInputType=DirtyPrice&quot;);</span>

<span class="nc" id="L15720">		setstrMeasureNames.add (&quot;MarketInputType=GSpread&quot;);</span>

<span class="nc" id="L15722">		setstrMeasureNames.add (&quot;MarketInputType=ISpread&quot;);</span>

<span class="nc" id="L15724">		setstrMeasureNames.add (&quot;MarketInputType=PECS&quot;);</span>

<span class="nc" id="L15726">		setstrMeasureNames.add (&quot;MarketInputType=QuotedMargin&quot;);</span>

<span class="nc" id="L15728">		setstrMeasureNames.add (&quot;MarketInputType=TSYSpread&quot;);</span>

<span class="nc" id="L15730">		setstrMeasureNames.add (&quot;MarketInputType=Yield&quot;);</span>

<span class="nc" id="L15732">		setstrMeasureNames.add (&quot;MarketInputType=ZSpread&quot;);</span>

<span class="nc" id="L15734">		setstrMeasureNames.add (&quot;MarketLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15736">		setstrMeasureNames.add (&quot;MarketParPV&quot;);</span>

<span class="nc" id="L15738">		setstrMeasureNames.add (&quot;MarketPrincipalPV&quot;);</span>

<span class="nc" id="L15740">		setstrMeasureNames.add (&quot;MarketPV&quot;);</span>

<span class="nc" id="L15742">		setstrMeasureNames.add (&quot;MarketRecoveryPV&quot;);</span>

<span class="nc" id="L15744">		setstrMeasureNames.add (&quot;MarketRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15746">		setstrMeasureNames.add (&quot;MarketRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15748">		setstrMeasureNames.add (&quot;MarketRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15750">		setstrMeasureNames.add (&quot;MarketRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15752">		setstrMeasureNames.add (&quot;MarketRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15754">		setstrMeasureNames.add (&quot;MarketRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15756">		setstrMeasureNames.add (&quot;MarketRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15758">		setstrMeasureNames.add (&quot;MarketRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15760">		setstrMeasureNames.add (&quot;ModifiedDuration&quot;);</span>

<span class="nc" id="L15762">		setstrMeasureNames.add (&quot;OAS&quot;);</span>

<span class="nc" id="L15764">		setstrMeasureNames.add (&quot;OASpread&quot;);</span>

<span class="nc" id="L15766">		setstrMeasureNames.add (&quot;OptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15768">		setstrMeasureNames.add (&quot;ParEquivalentCDSSpread&quot;);</span>

<span class="nc" id="L15770">		setstrMeasureNames.add (&quot;ParPV&quot;);</span>

<span class="nc" id="L15772">		setstrMeasureNames.add (&quot;ParSpread&quot;);</span>

<span class="nc" id="L15774">		setstrMeasureNames.add (&quot;PECS&quot;);</span>

<span class="nc" id="L15776">		setstrMeasureNames.add (&quot;Price&quot;);</span>

<span class="nc" id="L15778">		setstrMeasureNames.add (&quot;PrincipalPV&quot;);</span>

<span class="nc" id="L15780">		setstrMeasureNames.add (&quot;PV&quot;);</span>

<span class="nc" id="L15782">		setstrMeasureNames.add (&quot;RecoveryPV&quot;);</span>

<span class="nc" id="L15784">		setstrMeasureNames.add (&quot;RisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15786">		setstrMeasureNames.add (&quot;RisklessCleanDV01&quot;);</span>

<span class="nc" id="L15788">		setstrMeasureNames.add (&quot;RisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15790">		setstrMeasureNames.add (&quot;RisklessCleanPV&quot;);</span>

<span class="nc" id="L15792">		setstrMeasureNames.add (&quot;RisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15794">		setstrMeasureNames.add (&quot;RisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15796">		setstrMeasureNames.add (&quot;RisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15798">		setstrMeasureNames.add (&quot;RisklessDirtyPV&quot;);</span>

<span class="nc" id="L15800">		setstrMeasureNames.add (&quot;RiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15802">		setstrMeasureNames.add (&quot;RiskyCleanDV01&quot;);</span>

<span class="nc" id="L15804">		setstrMeasureNames.add (&quot;RiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15806">		setstrMeasureNames.add (&quot;RiskyCleanPV&quot;);</span>

<span class="nc" id="L15808">		setstrMeasureNames.add (&quot;RiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15810">		setstrMeasureNames.add (&quot;RiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15812">		setstrMeasureNames.add (&quot;RiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15814">		setstrMeasureNames.add (&quot;RiskyDirtyPV&quot;);</span>

<span class="nc" id="L15816">		setstrMeasureNames.add (&quot;TSYSpread&quot;);</span>

<span class="nc" id="L15818">		setstrMeasureNames.add (&quot;WorkoutDate&quot;);</span>

<span class="nc" id="L15820">		setstrMeasureNames.add (&quot;WorkoutFactor&quot;);</span>

<span class="nc" id="L15822">		setstrMeasureNames.add (&quot;WorkoutType&quot;);</span>

<span class="nc" id="L15824">		setstrMeasureNames.add (&quot;WorkoutYield&quot;);</span>

<span class="nc" id="L15826">		setstrMeasureNames.add (&quot;Yield&quot;);</span>

<span class="nc" id="L15828">		setstrMeasureNames.add (&quot;Yield01&quot;);</span>

<span class="nc" id="L15830">		setstrMeasureNames.add (&quot;YieldBasis&quot;);</span>

<span class="nc" id="L15832">		setstrMeasureNames.add (&quot;YieldSpread&quot;);</span>

<span class="nc" id="L15834">		setstrMeasureNames.add (&quot;ZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15836">		setstrMeasureNames.add (&quot;ZSpread&quot;);</span>

<span class="nc" id="L15838">		return setstrMeasureNames;</span>
	}

	@Override public double pv (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParamsIn,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15848" title="All 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L15849">			throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc" id="L15851">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L15853">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L15855" title="All 2 branches missed.">		if (null == dcFunding) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15857" title="All 2 branches missed.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="nc bnc" id="L15859" title="All 2 branches missed.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="nc" id="L15860">			_creditSetting.recovery();</span>

<span class="nc bnc" id="L15862" title="All 2 branches missed.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="nc bnc" id="L15864" title="All 2 branches missed.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="nc" id="L15866">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc" id="L15868">		double dblRecoveryPV = 0.;</span>
<span class="nc" id="L15869">		double dblPrincipalPV = 0.;</span>
<span class="nc" id="L15870">		double dblDirtyCouponPV = 0.;</span>
<span class="nc" id="L15871">		boolean bApplyFlatForwardRate = false;</span>
<span class="nc" id="L15872">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L15874" title="All 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L15875">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="nc bnc" id="L15877" title="All 2 branches missed.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="nc" id="L15878">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L15880" title="All 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="nc" id="L15883">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc bnc" id="L15885" title="All 2 branches missed.">		org.drip.param.pricer.CreditPricerParams pricerParams = null != pricerParamsIn ? pricerParamsIn : new</span>
			org.drip.param.pricer.CreditPricerParams (7, null, false,
				org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_FULL_COUPON);

<span class="nc bnc" id="L15889" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L15890">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L15892" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L15894">			int iPeriodEndDate = period.endDate();</span>

<span class="nc" id="L15896">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L15898">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L15901" title="All 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15903" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L15904">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L15906" title="All 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="nc" id="L15908">			double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="nc" id="L15910">			double dblPeriodDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) * dblPeriodAnnuity *</span>
<span class="nc" id="L15911">				notional (iPeriodStartDate);</span>

<span class="nc" id="L15913">			double dblPeriodPrincipalPV = (notional (iPeriodStartDate) - notional (iPeriodEndDate)) *</span>
				dblPeriodAnnuity;

<span class="nc bnc" id="L15916" title="All 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L15917" title="All 2 branches missed.">				double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
					iPeriodEndDate);

<span class="nc" id="L15920">				dblPeriodDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L15921">				dblPeriodPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L15923" title="All 2 branches missed.">				for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
					valParams, pricerParams, iMaturityDate, csqc)) {
<span class="nc bnc" id="L15925" title="All 2 branches missed.">					if (null == lqm) continue;</span>

<span class="nc" id="L15927">					int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L15929">					int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L15931">					double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
						iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L15934">					double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L15936">					double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L15937">						(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L15939" title="All 2 branches missed.">					if (bAccrualOnDefault)</span>
<span class="nc" id="L15940">						dblPeriodDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival *</span>
							dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L15943" title="All 2 branches missed.">					dblRecoveryPV += (bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
						iSubPeriodEndDate) : dblProductRecovery) * dblSubPeriodSurvival *
							dblSubPeriodNotional * dblSubPeriodDF;
<span class="nc" id="L15946">				}</span>
			}

<span class="nc" id="L15949">			dblPrincipalPV += dblPeriodPrincipalPV;</span>

<span class="nc" id="L15951">			dblDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblPeriodDirtyDV01;
<span class="nc" id="L15953">		}</span>

<span class="nc" id="L15955">		double dblParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate);</span>

<span class="nc bnc" id="L15957" title="All 4 branches missed.">		if (null != cc &amp;&amp; null != pricerParams) dblParPV *= cc.survival (iMaturityDate);</span>

<span class="nc bnc" id="L15959" title="All 2 branches missed.">		return (dblDirtyCouponPV + dblPrincipalPV + dblParPV + dblRecoveryPV) / dcFunding.df (null !=</span>
<span class="nc" id="L15960">			_quoteConvention ? _quoteConvention.settleDate (valParams) : valParams.cashPayDate());</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian jackDDirtyPVDManifestMeasure (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15969">		return null;</span>
	}

	@Override public org.drip.product.calib.ProductQuoteSet calibQuoteSet (
		final org.drip.state.representation.LatentStateSpecification[] aLSS)
	{
<span class="nc" id="L15975">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15985">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint forwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15995">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingForwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16005">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fxPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16015">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint govviePRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16025">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint volatilityPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16035">		return null;</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian manifestMeasureDFMicroJack (
		final java.lang.String strManifestMeasure,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L16045">		return null;</span>
	}

	/**
	 * The BondCalibrator implements a calibrator that calibrates the yield, the credit basis, or the Z
	 * 		Spread for the bond given the price input. Calibration happens via either Newton-Raphson method,
	 * 		or via bracketing/root searching.
	 * 
	 * @author Lakshmi Krishnamurthy
	 *
	 */

	public class BondCalibrator {
<span class="fc" id="L16058">		private BondComponent _bond = null;</span>
<span class="fc" id="L16059">		private boolean _bApplyCouponExtension = false;</span>

		/**
		 * Constructor: Construct the calibrator from the parent bond.
		 * 
		 * @param bond Parent
		 * @param bApplyCouponExtension TRUE - Apply the Coupon Extension
		 * 
		 * @throws java.lang.Exception Thrown if the inputs are invalid
		 */

		public BondCalibrator (
			final BondComponent bond,
			final boolean bApplyCouponExtension)
			throws java.lang.Exception
<span class="fc" id="L16074">		{</span>
<span class="pc bpc" id="L16075" title="1 of 2 branches missed.">			if (null == (_bond = bond))</span>
<span class="nc" id="L16076">				throw new java.lang.Exception (&quot;BondComponent::BondCalibrator ctr =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L16078">			_bApplyCouponExtension = bApplyCouponExtension;</span>
<span class="fc" id="L16079">		}</span>

		/**
		 * Calibrate the bond yield from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Yield
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibrateYieldFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16105" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16106">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16109">			org.drip.function.definition.R1ToR1 ofYieldToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16110">				(null) {</span>
				@Override public double evaluate (
					final double dblYield)
					throws java.lang.Exception
				{
<span class="fc" id="L16115">					return _bond.priceFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L16116">						dblYield, _bApplyCouponExtension) - dblPrice;</span>
				}
			};

<span class="fc" id="L16120">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
<span class="fc" id="L16121">				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofYieldToPrice, true).findRoot();</span>

<span class="pc bpc" id="L16123" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16124">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofYieldToPrice,</span>
<span class="nc" id="L16125">					true).findRoot();</span>

<span class="pc bpc" id="L16127" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16128">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofYieldToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16130">						true).findRoot();</span>

<span class="pc bpc" id="L16132" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16133">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16136">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the Z Spread cannot be calibrated
		 */

		public double calibrateZSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16165" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16166">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="pc bpc" id="L16169" title="1 of 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16170">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="fc" id="L16173">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16174">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16179">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16184">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="fc" id="L16186">					true).findRoot();</span>

<span class="pc bpc" id="L16188" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16189">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16190">					true).findRoot();</span>

<span class="pc bpc" id="L16192" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16193">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					new org.drip.function.r1tor1solver.ExecutionControl (ofZSpreadToPrice, new
						org.drip.function.r1tor1solver.ExecutionControlParams (200, false, 1.e-02, 1.e-02,
							1.e-01, 1.e-01)),
								org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16198">									true).findRoot();</span>

<span class="pc bpc" id="L16200" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16201">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16204">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the Bond OAS from the Market Price using the Root Bracketing Technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The Calibrated OAS
		 * 
		 * @throws java.lang.Exception Thrown if the OAS cannot be calibrated
		 */

		public double calibrateOASFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16233" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16234">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16237">			org.drip.function.definition.R1ToR1 r1ToR1OASToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16238">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16243">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16248">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., r1ToR1OASToPrice,
<span class="fc" id="L16250">					true).findRoot();</span>

<span class="pc bpc" id="L16252" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16253">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., r1ToR1OASToPrice,</span>
<span class="fc" id="L16254">					true).findRoot();</span>

<span class="pc bpc" id="L16256" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16257">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., r1ToR1OASToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16259">						true).findRoot();</span>

<span class="pc bpc" id="L16261" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16262">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16265">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the discount
		 * 	curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibDiscCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16291" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16292">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateDiscCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc" id="L16295">			org.drip.function.definition.R1ToR1 ofDiscCurveSpreadToPrice = new</span>
<span class="nc" id="L16296">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16301">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16306">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofDiscCurveSpreadToPrice,
<span class="nc" id="L16308">					true).findRoot();</span>

<span class="nc bnc" id="L16310" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16311">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0.,</span>
<span class="nc" id="L16312">					ofDiscCurveSpreadToPrice, true).findRoot();</span>

<span class="nc bnc" id="L16314" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16315">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0.,</span>
					ofDiscCurveSpreadToPrice, null,
						org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16318">							true).findRoot();</span>

<span class="nc bnc" id="L16320" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16321">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibDiscCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16324">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the Zero Curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibZeroCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16349" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16350">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZeroCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc bnc" id="L16353" title="All 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16354">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibZeroCurveSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="nc" id="L16357">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="nc" id="L16358">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16363">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16368">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="nc" id="L16370">					true).findRoot();</span>

<span class="nc bnc" id="L16372" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16373">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16374">					true).findRoot();</span>

<span class="nc bnc" id="L16376" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16377">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16379">						true).findRoot();</span>

<span class="nc bnc" id="L16381" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16382">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibZeroCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16385">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Credit Basis from the market price
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * @param bFlat TRUE - Calibrate to Flat Curve
		 * 
		 * @return The calibrated Credit Basis
		 * 
		 * @throws java.lang.Exception Thrown if the Credit Basis cannot be calibrated
		 */

		public double calibrateCreditBasisFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice,
			final boolean bFlat)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16412" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16413">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateCreditBasisFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16416">			org.drip.function.definition.R1ToR1 ofCreditBasisToPrice = new</span>
<span class="fc" id="L16417">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblCreditBasis)
					throws java.lang.Exception
				{
<span class="fc" id="L16422">					return _bond.priceFromCreditCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblCreditBasis, bFlat) - dblPrice;
				}
			};

<span class="fc" id="L16427">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofCreditBasisToPrice,
<span class="fc" id="L16429">					true).findRoot();</span>

<span class="pc bpc" id="L16431" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16432">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofCreditBasisToPrice,</span>
<span class="fc" id="L16433">					true).findRoot();</span>

<span class="pc bpc" id="L16435" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16436">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofCreditBasisToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16438">						true).findRoot();</span>

<span class="pc bpc" id="L16440" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16441">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibrateCreditBasisFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16444">			return rfop.getRoot();</span>
		}
	}

	/**
	 * Generate the EOS Callable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics callMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16471" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16473">		org.drip.product.params.EmbeddedOptionSchedule eosCall = callSchedule();</span>

<span class="pc bpc" id="L16475" title="1 of 2 branches missed.">		if (null == eosCall) return null;</span>

<span class="fc" id="L16477">		int iNumDimension = gbs.dimension();</span>

<span class="fc" id="L16479">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L16481">		int[] aiExerciseDate = eosCall.exerciseDates (iValueDate);</span>

<span class="fc" id="L16483">		double[] adblExercisePrice = eosCall.exerciseFactors (iValueDate);</span>

<span class="pc bpc" id="L16485" title="2 of 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="fc" id="L16487">		double dblOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L16488">		int iNumVertex = aiExerciseDate.length;</span>
<span class="fc" id="L16489">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="fc" id="L16490">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="fc" id="L16491">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="fc" id="L16492">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="fc" id="L16493">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="fc" id="L16494">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="fc" id="L16495">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="fc" id="L16496">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="fc" id="L16497">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="fc" id="L16498">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="fc" id="L16499">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="fc" id="L16500">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="fc" id="L16502">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="fc bfc" id="L16505" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="fc bfc" id="L16506" title="All 2 branches covered.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="fc bfc" id="L16507" title="All 2 branches covered.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="pc bpc" id="L16511" title="1 of 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16515">				return null;</span>
<span class="nc" id="L16516">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16517">			e.printStackTrace();</span>

<span class="nc" id="L16519">			return null;</span>
<span class="fc" id="L16520">		}</span>

<span class="fc" id="L16522">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="pc bpc" id="L16524" title="1 of 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="fc" id="L16527">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16528">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16529">			e.printStackTrace();</span>

<span class="nc" id="L16531">			return null;</span>
<span class="fc" id="L16532">		}</span>

<span class="fc bfc" id="L16534" title="All 2 branches covered.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16535">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="pc bpc" id="L16536" title="1 of 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16537">				return null;</span>
		}

<span class="fc" id="L16540">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L16542" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc bfc" id="L16543" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="fc" id="L16545">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="fc" id="L16546">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="fc" id="L16548">				} catch (java.lang.Exception e) {</span>
<span class="fc" id="L16549">					e.printStackTrace();</span>

<span class="fc" id="L16551">					return null;</span>
<span class="fc" id="L16552">				}</span>
			}
		}

<span class="fc bfc" id="L16556" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16557">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="fc" id="L16558">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="fc" id="L16559">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="fc" id="L16561">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="fc bfc" id="L16563" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16564">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="fc" id="L16565">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="fc" id="L16568">					dblExercisePV = (aadblForwardPrice[iPath][iVertex] - adblExercisePrice[iVertex]) *</span>
<span class="fc" id="L16569">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16570">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16571">					e.printStackTrace();</span>
<span class="fc" id="L16572">				}</span>

<span class="fc bfc" id="L16574" title="All 2 branches covered.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="fc" id="L16575">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="fc" id="L16578">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="fc" id="L16579">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="fc" id="L16580">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="fc" id="L16581">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="fc bfc" id="L16586" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16587">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="fc" id="L16590">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16593">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16596">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16598">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16599">				e.printStackTrace();</span>

<span class="nc" id="L16601">				return null;</span>
<span class="fc" id="L16602">			}</span>

<span class="fc" id="L16604">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="fc" id="L16608">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16612">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16613">			e.printStackTrace();</span>
		}

<span class="nc" id="L16616">		return null;</span>
	}

	/**
	 * Generate the EOS Putable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics putMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16642" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16644">		org.drip.product.params.EmbeddedOptionSchedule eosPut = putSchedule();</span>

<span class="pc bpc" id="L16646" title="1 of 2 branches missed.">		if (null == eosPut) return null;</span>

<span class="nc" id="L16648">		int iNumDimension = gbs.dimension();</span>

<span class="nc" id="L16650">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L16652">		int[] aiExerciseDate = eosPut.exerciseDates (iValueDate);</span>

<span class="nc" id="L16654">		double[] adblExercisePrice = eosPut.exerciseFactors (iValueDate);</span>

<span class="nc bnc" id="L16656" title="All 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="nc" id="L16658">		double dblOAS = java.lang.Double.NaN;</span>
<span class="nc" id="L16659">		int iNumVertex = aiExerciseDate.length;</span>
<span class="nc" id="L16660">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="nc" id="L16661">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="nc" id="L16662">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="nc" id="L16663">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="nc" id="L16664">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="nc" id="L16665">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="nc" id="L16666">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="nc" id="L16667">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="nc" id="L16668">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="nc" id="L16669">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="nc" id="L16670">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="nc" id="L16671">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="nc" id="L16673">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="nc bnc" id="L16676" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="nc bnc" id="L16677" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="nc bnc" id="L16678" title="All 2 branches missed.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="nc bnc" id="L16682" title="All 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16686">				return null;</span>
<span class="nc" id="L16687">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16688">			e.printStackTrace();</span>

<span class="nc" id="L16690">			return null;</span>
<span class="nc" id="L16691">		}</span>

<span class="nc" id="L16693">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="nc bnc" id="L16695" title="All 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="nc" id="L16698">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16699">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16700">			e.printStackTrace();</span>

<span class="nc" id="L16702">			return null;</span>
<span class="nc" id="L16703">		}</span>

<span class="nc bnc" id="L16705" title="All 2 branches missed.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16706">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="nc bnc" id="L16707" title="All 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16708">				return null;</span>
		}

<span class="nc" id="L16711">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L16713" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc bnc" id="L16714" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="nc" id="L16716">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="nc" id="L16717">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16719">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16720">					e.printStackTrace();</span>

<span class="nc" id="L16722">					return null;</span>
<span class="nc" id="L16723">				}</span>
			}
		}

<span class="nc bnc" id="L16727" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16728">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="nc" id="L16729">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="nc" id="L16730">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="nc" id="L16732">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="nc bnc" id="L16734" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16735">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="nc" id="L16736">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="nc" id="L16739">					dblExercisePV = (adblExercisePrice[iVertex] - aadblForwardPrice[iPath][iVertex]) *</span>
<span class="nc" id="L16740">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16741">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16742">					e.printStackTrace();</span>
<span class="nc" id="L16743">				}</span>

<span class="nc bnc" id="L16745" title="All 2 branches missed.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="nc" id="L16746">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="nc" id="L16749">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="nc" id="L16750">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="nc" id="L16751">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="nc" id="L16752">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="nc bnc" id="L16757" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16758">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="nc" id="L16761">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16764">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16767">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16769">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16770">				e.printStackTrace();</span>

<span class="nc" id="L16772">				return null;</span>
<span class="nc" id="L16773">			}</span>

<span class="nc" id="L16775">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="nc" id="L16779">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16783">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16784">			e.printStackTrace();</span>
		}

<span class="nc" id="L16787">		return null;</span>
	}

	@Override public void showPeriods()
		throws java.lang.Exception
	{
<span class="nc bnc" id="L16793" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods())</span>
<span class="nc" id="L16794">			System.out.println (&quot;\t&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.startDate()) +</span>
<span class="nc" id="L16795">				&quot;-&gt;&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.endDate()) + &quot;    &quot; +</span>
<span class="nc" id="L16796">					period.accrualDCF (period.endDate()));</span>
<span class="nc" id="L16797">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>