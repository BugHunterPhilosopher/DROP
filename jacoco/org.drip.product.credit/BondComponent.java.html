<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BondComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.product.credit</a> &gt; <span class="el_source">BondComponent.java</span></div><h1>BondComponent.java</h1><pre class="source lang-java linenums">
package org.drip.product.credit;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2019 Lakshmi Krishnamurthy
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * Copyright (C) 2014 Lakshmi Krishnamurthy
 * Copyright (C) 2013 Lakshmi Krishnamurthy
 * Copyright (C) 2012 Lakshmi Krishnamurthy
 * Copyright (C) 2011 Lakshmi Krishnamurthy
 * 
 *  This file is part of DROP, an open-source library targeting risk, transaction costs, exposure, margin
 *  	calculations, and portfolio construction within and across fixed income, credit, commodity, equity,
 *  	FX, and structured products.
 *  
 *  	https://lakshmidrip.github.io/DROP/
 *  
 *  DROP is composed of three main modules:
 *  
 *  - DROP Analytics Core - https://lakshmidrip.github.io/DROP-Analytics-Core/
 *  - DROP Portfolio Core - https://lakshmidrip.github.io/DROP-Portfolio-Core/
 *  - DROP Numerical Core - https://lakshmidrip.github.io/DROP-Numerical-Core/
 * 
 * 	DROP Analytics Core implements libraries for the following:
 * 	- Fixed Income Analytics
 * 	- Asset Backed Analytics
 * 	- XVA Analytics
 * 	- Exposure and Margin Analytics
 * 
 * 	DROP Portfolio Core implements libraries for the following:
 * 	- Asset Allocation Analytics
 * 	- Transaction Cost Analytics
 * 
 * 	DROP Numerical Core implements libraries for the following:
 * 	- Statistical Learning Library
 * 	- Numerical Optimizer Library
 * 	- Machine Learning Library
 * 	- Spline Builder Library
 * 
 * 	Documentation for DROP is Spread Over:
 * 
 * 	- Main                     =&gt; https://lakshmidrip.github.io/DROP/
 * 	- Wiki                     =&gt; https://github.com/lakshmiDRIP/DROP/wiki
 * 	- GitHub                   =&gt; https://github.com/lakshmiDRIP/DROP
 * 	- Javadoc                  =&gt; https://lakshmidrip.github.io/DROP/Javadoc/index.html
 * 	- Technical Specifications =&gt; https://github.com/lakshmiDRIP/DROP/tree/master/Docs/Internal
 * 	- Release Versions         =&gt; https://lakshmidrip.github.io/DROP/version.html
 * 	- Community Credits        =&gt; https://lakshmidrip.github.io/DROP/credits.html
 * 	- Issues Catalog           =&gt; https://github.com/lakshmiDRIP/DROP/issues
 * 	- JUnit                    =&gt; https://lakshmidrip.github.io/DROP/junit/index.html
 * 	- Jacoco                   =&gt; https://lakshmidrip.github.io/DROP/jacoco/index.html
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * &lt;i&gt;BondComponent&lt;/i&gt; is the base class that extends CreditComponent abstract class and implements the
 * functionality behind bonds of all kinds. Bond static data is captured in a set of 11 container classes â€“
 * BondTSYParams, BondCouponParams, BondNotionalParams, BondFloaterParams, BondCurrencyParams,
 * BondIdentifierParams, CompCRValParams, BondCFTerminationEvent, BondFixedPeriodGenerationParams, and one
 * EmbeddedOptionSchedule object instance each for the call and the put objects. Each of these parameter set
 * can be set separately.
 *
 *	&lt;br&gt;&lt;br&gt;
 *  &lt;ul&gt;
 *		&lt;li&gt;&lt;b&gt;Module &lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/AnalyticsCore.md&quot;&gt;Analytics Core Module&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Library&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/FixedIncomeAnalyticsLibrary.md&quot;&gt;Fixed Income Analytics Library&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Project&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/product&quot;&gt;Product&lt;/a&gt;&lt;/li&gt;
 *		&lt;li&gt;&lt;b&gt;Package&lt;/b&gt; = &lt;a href = &quot;https://github.com/lakshmiDRIP/DROP/tree/master/src/main/java/org/drip/product/credit&quot;&gt;Credit&lt;/a&gt;&lt;/li&gt;
 *  &lt;/ul&gt;
 * &lt;br&gt;&lt;br&gt;
 *
 * @author Lakshmi Krishnamurthy
 */

public class BondComponent extends org.drip.product.definition.Bond implements
	org.drip.product.definition.BondProduct
{
	private static final boolean s_bSuppressErrors = true;
	private static final boolean s_bYieldDFOffofCouponAccrualDCF = true;

	/*
	 * Width for calculating local forward rate width
	 */

	private static final int LOCAL_FORWARD_RATE_WIDTH = 1;

	/*
	 * Recovery Period discretization Mode
	 */

	private static final int s_iDiscretizationScheme =
		org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_DAY_STEP;

	/*
	 * Discount Curve to derive the zero curve off of
	 */

	private static final int ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE = 1;
	private static final int ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE = 2;

	/*
	 * Discount Curve to derive Bumped Prices
	 */

	private static final int PRICE_OFF_OF_FUNDING_CURVE = 1;
	private static final int PRICE_OFF_OF_TREASURY_CURVE = 2;
	// private static final int PRICE_OFF_OF_OVERNIGHT_CURVE = 3;

<span class="fc" id="L128">	private org.drip.product.params.BondStream _stream = null;</span>
<span class="fc" id="L129">	private org.drip.product.params.IdentifierSet _idParams = null;</span>
<span class="fc" id="L130">	private org.drip.product.params.CouponSetting _couponSetting = null;</span>
<span class="fc" id="L131">	private org.drip.product.params.CreditSetting _creditSetting = null;</span>
<span class="fc" id="L132">	private org.drip.product.params.FloaterSetting _floaterSetting = null;</span>
<span class="fc" id="L133">	private org.drip.product.params.NotionalSetting _notionalSetting = null;</span>
<span class="fc" id="L134">	private org.drip.product.params.QuoteConvention _quoteConvention = null;</span>
<span class="fc" id="L135">	private org.drip.product.params.TerminationSetting _terminationSetting = null;</span>
<span class="fc" id="L136">	private org.drip.product.params.TreasuryBenchmarks _treasuryBenchmarks = null;</span>

	/*
	 * Bond EOS Params
	 */

<span class="fc" id="L142">	protected org.drip.product.params.EmbeddedOptionSchedule _eosPut = null;</span>
<span class="fc" id="L143">	protected org.drip.product.params.EmbeddedOptionSchedule _eosCall = null;</span>

	private int terminationAdjust (
		final int iDate)
	{
<span class="fc bfc" id="L148" title="All 2 branches covered.">		org.drip.analytics.daycount.DateAdjustParams dap = null == _terminationSetting ? null :</span>
<span class="fc" id="L149">			_terminationSetting.dap();</span>

		try {
<span class="pc bpc" id="L152" title="1 of 2 branches missed.">			return null == dap ? iDate : dap.roll (iDate);</span>
<span class="nc" id="L153">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L154">			e.printStackTrace();</span>
		}

<span class="nc" id="L157">		return iDate;</span>
	}

	private double treasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L166" title="2 of 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L167">			throw new java.lang.Exception (&quot;BondComponent::treasuryBenchmarkYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L169">		java.lang.String strTsyBmk = null;</span>
<span class="fc" id="L170">		org.drip.param.definition.ProductQuote pqTsyBmkYield = null;</span>

<span class="pc bpc" id="L172" title="1 of 2 branches missed.">		if (null != _treasuryBenchmarks) strTsyBmk = _treasuryBenchmarks.primary();</span>

<span class="fc" id="L174">		int iValDate = valParams.valueDate();</span>

<span class="pc bpc" id="L176" title="3 of 4 branches missed.">		if (null == strTsyBmk || strTsyBmk.isEmpty())</span>
<span class="fc" id="L177">			strTsyBmk = org.drip.analytics.support.Helper.BaseTsyBmk (iValDate, iWorkoutDate);</span>

<span class="fc" id="L179">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; pqMap =</span>
<span class="fc" id="L180">			csqc.quoteMap();</span>

<span class="pc bpc" id="L182" title="2 of 6 branches missed.">		if (null != pqMap &amp;&amp; null != strTsyBmk &amp;&amp; !strTsyBmk.isEmpty())</span>
<span class="fc" id="L183">			pqTsyBmkYield = pqMap.get (strTsyBmk);</span>

<span class="fc bfc" id="L185" title="All 2 branches covered.">		if (null != pqTsyBmkYield) {</span>
<span class="fc" id="L186">			 org.drip.param.definition.Quote q = pqTsyBmkYield.quote (&quot;Yield&quot;);</span>

<span class="pc bpc" id="L188" title="1 of 2 branches missed.">			 if (null != q) return q.value (&quot;mid&quot;);</span>
		}

<span class="fc" id="L191">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L193" title="All 2 branches covered.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	private org.drip.param.valuation.WorkoutInfo exerciseCallYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L202" title="4 of 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosCall)
<span class="nc" id="L204">			return null;</span>

<span class="fc" id="L206">		int iValDate = valParams.valueDate();</span>

<span class="fc" id="L208">		int[] aiEOSDate = _eosCall.dates();</span>

<span class="fc" id="L210">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L212">		double[] adblEOSFactor = _eosCall.factors();</span>

<span class="fc" id="L214">		int iNoticePeriod = _eosCall.exerciseNoticePeriod();</span>

<span class="fc" id="L216">		int iExercise = -1;</span>
<span class="fc" id="L217">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="pc bpc" id="L218" title="1 of 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="fc" id="L221">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L222">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L225">			return null;</span>
<span class="fc" id="L226">		}</span>

<span class="fc bfc" id="L228" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="fc bfc" id="L229" title="All 4 branches covered.">			if (iValDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="fc" id="L232">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="fc bfc" id="L235" title="All 2 branches covered.">				if (dblYield &lt; dblExerciseYield) {</span>
<span class="fc" id="L236">					iExercise = i;</span>
<span class="fc" id="L237">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L239">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L241">			}</span>
		}

		try {
<span class="fc bfc" id="L245" title="All 2 branches covered.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L249">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L253">		return null;</span>
	}

	private org.drip.param.valuation.WorkoutInfo exercisePutYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L262" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosPut)
<span class="nc" id="L264">			return null;</span>

<span class="nc" id="L266">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L268">		int[] aiEOSDate = _eosPut.dates();</span>

<span class="nc" id="L270">		double[] adblEOSFactor = _eosPut.factors();</span>

<span class="nc" id="L272">		int iNoticePeriod = _eosPut.exerciseNoticePeriod();</span>

<span class="nc" id="L274">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L276">		int iExercise = -1;</span>
<span class="nc" id="L277">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L278" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L281">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L282">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L285">			return null;</span>
<span class="nc" id="L286">		}</span>

<span class="nc bnc" id="L288" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L289" title="All 4 branches missed.">			if (iValueDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValueDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L292">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L295" title="All 2 branches missed.">				if (dblYield &gt; dblExerciseYield) {</span>
<span class="nc" id="L296">					iExercise = i;</span>
<span class="nc" id="L297">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L299">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L301">			}</span>
		}

		try {
<span class="nc bnc" id="L305" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT);
<span class="nc" id="L309">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L313">		return null;</span>
	}

	private double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield,
		final boolean bApplyCouponExtension)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L326" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L327">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L329">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L331" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L332">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L334">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L335">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L336">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L337">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L338">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L339">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L340">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L341">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>

<span class="pc bpc" id="L343" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L344">			? 1. : notional (iValueDate);</span>

<span class="fc" id="L346">		int iFrequency = freq();</span>

<span class="fc" id="L348">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L350">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L352">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L354" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L356" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L357">			_quoteConvention.valuationCustomizationParams();</span>

<span class="fc bfc" id="L359" title="All 2 branches covered.">		if (null != vcp) {</span>
<span class="fc" id="L360">			strDC = vcp.yieldDayCount();</span>

<span class="fc" id="L362">			iFrequency = vcp.yieldFreq();</span>

<span class="fc" id="L364">			strCalendar = vcp.yieldCalendar();</span>

<span class="fc" id="L366">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="fc" id="L368">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L369" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L370">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L372">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L374">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L376">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L378">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L381">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L383" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L384">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L386" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L388" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L389">				bFirstPeriod = false;</span>

<span class="fc" id="L391">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L393">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L395">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L397">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L399" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L400">				iPeriodEndDate = iWorkoutDate;</span>
<span class="fc" id="L401">				bTerminateCouponFlow = true;</span>
			}

<span class="fc" id="L404">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L407" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L408">				throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; No PCM for &quot; + new</span>
<span class="nc" id="L409">					org.drip.analytics.date.JulianDate (iValueDate) + &quot; | &quot; + effectiveDate());</span>

<span class="fc bfc" id="L411" title="All 2 branches covered.">			if (null != vcp) {</span>
<span class="pc bpc" id="L412" title="1 of 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="fc" id="L413">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L415" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L416" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L417">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L420">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L423">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
					org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iPeriodPayDate, strDC,
<span class="fc" id="L426">						bApplyCpnEOMAdj, aap, strCalendar)) * cpcm.cumulative();</span>

<span class="fc" id="L428">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L430">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L432">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L434" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L435">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L436" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L437">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L438" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L440">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L442" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L443">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc bfc" id="L445" title="All 2 branches covered.">			dblCumulativePeriodPV += (period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="pc bpc" id="L446" title="1 of 2 branches missed.">				dblFlatForwardRate : cpcm.rate() + (bApplyCouponExtension ?</span>
<span class="pc" id="L447">					_couponSetting.couponRateExtension() : 0.)) * couponFactor (iPeriodEndDate) *</span>
						dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;

<span class="fc bfc" id="L450" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L451">		}</span>

		try {
<span class="fc bfc" id="L454" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L455">				valParams.cashPayDate();</span>
<span class="nc" id="L456">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L459">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L460">		}</span>

<span class="fc" id="L462">		double dblCleanPrice = (((dblCumulativePeriodPV + dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (</span>
			iFrequency,
			dblYield,
			s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (
					iValueDate,
					terminationAdjust (iWorkoutDate),
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
<span class="fc" id="L474">			) * notional (iWorkoutDate)) /</span>
<span class="fc" id="L475">			org.drip.analytics.support.Helper.Yield2DF (</span>
				iFrequency,
				dblYield,
<span class="fc" id="L478">				org.drip.analytics.daycount.Convention.YearFraction (</span>
					iValueDate,
					iCashPayDate,
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
			)
<span class="fc" id="L487">		) - accrued (</span>
			iValueDate,
			csqc
		)) / dblScalingNotional;

<span class="fc" id="L492">		return dblCleanPrice;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; calibMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L501">		double dblCleanPrice = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L503" title="1 of 2 branches missed.">		org.drip.param.definition.CalibrationParams calibParams = null == pricerParams ? null :</span>
<span class="fc" id="L504">			pricerParams.calibParams();</span>

<span class="pc bpc" id="L506" title="1 of 2 branches missed.">		if (null == calibParams) return null;</span>

<span class="fc" id="L508">		org.drip.param.valuation.WorkoutInfo wi = calibParams.workout();</span>

<span class="fc bfc" id="L510" title="All 2 branches covered.">		double dblExerciseFactor = null == wi ? 1. : wi.factor();</span>

<span class="fc bfc" id="L512" title="All 2 branches covered.">		int iExerciseDate = null == wi ? maturityDate().julian() : wi.date();</span>

<span class="fc" id="L514">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

		try {
<span class="fc bfc" id="L517" title="All 2 branches covered.">			dblCleanPrice = null == cc ? priceFromFundingCurve (valParams, csqc, iExerciseDate,</span>
<span class="fc" id="L518">				dblExerciseFactor, 0.) : priceFromCreditCurve (valParams, csqc, iExerciseDate,</span>
					dblExerciseFactor, 0., false);
<span class="nc" id="L520">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L523">			return null;</span>
<span class="fc" id="L524">		}</span>

<span class="pc bpc" id="L526" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblCleanPrice)) return null;</span>

<span class="fc" id="L528">		java.lang.String strCalibMeasure = calibParams.measure();</span>

<span class="fc" id="L530">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

<span class="fc bfc" id="L533" title="All 2 branches covered.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CleanPrice&quot;, &quot;FairCleanPrice&quot;, &quot;FairPrice&quot;, &quot;Price&quot;}, false)) {
<span class="fc" id="L535">			mapCalibMeasures.put (strCalibMeasure, dblCleanPrice);</span>

<span class="fc" id="L537">			return mapCalibMeasures;</span>
		}

<span class="pc bpc" id="L540" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;DirtyPrice&quot;, &quot;FairDirtyPrice&quot;}, false)) {
			try {
<span class="nc" id="L543">				mapCalibMeasures.put (strCalibMeasure, dblCleanPrice + accrued (valParams.valueDate(),</span>
					csqc));

<span class="nc" id="L546">				return mapCalibMeasures;</span>
<span class="nc" id="L547">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="pc bpc" id="L552" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;Yield&quot;, &quot;FairYield&quot;}, false)) {
			try {
<span class="fc" id="L555">				mapCalibMeasures.put (strCalibMeasure, yieldFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="fc" id="L558">				return mapCalibMeasures;</span>
<span class="nc" id="L559">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L564" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;TSYSpread&quot;, &quot;FairTSYSpread&quot;}, false)) {
			try {
<span class="nc" id="L567">				mapCalibMeasures.put (strCalibMeasure, tsySpreadFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L570">				return mapCalibMeasures;</span>
<span class="nc" id="L571">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L576" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;OAS&quot;, &quot;OASpread&quot;, &quot;OptionAdjustedSpread&quot;}, false)) {
			try {
<span class="nc" id="L579">				mapCalibMeasures.put (strCalibMeasure, oasFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L582">				return mapCalibMeasures;</span>
<span class="nc" id="L583">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L588" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;BondBasis&quot;, &quot;YieldBasis&quot;, &quot;YieldSpread&quot;}, false)) {
			try {
<span class="nc" id="L591">				mapCalibMeasures.put (strCalibMeasure, bondBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L594">				return mapCalibMeasures;</span>
<span class="nc" id="L595">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L600" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CreditBasis&quot;}, false)) {
<span class="nc bnc" id="L602" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L605">				mapCalibMeasures.put (strCalibMeasure, creditBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L608">				return mapCalibMeasures;</span>
<span class="nc" id="L609">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L614" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;PECS&quot;, &quot;ParEquivalentCDSSpread&quot;}, false)) {
<span class="nc bnc" id="L616" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L619">				mapCalibMeasures.put (strCalibMeasure, pecsFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L622">				return mapCalibMeasures;</span>
<span class="nc" id="L623">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc" id="L628">		return null;</span>
	}

	@Override public org.drip.param.valuation.WorkoutInfo exerciseYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L637" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L638">			return null;</span>

<span class="fc" id="L640">		int iMaturityDate = maturityDate().julian();</span>

		try {
<span class="pc bpc" id="L643" title="1 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L644">				return new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPrice (valParams,</span>
					csqc, vcp, iMaturityDate, 1., dblPrice), 1.,
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);

<span class="pc bpc" id="L648" title="3 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null != _eosPut)</span>
<span class="nc" id="L649">				return exercisePutYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="pc bpc" id="L651" title="2 of 4 branches missed.">			if (null != _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L652">				return exerciseCallYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc" id="L654">			org.drip.param.valuation.WorkoutInfo wiPut = exercisePutYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc" id="L657">			org.drip.param.valuation.WorkoutInfo wiCall = exerciseCallYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc bnc" id="L660" title="All 4 branches missed.">			if (null == wiPut || null == wiCall) return null;</span>

<span class="nc bnc" id="L662" title="All 2 branches missed.">			return wiPut.date() &lt; wiCall.date() ? wiPut : wiCall;</span>
<span class="nc" id="L663">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L667">		return null;</span>
	}

	private double indexRate (
		final int iValueDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.analytics.cashflow.CompositeFloatingPeriod cup)
		throws java.lang.Exception
	{
<span class="fc" id="L676">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState (fundingLabel());</span>

<span class="fc" id="L678">		int iFreq = freq();</span>

<span class="pc bpc" id="L680" title="1 of 2 branches missed.">		if (null != cup) {</span>
<span class="fc" id="L681">			org.drip.analytics.cashflow.ComposableUnitPeriod cupFirst = cup.periods().get (0);</span>

<span class="pc bpc" id="L683" title="1 of 2 branches missed.">			if (!(cupFirst instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod))</span>
<span class="nc" id="L684">				throw new java.lang.Exception (&quot;BondComponent::indexRate =&gt; Not a floater&quot;);</span>

<span class="fc" id="L686">			return ((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod) cupFirst).baseRate (csqc);</span>
		}

<span class="nc bnc" id="L689" title="All 2 branches missed.">		return dc.libor (iValueDate, 0 != iFreq ? iValueDate + 365 / iFreq : iValueDate +</span>
			LOCAL_FORWARD_RATE_WIDTH);
	}

	private org.drip.analytics.output.BondWorkoutMeasures workoutMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
	{
<span class="pc bpc" id="L700" title="2 of 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="fc" id="L702">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L704" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L706">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L708" title="All 2 branches covered.">		if (null == dcFunding) return null;</span>

<span class="fc bfc" id="L710" title="All 2 branches covered.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="fc bfc" id="L712" title="All 2 branches covered.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="fc" id="L713">			_creditSetting.recovery();</span>

<span class="fc bfc" id="L715" title="All 2 branches covered.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="fc bfc" id="L717" title="All 2 branches covered.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L719">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="fc" id="L721">		double dblAccrued01 = 0.;</span>
<span class="fc" id="L722">		double dblRecoveryPV = 0.;</span>
<span class="fc" id="L723">		boolean bPeriodZero = true;</span>
<span class="fc" id="L724">		double dblExpectedRecovery = 0.;</span>
<span class="fc" id="L725">		double dblCreditRiskyDirtyDV01 = 0.;</span>
<span class="fc" id="L726">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L727">		double dblCreditRiskyPrincipalPV = 0.;</span>
<span class="fc" id="L728">		double dblCreditRisklessDirtyDV01 = 0.;</span>
<span class="fc" id="L729">		double dblCreditRiskyDirtyCouponPV = 0.;</span>
<span class="fc" id="L730">		double dblCreditRisklessPrincipalPV = 0.;</span>
<span class="fc" id="L731">		double dblCreditRisklessDirtyCouponPV = 0.;</span>
<span class="fc" id="L732">		double dblFirstCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L733">		double dblCreditRiskyDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L734">		double dblFirstIndexRate = java.lang.Double.NaN;</span>
<span class="fc" id="L735">		double dblCreditRisklessDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L736">		double dblCreditRiskyParPV = java.lang.Double.NaN;</span>
<span class="fc" id="L737">		double dblFlatForwardCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L738">		double dblCreditRisklessParPV = java.lang.Double.NaN;</span>

<span class="fc bfc" id="L740" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L741">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L743" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

		try {
<span class="pc bpc" id="L746" title="1 of 2 branches missed.">			for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L747">				int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L749" title="All 2 branches covered.">				if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L751">				int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L753">				int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L755" title="All 2 branches covered.">				if (iWorkoutDate &lt;= iPeriodEndDate) {</span>
<span class="fc" id="L756">					bTerminateCouponFlow = true;</span>
<span class="fc" id="L757">					iPeriodEndDate = iWorkoutDate;</span>
				}

<span class="fc" id="L760">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L763" title="1 of 2 branches missed.">				if (null == cpcm) return null;</span>

<span class="fc bfc" id="L765" title="All 2 branches covered.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardCoupon))</span>
<span class="fc" id="L766">					dblFlatForwardCoupon = cpcm.rate();</span>

<span class="fc" id="L768">				double dblPeriodBaseRate = period.periods().get (0).baseRate (csqc);</span>

<span class="fc" id="L770">				double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="pc bpc" id="L772" title="1 of 2 branches missed.">				double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardCoupon : cpcm.rate();</span>

<span class="fc bfc" id="L774" title="All 2 branches covered.">				if (bPeriodZero) {</span>
<span class="fc" id="L775">					bPeriodZero = false;</span>
<span class="fc" id="L776">					dblFirstCoupon = dblPeriodCoupon;</span>

<span class="pc bpc" id="L778" title="1 of 2 branches missed.">					if (iPeriodStartDate &lt; iValueDate)</span>
<span class="fc" id="L779">						dblAccrued01 = 0.0001 * period.accrualDCF (iValueDate) * notional (iPeriodStartDate,</span>
							iValueDate);

<span class="fc bfc" id="L782" title="All 2 branches covered.">					if (null != _floaterSetting) dblFirstIndexRate = dblPeriodBaseRate;</span>
				}

<span class="fc" id="L785">				double dblPeriodCreditRisklessDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) *</span>
<span class="fc" id="L786">					dblPeriodAnnuity * notional (iPeriodStartDate);</span>

<span class="fc" id="L788">				double dblPeriodCreditRiskessPrincipalPV = (notional (iPeriodStartDate) - notional</span>
<span class="fc" id="L789">					(iPeriodEndDate)) * dblPeriodAnnuity;</span>

<span class="fc" id="L791">				double dblPeriodCreditRiskyDirtyDV01 = dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L792">				double dblPeriodCreditRiskyPrincipalPV = dblPeriodCreditRiskessPrincipalPV;</span>

<span class="pc bpc" id="L794" title="1 of 4 branches missed.">				if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L795" title="All 2 branches missed.">					double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
						iPeriodEndDate);

<span class="nc" id="L798">					dblPeriodCreditRiskyDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L799">					dblPeriodCreditRiskyPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L801" title="All 2 branches missed.">					for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
<span class="nc" id="L802">						valParams, pricerParams, terminationAdjust (iWorkoutDate), csqc)) {</span>
<span class="nc bnc" id="L803" title="All 2 branches missed.">						if (null == lqm) continue;</span>

<span class="nc" id="L805">						int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L807">						int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L809">						double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
							iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L812">						double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L814">						double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L815">							(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L817" title="All 2 branches missed.">						if (bAccrualOnDefault)</span>
<span class="nc" id="L818">							dblPeriodCreditRiskyDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival</span>
								* dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L821" title="All 2 branches missed.">						double dblRecovery = bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
							iSubPeriodEndDate) : dblProductRecovery;

<span class="nc" id="L824">						double dblSubPeriodExpRecovery = dblRecovery * dblSubPeriodSurvival *</span>
							dblSubPeriodNotional;
<span class="nc" id="L826">						dblRecoveryPV += dblSubPeriodExpRecovery * dblSubPeriodDF;</span>
<span class="nc" id="L827">						dblExpectedRecovery += dblSubPeriodExpRecovery;</span>
<span class="nc" id="L828">					}</span>
				}

<span class="fc" id="L831">				dblCreditRiskyDirtyDV01 += dblPeriodCreditRiskyDirtyDV01;</span>
<span class="fc" id="L832">				dblCreditRiskyPrincipalPV += dblPeriodCreditRiskyPrincipalPV;</span>
<span class="fc" id="L833">				dblCreditRisklessDirtyDV01 += dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L834">				dblCreditRisklessPrincipalPV += dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc" id="L836">				dblCreditRiskyDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRiskyDirtyDV01;

<span class="fc" id="L839">				dblCreditRisklessDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc" id="L842">				dblCreditRiskyDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRiskyDirtyDV01;
<span class="fc" id="L844">				dblCreditRisklessDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc bfc" id="L847" title="All 2 branches covered.">				if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L848">			}</span>
<span class="nc" id="L849">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L852">			return null;</span>
<span class="fc" id="L853">		}</span>

<span class="fc" id="L855">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>

		try {
<span class="fc bfc" id="L858" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L859">				valParams.cashPayDate();</span>
<span class="nc" id="L860">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L863">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L864">		}</span>

		try {
<span class="fc" id="L867">			double dblCashPayDF = dcFunding.df (iCashPayDate);</span>

<span class="fc" id="L869">			int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L871">			dblCreditRisklessParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate) *</span>
				dblWorkoutFactor;

<span class="pc bpc" id="L874" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams)</span>
<span class="nc" id="L875">				dblCreditRiskyParPV = dblCreditRisklessParPV * cc.survival (iMaturityDate);</span>

<span class="fc" id="L877">			org.drip.analytics.output.BondCouponMeasures bcmCreditRisklessDirty = new</span>
				org.drip.analytics.output.BondCouponMeasures (dblCreditRisklessDirtyDV01,
					dblCreditRisklessDirtyIndexCouponPV, dblCreditRisklessDirtyCouponPV,
						dblCreditRisklessDirtyCouponPV + dblCreditRisklessPrincipalPV +
							dblCreditRisklessParPV);

<span class="fc" id="L883">			double dblDefaultExposure = java.lang.Double.NaN;</span>
<span class="fc" id="L884">			double dblDefaultExposureNoRec = java.lang.Double.NaN;</span>
<span class="fc" id="L885">			double dblLossOnInstantaneousDefault = java.lang.Double.NaN;</span>
<span class="fc" id="L886">			org.drip.analytics.output.BondCouponMeasures bcmCreditRiskyDirty = null;</span>

<span class="pc bpc" id="L888" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc" id="L889">				double dblInitialNotional = notional (iValueDate);</span>

<span class="nc" id="L891">				double dblInitialRecovery = cc.recovery (iValueDate);</span>

<span class="nc" id="L893">				bcmCreditRiskyDirty = new org.drip.analytics.output.BondCouponMeasures</span>
					(dblCreditRiskyDirtyDV01, dblCreditRiskyDirtyIndexCouponPV, dblCreditRiskyDirtyCouponPV,
						dblCreditRiskyDirtyCouponPV + dblCreditRiskyPrincipalPV + dblCreditRiskyParPV);

<span class="nc" id="L897">				dblDefaultExposure = (dblDefaultExposureNoRec = dblInitialNotional) * dblInitialRecovery;</span>
<span class="nc" id="L898">				dblLossOnInstantaneousDefault = dblInitialNotional * (1. - dblInitialRecovery);</span>
			}

<span class="fc" id="L901">			return new org.drip.analytics.output.BondWorkoutMeasures (bcmCreditRiskyDirty,</span>
				bcmCreditRisklessDirty, dblCreditRiskyParPV, dblCreditRisklessParPV,
					dblCreditRiskyPrincipalPV, dblCreditRisklessPrincipalPV, dblRecoveryPV,
						dblExpectedRecovery, dblDefaultExposure, dblDefaultExposureNoRec,
							dblLossOnInstantaneousDefault, dblAccrued01, dblFirstCoupon, dblFirstIndexRate,
								dblCashPayDF);
<span class="nc" id="L907">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L911">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; rvMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice,
		final java.lang.String strPrefix)
	{
<span class="pc bpc" id="L923" title="1 of 2 branches missed.">		if (null == strPrefix) return null;</span>

<span class="fc" id="L925">		org.drip.analytics.output.BondRVMeasures bmRV = standardMeasures (valParams, pricerParams, csqc, vcp,</span>
			wi, dblPrice);

<span class="pc bpc" id="L928" title="1 of 2 branches missed.">		return null == bmRV ? null : bmRV.toMap (strPrefix);</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; fairMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L937">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L939">		org.drip.analytics.output.BondWorkoutMeasures bwmFair = workoutMeasures (valParams, pricerParams,</span>
			csqc, iMaturityDate, 1.);

<span class="pc bpc" id="L942" title="1 of 2 branches missed.">		if (null == bwmFair) return null;</span>

<span class="fc" id="L944">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = bwmFair.toMap (&quot;&quot;);</span>

<span class="fc" id="L946">		org.drip.analytics.output.BondCouponMeasures bcm = bwmFair.creditRiskyCleanbcm();</span>

<span class="pc bpc" id="L948" title="1 of 2 branches missed.">		double dblCreditRiskyPV = null == bcm ? java.lang.Double.NaN : bcm.pv();</span>

<span class="pc bpc" id="L950" title="1 of 2 branches missed.">		double dblPrice = !org.drip.quant.common.NumberUtil.IsValid (dblCreditRiskyPV) ?</span>
<span class="pc" id="L951">			bwmFair.creditRisklessCleanbcm().pv() : dblCreditRiskyPV;</span>

		try {
<span class="fc" id="L954">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, rvMeasures (valParams,</span>
				pricerParams, csqc, vcp, new org.drip.param.valuation.WorkoutInfo (iMaturityDate,
<span class="fc" id="L956">					yieldFromPrice (valParams, csqc, vcp, dblPrice / notional (valParams.valueDate())), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY), dblPrice, &quot;&quot;));

<span class="fc" id="L959">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L960">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Fair&quot;));</span>

<span class="fc" id="L962">			return mapMeasures;</span>
<span class="nc" id="L963">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L967">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; marketMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wiMarket)
	{
		try {
<span class="fc" id="L978">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = rvMeasures</span>
<span class="fc" id="L979">				(valParams, pricerParams, csqc, vcp, wiMarket, priceFromYield (valParams, csqc, vcp,</span>
<span class="fc" id="L980">					wiMarket.date(), wiMarket.factor(), wiMarket.yield()), &quot;&quot;);</span>

<span class="fc" id="L982">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L983">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Market&quot;));</span>

<span class="fc" id="L985">			return mapMeasures;</span>
<span class="nc" id="L986">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L990">		return null;</span>
	}

	private org.drip.analytics.cashflow.CompositePeriod currentPeriod (
		final int iDate)
	{
		try {
<span class="fc" id="L997">			return _stream.period (_stream.periodIndex (iDate));</span>
<span class="nc" id="L998">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1002">		return null;</span>
	}

	private double priceFromDiscountCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump,
		final int iDiscountCurveType)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1014" title="3 of 6 branches missed.">		if (null == valParams || null == csqc ||!org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L1015" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L1016">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L1018">		org.drip.state.discount.DiscountCurve dc = null;</span>

<span class="pc bpc" id="L1020" title="1 of 2 branches missed.">		if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="fc" id="L1021">			dc = csqc.fundingState (fundingLabel());</span>
<span class="nc bnc" id="L1022" title="All 2 branches missed.">		else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1023">			dc = csqc.govvieState (govvieLabel());</span>
		/* else if (PRICE_OFF_OF_OVERNIGHT_CURVE == iDiscountCurveType)
			dfe = csqc.overnightState (overnightLabel()); */

<span class="pc bpc" id="L1027" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1028">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No Discount Curve&quot;);</span>

<span class="fc" id="L1030">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L1032" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1033">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L1034">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L1035">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L1037">		double dblPV = 0.;</span>
<span class="fc" id="L1038">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L1039">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L1040">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L1042" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L1043">			? 1. : notional (iValueDate);</span>

<span class="fc bfc" id="L1045" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L1046">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L1048" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L1050" title="1 of 2 branches missed.">		if (0. != dblBump) {</span>
<span class="nc bnc" id="L1051" title="All 2 branches missed.">			if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1052">				dc = (org.drip.state.discount.MergedDiscountForwardCurve) dc.parallelShiftManifestMeasure</span>
<span class="nc" id="L1053">					(&quot;SwapRate&quot;, dblBump);</span>
<span class="nc bnc" id="L1054" title="All 2 branches missed.">			else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1055">				dc = (org.drip.state.govvie.GovvieCurve) dc.parallelShiftManifestMeasure (&quot;Yield&quot;, dblBump);</span>
		}

<span class="pc bpc" id="L1058" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1059">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromDiscountCurve =&gt; Cannot shift Discount Curve&quot;);

<span class="pc bpc" id="L1062" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1063">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L1065" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L1067">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L1069">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L1071">			int iNotionalEndDate = period.endDate();</span>

<span class="fc bfc" id="L1073" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L1074">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L1075">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L1076">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L1079">			org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L1082" title="1 of 2 branches missed.">			if (null == pcm)</span>
<span class="nc" id="L1083">				throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No PCM&quot;);</span>

<span class="fc" id="L1085">			double dblPeriodAnnuity = dc.df (iPeriodPayDate) * pcm.cumulative();</span>

<span class="fc" id="L1087">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L1089">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L1091">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L1093">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L1095" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L1096">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L1097" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L1098">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L1099" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L1101">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc bfc" id="L1103" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L1104">				dblFlatForwardRate = pcm.rate();</span>

<span class="pc bpc" id="L1106" title="1 of 2 branches missed.">			dblPV += period.accrualDCF (iAccrualEndDate) * dblPeriodAnnuity * (bApplyFlatForward ?</span>
<span class="fc" id="L1107">				dblFlatForwardRate : pcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L1109">			dblPV += (dblPeriodStartNotional - dblPeriodEndNotional) * dblPeriodAnnuity;</span>

<span class="fc bfc" id="L1111" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L1112">		}</span>

		try {
<span class="fc bfc" id="L1115" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L1116">				valParams.cashPayDate();</span>
<span class="nc" id="L1117">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1120">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L1121">		}</span>

<span class="fc" id="L1123">		return ((dblPV + dblWorkoutFactor * dc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L1124">			(iWorkoutDate)) / dc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	/**
	 * Constructor: Construct an empty bond object
	 */

	public BondComponent()
<span class="fc" id="L1132">	{</span>
<span class="fc" id="L1133">	}</span>

	@Override public double[] secTreasurySpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1139" title="All 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="nc" id="L1141">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1142">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1144" title="All 4 branches missed.">		if (null == mapTSYQuote || 0 == mapTSYQuote.size()) return null;</span>

<span class="nc bnc" id="L1146" title="All 2 branches missed.">		java.lang.String[] astrTreasuryBenchmark = null == _treasuryBenchmarks ? null :</span>
<span class="nc" id="L1147">			_treasuryBenchmarks.secondary();</span>

<span class="nc bnc" id="L1149" title="All 2 branches missed.">		int iNumTreasuryBenchmark = null == astrTreasuryBenchmark ? 0 : astrTreasuryBenchmark.length;</span>
<span class="nc" id="L1150">		double[] adblSecTSYSpread = new double[iNumTreasuryBenchmark];</span>

<span class="nc bnc" id="L1152" title="All 2 branches missed.">		if (0 == iNumTreasuryBenchmark) return null;</span>

<span class="nc bnc" id="L1154" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="nc" id="L1155">			org.drip.param.definition.ProductQuote pqTSYBenchmark = mapTSYQuote.get</span>
<span class="nc" id="L1156">				(astrTreasuryBenchmark[i]);</span>

<span class="nc bnc" id="L1158" title="All 2 branches missed.">			org.drip.param.definition.Quote q = null == pqTSYBenchmark ? null : pqTSYBenchmark.quote</span>
<span class="nc" id="L1159">				(&quot;Yield&quot;);</span>

<span class="nc bnc" id="L1161" title="All 2 branches missed.">			adblSecTSYSpread[i] = null == q ? java.lang.Double.NaN : q.value (&quot;mid&quot;);</span>
		}

<span class="nc" id="L1164">		return adblSecTSYSpread;</span>
	}

	@Override public double effectiveTreasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1174" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1175">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Bad val/mkt Params&quot;);

<span class="nc" id="L1178">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1180" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L1181">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Invalid Work-out!&quot;);

<span class="nc bnc" id="L1184" title="All 2 branches missed.">		java.lang.String strTreasuryBenchmark = null != _treasuryBenchmarks ? _treasuryBenchmarks.primary() :</span>
			null;

<span class="nc" id="L1187">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1189">		int iWorkoutDate = wi.date();</span>

<span class="nc bnc" id="L1191" title="All 4 branches missed.">		if (null == strTreasuryBenchmark || strTreasuryBenchmark.isEmpty())</span>
<span class="nc" id="L1192">			strTreasuryBenchmark = org.drip.analytics.support.Helper.BaseTsyBmk (iValueDate, iWorkoutDate);</span>

<span class="nc" id="L1194">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1195">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1197" title="All 2 branches missed.">		org.drip.param.definition.ProductQuote pqTSYBenchmark = null != mapTSYQuote &amp;&amp;</span>
<span class="nc bnc" id="L1198" title="All 4 branches missed.">			mapTSYQuote.containsKey (strTreasuryBenchmark) &amp;&amp; !strTreasuryBenchmark.isEmpty() ?</span>
<span class="nc" id="L1199">				mapTSYQuote.get (strTreasuryBenchmark) : null;</span>

<span class="nc bnc" id="L1201" title="All 2 branches missed.">		org.drip.param.definition.Quote q = null != pqTSYBenchmark ? pqTSYBenchmark.quote (&quot;Yield&quot;) : null;</span>

<span class="nc bnc" id="L1203" title="All 2 branches missed.">		if (null != q) return q.value (&quot;mid&quot;);</span>

<span class="nc" id="L1205">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());;</span>

<span class="nc bnc" id="L1207" title="All 2 branches missed.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	@Override public boolean setTreasuryBenchmark (
		final org.drip.product.params.TreasuryBenchmarks treasuryBenchmarks)
	{
<span class="pc bpc" id="L1213" title="1 of 2 branches missed.">		return null != (_treasuryBenchmarks = treasuryBenchmarks);</span>
	}

	@Override public org.drip.product.params.TreasuryBenchmarks treasuryBenchmark()
	{
<span class="nc" id="L1218">		return _treasuryBenchmarks;</span>
	}

	@Override public boolean setIdentifierSet (
		final org.drip.product.params.IdentifierSet idParams)
	{
<span class="pc bpc" id="L1224" title="1 of 2 branches missed.">		return null != (_idParams = idParams);</span>
	}

	@Override public org.drip.product.params.IdentifierSet identifierSet()
	{
<span class="nc" id="L1229">		return _idParams;</span>
	}

	@Override public boolean setCouponSetting (
		final org.drip.product.params.CouponSetting couponSetting)
	{
<span class="pc bpc" id="L1235" title="1 of 2 branches missed.">		return null != (_couponSetting = couponSetting);</span>
	}

	@Override public org.drip.product.params.CouponSetting couponSetting()
	{
<span class="nc" id="L1240">		return _couponSetting;</span>
	}

	@Override public boolean setFloaterSetting (
		final org.drip.product.params.FloaterSetting fltParams)
	{
<span class="fc bfc" id="L1246" title="All 2 branches covered.">		return null == (_floaterSetting = fltParams);</span>
	}

	@Override public org.drip.product.params.FloaterSetting floaterSetting()
	{
<span class="fc" id="L1251">		return _floaterSetting;</span>
	}

	@Override public boolean setMarketConvention (
		final org.drip.product.params.QuoteConvention quoteConvention)
	{
<span class="pc bpc" id="L1257" title="1 of 2 branches missed.">		return null == (_quoteConvention = quoteConvention);</span>
	}

	@Override public org.drip.product.params.QuoteConvention marketConvention()
	{
<span class="nc" id="L1262">		return _quoteConvention;</span>
	}

	@Override public boolean setCreditSetting (
		final org.drip.product.params.CreditSetting creditSetting)
	{
<span class="pc bpc" id="L1268" title="1 of 2 branches missed.">		return null == (_creditSetting = creditSetting);</span>
	}

	@Override public org.drip.product.params.CreditSetting creditSetting()
	{
<span class="nc" id="L1273">		return _creditSetting;</span>
	}

	@Override public boolean setTerminationSetting (
		final org.drip.product.params.TerminationSetting terminationSetting)
	{
<span class="pc bpc" id="L1279" title="1 of 2 branches missed.">		return null == (_terminationSetting = terminationSetting);</span>
	}

	@Override public org.drip.product.params.TerminationSetting terminationSetting()
	{
<span class="nc" id="L1284">		return _terminationSetting;</span>
	}

	@Override public boolean setStream (
		final org.drip.product.params.BondStream stream)
	{
<span class="pc bpc" id="L1290" title="1 of 2 branches missed.">		return null != (_stream = stream);</span>
	}

	@Override public org.drip.product.params.BondStream stream()
	{
<span class="fc" id="L1295">		return _stream;</span>
	}

	@Override public boolean setNotionalSetting (
		final org.drip.product.params.NotionalSetting notionalSetting)
	{
<span class="pc bpc" id="L1301" title="1 of 2 branches missed.">		return null == (_notionalSetting = notionalSetting);</span>
	}

	@Override public org.drip.product.params.NotionalSetting notionalSetting()
	{
<span class="nc" id="L1306">		return _notionalSetting;</span>
	}

	@Override public java.lang.String primaryCode()
	{
<span class="pc bpc" id="L1311" title="1 of 2 branches missed.">		return null == _idParams ? null : &quot;BOND.&quot; + _idParams.id();</span>
	}

	@Override public void setPrimaryCode (
		final java.lang.String strCode)
	{
		// _strCode = strCode;
<span class="nc" id="L1318">	}</span>

	@Override public java.lang.String[] secondaryCode()
	{
<span class="fc" id="L1322">		return new java.lang.String[] {_idParams.id()};</span>
	}

	@Override public java.lang.String isin()
	{
<span class="nc bnc" id="L1327" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.isin();</span>
	}

	@Override public java.lang.String cusip()
	{
<span class="nc bnc" id="L1332" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.cusip();</span>
	}

	@Override public java.lang.String name()
	{
<span class="pc bpc" id="L1337" title="1 of 2 branches missed.">		return null == _idParams ? null : _idParams.id();</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; couponCurrency()
	{
<span class="nc" id="L1342">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; mapCouponCurrency = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt;();

<span class="nc" id="L1345">		mapCouponCurrency.put (name(), _stream.couponCurrency());</span>

<span class="nc" id="L1347">		return mapCouponCurrency;</span>
	}

	@Override public java.lang.String payCurrency()
	{
<span class="fc" id="L1352">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String principalCurrency()
	{
<span class="nc" id="L1357">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public double notional (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1364" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1365">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1367">		return _notionalSetting.outstandingFactorSchedule().y (iDate);</span>
	}

	@Override public double notional (
		final int iStartDate,
		final int iEndDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1375" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1376">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1378">		return _notionalSetting.outstandingFactorSchedule().y (iStartDate, iEndDate);</span>
	}

	@Override public double initialNotional()
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1384" title="1 of 2 branches missed.">		if (null == _notionalSetting)</span>
<span class="nc" id="L1385">			throw new java.lang.Exception (&quot;BondComponent::initialNotional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1387">		return _notionalSetting.notionalAmount();</span>
	}

	public double couponFactor (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1394" title="1 of 2 branches missed.">		if (null == _couponSetting) return 1.;</span>

<span class="fc" id="L1396">		org.drip.quant.common.Array2D fsCoupon = _couponSetting.factorSchedule();</span>

<span class="fc bfc" id="L1398" title="All 2 branches covered.">		return null == fsCoupon ? 1. : fsCoupon.y (iDate);</span>
	}

	@Override public double recovery (
		final int iDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1406" title="All 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="nc bnc" id="L1408" title="All 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.recovery (iDate) : _creditSetting.recovery();</span>
	}

	@Override public double recovery (
		final int iStartDate,
		final int iEndDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1417" title="1 of 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="pc bpc" id="L1419" title="1 of 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iStartDate, iEndDate) :</span>
<span class="nc" id="L1420">			_creditSetting.recovery();</span>
	}

	@Override public org.drip.product.params.CreditSetting creditValuationParams()
	{
<span class="fc" id="L1425">		return _creditSetting;</span>
	}

	@Override public org.drip.analytics.output.CompositePeriodCouponMetrics couponMetrics (
		final int iAccrualEndDate,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="fc" id="L1433">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iAccrualEndDate);</span>

<span class="pc bpc" id="L1435" title="1 of 2 branches missed.">		if (null == cp) return null;</span>

<span class="fc" id="L1437">		java.util.List&lt;org.drip.analytics.output.UnitPeriodMetrics&gt; lsUPM = new</span>
			java.util.ArrayList&lt;org.drip.analytics.output.UnitPeriodMetrics&gt;();

		try {
<span class="fc" id="L1441">			lsUPM.add (new org.drip.analytics.output.UnitPeriodMetrics (cp.startDate(), cp.endDate(),</span>
<span class="fc" id="L1442">				cp.couponDCF(), cp.couponMetrics (valParams.valueDate(), csqc).rate(), new</span>
					org.drip.analytics.output.ConvexityAdjustment()));
<span class="nc" id="L1444">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L1445">			e.printStackTrace();</span>

<span class="nc" id="L1447">			return null;</span>
<span class="fc" id="L1448">		}</span>

<span class="fc" id="L1450">		return org.drip.analytics.output.CompositePeriodCouponMetrics.Create (lsUPM);</span>
	}

	@Override public int freq()
	{
<span class="fc" id="L1455">		return couponPeriods().get (0).freq();</span>
	}

	@Override public org.drip.state.identifier.EntityCDSLabel creditLabel()
	{
<span class="fc bfc" id="L1460" title="All 2 branches covered.">		if (null == _creditSetting) return null;</span>

<span class="fc" id="L1462">		java.lang.String strCreditCurveName = _creditSetting.creditCurveName();</span>

<span class="pc bpc" id="L1464" title="1 of 4 branches missed.">		return null == strCreditCurveName  || strCreditCurveName.isEmpty() ? null :</span>
<span class="fc" id="L1465">			org.drip.state.identifier.EntityCDSLabel.Standard (strCreditCurveName, currency());</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
			forwardLabel()
	{
<span class="pc bpc" id="L1472" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1474">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1476" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.ForwardLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
<span class="fc" id="L1479">			mapForwardLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;();

<span class="fc" id="L1482">		mapForwardLabel.put (</span>
<span class="fc" id="L1483">			name(),</span>
			(org.drip.state.identifier.ForwardLabel) floaterLabel
		);

<span class="fc" id="L1487">		return mapForwardLabel;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
			otcFixFloatLabel()
	{
<span class="pc bpc" id="L1494" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1496">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1498" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.OTCFixFloatLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
<span class="fc" id="L1501">			mapOTCFixFloatLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;();

<span class="fc" id="L1504">		mapOTCFixFloatLabel.put (</span>
<span class="fc" id="L1505">			name(),</span>
			(org.drip.state.identifier.OTCFixFloatLabel) floaterLabel
		);

<span class="fc" id="L1509">		return mapOTCFixFloatLabel;</span>
	}

	@Override public org.drip.state.identifier.FundingLabel fundingLabel()
	{
<span class="fc" id="L1514">		return org.drip.state.identifier.FundingLabel.Standard (payCurrency());</span>
	}

	@Override public org.drip.state.identifier.GovvieLabel govvieLabel()
	{
<span class="fc" id="L1519">		return org.drip.state.identifier.GovvieLabel.Standard</span>
<span class="fc" id="L1520">			(org.drip.market.issue.TreasurySettingContainer.CurrencyBenchmarkCode (payCurrency()));</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.FXLabel&gt;
		fxLabel()
	{
<span class="nc" id="L1526">		return null;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.VolatilityLabel&gt;
			volatilityLabel()
	{
<span class="nc" id="L1533">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate effectiveDate()
	{
<span class="fc" id="L1538">		return _stream.effective();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityDate()
	{
<span class="fc" id="L1543">		return _stream.maturity();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityPayDate()
	{
<span class="fc" id="L1548">		return new org.drip.analytics.date.JulianDate (terminationAdjust (maturityDate().julian()));</span>
	}

	@Override public org.drip.analytics.date.JulianDate firstCouponDate()
	{
<span class="fc" id="L1553">		return new org.drip.analytics.date.JulianDate (couponPeriods().get (0).endDate());</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; couponPeriods()
	{
<span class="fc" id="L1558">		return _stream.periods();</span>
	}

	@Override public org.drip.param.valuation.CashSettleParams cashSettleParams()
	{
<span class="nc bnc" id="L1563" title="All 2 branches missed.">		return null == _quoteConvention ? null : _quoteConvention.cashSettleParams();</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlow (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1571" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc) return null;</span>

<span class="nc" id="L1573">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1576" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1577" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1579">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1580">				(this, valParams, pricerParams, period.endDate(), csqc);</span>

<span class="nc bnc" id="L1582" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1583">		}</span>

<span class="nc" id="L1585">		return sLP;</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlowFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L1595" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc ||</span>
<span class="nc bnc" id="L1596" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1597">			return null;</span>

<span class="nc" id="L1599">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1601" title="All 2 branches missed.">		if (null == wi) return null;</span>

<span class="nc" id="L1603">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1605">		int iWorkoutDate = wi.date();</span>

<span class="nc" id="L1607">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1610" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1611" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1613">			int iPeriodEndDate = period.endDate();</span>

<span class="nc bnc" id="L1615" title="All 4 branches missed.">			if (null == period || iPeriodEndDate &lt; iValueDate) continue;</span>

<span class="nc bnc" id="L1617" title="All 2 branches missed.">			if (period.startDate() &gt; iWorkoutDate) break;</span>

<span class="nc" id="L1619">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1620">				(this, valParams, pricerParams, iPeriodEndDate, csqc);</span>

<span class="nc bnc" id="L1622" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1623">		}</span>

<span class="nc" id="L1625">		return sLP;</span>
	}

	@Override public boolean isFloater()
	{
<span class="fc bfc" id="L1630" title="All 2 branches covered.">		return null == _floaterSetting ? false : true;</span>
	}

	@Override public java.lang.String rateIndex()
	{
<span class="nc bnc" id="L1635" title="All 2 branches missed.">		return null == _floaterSetting ? &quot;&quot; : _floaterSetting.fri().fullyQualifiedName();</span>
	}

	@Override public double currentCoupon()
	{
<span class="nc bnc" id="L1640" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.currentFullCoupon();</span>
	}

	@Override public double floatSpread()
	{
<span class="pc bpc" id="L1645" title="1 of 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.spread();</span>
	}

	@Override public java.lang.String ticker()
	{
<span class="nc bnc" id="L1650" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.ticker();</span>
	}

	@Override public void setEmbeddedCallSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="pc bpc" id="L1656" title="2 of 4 branches missed.">		if (null == eos || eos.isPut()) return;</span>

<span class="fc" id="L1658">		_eosCall = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="fc" id="L1659">	}</span>

	@Override public void setEmbeddedPutSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="nc bnc" id="L1664" title="All 4 branches missed.">		if (null == eos || !eos.isPut()) return;</span>

<span class="nc" id="L1666">		_eosPut = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="nc" id="L1667">	}</span>

	@Override public boolean callable()
	{
<span class="fc bfc" id="L1671" title="All 2 branches covered.">		return null != _eosCall;</span>
	}

	@Override public boolean putable()
	{
<span class="pc bpc" id="L1676" title="1 of 2 branches missed.">		return null != _eosPut;</span>
	}

	@Override public boolean sinkable()
	{
<span class="nc bnc" id="L1681" title="All 2 branches missed.">		return null == _notionalSetting ? false : true;</span>
	}

	@Override public boolean variableCoupon()
	{
<span class="nc bnc" id="L1686" title="All 4 branches missed.">		return null == _couponSetting || null == _couponSetting.couponType() || !&quot;variable&quot;.equalsIgnoreCase</span>
<span class="nc bnc" id="L1687" title="All 2 branches missed.">			(_couponSetting.couponType()) ? false : true;</span>
	}

	@Override public boolean exercised()
	{
<span class="nc bnc" id="L1692" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.exercised();</span>
	}

	@Override public boolean defaulted()
	{
<span class="nc bnc" id="L1697" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.defaulted();</span>
	}

	@Override public boolean perpetual()
	{
<span class="nc bnc" id="L1702" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.perpetual();</span>
	}

	@Override public boolean tradeable (
		final org.drip.param.valuation.ValuationParams valParams)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1709" title="All 2 branches missed.">		if (null == valParams) throw new java.lang.Exception (&quot;BondComponent::tradeable =&gt; invalid Inputs&quot;);</span>

<span class="nc bnc" id="L1711" title="All 4 branches missed.">		return !_terminationSetting.exercised() &amp;&amp; !_terminationSetting.defaulted() &amp;&amp; valParams.valueDate()</span>
<span class="nc bnc" id="L1712" title="All 2 branches missed.">			&lt; maturityDate().julian();</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule callSchedule()
	{
<span class="fc" id="L1717">		return _eosCall;</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule putSchedule()
	{
<span class="fc" id="L1722">		return _eosPut;</span>
	}

	@Override public java.lang.String couponType()
	{
<span class="nc bnc" id="L1727" title="All 2 branches missed.">		return null == _couponSetting ? &quot;&quot; : _couponSetting.couponType();</span>
	}

	@Override public java.lang.String couponDC()
	{
<span class="pc bpc" id="L1732" title="1 of 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.couponDC();</span>
	}

	@Override public java.lang.String accrualDC()
	{
<span class="nc bnc" id="L1737" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.accrualDC();</span>
	}

	@Override public java.lang.String maturityType()
	{
<span class="nc bnc" id="L1742" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : maturityType();</span>
	}

	@Override public org.drip.analytics.date.JulianDate finalMaturity()
	{
<span class="nc bnc" id="L1747" title="All 2 branches missed.">		return null == _stream ? null : new org.drip.analytics.date.JulianDate (_stream.finalMaturityDate());</span>
	}

	@Override public java.lang.String calculationType()
	{
<span class="nc bnc" id="L1752" title="All 2 branches missed.">		return null == _quoteConvention ? &quot;&quot; : _quoteConvention.calculationType();</span>
	}

	@Override public double redemptionValue()
	{
<span class="nc bnc" id="L1757" title="All 2 branches missed.">		return null == _quoteConvention ? java.lang.Double.NaN : _quoteConvention.redemptionValue();</span>
	}

	@Override public java.lang.String currency()
	{
<span class="fc" id="L1762">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String redemptionCurrency()
	{
<span class="nc" id="L1767">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public boolean inFirstCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1774">		return _stream.firstPeriod().contains (iDate);</span>
	}

	@Override public boolean inLastCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1781">		return _stream.lastPeriod().contains (iDate);</span>
	}

	@Override public java.lang.String floatCouponConvention()
	{
<span class="nc bnc" id="L1786" title="All 2 branches missed.">		return null == _floaterSetting ? null : _floaterSetting.dayCount();</span>
	}

	@Override public org.drip.analytics.date.JulianDate periodFixingDate (
		final int iValueDate)
	{
<span class="nc bnc" id="L1792" title="All 4 branches missed.">		if (null == _floaterSetting || iValueDate &gt;= maturityDate().julian()) return null;</span>

<span class="nc bnc" id="L1794" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1795" title="All 2 branches missed.">			if (period.payDate() &lt; iValueDate) continue;</span>

<span class="nc" id="L1797">			org.drip.analytics.cashflow.ComposableUnitPeriod cup = period.periods().get (0);</span>

<span class="nc bnc" id="L1799" title="All 2 branches missed.">			if (!(cup instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)) continue;</span>

			try {
<span class="nc" id="L1802">				return new org.drip.analytics.date.JulianDate</span>
					(((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)
<span class="nc" id="L1804">						(cup)).referenceIndexPeriod().fixingDate());</span>
<span class="nc" id="L1805">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
<span class="nc" id="L1808">		}</span>

<span class="nc" id="L1810">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate previousCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="pc bpc" id="L1816" title="2 of 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="fc" id="L1819">			int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="fc bfc" id="L1821" title="All 2 branches covered.">			if (0 == iIndex) return new org.drip.analytics.date.JulianDate (_stream.period (0).startDate());</span>
			
<span class="fc" id="L1823">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex - 1);</span>

<span class="pc bpc" id="L1825" title="1 of 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1826">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1830">		return null;</span>
	}

	@Override public double previousCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1838" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1839">			throw new java.lang.Exception (&quot;BondComponent::previousCouponRate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1841">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1842">			(dt.julian()) - 1);</span>

<span class="nc bnc" id="L1844" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1845">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Cannot find previous period!&quot;);

<span class="nc" id="L1848">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1851" title="All 2 branches missed.">		if (null == cpcm)</span>
<span class="nc" id="L1852">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Invalid previous period metrics!&quot;);

<span class="nc" id="L1855">		return cpcm.rate();</span>
	}

	@Override public org.drip.analytics.date.JulianDate currentCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1861" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1864">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1865">				(dt.julian()));</span>

<span class="nc bnc" id="L1867" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1868">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1871">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate nextCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1877" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1880">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1881">				(dt.julian()) + 1);</span>

<span class="nc bnc" id="L1883" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1884">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1887">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseDateOfType (
		final org.drip.analytics.date.JulianDate dt,
		final boolean bPut)
	{
<span class="nc bnc" id="L1894" title="All 10 branches missed.">		if (null == dt || (bPut &amp;&amp; null == _eosPut) || (!bPut &amp;&amp; null == _eosCall)) return null;</span>

<span class="nc bnc" id="L1896" title="All 2 branches missed.">		org.drip.product.params.EmbeddedOptionSchedule eos = bPut ? _eosPut : _eosCall;</span>

<span class="nc" id="L1898">		int[] aiEOSExerciseDates = eos.dates();</span>

<span class="nc bnc" id="L1900" title="All 4 branches missed.">		if (null == eos || null == aiEOSExerciseDates) return null;</span>

<span class="nc" id="L1902">		int iNumExerciseDates = aiEOSExerciseDates.length;</span>

<span class="nc bnc" id="L1904" title="All 2 branches missed.">		if (0 == iNumExerciseDates) return null;</span>

<span class="nc bnc" id="L1906" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumExerciseDates; ++i) {</span>
<span class="nc bnc" id="L1907" title="All 2 branches missed.">			if (aiEOSExerciseDates[i] - dt.julian() &lt; eos.exerciseNoticePeriod())</span>
<span class="nc" id="L1908">				continue;</span>

			try {
<span class="nc bnc" id="L1911" title="All 2 branches missed.">				return new org.drip.analytics.output.ExerciseInfo (aiEOSExerciseDates[i], eos.factor (i),</span>
					bPut ? org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT :
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L1914">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1917">				return null;</span>
			}
		}

<span class="nc" id="L1921">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseInfo (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1927" title="All 2 branches missed.">		if (null == dt) return null;</span>

<span class="nc" id="L1929">		org.drip.analytics.output.ExerciseInfo neiNextCall = nextValidExerciseDateOfType (dt, false);</span>

<span class="nc" id="L1931">		org.drip.analytics.output.ExerciseInfo neiNextPut = nextValidExerciseDateOfType (dt, true);</span>

<span class="nc bnc" id="L1933" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null == neiNextPut) {</span>
			try {
<span class="nc" id="L1935">				return new org.drip.analytics.output.ExerciseInfo (maturityDate().julian(), 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L1937">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1940">				return null;</span>
			}
		}

<span class="nc bnc" id="L1944" title="All 4 branches missed.">		if (null != neiNextCall &amp;&amp; null == neiNextPut) return neiNextCall;</span>

<span class="nc bnc" id="L1946" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null != neiNextPut) return neiNextPut;</span>

<span class="nc bnc" id="L1948" title="All 2 branches missed.">		return neiNextCall.date() &lt; neiNextPut.date() ? neiNextCall : neiNextPut;</span>
	}

	@Override public double currentCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1956" title="All 4 branches missed.">		if (null == dt || null == csqc)</span>
<span class="nc" id="L1957">			throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc bnc" id="L1959" title="All 2 branches missed.">		if (null != _floaterSetting) {</span>
<span class="nc" id="L1960">			double dblCurrentFullCoupon = _floaterSetting.currentFullCoupon();</span>

<span class="nc bnc" id="L1962" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblCurrentFullCoupon))</span>
<span class="nc" id="L1963">				return dblCurrentFullCoupon;</span>
		}

<span class="nc" id="L1966">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (dt.julian(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1969" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1971">		return pcm.rate();</span>
	}

	@Override public double nextCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1979" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1980">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc" id="L1982">		int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="nc" id="L1984">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex + 1);</span>

<span class="nc bnc" id="L1986" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1987">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Cannot find next period!&quot;);</span>

<span class="nc" id="L1989">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1992" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1994">		return pcm.rate();</span>
	}

	@Override public double accrued (
		final int iDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2002">		org.drip.analytics.date.JulianDate dt = new org.drip.analytics.date.JulianDate (iDate);</span>

<span class="pc bpc" id="L2004" title="1 of 2 branches missed.">		if (iDate &gt;= maturityDate().julian())</span>
<span class="nc" id="L2005">			throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Val date &quot; + dt +</span>
<span class="nc" id="L2006">				&quot; greater than maturity &quot; + maturityDate());</span>

<span class="fc" id="L2008">		org.drip.param.valuation.ValuationParams valParams = new org.drip.param.valuation.ValuationParams</span>
			(dt, dt, &quot;&quot;);

<span class="fc bfc" id="L2011" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2012">			int iEndDate = period.endDate();</span>

<span class="fc" id="L2014">			int iStartDate = period.startDate();</span>

<span class="fc bfc" id="L2016" title="All 4 branches covered.">			if (iStartDate &lt; iDate &amp;&amp; iEndDate &gt;= iDate) {</span>
<span class="fc" id="L2017">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iEndDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L2020" title="1 of 2 branches missed.">				if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; No PCM&quot;);</span>

<span class="fc" id="L2022">				double dblCoupon = cpcm.rate();</span>

<span class="pc bpc" id="L2024" title="1 of 2 branches missed.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblCoupon))</span>
<span class="nc" id="L2025">					throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Invalid Coupon For &quot; + dt);</span>

<span class="fc" id="L2027">				return period.accrualDCF (iDate) * dblCoupon * notional (iStartDate) * couponFactor</span>
<span class="fc" id="L2028">					(iEndDate);</span>
			}
<span class="fc" id="L2030">		}</span>

<span class="fc" id="L2032">		return 0.;</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2042" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2043">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2045">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2047" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2048">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Val date &quot; +</span>
<span class="nc" id="L2049">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2050">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2052">		int iPeriodEndDate = 0;</span>
<span class="fc" id="L2053">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2054">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2055">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2056">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2058" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2059">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2061" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2063" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2064">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2066" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2068">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2070">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2072">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2073" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2075" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2076">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2077">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2078">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2081">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2084" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2085">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2087">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2089">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2091">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2093">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2095" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2096">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2097" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2098">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2099" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2101">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2103">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2104">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2106" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2107">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2109" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2110">				cpcm.rate()) * couponFactor (iPeriodEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2113">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2114">			iPeriodEndDate += (iAccrualEndDate - iAccrualStartDate);</span>
<span class="fc" id="L2115">			dblTimeWeightedTotalCashflow += iPeriodEndDate * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2117" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2118">		}</span>

<span class="fc" id="L2120">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2122">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2123">		dblTimeWeightedTotalCashflow += iPeriodEndDate * dblTerminalCashflow;</span>
<span class="fc" id="L2124">		return (int) (dblTimeWeightedTotalCashflow / dblTotalCashflow);</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2132">		return weightedAverageMaturityDate (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2142" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2143">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2145">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2147" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2148">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Val date &quot; +</span>
<span class="nc" id="L2149">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2150">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2152">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2153">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2154">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2155">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2156">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2158" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2159">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2161" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2163" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2164">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2166" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2168">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2170">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2172">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2173" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2175" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2176">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2177">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2178">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2181">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2184" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2185">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2187">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2189">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2191">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2193">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2195" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2196">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2197" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2198">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2199" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2201">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2203">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2204">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2206" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2207">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2209" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2210">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2213">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2214">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2215">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2217" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2218">		}</span>

<span class="fc" id="L2220">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2222">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2223">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2224">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2232">		return weightedAverageLife (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2242" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2243">			throw new java.lang.Exception</span>
				(&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Invalid Inputs&quot;);

<span class="fc" id="L2246">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2248" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2249">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2250">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2251">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2253">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2254">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2255">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2256">		double dblTimeWeightedTotalCashflow = 0.;</span>

<span class="pc bpc" id="L2258" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2259">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2261" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2263">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2265">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2267">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2268" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2270" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2271">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2272">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2273">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2276">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2278">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2280">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2281">				(iAccrualStartDate);</span>

<span class="fc" id="L2283">			double dblPeriodCashflow = dblPeriodStartNotional - dblPeriodEndNotional;</span>
<span class="fc" id="L2284">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>
<span class="fc" id="L2285">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2286">			dblPeriodEndTime += dblPeriodTimeWidth;</span>

<span class="fc bfc" id="L2288" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2289">		}</span>

<span class="fc" id="L2291">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2293">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2294">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2295">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2303">		return weightedAverageLifePrincipalOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2313" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2314">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2316">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2318" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2319">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2320">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2321">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2323">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2324">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2325">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2326">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2327">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2329" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2330">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2332" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2334" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2335">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2337" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2339">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2341">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2343">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2344" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2346" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2347">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2348">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2349">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2352">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2355" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2356">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2358">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2360">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2362">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2364">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2366" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2367">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2368" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2369">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2370" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2372">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2374">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2375">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2377" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2378">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2380" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2381">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L2383">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2384">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2385">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2387" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2388">		}</span>

<span class="fc" id="L2390">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2398">		return weightedAverageLifeCouponOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2408" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2409">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2411">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2413">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2415" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2416">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2418">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2419">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2420">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2421">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2422">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2424" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2425">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2427" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2429" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2430">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2432" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2434">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2436">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2438">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2439" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2441" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2442">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2443">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2444">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2447">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2450" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2451">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2453">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2455">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2457">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2459">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2461" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2462">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2463" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2464">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2465" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2467">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2469">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2470">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2472" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2473">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2475" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2476">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2477">					dblPeriodEndNotional) * cc.survival (iPeriodPayDate) * (1. - cc.effectiveRecovery</span>
<span class="fc" id="L2478">						(iPeriodStartDate, period.endDate()));</span>

<span class="fc" id="L2480">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2481">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2482">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2484" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2485">		}</span>

<span class="fc" id="L2487">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * cc.survival</span>
<span class="fc" id="L2488">			(iWorkoutDate) * (1. - cc.recovery (iWorkoutDate));</span>

<span class="fc" id="L2490">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2491">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2492">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2500">		return weightedAverageLifeLossOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2510" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2511">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2513">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2515">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2517" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2518">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2520">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2521">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2522">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2523">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2524">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2526" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2527">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2529" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2531" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2532">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2534" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2536">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2538">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2540">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2541" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2543" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2544">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2545">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2546">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2549">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2552" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2553">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2555">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2557">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2559">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2561">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2563" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2564">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2565" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2566">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2567" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2569">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2571">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2572">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2574" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2575">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc" id="L2577">			double dblPeriodSurvival = cc.survival (iPeriodPayDate);</span>

<span class="pc bpc" id="L2579" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2580">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional) * (dblPeriodSurvival * (1. - cc.effectiveRecovery
<span class="fc" id="L2582">						(iPeriodStartDate, iNotionalEndDate)) + 1. - dblPeriodSurvival);</span>

<span class="fc" id="L2584">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2585">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2586">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2588" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2589">		}</span>

<span class="fc" id="L2591">		double dblTerminalSurvival = cc.survival (iWorkoutDate);</span>

<span class="fc" id="L2593">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * (dblTerminalSurvival *</span>
<span class="fc" id="L2594">			(1. - cc.recovery (iWorkoutDate)) + 1. - dblTerminalSurvival);</span>

<span class="fc" id="L2596">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2597">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2598">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2606">		return weightedAverageLifeCredit (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double priceFromZeroCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iZeroCurveBaseDC,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2619" title="1 of 2 branches missed.">		if (null == valParams)</span>
<span class="nc" id="L2620">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2622">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2624" title="1 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == csqc || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L2625" title="2 of 4 branches missed.">			(dblWorkoutFactor) || !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="fc" id="L2626">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs &quot; + dblBump);</span>

<span class="fc" id="L2628">		double dblPV = 0.;</span>
<span class="fc" id="L2629">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2630">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L2631">		org.drip.state.discount.ZeroCurve zc = null;</span>
<span class="fc" id="L2632">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2633">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2635" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2636">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2638" title="1 of 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L2639">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="fc bfc" id="L2641" title="All 2 branches covered.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="fc" id="L2642">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2644" title="1 of 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc bfc" id="L2647" title="All 2 branches covered.">		org.drip.state.discount.DiscountCurve dcBase = ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE ==</span>
<span class="fc" id="L2648">			iZeroCurveBaseDC ? csqc.fundingState (fundingLabel()) : csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L2650" title="All 2 branches covered.">		if (null == dcBase)</span>
<span class="fc" id="L2651">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Discount Curve&quot;);</span>

		try {
<span class="fc bfc" id="L2654" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L2655">				valParams.cashPayDate();</span>
<span class="nc" id="L2656">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2659">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2660">		}</span>

<span class="fc" id="L2662">		java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; lsCompositePeriod = couponPeriods();</span>

		try {
<span class="fc" id="L2665">			zc = org.drip.state.curve.DerivedZeroRate.FromBaseCurve (freq(), couponDC(), currency(),</span>
<span class="pc bpc" id="L2666" title="1 of 4 branches missed.">				_stream.couponEOMAdjustment(), lsCompositePeriod, terminationAdjust (iWorkoutDate),</span>
					iValueDate, iCashPayDate, dcBase, dblBump, null == vcp ? (null == _quoteConvention ? null
<span class="pc" id="L2668">						: _quoteConvention.valuationCustomizationParams()) : vcp, new</span>
							org.drip.spline.params.SegmentCustomBuilderControl
								(org.drip.spline.stretch.MultiSegmentSequenceBuilder.BASIS_SPLINE_POLYNOMIAL,
									new org.drip.spline.basis.PolynomialFunctionSetParams (2),
<span class="fc" id="L2672">										org.drip.spline.params.SegmentInelasticDesignControl.Create (0, 2),</span>
											new org.drip.spline.params.ResponseScalingShapeControl (true, new
												org.drip.function.r1tor1.QuadraticRationalShapeControl (0.)),
													null));
<span class="nc" id="L2676">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L2677">			e.printStackTrace();</span>
<span class="fc" id="L2678">		}</span>

<span class="pc bpc" id="L2680" title="1 of 2 branches missed.">		if (null == zc)</span>
<span class="nc" id="L2681">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Cannot create shifted ZC&quot;);</span>

<span class="pc bpc" id="L2683" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : lsCompositePeriod) {</span>
<span class="fc" id="L2684">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2686" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2688">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2690">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2692">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L2694">			int iNotionalEndDate = iAccrualEndDate;</span>
<span class="fc" id="L2695">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2697">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc bfc" id="L2699" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2700">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2701">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2702">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2705">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START ==</span>
<span class="fc bfc" id="L2706" title="All 2 branches covered.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2707">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="fc" id="L2708">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END ==</span>
<span class="pc bpc" id="L2709" title="1 of 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2710">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc" id="L2711">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
<span class="nc bnc" id="L2712" title="All 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="nc" id="L2713">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2715">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2718" title="1 of 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2720" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2721">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2723" title="1 of 2 branches missed.">			dblPV += (period.accrualDCF (iAccrualEndDate) * (bApplyFlatForwardRate ? dblFlatForwardRate :</span>
<span class="fc" id="L2724">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2725">					dblPeriodEndNotional) * zc.df (iPeriodPayDate);</span>

<span class="fc bfc" id="L2727" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2728">		}</span>

<span class="fc" id="L2730">		return ((dblPV + dblWorkoutFactor * zc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L2731">			(iWorkoutDate)) / zc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	@Override public double priceFromFundingCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="fc" id="L2742">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_FUNDING_CURVE);
	}

	@Override public double priceFromTreasuryCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="nc" id="L2754">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_TREASURY_CURVE);
	}

	@Override public double priceFromCreditCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis,
		final boolean bFlat)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2767" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L2768" title="1 of 4 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblCreditBasis) || null == _creditSetting)</span>
<span class="fc" id="L2769">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2771">		org.drip.state.credit.CreditCurve ccIn = csqc.creditState (creditLabel());</span>

<span class="fc bfc" id="L2773" title="All 2 branches covered.">		if (null == ccIn)</span>
<span class="fc" id="L2774">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2776">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L2778" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L2779">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No funding curve&quot;);</span>

<span class="fc" id="L2781">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2783" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2784">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L2785">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2786">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="pc bpc" id="L2788" title="1 of 2 branches missed.">		double dblRecoveryToUse = !_creditSetting.useCurveRecovery() ? _creditSetting.recovery() :</span>
			java.lang.Double.NaN;

<span class="pc bpc" id="L2791" title="1 of 2 branches missed.">		org.drip.state.credit.CreditCurve cc = bFlat ? ccIn.flatCurve (dblCreditBasis, true,</span>
			dblRecoveryToUse) : (org.drip.state.credit.CreditCurve) ccIn.parallelShiftManifestMeasure
<span class="fc" id="L2793">				(&quot;SwapRate&quot;, dblCreditBasis);</span>

<span class="pc bpc" id="L2795" title="1 of 2 branches missed.">		if (null == cc)</span>
<span class="nc" id="L2796">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromCreditCurve =&gt; Cannot create adjusted Curve&quot;);

<span class="fc" id="L2799">		double dblPV = 0.;</span>
<span class="fc" id="L2800">		boolean bTerminateCashFlow = false;</span>
<span class="fc" id="L2801">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2802">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2804" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2805">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2807" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2808">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2810" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="fc" id="L2812">		org.drip.param.pricer.CreditPricerParams pricerParams = new org.drip.param.pricer.CreditPricerParams</span>
			(7, null, false, s_iDiscretizationScheme);

<span class="fc" id="L2815">		int iLossPayLag = _creditSetting.lossPayLag();</span>

<span class="fc" id="L2817">		boolean bAccrualOnDefault = _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L2819">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2821" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc bfc" id="L2822" title="All 2 branches covered.">			if (bTerminateCashFlow) continue;</span>

<span class="fc" id="L2824">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2826" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2828">			int iPeriodEndDate = period.endDate();</span>

<span class="fc bfc" id="L2830" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2831">				bTerminateCashFlow = true;</span>
<span class="fc" id="L2832">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2835">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L2837" title="All 2 branches covered.">			if (iPeriodStartDate &lt; iValueDate) iPeriodStartDate = iValueDate;</span>

<span class="fc" id="L2839">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2842" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2843">				throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2845" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2846">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2848" title="1 of 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="fc" id="L2850">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2852">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L2854">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L2856" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2857">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L2858" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2859">				dblCouponNotional = notional (iPeriodEndDate);</span>
<span class="nc bnc" id="L2860" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2862">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc" id="L2864">			dblPV += (period.accrualDCF (iPeriodEndDate) * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dcFunding.df
<span class="fc" id="L2866">					(iPeriodPayDate) * cpcm.cumulative() * cc.survival (iPeriodEndDate);</span>

<span class="fc bfc" id="L2868" title="All 2 branches covered.">			for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this, valParams,</span>
				pricerParams, iPeriodEndDate, csqc)) {
<span class="pc bpc" id="L2870" title="1 of 2 branches missed.">				if (null == lqm) continue;</span>

<span class="fc" id="L2872">				int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L2874">				int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L2876">				double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
					iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L2879">				double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L2881">				double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L2882">					(iSubPeriodEndDate);</span>

<span class="fc bfc" id="L2884" title="All 2 branches covered.">				if (bAccrualOnDefault)</span>
<span class="fc" id="L2885">					dblPV += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival * dblSubPeriodDF *</span>
						dblSubPeriodNotional * dblPeriodCoupon;

<span class="pc bpc" id="L2888" title="1 of 2 branches missed.">				dblPV += (_creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
<span class="pc" id="L2889">					iSubPeriodEndDate) : _creditSetting.recovery()) * dblSubPeriodSurvival *</span>
						dblSubPeriodNotional * dblSubPeriodDF;
<span class="fc" id="L2891">			}</span>
<span class="fc" id="L2892">		}</span>

		try {
<span class="pc bpc" id="L2895" title="1 of 2 branches missed.">			iCashPayDate = null == _quoteConvention ? valParams.cashPayDate() : _quoteConvention.settleDate</span>
<span class="fc" id="L2896">				(valParams);</span>
<span class="nc" id="L2897">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2900">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2901">		}</span>

<span class="fc" id="L2903">		return ((dblPV + dblWorkoutFactor * dcFunding.df (terminationAdjust (iWorkoutDate)) * cc.survival</span>
<span class="fc" id="L2904">			(iWorkoutDate) * notional (iWorkoutDate)) / dcFunding.df (iCashPayDate) - accrued (iValueDate,</span>
				csqc)) / dblScalingNotional;
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2917">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L2918">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2928">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2938" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2939">			throw new java.lang.Exception (&quot;BondComponent::aswFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Bond Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2942">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2954">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L2955">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2965">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2975" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2976">			throw new java.lang.Exception (&quot;BondComponent::aswFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Credit Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2979">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2991">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L2992">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3002">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3012" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3013">			throw new java.lang.Exception (&quot;BondComponent::aswFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3016">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3028">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3029">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3039">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3049" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3050">			throw new java.lang.Exception (&quot;BondComponent::aswFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3053">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3065">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L3066">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3076">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3086" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3087">			throw new java.lang.Exception (&quot;BondComponent::aswFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3090">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3102">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L3103">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3113">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3123" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3124">			throw new java.lang.Exception (&quot;BondComponent::aswFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3127">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3139">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L3140">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3150">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3160" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3161">			throw new java.lang.Exception (&quot;BondComponent::aswFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3164">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3176">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L3177">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3187">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3197" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3198">			throw new java.lang.Exception (&quot;BondComponent::aswFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3201">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3213">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3224">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3234" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3235">			throw new java.lang.Exception (&quot;BondComponent::aswFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3238">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3250">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L3251">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3261">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3271" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3272">			throw new java.lang.Exception (&quot;BondComponent::aswFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3275">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3287" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L3288" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L3289">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3291">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L3293" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L3294">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3296">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="pc bpc" id="L3299" title="1 of 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; No CPCM&quot;);</span>

<span class="fc" id="L3301">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L3303" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L3304">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3306">		return cpcm.rate() - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + 0.0001 *</span>
<span class="fc" id="L3307">			(dblWorkoutFactor - dblPrice) / dcFunding.parSwapDV01 (iWorkoutDate);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3317">		return aswFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double aswFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3327">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L3329" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3330">			throw new java.lang.Exception</span>
				(&quot;BondComponent::aswFromPriceToOptimalExercise =&gt; Can't determine Optimal Work-out&quot;);

<span class="nc" id="L3333">		return aswFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L3345">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="fc" id="L3346">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3356">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3366" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3367">			throw new java.lang.Exception (&quot;BondComponent::aswFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3370">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3382">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3393">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3403" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3404">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3407">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3419">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L3420">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3430">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3440" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3441">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3444">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3456">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L3457">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3467">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double aswFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3477" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3478">			throw new java.lang.Exception (&quot;BondComponent::aswFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3481">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3493">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L3494">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3504">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3514" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3515">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3518">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3530">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3531">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3541">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3551" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3552">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3555">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3567">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3568">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3579">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3590" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3591">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3594">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3607">		return bondBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3608">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3618">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3628" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3629">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3632">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3644">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L3645">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3655">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3665" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3666">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3669">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3681">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L3682">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3692">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3702" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3703">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3706">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3718">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L3719">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3729">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3739" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3740">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3743">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3755">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L3756">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3766">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3776" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3777">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3780">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3792">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L3793">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3803">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3813" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3814">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3817">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3829">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L3830">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3840">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3850" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3851">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3854">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3866">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L3867">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3877">		return bondBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double bondBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3887">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>
		
<span class="nc bnc" id="L3889" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3890">			throw new java.lang.Exception</span>
				(&quot;BondComponent::bondBasisFromPriceToOptimalExercise =&gt; cant calc Work-out info&quot;);

<span class="nc" id="L3893">		return bondBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3905">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L3906">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3916">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3926" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3927">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3930">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3942" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L3943">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L3945">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L3946">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3956">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3966" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3967">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3970">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3982">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3983">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3993">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4003" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4004">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4007">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4019">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L4020">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4030">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4040" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4041">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4044">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4056">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4057">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4067">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4077" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4078">			throw new java.lang.Exception (&quot;BondComponent::convexityFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4081">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4093">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L4094">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4104">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4114" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4115">			throw new java.lang.Exception (&quot;BondComponent::convexityFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4118">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4130">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4131">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4141">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4151" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4152">			throw new java.lang.Exception (&quot;BondComponent::convexityFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4155">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4167">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4168">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4179">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4190" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4191">			throw new java.lang.Exception (&quot;BondComponent::convexityFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Convexity from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4194">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4207">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4208">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4218">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4228" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4229">			throw new java.lang.Exception (&quot;BondComponent::convexityFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4232">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4244">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4245">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4255">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4265" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4266">			throw new java.lang.Exception (&quot;BondComponent::convexityFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4269">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4281">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4282">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4292">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4302" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4303">			throw new java.lang.Exception (&quot;BondComponent::convexityFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4306">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4318">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4319">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4329">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4339" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4340">			throw new java.lang.Exception (&quot;BondComponent::convexityFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4343">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4355">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4356">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4366">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4376" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4377">			throw new java.lang.Exception (&quot;BondComponent::convexityFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4380">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4392">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4393">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4403">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4413" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4414">			throw new java.lang.Exception (&quot;BondComponent::convexityFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4417">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4429">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4430">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4440">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4450" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4451">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4454">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L4466" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L4467">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc" id="L4469">		double dblYield = yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>

<span class="fc" id="L4471">		return (priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield - 0.0001) +</span>
<span class="fc" id="L4472">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001) - 2. *</span>
<span class="fc" id="L4473">				dblPrice) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4483">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4493" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4494">			throw new java.lang.Exception (&quot;BondComponent::calcConvexityFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4497">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4509">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L4510">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4520">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4530" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4531">			throw new java.lang.Exception (&quot;BondComponent::convexityFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4534">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4546">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L4547">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4557">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4567" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4568">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4571">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4583">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L4584">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4594">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4604" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4605">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4608">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4620">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L4621">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4631">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4641" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4642">			throw new java.lang.Exception (&quot;BondComponent::convexityFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4645">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4657">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4658">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4668">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4678" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4679">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Credit Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4682">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4694">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4695">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4705">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4715" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4716">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4719">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4731">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4732">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4743">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4754" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4755">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Credit Basis from Discnt Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4759">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4772">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4773">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4783">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4793" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4794">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4797">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4809">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4810">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4820">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4830" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4831">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4834">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4846">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4847">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4857">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4867" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4868">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4871">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4883">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4884">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4894">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4904" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4905">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4908">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4920">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4921">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4931">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4941" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4942">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4945">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4957">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4958">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4968">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4978" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4979">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4982">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4994">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4995">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5005">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5015" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5016">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5019">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5031">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, false);
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5042">		return creditBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double creditBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5052">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5054" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5055">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromPriceToOptimalExercise =&gt; cant calc Work-out&quot;);

<span class="nc" id="L5058">		return creditBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L5070">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5071">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5081">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5091" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5092">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5095">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5107">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L5108">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5118">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5128" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5129">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5132">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5144">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5145">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5155">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws	java.lang.Exception
	{
<span class="nc bnc" id="L5166" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5167">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5170">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5183">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L5184">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5194">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5204" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5205">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5208">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5220">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L5221">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5231">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5241" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5242">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5245">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5257">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5258">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5268">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5278" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5279">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5282">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5294">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5295">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5305">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5316" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5317">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Crdit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5321">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5334">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5335">			yieldFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5345">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5355" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5356">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromESpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5359">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5371">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5372">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5382">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5392" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5393">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromGSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5396">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5408">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5409">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5419">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5429" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5430">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromISpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5433">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5445">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5446">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5456">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5466" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5467">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromJSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5470">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5482">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5483">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5493">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5503" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5504">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromNSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5507">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5519">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L5520">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5530">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5540" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5541">			throw new java.lang.Exception (&quot;BondComponent::calcDiscountMarginFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5544">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5556">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L5557">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5567">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5577" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5578">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5581">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5593">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5594">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5604">		return discountMarginFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double discountMarginFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5614">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5616" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5617">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L5620">		return discountMarginFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5632">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5633">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5643">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5653" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5654">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromTSYSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5657">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L5669" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L5670">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5672">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L5674" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L5675">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5677">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L5679">		int iFreq = freq();</span>

<span class="fc" id="L5681">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L5683" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L5684">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L5686" title="1 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
<span class="fc" id="L5687">			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblYield - dcFunding.libor (iValueDate,</span>
<span class="fc" id="L5688">				((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblYield - indexRate (iValueDate, csqc,</span>
					(org.drip.analytics.cashflow.CompositeFloatingPeriod) cp);
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5699">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5709" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5710">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5713">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5725">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5726">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5736">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5747" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5748">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5752">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5765">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5766">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5776">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5786" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5787">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromZSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5790">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5802">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L5803">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5813">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5823" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5824">			throw new java.lang.Exception (&quot;BondComponent::durationFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5827">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5839">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L5840">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5850">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5860" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5861">			throw new java.lang.Exception (&quot;BondComponent::durationFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5864">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5876">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5877">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5887">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5897" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5898">			throw new java.lang.Exception (&quot;BondComponent::durationFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5901">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5913">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5914">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5925">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5936" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5937">			throw new java.lang.Exception (&quot;BondComponent::durationFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Duration from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5940">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5953">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L5954">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5964">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5974" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5975">			throw new java.lang.Exception (&quot;BondComponent::durationFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5978">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5990">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L5991">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6001">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6011" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6012">			throw new java.lang.Exception (&quot;BondComponent::durationFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6015">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6027">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6028">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6038">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6048" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6049">			throw new java.lang.Exception (&quot;BondComponent::durationFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6052">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6064">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6065">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6075">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6085" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6086">			throw new java.lang.Exception (&quot;BondComponent::durationFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6089">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6101">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6102">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6112">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6122" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6123">			throw new java.lang.Exception (&quot;BondComponent::durationFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6126">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6138">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6139">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6149">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6159" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6160">			throw new java.lang.Exception (&quot;BondComponent::durationFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6163">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6175">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6176">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6186">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6196" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6197">			throw new java.lang.Exception (&quot;BondComponent::durationFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6200">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6212">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6222">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6232" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6233">			throw new java.lang.Exception (&quot;BondComponent::durationFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6236">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6248">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6249">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6259">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6269" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6270">			throw new java.lang.Exception (&quot;BondComponent::durationFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6273">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6285">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6286">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6296">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6306" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6307">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6310">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6322">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6323">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6333">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6343" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6344">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6347">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6359">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L6360">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6370">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6380" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6381">			throw new java.lang.Exception (&quot;BondComponent::durationFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6384">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6396">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L6397">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6407">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6417" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6418">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6421">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6433">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L6434">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6444">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6454" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6455">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6458">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6470">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L6471">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6481">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6491" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6492">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6495">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6507">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6508">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6519">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6530" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6531">			throw new java.lang.Exception</span>
				(&quot;BondComponent::eSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc E Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6535">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6548">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L6549">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6559">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6569" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6570">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6573">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6585">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6586">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6596">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6606" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6607">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6610">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6622">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6623">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6633">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6643" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6644">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6647">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6659">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6660">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6670">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6680" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6681">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6684">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6696">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6697">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6707">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6717" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6718">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6721">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6733">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6734">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6744">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6754" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6755">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6758">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6770">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6781">		return eSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double eSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6791">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L6793" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L6794">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6797">		return eSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6809">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6810">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6820">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6830" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6831">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6834">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6846">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6847">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6857">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6867" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6868">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6871">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6883">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L6884">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6894">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double eSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6904" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6905">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6908">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6920">		return gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L6921">			(valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6931">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6941" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6942">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6945">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6957">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L6958">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6968">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6978" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6979">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6982">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6994">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L6995">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7005">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7015" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7016">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7019">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7031">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7032">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7043">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7054" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7055">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc G Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7058">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7071">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7072">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7082">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7092" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7093">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7096">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7108">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L7109">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7119">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7129" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7130">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7133">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7145">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7146">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7156">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7166" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7167">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7170">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7182">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7183">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7193">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7203" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7204">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7207">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7219">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7220">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7230">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7240" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7241">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7244">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7256">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7257">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7267">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7277" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7278">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7281">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7293">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7294">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7304">		return gSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double gSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7314">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7316" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7317">			throw new java.lang.Exception</span>
				(&quot;BondComponent::gSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7320">		return gSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7332">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7333">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7343">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7353" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7354">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7357">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7369" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield) ||</span>
<span class="pc bpc" id="L7370" title="1 of 2 branches missed.">			valParams.valueDate() &gt;= iWorkoutDate)</span>
<span class="nc" id="L7371">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7373">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L7375" title="All 2 branches covered.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7377">		return dblYield - gc.yield (iWorkoutDate);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7387">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7397" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7398">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7401">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7413">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7414">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7424">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7434" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7435">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7438">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7450">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7451">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7461">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double gSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7471" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7472">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7475">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7487">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7488">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7498">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7508" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7509">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7512">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7524">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L7525">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7535">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7545" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7546">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7549">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7561">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L7562">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7572">		return iSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7582" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7583">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7586">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7598">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7599">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7610">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7621" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7622">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc I Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7625">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7638">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7639">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7649">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7659" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7660">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7663">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7675">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L7676">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7686">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7696" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7697">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7700">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7712">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7713">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7723">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7733" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7734">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7737">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7749">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7750">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7760">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7770" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7771">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7774">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7786">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7787">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7797">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7807" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7808">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7811">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7823">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7824">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7834">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7844" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7845">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7848">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7860">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7861">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7871">		return iSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double iSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7881">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7883" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7884">			throw new java.lang.Exception</span>
				(&quot;BondComponent::iSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7887">		return iSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7899">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7900">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7910">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7920" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7921">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7924">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7936" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L7937">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7939">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L7941" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L7942">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7944">		return dblYield - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7954">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7964" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7965">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7968">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7980">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7981">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7991">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8001" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8002">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8005">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8017">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8018">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8028">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8038" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8039">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8042">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8054">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L8055">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8065">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8075" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8076">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8079">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8091">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L8092">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8102">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8112" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8113">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8116">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8128">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L8129">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8139">		return jSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8149" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8150">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8153">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8165">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8166">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8177">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8188" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8189">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc J Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8192">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8205">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L8206">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8216">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8226" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8227">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8230">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8242">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L8243">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8253">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8263" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8264">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8267">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8279">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L8280">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8290">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8300" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8301">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8304">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8316">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L8317">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8327">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8337" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8338">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8341">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8353">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L8354">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8364">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8374" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8375">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8378">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8390">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L8391">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8401">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8411" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8412">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8415">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8427">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L8428">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8438">		return jSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double jSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8448">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L8450" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L8451">			throw new java.lang.Exception</span>
				(&quot;BondComponent::jSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L8454">		return jSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8466">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L8467">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8477">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8487" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8488">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8491">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L8503" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L8504">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8506">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="pc bpc" id="L8508" title="1 of 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8510">		return dblYield - gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L8521">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8531" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8532">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8535">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8547">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L8548">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8558">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8568" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8569">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8572">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8584">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8585">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8595">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8605" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8606">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8609">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8621">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8622">			yieldFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8632">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8642" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8643">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8647">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8659">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8660">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8670">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8681" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8682">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8686">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8699">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8700">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8710">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8721" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8722">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8726">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8739">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8740">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8751">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8762" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8763">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8767">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8780">		return macaulayDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8781">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8791">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8801" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8802">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8806">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8818">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8819">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8829">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8839" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8840">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8844">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8856">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8857">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8867">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8877" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8878">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8882">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8894">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8895">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8905">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8915" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8916">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8920">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8932">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8933">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8943">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8953" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8954">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8958">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8970">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8971">			yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8981">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double mnacaulayDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8991" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8992">			throw new java.lang.Exception</span>
				(&quot;BondComponent::mnacaulayDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8996">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9008">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9009">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9019">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9029" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9030">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9034">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9046">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9047">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9057">		return macaulayDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double macaulayDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9067">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9069" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9070">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9073">		return macaulayDurationFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9085">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9086">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9096">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9107" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9108">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9112">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9125" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L9126">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9128">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L9130" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L9131">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9133">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L9134">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L9135">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L9136">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L9137">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L9138">		double dblCumulativePeriodDuration = 0.;</span>
<span class="fc" id="L9139">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L9140">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>
<span class="fc" id="L9141">		org.drip.analytics.cashflow.CompositePeriod periodRef = null;</span>

<span class="fc" id="L9143">		int iFrequency = freq();</span>

<span class="fc" id="L9145">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L9147">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L9149">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L9151" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L9153" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L9154">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L9156" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L9157">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L9159">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L9161">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L9163">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L9165">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L9166" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L9167">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L9169">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L9171">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L9173">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L9175">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L9178">		int iAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L9180" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L9181">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L9183" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L9185" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L9186">				bFirstPeriod = false;</span>

<span class="fc" id="L9188">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L9190">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L9192">			periodRef = period;</span>

<span class="fc" id="L9194">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L9196">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L9198" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L9199">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L9200">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L9203">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L9206" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L9207">				throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; No CPCM&quot;);</span>

<span class="pc bpc" id="L9209" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L9210" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L9211">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L9213" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L9214" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L9215">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L9218">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L9221">			double dblYearFract = org.drip.analytics.daycount.Convention.YearFraction (iValueDate,</span>
				iPeriodPayDate, strDC, bApplyCpnEOMAdj, aap, strCalendar);

<span class="fc" id="L9224">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L9225">				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract : dblYearFract) * cpcm.cumulative();</span>

<span class="fc" id="L9227">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L9229">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L9231">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L9233" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iAmortizationMode)</span>
<span class="fc" id="L9234">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L9235" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iAmortizationMode)</span>
<span class="fc" id="L9236">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L9237" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE == iAmortizationMode)</span>
<span class="nc" id="L9238">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L9240" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L9241">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L9243" title="1 of 2 branches missed.">			double dblCouponPV = period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="fc" id="L9244">				dblFlatForwardRate : cpcm.rate()) * couponFactor (iPeriodEndDate) * dblYieldAnnuity *</span>
					dblCouponNotional;

<span class="fc" id="L9247">			double dblPeriodNotionalPV = (dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;</span>
<span class="fc" id="L9248">			dblCumulativePeriodDuration += dblPeriodYearFract * (dblCouponPV + dblPeriodNotionalPV);</span>
<span class="fc" id="L9249">			dblCumulativePeriodPV += (dblCouponPV + dblPeriodNotionalPV);</span>

<span class="fc bfc" id="L9251" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L9252">		}</span>

<span class="pc bpc" id="L9254" title="1 of 2 branches missed.">		if (null != periodRef)</span>
<span class="fc" id="L9255">			aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, periodRef.endDate() -</span>
<span class="fc" id="L9256">				periodRef.startDate());</span>

<span class="fc" id="L9258">		double dblRedemptionPV = dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (iFrequency,</span>
			dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L9261">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate);</span>

<span class="fc" id="L9263">		return (dblCumulativePeriodDuration + dblPeriodYearFract * dblRedemptionPV) / (dblCumulativePeriodPV</span>
			+ dblRedemptionPV);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9274">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9284" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9285">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Macaulay Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9288">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9300">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9301">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9311">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9322" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9323">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9327">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9340">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9341">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9351">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9361" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9362">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9366">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9378">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9379">			priceFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9389">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9399" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9400">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9404">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9416">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9417">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9427">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9438" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9439">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9443">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9456">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9457">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9467">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9478" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9479">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9483">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9496">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9497">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9508">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9519" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9520">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9524">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9537">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9538">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9548">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9558" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9559">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9563">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9575">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9576">			priceFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9586">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9596" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9597">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9601">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9613">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9614">			priceFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9624">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9634" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9635">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9639">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9651">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9652">			priceFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9662">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9672" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9673">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9677">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9689">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9690">			priceFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9700">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9710" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9711">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9715">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9727">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9728">			priceFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9738">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9748" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9749">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9753">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9765">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9766">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9776">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9786" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9787">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9791">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9803" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L9804">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc bfc" id="L9806" title="All 2 branches covered.">		if (null == _floaterSetting)</span>
<span class="fc" id="L9807">			return (dblPrice - priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9808">				yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) + 0.0001)) /</span>
<span class="fc" id="L9809">					(dblPrice + accrued (valParams.valueDate(), csqc));</span>

<span class="fc" id="L9811">		return (dblPrice - priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9812">			discountMarginFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) +</span>
<span class="fc" id="L9813">				0.0001)) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9823">		return modifiedDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double modifiedDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9833">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9835" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9836">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9839">		return modifiedDurationFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9851">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9852">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9862">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9873" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9874">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9878">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9891">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9892">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9902">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9912" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9913">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Modified Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9916">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9928">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9929">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9939">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9950" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9951">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9955">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9968">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9969">			priceFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9979">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9989" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9990">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9994">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10006">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L10007">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10017">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10027" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10028">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10031">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10043">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L10044">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10054">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10064" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10065">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10068">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10080">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L10081">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10091">		return nSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10101" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10102">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10105">		return nSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10117">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L10118">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10129">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10140" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10141">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc N Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10144">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10157">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L10158">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10168">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10178" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10179">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10182">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10194">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L10195">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10205">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10215" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10216">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10219">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10231">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L10232">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10242">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10252" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10253">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10256">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10268">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L10269">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10279">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10289" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10290">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10293">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10305">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L10306">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10316">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10326" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10327">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10330">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10342">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L10343">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10353">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10363" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10364">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10367">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10379">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L10380">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10390">		return nSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double nSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10400">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10402" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10403">			throw new java.lang.Exception</span>
				(&quot;BondComponent::nSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L10406">		return nSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10418">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L10419">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10429">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10439" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10440">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10443">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L10455" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L10456">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10458">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L10460" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L10461">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10463">		return dblYield - dcFunding.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10473">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10483" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10484">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10487">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10499">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L10500">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10510">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10520" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10521">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10524">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10536">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L10537">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10547">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10557" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10558">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10561">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10573">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10584">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10594" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10595">			throw new java.lang.Exception (&quot;BondComponent::oasFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10598">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10610">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L10611">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10621">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10631" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10632">			throw new java.lang.Exception (&quot;BondComponent::oasFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10635">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10647">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L10648">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10658">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10668" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10669">			throw new java.lang.Exception (&quot;BondComponent::oasFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10672">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10684">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L10685">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10695">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10705" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10706">			throw new java.lang.Exception (&quot;BondComponent::oasFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10709">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10721">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L10722">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10732">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10742" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10743">			throw new java.lang.Exception (&quot;BondComponent::oasFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10746">		return oasFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10758">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L10759">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10769">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10779" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10780">			throw new java.lang.Exception (&quot;BondComponent::oasFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10783">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10795">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L10796">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10806">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10816" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10817">			throw new java.lang.Exception (&quot;BondComponent::oasFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10820">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10832">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L10833">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10843">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10853" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10854">			throw new java.lang.Exception (&quot;BondComponent::oasFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10857">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10869">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L10870">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10880">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10890" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10891">			throw new java.lang.Exception (&quot;BondComponent::oasFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10894">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10906">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10907">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10917">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10927" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10928">			throw new java.lang.Exception (&quot;BondComponent::oasFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10931">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10943">		return new BondCalibrator (this, false).calibrateOASFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10954">		return oasFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double oasFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10964">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10966" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10967">			throw new java.lang.Exception</span>
				(&quot;BondComponent::oasFromPriceToOptimalExercise - cant calc Work-out&quot;);

<span class="nc" id="L10970">		return oasFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10982">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L10983">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10993">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11003" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11004">			throw new java.lang.Exception (&quot;BondComponent::oasFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11007">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L11019">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L11020">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11030">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11040" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11041">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11044">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11056">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11057">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11067">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11077" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11078">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11081">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11093">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11094">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11104">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11114" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11115">			throw new java.lang.Exception (&quot;BondComponent::oasFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11118">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11130">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L11131">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11141">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11151" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11152">			throw new java.lang.Exception (&quot;BondComponent::pecsFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11155">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11167">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L11168">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11178">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11188" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11189">			throw new java.lang.Exception (&quot;BondComponent::pecsFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11192">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11204">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L11205">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11215">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11225" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11226">			throw new java.lang.Exception (&quot;BondComponent::pecsFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11229">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11241">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L11242">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11252">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11262" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11263">			throw new java.lang.Exception (&quot;BondComponent::pecsFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11266">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11278">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L11279">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11289">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11299" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11300">			throw new java.lang.Exception (&quot;BondComponent::pecsFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11303">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11315">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L11316">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11326">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11336" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11337">			throw new java.lang.Exception (&quot;BondComponent::pecsFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11340">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11352">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L11353">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11363">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11373" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11374">			throw new java.lang.Exception (&quot;BondComponent::pecsFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11377">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11389">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L11390">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11400">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11410" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11411">			throw new java.lang.Exception (&quot;BondComponent::pecsFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11414">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11426">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L11427">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11437">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11447" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11448">			throw new java.lang.Exception (&quot;BondComponent::pecsFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11451">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11463">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L11464">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11474">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11484" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11485">			throw new java.lang.Exception (&quot;BondComponent::pecsFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11488">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11500">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, true);
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11511">		return pecsFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double pecsFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11521">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L11523" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L11524">			throw new java.lang.Exception</span>
				(&quot;BondComponent::pecsFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L11527">		return pecsFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11539">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L11540">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11550">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11560" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11561">			throw new java.lang.Exception (&quot;BondComponent::pecsFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11564">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11576">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L11577">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11587">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11597" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11598">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11601">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11613">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11614">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11624">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11634" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11635">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11638">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11650">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11651">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11661">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11671" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11672">			throw new java.lang.Exception (&quot;BondComponent::pecsFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11675">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11687" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="nc bnc" id="L11688" title="All 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblASW))</span>
<span class="nc" id="L11689">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11691">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L11693" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L11694">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11696">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L11698" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L11699">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11701">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="nc bnc" id="L11704" title="All 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; No CPCM&quot;);</span>

<span class="nc" id="L11706">		return dblWorkoutFactor - 100. * dcFunding.parSwapDV01 (iWorkoutDate) * (dblASW +</span>
<span class="nc" id="L11707">			dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) - cpcm.rate());</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11717">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11727" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11728">			throw new java.lang.Exception (&quot;BondComponent::priceFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11731">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11743">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="fc" id="L11744">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11754">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11764" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11765">			throw new java.lang.Exception (&quot;BondComponent::priceFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11768">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11780">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblCreditBasis,</span>
			false);
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11791">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11801" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11802">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11805">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="fc" id="L11817">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L11818">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11829">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11840" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11841">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11844">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11857">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L11858">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11868">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11878" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11879">			throw new java.lang.Exception (&quot;BondComponent::priceFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11882">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11894">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L11895">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11905">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11915" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11916">			throw new java.lang.Exception (&quot;BondComponent::priceFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11919">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11931">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L11932">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11942">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11952" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11953">			throw new java.lang.Exception (&quot;BondComponent::priceFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11956">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11968">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L11969">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11979">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11989" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11990">			throw new java.lang.Exception (&quot;BondComponent::priceFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11993">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12005">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12006">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12016">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12026" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12027">			throw new java.lang.Exception (&quot;BondComponent::priceFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12030">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12042">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblOAS);
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12053">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12063" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12064">			throw new java.lang.Exception (&quot;BondComponent::priceFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12067">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12079">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblPECS, true);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12089">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12099" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12100">			throw new java.lang.Exception (&quot;BondComponent::priceFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12103">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12115">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="fc" id="L12116">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12126">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12136" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12137">			throw new java.lang.Exception (&quot;BondComponent::priceFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12140">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12152">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield, false);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12162">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12172" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12173">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc exercise px from yld for bonds w emb option&quot;);

<span class="nc" id="L12176">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12188">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L12189">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12199">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12209" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12210">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12213">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12225">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblZSpread);
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12236">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12246" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12247">			throw new java.lang.Exception (&quot;BondComponent::priceFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12250">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12262">		return tsySpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12263">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12273">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12283" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12284">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12287">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12299">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L12300">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12310">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12320" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12321">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12324">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12336">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12337">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12347">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12357" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12358">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12361">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12373">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12374">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12385">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12396" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12397">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc TSY Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12400">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12413">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L12414">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12424">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12434" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12435">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12438">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12450">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L12451">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12461">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12471" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12472">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12475">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12487">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L12488">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12498">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12508" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12509">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12512">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12524">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L12525">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12535">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12545" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12546">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12549">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12561">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12562">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12572">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12582" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12583">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12586">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12598">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L12599">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12609">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12619" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12620">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12623">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12635">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L12636">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12646">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12656" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12657">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12660">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12672">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L12673">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12683">		return tsySpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double tsySpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L12693">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L12695" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L12696">			throw new java.lang.Exception</span>
				(&quot;BondComponent::tsySpreadFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L12699">		return tsySpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12711">		return dblYield - treasuryBenchmarkYield (valParams, csqc, iWorkoutDate);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L12721">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12731" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12732">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12735">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12747">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12748">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12758">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12768" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12769">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12772">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12784">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L12785">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12795">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12805" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12806">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12809">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12821">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12822">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12832">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12842" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12843">			throw new java.lang.Exception (&quot;BondComponent::yieldFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12846">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12858" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblBondBasis))</span>
<span class="nc" id="L12859">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasis =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L12861">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L12862">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblBondBasis;</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L12872">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12882" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12883">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12886">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12898">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L12899">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12909">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12919" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12920">			throw new java.lang.Exception (&quot;BondComponent::yieldFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12923">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12935" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L12936" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblDiscountMargin))</span>
<span class="nc" id="L12937">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12939">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L12941" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L12942">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12944">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L12946">		int iFreq = freq();</span>

<span class="fc" id="L12948">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L12950" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L12951">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L12953" title="2 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblDiscountMargin + dcFunding.libor
<span class="fc" id="L12955">				(iValueDate, ((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblDiscountMargin + indexRate</span>
<span class="fc" id="L12956">					(iValueDate, csqc, (org.drip.analytics.cashflow.CompositeFloatingPeriod) currentPeriod</span>
<span class="fc" id="L12957">						(iValueDate));</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12967">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12978">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12991">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L12992">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblESpread));
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13003">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13013" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13014">			throw new java.lang.Exception (&quot;BondComponent::yieldFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13017">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13029" title="All 6 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblGSpread) || valParams.valueDate() &gt;= iWorkoutDate</span>
			|| null == csqc)
<span class="nc" id="L13031">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13033">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13035" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13037">		return gc.yield (iWorkoutDate) + dblGSpread;</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13047">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13057" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13058">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13061">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13073" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13074" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblISpread))</span>
<span class="nc" id="L13075">			throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13077">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13078">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13080" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13082">		return dc.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblISpread;</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13092">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13102">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13114" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13115" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblJSpread))</span>
<span class="nc" id="L13116">			throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13118">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13120" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13122">		return dblJSpread + gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13133">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13143">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13155" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13156" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblNSpread))</span>
<span class="nc" id="L13157">			throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13159">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13160">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13162" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13164">		return dc.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblNSpread;</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13174">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13184">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13196">		return yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13207">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13217" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13218">			throw new java.lang.Exception (&quot;BondComponent::yieldFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13221">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13233">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L13234">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13244">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13254" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13255">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13258">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13270">		return new BondCalibrator (this, false).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13281">		return yieldFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13291">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13293" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13294">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13297">		return wi.yield();</span>
	}

	@Override public double yieldFromPriceTC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13309">		return new BondCalibrator (this, true).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13322" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblTSYSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13324">			throw new java.lang.Exception (&quot;BondComponent::calcYieldFromTSYSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13326">		return treasuryBenchmarkYield (valParams, csqc, iWorkoutDate) + dblTSYSpread;</span>
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13336">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13346" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13347">			throw new java.lang.Exception (&quot;BondComponent::yieldFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13350">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13362" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYieldSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13364">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13366">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L13367">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblYieldSpread;</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L13377">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13387" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13388">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13391">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13403">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L13404">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblZSpread));
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13415">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13425" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13426">			throw new java.lang.Exception (&quot;BondComponent::yieldFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13429">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13441">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13442">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13452">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13462" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13463">			throw new java.lang.Exception (&quot;BondComponent::yield01FromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13466">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13478">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L13479">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13489">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13499" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13500">			throw new java.lang.Exception (&quot;BondComponent::yield01FromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13503">		return yield01FromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13515">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L13516">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13526">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13536" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13537">			throw new java.lang.Exception (&quot;BondComponent::yield01FromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13540">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13552">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13553">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13564">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13575" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13576">			throw new java.lang.Exception (&quot;BondComponent::yield01FromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Yield01 from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13579">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13592">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L13593">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13603">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13613" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13614">			throw new java.lang.Exception (&quot;BondComponent::yield01FromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13617">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13629">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L13630">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13640">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13650" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13651">			throw new java.lang.Exception (&quot;BondComponent::yield01FromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13654">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13666">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L13667">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13677">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13687" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13688">			throw new java.lang.Exception (&quot;BondComponent::yield01FromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13691">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13703">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L13704">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13714">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13724" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13725">			throw new java.lang.Exception (&quot;BondComponent::yield01FromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13728">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13740">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L13741">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13751">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13761" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13762">			throw new java.lang.Exception (&quot;BondComponent::yield01FromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13765">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13777">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L13778">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13788">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13798" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13799">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13802">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13814">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L13815">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13825">		return yield01FromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13835">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13837" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13838">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13841">		return yield01FromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13853">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L13854">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13864">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13874" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13875">			throw new java.lang.Exception (&quot;BondComponent::yield01FromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13878">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13890" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L13891">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13893">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield) -</span>
<span class="fc" id="L13894">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L13904">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13915">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13918">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13930">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L13931">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13941">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13951" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13952">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13955">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13967">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L13968">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13978">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13989">			throw new java.lang.Exception (&quot;BondComponent::yield01FromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13992">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14004">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L14005">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14015">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14025" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14026">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14029">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14041">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14042">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14052">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14062" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14063">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromBondBasisToOptimalExercise =&gt; &quot;</span>
				+ &quot;Cant calc Yield Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14066">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14078">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14079">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14089">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14100" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14101">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromCreditBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Yield Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14104">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14117">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14118">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14129">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14140" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14141">			throw new java.lang.Exception</span>
				(&quot;BondComponent::yieldSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Yield Spread from Disc Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14145">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14158">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L14159">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14169">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14179" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14180">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14183">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14195">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L14196">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14206">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14216" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14217">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14220">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14232">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L14233">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14243">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14253" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14254">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14257">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14269">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L14270">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14280">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14290" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14291">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14294">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14306">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L14307">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14317">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14327" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14328">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14331">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14343">		return yieldSpreadFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L14344">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14354">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14364" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14365">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14368">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14380">		return yieldSpreadFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L14381">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14391">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14401" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14402">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14405">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14417">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L14418">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14428">		return yieldSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14438">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14440" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14441">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14444">		return yieldSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14456">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14457">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14467">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14477" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14478">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14481">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14493" title="All 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L14494">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L14496">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14497">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14507">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14517" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14518">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14521">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14533">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L14534">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14544">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14554" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14555">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14558">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14570">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L14571">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14581">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14591" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14592">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14595">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14607">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L14608">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14618">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14628" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14629">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14632">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14644">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L14645">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14655">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14665" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14666">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14669">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14681">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14682">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14693">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14705">			throw new java.lang.Exception</span>
				(&quot;BondComponent::zSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Z Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14709">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14722">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L14723">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14733">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14743" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14744">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14747">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14759">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L14760">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14770">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14780" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14781">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14784">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14796">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L14797">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14807">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14817" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14818">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14821">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14833">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L14834">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14844">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14854" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14855">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14858">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14870">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L14871">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14881">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14891" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14892">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14895">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14907">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L14908">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14918">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14928" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14929">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14932">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14944">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14955">		return zSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double zSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14965">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14967" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14968">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14971">		return zSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14983">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L14984">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14994">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15004" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15005">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15008">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L15020">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L15021">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L15031">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15041" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15042">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15045">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15057">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L15058">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15068">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double zSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15078" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15079">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15082">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public org.drip.analytics.output.BondRVMeasures standardMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice)
	{
<span class="pc bpc" id="L15093" title="3 of 6 branches missed.">		if (null == valParams || null == csqs || null == wi || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L15094" title="1 of 2 branches missed.">			(dblPrice))</span>
<span class="nc" id="L15095">			return null;</span>

<span class="fc" id="L15097">		int iWorkoutDate = wi.date();</span>

<span class="fc" id="L15099">		double dblWorkoutYield = wi.yield();</span>

<span class="fc" id="L15101">		double dblWorkoutFactor = wi.factor();</span>

<span class="pc bpc" id="L15103" title="1 of 2 branches missed.">		if (valParams.valueDate() &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L15105">		double dblASW = java.lang.Double.NaN;</span>
<span class="fc" id="L15106">		double dblPECS = java.lang.Double.NaN;</span>
<span class="fc" id="L15107">		double dblGSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15108">		double dblISpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15109">		double dblYield01 = java.lang.Double.NaN;</span>
<span class="fc" id="L15110">		double dblZSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15111">		double dblOASpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15112">		double dblBondBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15113">		double dblConvexity = java.lang.Double.NaN;</span>
<span class="fc" id="L15114">		double dblTSYSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15115">		double dblCreditBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15116">		double dblDiscountMargin = java.lang.Double.NaN;</span>
<span class="fc" id="L15117">		double dblMacaulayDuration = java.lang.Double.NaN;</span>
<span class="fc" id="L15118">		double dblModifiedDuration = java.lang.Double.NaN;</span>

		try {
<span class="fc" id="L15121">			dblDiscountMargin = discountMarginFromYield (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblWorkoutYield);
<span class="nc" id="L15123">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15125">		}</span>

<span class="fc bfc" id="L15127" title="All 2 branches covered.">		if (null == _floaterSetting) {</span>
			try {
<span class="fc" id="L15129">				dblZSpread = zSpreadFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
					dblPrice);
<span class="nc" id="L15131">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15133">			}</span>
		}

		try {
<span class="fc" id="L15137">			dblOASpread = oasFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15138">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15140">		}</span>

		try {
<span class="fc" id="L15143">			dblISpread = iSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15145">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15147">		}</span>

		try {
<span class="fc" id="L15150">			dblGSpread = gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15152">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15154">		}</span>

		try {
<span class="fc" id="L15157">			dblTSYSpread = tsySpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15159">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15161">		}</span>

		try {
<span class="fc" id="L15164">			dblMacaulayDuration = macaulayDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15166">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15168">		}</span>

		try {
<span class="fc" id="L15171">			dblModifiedDuration = modifiedDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15173">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15175">		}</span>

		try {
<span class="fc" id="L15178">			dblASW = aswFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15179">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15181">		}</span>

		try {
<span class="fc" id="L15184">			dblConvexity = convexityFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="nc" id="L15186">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15188">		}</span>

		try {
<span class="fc" id="L15191">			dblCreditBasis = creditBasisFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="fc" id="L15193">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15195">		}</span>

		try {
			// dblPECS = pecsFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);
		} catch (java.lang.Exception e) {
			if (!s_bSuppressErrors) e.printStackTrace();
		}

		try {
<span class="fc" id="L15204">			dblBondBasis = bondBasisFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15206">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15208">		}</span>

		try {
<span class="fc" id="L15211">			dblYield01 = yield01FromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15213">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15215">		}</span>

		try {
<span class="fc" id="L15218">			return new org.drip.analytics.output.BondRVMeasures (dblPrice, dblBondBasis, dblZSpread,</span>
				dblGSpread, dblISpread, dblOASpread, dblTSYSpread, dblDiscountMargin, dblASW, dblCreditBasis,
					dblPECS, dblYield01, dblModifiedDuration, dblMacaulayDuration, dblConvexity, wi);
<span class="nc" id="L15221">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L15225">		return null;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; value (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="pc bpc" id="L15234" title="2 of 4 branches missed.">		if (null == valParams || null == csqs) return null;</span>

<span class="fc bfc" id="L15236" title="All 2 branches covered.">		if (null != pricerParams) {</span>
<span class="fc" id="L15237">			org.drip.param.definition.CalibrationParams calibParams = pricerParams.calibParams();</span>

<span class="fc bfc" id="L15239" title="All 2 branches covered.">			if (null != calibParams) {</span>
<span class="fc" id="L15240">				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures =</span>
<span class="fc" id="L15241">					calibMeasures (valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15243" title="2 of 4 branches missed.">				if (null != mapCalibMeasures &amp;&amp; mapCalibMeasures.containsKey (calibParams.measure()))</span>
<span class="fc" id="L15244">					return mapCalibMeasures;</span>
			}
		}

<span class="fc" id="L15248">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = fairMeasures</span>
<span class="fc" id="L15249">			(valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15251" title="1 of 2 branches missed.">		if (null == mapMeasures) return null;</span>

<span class="fc" id="L15253">		java.lang.String strName = name();</span>

<span class="fc" id="L15255">		org.drip.param.definition.ProductQuote pq = csqs.productQuote (strName);</span>

<span class="fc bfc" id="L15257" title="All 2 branches covered.">		if (null == pq) return mapMeasures;</span>

<span class="fc" id="L15259">		int iMaturityDate = maturityDate().julian();</span>

<span class="pc bpc" id="L15261" title="1 of 2 branches missed.">		if (null == _floaterSetting) {</span>
<span class="fc" id="L15262">			double dblParSpread = (mapMeasures.get (&quot;FairDirtyPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15263">				mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairDirtyDV01&quot;);</span>

<span class="fc" id="L15265">			mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15267">			mapMeasures.put (&quot;FairParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15268">		} else {</span>
<span class="nc bnc" id="L15269" title="All 2 branches missed.">			double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15270">				mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15271">					(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15273">			double dblZeroDiscountMargin = (mapMeasures.get (&quot;FairCleanPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15274">				dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15275">					(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15277">			mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15279">			mapMeasures.put (&quot;FairZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
		}

<span class="fc" id="L15282">		org.drip.param.valuation.WorkoutInfo wiMarket = null;</span>

<span class="pc bpc" id="L15284" title="1 of 2 branches missed.">		if (pq.containsQuote (&quot;Price&quot;)) {</span>
<span class="fc" id="L15285">			double dblMarketPrice = pq.quote (&quot;Price&quot;).value (&quot;mid&quot;);</span>

<span class="fc" id="L15287">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblMarketPrice);</span>

<span class="fc" id="L15289">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblMarketPrice);</span>
<span class="pc bnc" id="L15290" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CleanPrice&quot;)) {</span>
<span class="nc" id="L15291">			double dblCleanMarketPrice = pq.quote (&quot;CleanPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15293">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblCleanMarketPrice);</span>

<span class="nc" id="L15295">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblCleanMarketPrice);</span>
<span class="nc bnc" id="L15296" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;QuotedMargin&quot;)) {</span>
<span class="nc" id="L15297">			double dblQuotedMargin = pq.quote (&quot;QuotedMargin&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15299">			mapMeasures.put (&quot;MarketInputType=QuotedMargin&quot;, dblQuotedMargin);</span>

			try {
<span class="nc" id="L15302">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, priceFromDiscountMargin (valParams,</span>
					csqs, vcp, dblQuotedMargin));
<span class="nc" id="L15304">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15306">			}</span>
<span class="nc bnc" id="L15307" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;DirtyPrice&quot;)) {</span>
			try {
<span class="nc" id="L15309">				double dblDirtyMarketPrice = pq.quote (&quot;DirtyPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15311">				mapMeasures.put (&quot;MarketInputType=DirtyPrice&quot;, dblDirtyMarketPrice);</span>

<span class="nc" id="L15313">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblDirtyMarketPrice - accrued</span>
<span class="nc" id="L15314">					(valParams.valueDate(), csqs));</span>
<span class="nc" id="L15315">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15318">				wiMarket = null;</span>
<span class="nc" id="L15319">			}</span>
<span class="nc bnc" id="L15320" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;TSYSpread&quot;)) {</span>
			try {
<span class="nc" id="L15322">				double dblTSYSpread = pq.quote (&quot;TSYSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15324">				mapMeasures.put (&quot;MarketInputType=TSYSpread&quot;, dblTSYSpread);</span>

<span class="nc" id="L15326">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, treasuryBenchmarkYield</span>
<span class="nc" id="L15327">					(valParams, csqs, iMaturityDate) + dblTSYSpread, 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15329">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15332">				wiMarket = null;</span>
<span class="nc" id="L15333">			}</span>
<span class="nc bnc" id="L15334" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;Yield&quot;)) {</span>
			try {
<span class="nc" id="L15336">				double dblYield = pq.quote (&quot;Yield&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15338">				mapMeasures.put (&quot;MarketInputType=Yield&quot;, dblYield);</span>

<span class="nc" id="L15340">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, dblYield, 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15342">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15345">				wiMarket = null;</span>
<span class="nc" id="L15346">			}</span>
<span class="nc bnc" id="L15347" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ZSpread&quot;)) {</span>
			try {
<span class="nc" id="L15349">				double dblZSpread = pq.quote (&quot;ZSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15351">				mapMeasures.put (&quot;MarketInputType=ZSpread&quot;, dblZSpread);</span>

<span class="nc" id="L15353">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromZSpread</span>
<span class="nc" id="L15354">					(valParams, csqs, vcp, dblZSpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15356">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15359">				wiMarket = null;</span>
<span class="nc" id="L15360">			}</span>
<span class="nc bnc" id="L15361" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ISpread&quot;)) {</span>
			try {
<span class="nc" id="L15363">				double dblISpread = pq.quote (&quot;ISpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15365">				mapMeasures.put (&quot;MarketInputType=ISpread&quot;, dblISpread);</span>

<span class="nc" id="L15367">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromISpread</span>
<span class="nc" id="L15368">					(valParams, csqs, vcp, dblISpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15370">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15373">				wiMarket = null;</span>
<span class="nc" id="L15374">			}</span>
<span class="nc bnc" id="L15375" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CreditBasis&quot;)) {</span>
			try {
<span class="nc" id="L15377">				double dblCreditBasis = pq.quote (&quot;CreditBasis&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15379">				mapMeasures.put (&quot;MarketInputType=CreditBasis&quot;, dblCreditBasis);</span>

<span class="nc" id="L15381">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromCreditBasis</span>
<span class="nc" id="L15382">					(valParams, csqs, vcp, dblCreditBasis), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15384">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15387">				wiMarket = null;</span>
<span class="nc" id="L15388">			}</span>
<span class="nc bnc" id="L15389" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;PECS&quot;)) {</span>
			try {
<span class="nc" id="L15391">				double dblCreditBasis = pq.quote (&quot;PECS&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15393">				mapMeasures.put (&quot;MarketInputType=PECS&quot;, dblCreditBasis);</span>

<span class="nc" id="L15395">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPECS (valParams,</span>
					csqs, vcp, dblCreditBasis), 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15397">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15400">				wiMarket = null;</span>
<span class="nc" id="L15401">			}</span>
		}

<span class="pc bpc" id="L15404" title="1 of 2 branches missed.">		if (null != wiMarket) {</span>
<span class="fc" id="L15405">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapWorkoutMeasures =</span>
<span class="fc" id="L15406">				marketMeasures (valParams, pricerParams, csqs, vcp, wiMarket);</span>

<span class="pc bpc" id="L15408" title="1 of 2 branches missed.">			if (null == _floaterSetting) {</span>
<span class="fc" id="L15409">				double dblParSpread = (mapWorkoutMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15410">					mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairCleanDV01&quot;);</span>

<span class="fc" id="L15412">				mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15414">				mapMeasures.put (&quot;MarketParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15415">			} else {</span>
<span class="nc bnc" id="L15416" title="All 2 branches missed.">				double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15417">					mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15418">						(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15420">				double dblZeroDiscountMargin = (mapMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15421">					dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15422">						(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15424">				mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15426">				mapMeasures.put (&quot;MarketZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
			}

<span class="fc" id="L15429">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapWorkoutMeasures);</span>

<span class="fc" id="L15431">			org.drip.state.credit.CreditCurve cc = csqs.creditState (creditLabel());</span>

<span class="pc bpc" id="L15433" title="1 of 2 branches missed.">			if (null != mapMeasures.get (&quot;FairYield&quot;)) {</span>
<span class="fc" id="L15434">				org.drip.param.market.CurveSurfaceQuoteContainer csqsMarket =</span>
					org.drip.param.creator.MarketParamsBuilder.Create
<span class="fc" id="L15436">						((org.drip.state.discount.MergedDiscountForwardCurve) csqs.fundingState</span>
<span class="fc" id="L15437">							(fundingLabel()).parallelShiftQuantificationMetric (wiMarket.yield() -</span>
<span class="fc" id="L15438">								mapMeasures.get (&quot;FairYield&quot;)), csqs.govvieState (govvieLabel()), cc,</span>
<span class="fc" id="L15439">									strName, csqs.productQuote (strName), csqs.quoteMap(), csqs.fixings());</span>

<span class="pc bpc" id="L15441" title="1 of 2 branches missed.">				if (null != csqsMarket) {</span>
<span class="fc" id="L15442">					org.drip.analytics.output.BondWorkoutMeasures bwmMarket = workoutMeasures (valParams,</span>
<span class="fc" id="L15443">						pricerParams, csqsMarket, wiMarket.date(), wiMarket.factor());</span>

<span class="pc bpc" id="L15445" title="1 of 2 branches missed.">					if (null != bwmMarket) {</span>
<span class="nc" id="L15446">						org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMarketMeasures</span>
<span class="nc" id="L15447">							= bwmMarket.toMap (&quot;&quot;);</span>

<span class="nc" id="L15449">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMarketMeasures,</span>
<span class="nc" id="L15450">							org.drip.quant.common.CollectionUtil.PrefixKeys (mapMarketMeasures, &quot;Market&quot;));</span>

<span class="nc" id="L15452">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapMarketMeasures);</span>
					}
				}
			}
		}

<span class="fc" id="L15458">		return mapMeasures;</span>
	}

	@Override public java.util.Set&lt;java.lang.String&gt; measureNames()
	{
<span class="nc" id="L15463">		java.util.Set&lt;java.lang.String&gt; setstrMeasureNames = new java.util.TreeSet&lt;java.lang.String&gt;();</span>

<span class="nc" id="L15465">		setstrMeasureNames.add (&quot;Accrued&quot;);</span>

<span class="nc" id="L15467">		setstrMeasureNames.add (&quot;Accrued01&quot;);</span>

<span class="nc" id="L15469">		setstrMeasureNames.add (&quot;AssetSwapSpread&quot;);</span>

<span class="nc" id="L15471">		setstrMeasureNames.add (&quot;ASW&quot;);</span>

<span class="nc" id="L15473">		setstrMeasureNames.add (&quot;BondBasis&quot;);</span>

<span class="nc" id="L15475">		setstrMeasureNames.add (&quot;CleanCouponPV&quot;);</span>

<span class="nc" id="L15477">		setstrMeasureNames.add (&quot;CleanDV01&quot;);</span>

<span class="nc" id="L15479">		setstrMeasureNames.add (&quot;CleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15481">		setstrMeasureNames.add (&quot;CleanPrice&quot;);</span>

<span class="nc" id="L15483">		setstrMeasureNames.add (&quot;CleanPV&quot;);</span>

<span class="nc" id="L15485">		setstrMeasureNames.add (&quot;Convexity&quot;);</span>

<span class="nc" id="L15487">		setstrMeasureNames.add (&quot;CreditRisklessParPV&quot;);</span>

<span class="nc" id="L15489">		setstrMeasureNames.add (&quot;CreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15491">		setstrMeasureNames.add (&quot;CreditRiskyParPV&quot;);</span>

<span class="nc" id="L15493">		setstrMeasureNames.add (&quot;CreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15495">		setstrMeasureNames.add (&quot;CreditBasis&quot;);</span>

<span class="nc" id="L15497">		setstrMeasureNames.add (&quot;DiscountMargin&quot;);</span>

<span class="nc" id="L15499">		setstrMeasureNames.add (&quot;DefaultExposure&quot;);</span>

<span class="nc" id="L15501">		setstrMeasureNames.add (&quot;DefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15503">		setstrMeasureNames.add (&quot;DirtyCouponPV&quot;);</span>

<span class="nc" id="L15505">		setstrMeasureNames.add (&quot;DirtyDV01&quot;);</span>

<span class="nc" id="L15507">		setstrMeasureNames.add (&quot;DirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15509">		setstrMeasureNames.add (&quot;DirtyPrice&quot;);</span>

<span class="nc" id="L15511">		setstrMeasureNames.add (&quot;DirtyPV&quot;);</span>

<span class="nc" id="L15513">		setstrMeasureNames.add (&quot;Duration&quot;);</span>

<span class="nc" id="L15515">		setstrMeasureNames.add (&quot;DV01&quot;);</span>

<span class="nc" id="L15517">		setstrMeasureNames.add (&quot;ExpectedRecovery&quot;);</span>

<span class="nc" id="L15519">		setstrMeasureNames.add (&quot;FairAccrued&quot;);</span>

<span class="nc" id="L15521">		setstrMeasureNames.add (&quot;FairAccrued01&quot;);</span>

<span class="nc" id="L15523">		setstrMeasureNames.add (&quot;FairAssetSwapSpread&quot;);</span>

<span class="nc" id="L15525">		setstrMeasureNames.add (&quot;FairASW&quot;);</span>

<span class="nc" id="L15527">		setstrMeasureNames.add (&quot;FairBondBasis&quot;);</span>

<span class="nc" id="L15529">		setstrMeasureNames.add (&quot;FairCleanCouponPV&quot;);</span>

<span class="nc" id="L15531">		setstrMeasureNames.add (&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15533">		setstrMeasureNames.add (&quot;FairCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15535">		setstrMeasureNames.add (&quot;FairCleanPrice&quot;);</span>

<span class="nc" id="L15537">		setstrMeasureNames.add (&quot;FairCleanPV&quot;);</span>

<span class="nc" id="L15539">		setstrMeasureNames.add (&quot;FairConvexity&quot;);</span>

<span class="nc" id="L15541">		setstrMeasureNames.add (&quot;FairCreditBasis&quot;);</span>

<span class="nc" id="L15543">		setstrMeasureNames.add (&quot;FairCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15545">		setstrMeasureNames.add (&quot;FairCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15547">		setstrMeasureNames.add (&quot;FairCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15549">		setstrMeasureNames.add (&quot;FairCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15551">		setstrMeasureNames.add (&quot;FairDefaultExposure&quot;);</span>

<span class="nc" id="L15553">		setstrMeasureNames.add (&quot;FairDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15555">		setstrMeasureNames.add (&quot;FairDirtyCouponPV&quot;);</span>

<span class="nc" id="L15557">		setstrMeasureNames.add (&quot;FairDirtyDV01&quot;);</span>

<span class="nc" id="L15559">		setstrMeasureNames.add (&quot;FairDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15561">		setstrMeasureNames.add (&quot;FairDirtyPrice&quot;);</span>

<span class="nc" id="L15563">		setstrMeasureNames.add (&quot;FairDirtyPV&quot;);</span>

<span class="nc" id="L15565">		setstrMeasureNames.add (&quot;FairDiscountMargin&quot;);</span>

<span class="nc" id="L15567">		setstrMeasureNames.add (&quot;FairDuration&quot;);</span>

<span class="nc" id="L15569">		setstrMeasureNames.add (&quot;FairDV01&quot;);</span>

<span class="nc" id="L15571">		setstrMeasureNames.add (&quot;FairExpectedRecovery&quot;);</span>

<span class="nc" id="L15573">		setstrMeasureNames.add (&quot;FairFirstIndexRate&quot;);</span>

<span class="nc" id="L15575">		setstrMeasureNames.add (&quot;FairGSpread&quot;);</span>

<span class="nc" id="L15577">		setstrMeasureNames.add (&quot;FairISpread&quot;);</span>

<span class="nc" id="L15579">		setstrMeasureNames.add (&quot;FairLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15581">		setstrMeasureNames.add (&quot;FairMacaulayDuration&quot;);</span>

<span class="nc" id="L15583">		setstrMeasureNames.add (&quot;FairModifiedDuration&quot;);</span>

<span class="nc" id="L15585">		setstrMeasureNames.add (&quot;FairOAS&quot;);</span>

<span class="nc" id="L15587">		setstrMeasureNames.add (&quot;FairOASpread&quot;);</span>

<span class="nc" id="L15589">		setstrMeasureNames.add (&quot;FairOptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15591">		setstrMeasureNames.add (&quot;FairParPV&quot;);</span>

<span class="nc" id="L15593">		setstrMeasureNames.add (&quot;FairParSpread&quot;);</span>

<span class="nc" id="L15595">		setstrMeasureNames.add (&quot;FairPECS&quot;);</span>

<span class="nc" id="L15597">		setstrMeasureNames.add (&quot;FairPrice&quot;);</span>

<span class="nc" id="L15599">		setstrMeasureNames.add (&quot;FairPrincipalPV&quot;);</span>

<span class="nc" id="L15601">		setstrMeasureNames.add (&quot;FairPV&quot;);</span>

<span class="nc" id="L15603">		setstrMeasureNames.add (&quot;FairRecoveryPV&quot;);</span>

<span class="nc" id="L15605">		setstrMeasureNames.add (&quot;FairRisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15607">		setstrMeasureNames.add (&quot;FairRisklessCleanDV01&quot;);</span>

<span class="nc" id="L15609">		setstrMeasureNames.add (&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15611">		setstrMeasureNames.add (&quot;FairRisklessCleanPV&quot;);</span>

<span class="nc" id="L15613">		setstrMeasureNames.add (&quot;FairRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15615">		setstrMeasureNames.add (&quot;FairRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15617">		setstrMeasureNames.add (&quot;FairRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15619">		setstrMeasureNames.add (&quot;FairRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15621">		setstrMeasureNames.add (&quot;FairRiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15623">		setstrMeasureNames.add (&quot;FairRiskyCleanDV01&quot;);</span>

<span class="nc" id="L15625">		setstrMeasureNames.add (&quot;FairRiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15627">		setstrMeasureNames.add (&quot;FairRiskyCleanPV&quot;);</span>

<span class="nc" id="L15629">		setstrMeasureNames.add (&quot;FairRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15631">		setstrMeasureNames.add (&quot;FairRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15633">		setstrMeasureNames.add (&quot;FairRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15635">		setstrMeasureNames.add (&quot;FairRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15637">		setstrMeasureNames.add (&quot;FairTSYSpread&quot;);</span>

<span class="nc" id="L15639">		setstrMeasureNames.add (&quot;FairWorkoutDate&quot;);</span>

<span class="nc" id="L15641">		setstrMeasureNames.add (&quot;FairWorkoutFactor&quot;);</span>

<span class="nc" id="L15643">		setstrMeasureNames.add (&quot;FairWorkoutType&quot;);</span>

<span class="nc" id="L15645">		setstrMeasureNames.add (&quot;FairWorkoutYield&quot;);</span>

<span class="nc" id="L15647">		setstrMeasureNames.add (&quot;FairYield&quot;);</span>

<span class="nc" id="L15649">		setstrMeasureNames.add (&quot;FairYield01&quot;);</span>

<span class="nc" id="L15651">		setstrMeasureNames.add (&quot;FairYieldBasis&quot;);</span>

<span class="nc" id="L15653">		setstrMeasureNames.add (&quot;FairYieldSpread&quot;);</span>

<span class="nc" id="L15655">		setstrMeasureNames.add (&quot;FairZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15657">		setstrMeasureNames.add (&quot;FairZSpread&quot;);</span>

<span class="nc" id="L15659">		setstrMeasureNames.add (&quot;FirstCouponRate&quot;);</span>

<span class="nc" id="L15661">		setstrMeasureNames.add (&quot;FirstIndexRate&quot;);</span>

<span class="nc" id="L15663">		setstrMeasureNames.add (&quot;GSpread&quot;);</span>

<span class="nc" id="L15665">		setstrMeasureNames.add (&quot;ISpread&quot;);</span>

<span class="nc" id="L15667">		setstrMeasureNames.add (&quot;LossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15669">		setstrMeasureNames.add (&quot;MacaulayDuration&quot;);</span>

<span class="nc" id="L15671">		setstrMeasureNames.add (&quot;MarketAccrued&quot;);</span>

<span class="nc" id="L15673">		setstrMeasureNames.add (&quot;MarketAccrued01&quot;);</span>

<span class="nc" id="L15675">		setstrMeasureNames.add (&quot;MarketCleanCouponPV&quot;);</span>

<span class="nc" id="L15677">		setstrMeasureNames.add (&quot;MarketCleanDV01&quot;);</span>

<span class="nc" id="L15679">		setstrMeasureNames.add (&quot;MarketCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15681">		setstrMeasureNames.add (&quot;MarketCleanPrice&quot;);</span>

<span class="nc" id="L15683">		setstrMeasureNames.add (&quot;MarketCleanPV&quot;);</span>

<span class="nc" id="L15685">		setstrMeasureNames.add (&quot;MarketCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15687">		setstrMeasureNames.add (&quot;MarketCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15689">		setstrMeasureNames.add (&quot;MarketCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15691">		setstrMeasureNames.add (&quot;MarketCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15693">		setstrMeasureNames.add (&quot;MarketDefaultExposure&quot;);</span>

<span class="nc" id="L15695">		setstrMeasureNames.add (&quot;MarketDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15697">		setstrMeasureNames.add (&quot;MarketDirtyCouponPV&quot;);</span>

<span class="nc" id="L15699">		setstrMeasureNames.add (&quot;MarketDirtyDV01&quot;);</span>

<span class="nc" id="L15701">		setstrMeasureNames.add (&quot;MarketDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15703">		setstrMeasureNames.add (&quot;MarketDirtyPrice&quot;);</span>

<span class="nc" id="L15705">		setstrMeasureNames.add (&quot;MarketDirtyPV&quot;);</span>

<span class="nc" id="L15707">		setstrMeasureNames.add (&quot;MarketDV01&quot;);</span>

<span class="nc" id="L15709">		setstrMeasureNames.add (&quot;MarketExpectedRecovery&quot;);</span>

<span class="nc" id="L15711">		setstrMeasureNames.add (&quot;MarketFirstCouponRate&quot;);</span>

<span class="nc" id="L15713">		setstrMeasureNames.add (&quot;MarketFirstIndexRate&quot;);</span>

<span class="nc" id="L15715">		setstrMeasureNames.add (&quot;MarketInputType=CleanPrice&quot;);</span>

<span class="nc" id="L15717">		setstrMeasureNames.add (&quot;MarketInputType=CreditBasis&quot;);</span>

<span class="nc" id="L15719">		setstrMeasureNames.add (&quot;MarketInputType=DirtyPrice&quot;);</span>

<span class="nc" id="L15721">		setstrMeasureNames.add (&quot;MarketInputType=GSpread&quot;);</span>

<span class="nc" id="L15723">		setstrMeasureNames.add (&quot;MarketInputType=ISpread&quot;);</span>

<span class="nc" id="L15725">		setstrMeasureNames.add (&quot;MarketInputType=PECS&quot;);</span>

<span class="nc" id="L15727">		setstrMeasureNames.add (&quot;MarketInputType=QuotedMargin&quot;);</span>

<span class="nc" id="L15729">		setstrMeasureNames.add (&quot;MarketInputType=TSYSpread&quot;);</span>

<span class="nc" id="L15731">		setstrMeasureNames.add (&quot;MarketInputType=Yield&quot;);</span>

<span class="nc" id="L15733">		setstrMeasureNames.add (&quot;MarketInputType=ZSpread&quot;);</span>

<span class="nc" id="L15735">		setstrMeasureNames.add (&quot;MarketLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15737">		setstrMeasureNames.add (&quot;MarketParPV&quot;);</span>

<span class="nc" id="L15739">		setstrMeasureNames.add (&quot;MarketPrincipalPV&quot;);</span>

<span class="nc" id="L15741">		setstrMeasureNames.add (&quot;MarketPV&quot;);</span>

<span class="nc" id="L15743">		setstrMeasureNames.add (&quot;MarketRecoveryPV&quot;);</span>

<span class="nc" id="L15745">		setstrMeasureNames.add (&quot;MarketRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15747">		setstrMeasureNames.add (&quot;MarketRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15749">		setstrMeasureNames.add (&quot;MarketRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15751">		setstrMeasureNames.add (&quot;MarketRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15753">		setstrMeasureNames.add (&quot;MarketRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15755">		setstrMeasureNames.add (&quot;MarketRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15757">		setstrMeasureNames.add (&quot;MarketRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15759">		setstrMeasureNames.add (&quot;MarketRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15761">		setstrMeasureNames.add (&quot;ModifiedDuration&quot;);</span>

<span class="nc" id="L15763">		setstrMeasureNames.add (&quot;OAS&quot;);</span>

<span class="nc" id="L15765">		setstrMeasureNames.add (&quot;OASpread&quot;);</span>

<span class="nc" id="L15767">		setstrMeasureNames.add (&quot;OptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15769">		setstrMeasureNames.add (&quot;ParEquivalentCDSSpread&quot;);</span>

<span class="nc" id="L15771">		setstrMeasureNames.add (&quot;ParPV&quot;);</span>

<span class="nc" id="L15773">		setstrMeasureNames.add (&quot;ParSpread&quot;);</span>

<span class="nc" id="L15775">		setstrMeasureNames.add (&quot;PECS&quot;);</span>

<span class="nc" id="L15777">		setstrMeasureNames.add (&quot;Price&quot;);</span>

<span class="nc" id="L15779">		setstrMeasureNames.add (&quot;PrincipalPV&quot;);</span>

<span class="nc" id="L15781">		setstrMeasureNames.add (&quot;PV&quot;);</span>

<span class="nc" id="L15783">		setstrMeasureNames.add (&quot;RecoveryPV&quot;);</span>

<span class="nc" id="L15785">		setstrMeasureNames.add (&quot;RisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15787">		setstrMeasureNames.add (&quot;RisklessCleanDV01&quot;);</span>

<span class="nc" id="L15789">		setstrMeasureNames.add (&quot;RisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15791">		setstrMeasureNames.add (&quot;RisklessCleanPV&quot;);</span>

<span class="nc" id="L15793">		setstrMeasureNames.add (&quot;RisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15795">		setstrMeasureNames.add (&quot;RisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15797">		setstrMeasureNames.add (&quot;RisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15799">		setstrMeasureNames.add (&quot;RisklessDirtyPV&quot;);</span>

<span class="nc" id="L15801">		setstrMeasureNames.add (&quot;RiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15803">		setstrMeasureNames.add (&quot;RiskyCleanDV01&quot;);</span>

<span class="nc" id="L15805">		setstrMeasureNames.add (&quot;RiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15807">		setstrMeasureNames.add (&quot;RiskyCleanPV&quot;);</span>

<span class="nc" id="L15809">		setstrMeasureNames.add (&quot;RiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15811">		setstrMeasureNames.add (&quot;RiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15813">		setstrMeasureNames.add (&quot;RiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15815">		setstrMeasureNames.add (&quot;RiskyDirtyPV&quot;);</span>

<span class="nc" id="L15817">		setstrMeasureNames.add (&quot;TSYSpread&quot;);</span>

<span class="nc" id="L15819">		setstrMeasureNames.add (&quot;WorkoutDate&quot;);</span>

<span class="nc" id="L15821">		setstrMeasureNames.add (&quot;WorkoutFactor&quot;);</span>

<span class="nc" id="L15823">		setstrMeasureNames.add (&quot;WorkoutType&quot;);</span>

<span class="nc" id="L15825">		setstrMeasureNames.add (&quot;WorkoutYield&quot;);</span>

<span class="nc" id="L15827">		setstrMeasureNames.add (&quot;Yield&quot;);</span>

<span class="nc" id="L15829">		setstrMeasureNames.add (&quot;Yield01&quot;);</span>

<span class="nc" id="L15831">		setstrMeasureNames.add (&quot;YieldBasis&quot;);</span>

<span class="nc" id="L15833">		setstrMeasureNames.add (&quot;YieldSpread&quot;);</span>

<span class="nc" id="L15835">		setstrMeasureNames.add (&quot;ZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15837">		setstrMeasureNames.add (&quot;ZSpread&quot;);</span>

<span class="nc" id="L15839">		return setstrMeasureNames;</span>
	}

	@Override public double pv (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParamsIn,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15849" title="All 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L15850">			throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc" id="L15852">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L15854">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L15856" title="All 2 branches missed.">		if (null == dcFunding) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15858" title="All 2 branches missed.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="nc bnc" id="L15860" title="All 2 branches missed.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="nc" id="L15861">			_creditSetting.recovery();</span>

<span class="nc bnc" id="L15863" title="All 2 branches missed.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="nc bnc" id="L15865" title="All 2 branches missed.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="nc" id="L15867">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc" id="L15869">		double dblRecoveryPV = 0.;</span>
<span class="nc" id="L15870">		double dblPrincipalPV = 0.;</span>
<span class="nc" id="L15871">		double dblDirtyCouponPV = 0.;</span>
<span class="nc" id="L15872">		boolean bApplyFlatForwardRate = false;</span>
<span class="nc" id="L15873">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L15875" title="All 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L15876">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="nc bnc" id="L15878" title="All 2 branches missed.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="nc" id="L15879">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L15881" title="All 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="nc" id="L15884">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc bnc" id="L15886" title="All 2 branches missed.">		org.drip.param.pricer.CreditPricerParams pricerParams = null != pricerParamsIn ? pricerParamsIn : new</span>
			org.drip.param.pricer.CreditPricerParams (7, null, false,
				org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_FULL_COUPON);

<span class="nc bnc" id="L15890" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L15891">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L15893" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L15895">			int iPeriodEndDate = period.endDate();</span>

<span class="nc" id="L15897">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L15899">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L15902" title="All 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15904" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L15905">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L15907" title="All 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="nc" id="L15909">			double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="nc" id="L15911">			double dblPeriodDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) * dblPeriodAnnuity *</span>
<span class="nc" id="L15912">				notional (iPeriodStartDate);</span>

<span class="nc" id="L15914">			double dblPeriodPrincipalPV = (notional (iPeriodStartDate) - notional (iPeriodEndDate)) *</span>
				dblPeriodAnnuity;

<span class="nc bnc" id="L15917" title="All 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L15918" title="All 2 branches missed.">				double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
					iPeriodEndDate);

<span class="nc" id="L15921">				dblPeriodDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L15922">				dblPeriodPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L15924" title="All 2 branches missed.">				for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
					valParams, pricerParams, iMaturityDate, csqc)) {
<span class="nc bnc" id="L15926" title="All 2 branches missed.">					if (null == lqm) continue;</span>

<span class="nc" id="L15928">					int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L15930">					int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L15932">					double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
						iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L15935">					double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L15937">					double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L15938">						(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L15940" title="All 2 branches missed.">					if (bAccrualOnDefault)</span>
<span class="nc" id="L15941">						dblPeriodDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival *</span>
							dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L15944" title="All 2 branches missed.">					dblRecoveryPV += (bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
						iSubPeriodEndDate) : dblProductRecovery) * dblSubPeriodSurvival *
							dblSubPeriodNotional * dblSubPeriodDF;
<span class="nc" id="L15947">				}</span>
			}

<span class="nc" id="L15950">			dblPrincipalPV += dblPeriodPrincipalPV;</span>

<span class="nc" id="L15952">			dblDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblPeriodDirtyDV01;
<span class="nc" id="L15954">		}</span>

<span class="nc" id="L15956">		double dblParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate);</span>

<span class="nc bnc" id="L15958" title="All 4 branches missed.">		if (null != cc &amp;&amp; null != pricerParams) dblParPV *= cc.survival (iMaturityDate);</span>

<span class="nc bnc" id="L15960" title="All 2 branches missed.">		return (dblDirtyCouponPV + dblPrincipalPV + dblParPV + dblRecoveryPV) / dcFunding.df (null !=</span>
<span class="nc" id="L15961">			_quoteConvention ? _quoteConvention.settleDate (valParams) : valParams.cashPayDate());</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian jackDDirtyPVDManifestMeasure (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15970">		return null;</span>
	}

	@Override public org.drip.product.calib.ProductQuoteSet calibQuoteSet (
		final org.drip.state.representation.LatentStateSpecification[] aLSS)
	{
<span class="nc" id="L15976">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15986">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint forwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15996">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingForwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16006">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fxPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16016">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint govviePRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16026">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint volatilityPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16036">		return null;</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian manifestMeasureDFMicroJack (
		final java.lang.String strManifestMeasure,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L16046">		return null;</span>
	}

	/**
	 * The BondCalibrator implements a calibrator that calibrates the yield, the credit basis, or the Z
	 * 		Spread for the bond given the price input. Calibration happens via either Newton-Raphson method,
	 * 		or via bracketing/root searching.
	 * 
	 * @author Lakshmi Krishnamurthy
	 *
	 */

	public class BondCalibrator {
<span class="fc" id="L16059">		private BondComponent _bond = null;</span>
<span class="fc" id="L16060">		private boolean _bApplyCouponExtension = false;</span>

		/**
		 * Constructor: Construct the calibrator from the parent bond.
		 * 
		 * @param bond Parent
		 * @param bApplyCouponExtension TRUE - Apply the Coupon Extension
		 * 
		 * @throws java.lang.Exception Thrown if the inputs are invalid
		 */

		public BondCalibrator (
			final BondComponent bond,
			final boolean bApplyCouponExtension)
			throws java.lang.Exception
<span class="fc" id="L16075">		{</span>
<span class="pc bpc" id="L16076" title="1 of 2 branches missed.">			if (null == (_bond = bond))</span>
<span class="nc" id="L16077">				throw new java.lang.Exception (&quot;BondComponent::BondCalibrator ctr =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L16079">			_bApplyCouponExtension = bApplyCouponExtension;</span>
<span class="fc" id="L16080">		}</span>

		/**
		 * Calibrate the bond yield from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Yield
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibrateYieldFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16106" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16107">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16110">			org.drip.function.definition.R1ToR1 ofYieldToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16111">				(null) {</span>
				@Override public double evaluate (
					final double dblYield)
					throws java.lang.Exception
				{
<span class="fc" id="L16116">					return _bond.priceFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L16117">						dblYield, _bApplyCouponExtension) - dblPrice;</span>
				}
			};

<span class="fc" id="L16121">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
<span class="fc" id="L16122">				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofYieldToPrice, true).findRoot();</span>

<span class="pc bpc" id="L16124" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16125">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofYieldToPrice,</span>
<span class="nc" id="L16126">					true).findRoot();</span>

<span class="pc bpc" id="L16128" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16129">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofYieldToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16131">						true).findRoot();</span>

<span class="pc bpc" id="L16133" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16134">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16137">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the Z Spread cannot be calibrated
		 */

		public double calibrateZSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16166" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16167">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="pc bpc" id="L16170" title="1 of 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16171">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="fc" id="L16174">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16175">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16180">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16185">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="fc" id="L16187">					true).findRoot();</span>

<span class="pc bpc" id="L16189" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16190">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16191">					true).findRoot();</span>

<span class="pc bpc" id="L16193" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16194">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					new org.drip.function.r1tor1solver.ExecutionControl (ofZSpreadToPrice, new
						org.drip.function.r1tor1solver.ExecutionControlParams (200, false, 1.e-02, 1.e-02,
							1.e-01, 1.e-01)),
								org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16199">									true).findRoot();</span>

<span class="pc bpc" id="L16201" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16202">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16205">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the Bond OAS from the Market Price using the Root Bracketing Technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The Calibrated OAS
		 * 
		 * @throws java.lang.Exception Thrown if the OAS cannot be calibrated
		 */

		public double calibrateOASFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16234" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16235">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16238">			org.drip.function.definition.R1ToR1 r1ToR1OASToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16239">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16244">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16249">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., r1ToR1OASToPrice,
<span class="fc" id="L16251">					true).findRoot();</span>

<span class="pc bpc" id="L16253" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16254">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., r1ToR1OASToPrice,</span>
<span class="fc" id="L16255">					true).findRoot();</span>

<span class="pc bpc" id="L16257" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16258">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., r1ToR1OASToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16260">						true).findRoot();</span>

<span class="pc bpc" id="L16262" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16263">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16266">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the discount
		 * 	curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibDiscCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16292" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16293">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateDiscCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc" id="L16296">			org.drip.function.definition.R1ToR1 ofDiscCurveSpreadToPrice = new</span>
<span class="nc" id="L16297">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16302">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16307">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofDiscCurveSpreadToPrice,
<span class="nc" id="L16309">					true).findRoot();</span>

<span class="nc bnc" id="L16311" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16312">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0.,</span>
<span class="nc" id="L16313">					ofDiscCurveSpreadToPrice, true).findRoot();</span>

<span class="nc bnc" id="L16315" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16316">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0.,</span>
					ofDiscCurveSpreadToPrice, null,
						org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16319">							true).findRoot();</span>

<span class="nc bnc" id="L16321" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16322">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibDiscCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16325">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the Zero Curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibZeroCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16350" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16351">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZeroCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc bnc" id="L16354" title="All 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16355">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibZeroCurveSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="nc" id="L16358">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="nc" id="L16359">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16364">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16369">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="nc" id="L16371">					true).findRoot();</span>

<span class="nc bnc" id="L16373" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16374">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16375">					true).findRoot();</span>

<span class="nc bnc" id="L16377" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16378">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16380">						true).findRoot();</span>

<span class="nc bnc" id="L16382" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16383">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibZeroCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16386">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Credit Basis from the market price
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * @param bFlat TRUE - Calibrate to Flat Curve
		 * 
		 * @return The calibrated Credit Basis
		 * 
		 * @throws java.lang.Exception Thrown if the Credit Basis cannot be calibrated
		 */

		public double calibrateCreditBasisFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice,
			final boolean bFlat)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16413" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16414">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateCreditBasisFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16417">			org.drip.function.definition.R1ToR1 ofCreditBasisToPrice = new</span>
<span class="fc" id="L16418">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblCreditBasis)
					throws java.lang.Exception
				{
<span class="fc" id="L16423">					return _bond.priceFromCreditCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblCreditBasis, bFlat) - dblPrice;
				}
			};

<span class="fc" id="L16428">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofCreditBasisToPrice,
<span class="fc" id="L16430">					true).findRoot();</span>

<span class="pc bpc" id="L16432" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16433">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofCreditBasisToPrice,</span>
<span class="fc" id="L16434">					true).findRoot();</span>

<span class="pc bpc" id="L16436" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16437">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofCreditBasisToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16439">						true).findRoot();</span>

<span class="pc bpc" id="L16441" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16442">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibrateCreditBasisFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16445">			return rfop.getRoot();</span>
		}
	}

	/**
	 * Generate the EOS Callable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics callMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16472" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16474">		org.drip.product.params.EmbeddedOptionSchedule eosCall = callSchedule();</span>

<span class="pc bpc" id="L16476" title="1 of 2 branches missed.">		if (null == eosCall) return null;</span>

<span class="fc" id="L16478">		int iNumDimension = gbs.dimension();</span>

<span class="fc" id="L16480">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L16482">		int[] aiExerciseDate = eosCall.exerciseDates (iValueDate);</span>

<span class="fc" id="L16484">		double[] adblExercisePrice = eosCall.exerciseFactors (iValueDate);</span>

<span class="pc bpc" id="L16486" title="2 of 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="fc" id="L16488">		double dblOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L16489">		int iNumVertex = aiExerciseDate.length;</span>
<span class="fc" id="L16490">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="fc" id="L16491">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="fc" id="L16492">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="fc" id="L16493">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="fc" id="L16494">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="fc" id="L16495">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="fc" id="L16496">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="fc" id="L16497">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="fc" id="L16498">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="fc" id="L16499">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="fc" id="L16500">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="fc" id="L16501">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="fc" id="L16503">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="fc bfc" id="L16506" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="fc bfc" id="L16507" title="All 2 branches covered.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="fc bfc" id="L16508" title="All 2 branches covered.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="pc bpc" id="L16512" title="1 of 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16516">				return null;</span>
<span class="nc" id="L16517">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16518">			e.printStackTrace();</span>

<span class="nc" id="L16520">			return null;</span>
<span class="fc" id="L16521">		}</span>

<span class="fc" id="L16523">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="pc bpc" id="L16525" title="1 of 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="fc" id="L16528">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16529">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16530">			e.printStackTrace();</span>

<span class="nc" id="L16532">			return null;</span>
<span class="fc" id="L16533">		}</span>

<span class="fc bfc" id="L16535" title="All 2 branches covered.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16536">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="pc bpc" id="L16537" title="1 of 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16538">				return null;</span>
		}

<span class="fc" id="L16541">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L16543" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc bfc" id="L16544" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="fc" id="L16546">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="fc" id="L16547">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="fc" id="L16549">				} catch (java.lang.Exception e) {</span>
<span class="fc" id="L16550">					e.printStackTrace();</span>

<span class="fc" id="L16552">					return null;</span>
<span class="fc" id="L16553">				}</span>
			}
		}

<span class="fc bfc" id="L16557" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16558">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="fc" id="L16559">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="fc" id="L16560">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="fc" id="L16562">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="fc bfc" id="L16564" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16565">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="fc" id="L16566">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="fc" id="L16569">					dblExercisePV = (aadblForwardPrice[iPath][iVertex] - adblExercisePrice[iVertex]) *</span>
<span class="fc" id="L16570">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16571">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16572">					e.printStackTrace();</span>
<span class="fc" id="L16573">				}</span>

<span class="fc bfc" id="L16575" title="All 2 branches covered.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="fc" id="L16576">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="fc" id="L16579">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="fc" id="L16580">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="fc" id="L16581">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="fc" id="L16582">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="fc bfc" id="L16587" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16588">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="fc" id="L16591">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16594">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16597">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16599">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16600">				e.printStackTrace();</span>

<span class="nc" id="L16602">				return null;</span>
<span class="fc" id="L16603">			}</span>

<span class="fc" id="L16605">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="fc" id="L16609">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16613">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16614">			e.printStackTrace();</span>
		}

<span class="nc" id="L16617">		return null;</span>
	}

	/**
	 * Generate the EOS Putable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics putMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16643" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16645">		org.drip.product.params.EmbeddedOptionSchedule eosPut = putSchedule();</span>

<span class="pc bpc" id="L16647" title="1 of 2 branches missed.">		if (null == eosPut) return null;</span>

<span class="nc" id="L16649">		int iNumDimension = gbs.dimension();</span>

<span class="nc" id="L16651">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L16653">		int[] aiExerciseDate = eosPut.exerciseDates (iValueDate);</span>

<span class="nc" id="L16655">		double[] adblExercisePrice = eosPut.exerciseFactors (iValueDate);</span>

<span class="nc bnc" id="L16657" title="All 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="nc" id="L16659">		double dblOAS = java.lang.Double.NaN;</span>
<span class="nc" id="L16660">		int iNumVertex = aiExerciseDate.length;</span>
<span class="nc" id="L16661">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="nc" id="L16662">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="nc" id="L16663">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="nc" id="L16664">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="nc" id="L16665">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="nc" id="L16666">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="nc" id="L16667">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="nc" id="L16668">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="nc" id="L16669">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="nc" id="L16670">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="nc" id="L16671">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="nc" id="L16672">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="nc" id="L16674">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="nc bnc" id="L16677" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="nc bnc" id="L16678" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="nc bnc" id="L16679" title="All 2 branches missed.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="nc bnc" id="L16683" title="All 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16687">				return null;</span>
<span class="nc" id="L16688">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16689">			e.printStackTrace();</span>

<span class="nc" id="L16691">			return null;</span>
<span class="nc" id="L16692">		}</span>

<span class="nc" id="L16694">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="nc bnc" id="L16696" title="All 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="nc" id="L16699">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16700">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16701">			e.printStackTrace();</span>

<span class="nc" id="L16703">			return null;</span>
<span class="nc" id="L16704">		}</span>

<span class="nc bnc" id="L16706" title="All 2 branches missed.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16707">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="nc bnc" id="L16708" title="All 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16709">				return null;</span>
		}

<span class="nc" id="L16712">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L16714" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc bnc" id="L16715" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="nc" id="L16717">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="nc" id="L16718">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16720">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16721">					e.printStackTrace();</span>

<span class="nc" id="L16723">					return null;</span>
<span class="nc" id="L16724">				}</span>
			}
		}

<span class="nc bnc" id="L16728" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16729">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="nc" id="L16730">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="nc" id="L16731">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="nc" id="L16733">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="nc bnc" id="L16735" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16736">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="nc" id="L16737">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="nc" id="L16740">					dblExercisePV = (adblExercisePrice[iVertex] - aadblForwardPrice[iPath][iVertex]) *</span>
<span class="nc" id="L16741">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16742">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16743">					e.printStackTrace();</span>
<span class="nc" id="L16744">				}</span>

<span class="nc bnc" id="L16746" title="All 2 branches missed.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="nc" id="L16747">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="nc" id="L16750">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="nc" id="L16751">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="nc" id="L16752">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="nc" id="L16753">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="nc bnc" id="L16758" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16759">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="nc" id="L16762">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16765">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16768">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16770">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16771">				e.printStackTrace();</span>

<span class="nc" id="L16773">				return null;</span>
<span class="nc" id="L16774">			}</span>

<span class="nc" id="L16776">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="nc" id="L16780">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16784">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16785">			e.printStackTrace();</span>
		}

<span class="nc" id="L16788">		return null;</span>
	}

	@Override public void showPeriods()
		throws java.lang.Exception
	{
<span class="nc bnc" id="L16794" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods())</span>
<span class="nc" id="L16795">			System.out.println (&quot;\t&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.startDate()) +</span>
<span class="nc" id="L16796">				&quot;-&gt;&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.endDate()) + &quot;    &quot; +</span>
<span class="nc" id="L16797">					period.accrualDCF (period.endDate()));</span>
<span class="nc" id="L16798">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>