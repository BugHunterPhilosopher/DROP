<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BondComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.product.credit</a> &gt; <span class="el_source">BondComponent.java</span></div><h1>BondComponent.java</h1><pre class="source lang-java linenums">
package org.drip.product.credit;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * Copyright (C) 2014 Lakshmi Krishnamurthy
 * Copyright (C) 2013 Lakshmi Krishnamurthy
 * Copyright (C) 2012 Lakshmi Krishnamurthy
 * Copyright (C) 2011 Lakshmi Krishnamurthy
 * 
 *  This file is part of DRIP, a free-software/open-source library for buy/side financial/trading model
 *  	libraries targeting analysts and developers
 *  	https://lakshmidrip.github.io/DRIP/
 *  
 *  DRIP is composed of four main libraries:
 *  
 *  - DRIP Fixed Income - https://lakshmidrip.github.io/DRIP-Fixed-Income/
 *  - DRIP Asset Allocation - https://lakshmidrip.github.io/DRIP-Asset-Allocation/
 *  - DRIP Numerical Optimizer - https://lakshmidrip.github.io/DRIP-Numerical-Optimizer/
 *  - DRIP Statistical Learning - https://lakshmidrip.github.io/DRIP-Statistical-Learning/
 * 
 *  - DRIP Fixed Income: Library for Instrument/Trading Conventions, Treasury Futures/Options,
 *  	Funding/Forward/Overnight Curves, Multi-Curve Construction/Valuation, Collateral Valuation and XVA
 *  	Metric Generation, Calibration and Hedge Attributions, Statistical Curve Construction, Bond RV
 *  	Metrics, Stochastic Evolution and Option Pricing, Interest Rate Dynamics and Option Pricing, LMM
 *  	Extensions/Calibrations/Greeks, Algorithmic Differentiation, and Asset Backed Models and Analytics.
 * 
 *  - DRIP Asset Allocation: Library for model libraries for MPT framework, Black Litterman Strategy
 *  	Incorporator, Holdings Constraint, and Transaction Costs.
 * 
 *  - DRIP Numerical Optimizer: Library for Numerical Optimization and Spline Functionality.
 * 
 *  - DRIP Statistical Learning: Library for Statistical Evaluation and Machine Learning.
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * BondComponent is the base class that extends CreditComponent abstract class and implements the
 * 	functionality behind bonds of all kinds. Bond static data is captured in a set of 11 container classes â€“
 *  BondTSYParams, BondCouponParams, BondNotionalParams, BondFloaterParams, BondCurrencyParams,
 *  BondIdentifierParams, CompCRValParams, BondCFTerminationEvent, BondFixedPeriodGenerationParams, and one
 *  EmbeddedOptionSchedule object instance each for the call and the put objects. Each of these parameter set
 *  can be set separately.
 *
 * @author Lakshmi Krishnamurthy
 */

public class BondComponent extends org.drip.product.definition.Bond implements
	org.drip.product.definition.BondProduct {
	private static final boolean s_bSuppressErrors = true;
	private static final boolean s_bYieldDFOffofCouponAccrualDCF = true;

	/*
	 * Width for calculating local forward rate width
	 */

	private static final int LOCAL_FORWARD_RATE_WIDTH = 1;

	/*
	 * Recovery Period discretization Mode
	 */

	private static final int s_iDiscretizationScheme =
		org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_DAY_STEP;

	/*
	 * Discount Curve to derive the zero curve off of
	 */

	private static final int ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE = 1;
	private static final int ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE = 2;

	/*
	 * Discount Curve to derive Bumped Prices
	 */

	private static final int PRICE_OFF_OF_FUNDING_CURVE = 1;
	private static final int PRICE_OFF_OF_TREASURY_CURVE = 2;
	// private static final int PRICE_OFF_OF_OVERNIGHT_CURVE = 3;

<span class="fc" id="L100">	private org.drip.product.params.BondStream _stream = null;</span>
<span class="fc" id="L101">	private org.drip.product.params.IdentifierSet _idParams = null;</span>
<span class="fc" id="L102">	private org.drip.product.params.CouponSetting _couponSetting = null;</span>
<span class="fc" id="L103">	private org.drip.product.params.CreditSetting _creditSetting = null;</span>
<span class="fc" id="L104">	private org.drip.product.params.FloaterSetting _floaterSetting = null;</span>
<span class="fc" id="L105">	private org.drip.product.params.NotionalSetting _notionalSetting = null;</span>
<span class="fc" id="L106">	private org.drip.product.params.QuoteConvention _quoteConvention = null;</span>
<span class="fc" id="L107">	private org.drip.product.params.TerminationSetting _terminationSetting = null;</span>
<span class="fc" id="L108">	private org.drip.product.params.TreasuryBenchmarks _treasuryBenchmarks = null;</span>

	/*
	 * Bond EOS Params
	 */

<span class="fc" id="L114">	protected org.drip.product.params.EmbeddedOptionSchedule _eosPut = null;</span>
<span class="fc" id="L115">	protected org.drip.product.params.EmbeddedOptionSchedule _eosCall = null;</span>

	private int terminationAdjust (
		final int iDate)
	{
<span class="fc bfc" id="L120" title="All 2 branches covered.">		org.drip.analytics.daycount.DateAdjustParams dap = null == _terminationSetting ? null :</span>
<span class="fc" id="L121">			_terminationSetting.dap();</span>

		try {
<span class="pc bpc" id="L124" title="1 of 2 branches missed.">			return null == dap ? iDate : dap.roll (iDate);</span>
<span class="nc" id="L125">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L126">			e.printStackTrace();</span>
		}

<span class="nc" id="L129">		return iDate;</span>
	}

	private double treasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L138" title="2 of 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L139">			throw new java.lang.Exception (&quot;BondComponent::treasuryBenchmarkYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L141">		java.lang.String strTsyBmk = null;</span>
<span class="fc" id="L142">		org.drip.param.definition.ProductQuote pqTsyBmkYield = null;</span>

<span class="pc bpc" id="L144" title="1 of 2 branches missed.">		if (null != _treasuryBenchmarks) strTsyBmk = _treasuryBenchmarks.primary();</span>

<span class="fc" id="L146">		int iValDate = valParams.valueDate();</span>

<span class="pc bpc" id="L148" title="3 of 4 branches missed.">		if (null == strTsyBmk || strTsyBmk.isEmpty())</span>
<span class="fc" id="L149">			strTsyBmk = org.drip.analytics.support.Helper.BaseTsyBmk (iValDate, iWorkoutDate);</span>

<span class="fc" id="L151">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; pqMap =</span>
<span class="fc" id="L152">			csqc.quoteMap();</span>

<span class="pc bpc" id="L154" title="3 of 6 branches missed.">		if (null != pqMap &amp;&amp; null != strTsyBmk &amp;&amp; !strTsyBmk.isEmpty())</span>
<span class="fc" id="L155">			pqTsyBmkYield = pqMap.get (strTsyBmk);</span>

<span class="fc bfc" id="L157" title="All 2 branches covered.">		if (null != pqTsyBmkYield) {</span>
<span class="fc" id="L158">			 org.drip.param.definition.Quote q = pqTsyBmkYield.quote (&quot;Yield&quot;);</span>

<span class="pc bpc" id="L160" title="1 of 2 branches missed.">			 if (null != q) return q.value (&quot;mid&quot;);</span>
		}

<span class="fc" id="L163">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L165" title="All 2 branches covered.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	private org.drip.param.valuation.WorkoutInfo exerciseCallYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L174" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosCall)
<span class="nc" id="L176">			return null;</span>

<span class="nc" id="L178">		int iValDate = valParams.valueDate();</span>

<span class="nc" id="L180">		int[] aiEOSDate = _eosCall.dates();</span>

<span class="nc" id="L182">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L184">		double[] adblEOSFactor = _eosCall.factors();</span>

<span class="nc" id="L186">		int iNoticePeriod = _eosCall.exerciseNoticePeriod();</span>

<span class="nc" id="L188">		int iExercise = -1;</span>
<span class="nc" id="L189">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L193">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L194">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L197">			return null;</span>
<span class="nc" id="L198">		}</span>

<span class="nc bnc" id="L200" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L201" title="All 4 branches missed.">			if (iValDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L204">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L207" title="All 2 branches missed.">				if (dblYield &lt; dblExerciseYield) {</span>
<span class="nc" id="L208">					iExercise = i;</span>
<span class="nc" id="L209">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L211">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L213">			}</span>
		}

		try {
<span class="nc bnc" id="L217" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L221">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L225">		return null;</span>
	}

	private org.drip.param.valuation.WorkoutInfo exercisePutYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L234" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosPut)
<span class="nc" id="L236">			return null;</span>

<span class="nc" id="L238">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L240">		int[] aiEOSDate = _eosPut.dates();</span>

<span class="nc" id="L242">		double[] adblEOSFactor = _eosPut.factors();</span>

<span class="nc" id="L244">		int iNoticePeriod = _eosPut.exerciseNoticePeriod();</span>

<span class="nc" id="L246">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L248">		int iExercise = -1;</span>
<span class="nc" id="L249">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L253">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L254">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L257">			return null;</span>
<span class="nc" id="L258">		}</span>

<span class="nc bnc" id="L260" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L261" title="All 4 branches missed.">			if (iValueDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValueDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L264">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L267" title="All 2 branches missed.">				if (dblYield &gt; dblExerciseYield) {</span>
<span class="nc" id="L268">					iExercise = i;</span>
<span class="nc" id="L269">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L271">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L273">			}</span>
		}

		try {
<span class="nc bnc" id="L277" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT);
<span class="nc" id="L281">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L285">		return null;</span>
	}

	private double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield,
		final boolean bApplyCouponExtension)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L298" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L299">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L301">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L303" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L304">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L306">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L307">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L308">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L309">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L310">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L311">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L312">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L313">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>

<span class="pc bpc" id="L315" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L316">			? 1. : notional (iValueDate);</span>

<span class="fc" id="L318">		int iFrequency = freq();</span>

<span class="fc" id="L320">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L322">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L324">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L326" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L328" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L329">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L331" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L332">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L334">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L336">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L338">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L340">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L341" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L342">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L344">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L346">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L348">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L350">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L353">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L355" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L356">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L358" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L360" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L361">				bFirstPeriod = false;</span>

<span class="fc" id="L363">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L365">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L367">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L369">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L371" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L372">				iPeriodEndDate = iWorkoutDate;</span>
<span class="fc" id="L373">				bTerminateCouponFlow = true;</span>
			}

<span class="fc" id="L376">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L379" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L380">				throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; No PCM for &quot; + new</span>
<span class="nc" id="L381">					org.drip.analytics.date.JulianDate (iValueDate) + &quot; | &quot; + effectiveDate());</span>

<span class="pc bpc" id="L383" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L384" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L385">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L387" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L389">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L392">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L395">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
					org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iPeriodPayDate, strDC,
<span class="fc" id="L398">						bApplyCpnEOMAdj, aap, strCalendar)) * cpcm.cumulative();</span>

<span class="fc" id="L400">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L402">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L404">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L406" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L407">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L408" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L409">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L410" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L412">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L414" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L415">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L417" title="1 of 2 branches missed.">			dblCumulativePeriodPV += (period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="pc bpc" id="L418" title="1 of 2 branches missed.">				dblFlatForwardRate : cpcm.rate() + (bApplyCouponExtension ?</span>
<span class="pc" id="L419">					_couponSetting.couponRateExtension() : 0.)) * couponFactor (iPeriodEndDate) *</span>
						dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;

<span class="fc bfc" id="L422" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L423">		}</span>

		try {
<span class="fc bfc" id="L426" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L427">				valParams.cashPayDate();</span>
<span class="nc" id="L428">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L431">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L432">		}</span>

<span class="fc" id="L434">		return (((dblCumulativePeriodPV + dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF</span>
<span class="fc" id="L435">			(iFrequency, dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :</span>
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L437">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate)) /</span>
<span class="fc" id="L438">						org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L439">							org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iCashPayDate,</span>
<span class="fc" id="L440">								strDC, bApplyCpnEOMAdj, aap, strCalendar))) - accrued (iValueDate, csqc)) /</span>
									dblScalingNotional;
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; calibMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L450">		double dblCleanPrice = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L452" title="1 of 2 branches missed.">		org.drip.param.definition.CalibrationParams calibParams = null == pricerParams ? null :</span>
<span class="fc" id="L453">			pricerParams.calibParams();</span>

<span class="pc bpc" id="L455" title="1 of 2 branches missed.">		if (null == calibParams) return null;</span>

<span class="fc" id="L457">		org.drip.param.valuation.WorkoutInfo wi = calibParams.workout();</span>

<span class="pc bpc" id="L459" title="1 of 2 branches missed.">		double dblExerciseFactor = null == wi ? 1. : wi.factor();</span>

<span class="pc bpc" id="L461" title="1 of 2 branches missed.">		int iExerciseDate = null == wi ? maturityDate().julian() : wi.date();</span>

<span class="fc" id="L463">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

		try {
<span class="fc bfc" id="L466" title="All 2 branches covered.">			dblCleanPrice = null == cc ? priceFromFundingCurve (valParams, csqc, iExerciseDate,</span>
<span class="fc" id="L467">				dblExerciseFactor, 0.) : priceFromCreditCurve (valParams, csqc, iExerciseDate,</span>
					dblExerciseFactor, 0., false);
<span class="nc" id="L469">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L472">			return null;</span>
<span class="fc" id="L473">		}</span>

<span class="pc bpc" id="L475" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblCleanPrice)) return null;</span>

<span class="fc" id="L477">		java.lang.String strCalibMeasure = calibParams.measure();</span>

<span class="fc" id="L479">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

<span class="fc bfc" id="L482" title="All 2 branches covered.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CleanPrice&quot;, &quot;FairCleanPrice&quot;, &quot;FairPrice&quot;, &quot;Price&quot;}, false)) {
<span class="fc" id="L484">			mapCalibMeasures.put (strCalibMeasure, dblCleanPrice);</span>

<span class="fc" id="L486">			return mapCalibMeasures;</span>
		}

<span class="pc bpc" id="L489" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;DirtyPrice&quot;, &quot;FairDirtyPrice&quot;}, false)) {
			try {
<span class="nc" id="L492">				mapCalibMeasures.put (strCalibMeasure, dblCleanPrice + accrued (valParams.valueDate(),</span>
					csqc));

<span class="nc" id="L495">				return mapCalibMeasures;</span>
<span class="nc" id="L496">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="pc bpc" id="L501" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;Yield&quot;, &quot;FairYield&quot;}, false)) {
			try {
<span class="fc" id="L504">				mapCalibMeasures.put (strCalibMeasure, yieldFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="fc" id="L507">				return mapCalibMeasures;</span>
<span class="nc" id="L508">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L513" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;TSYSpread&quot;, &quot;FairTSYSpread&quot;}, false)) {
			try {
<span class="nc" id="L516">				mapCalibMeasures.put (strCalibMeasure, tsySpreadFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L519">				return mapCalibMeasures;</span>
<span class="nc" id="L520">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L525" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;OAS&quot;, &quot;OASpread&quot;, &quot;OptionAdjustedSpread&quot;}, false)) {
			try {
<span class="nc" id="L528">				mapCalibMeasures.put (strCalibMeasure, oasFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L531">				return mapCalibMeasures;</span>
<span class="nc" id="L532">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L537" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;BondBasis&quot;, &quot;YieldBasis&quot;, &quot;YieldSpread&quot;}, false)) {
			try {
<span class="nc" id="L540">				mapCalibMeasures.put (strCalibMeasure, bondBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L543">				return mapCalibMeasures;</span>
<span class="nc" id="L544">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L549" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CreditBasis&quot;}, false)) {
<span class="nc bnc" id="L551" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L554">				mapCalibMeasures.put (strCalibMeasure, creditBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L557">				return mapCalibMeasures;</span>
<span class="nc" id="L558">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L563" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;PECS&quot;, &quot;ParEquivalentCDSSpread&quot;}, false)) {
<span class="nc bnc" id="L565" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L568">				mapCalibMeasures.put (strCalibMeasure, pecsFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L571">				return mapCalibMeasures;</span>
<span class="nc" id="L572">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc" id="L577">		return null;</span>
	}

	@Override public org.drip.param.valuation.WorkoutInfo exerciseYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L586" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L587">			return null;</span>

<span class="fc" id="L589">		int iMaturityDate = maturityDate().julian();</span>

		try {
<span class="pc bpc" id="L592" title="2 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L593">				return new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPrice (valParams,</span>
					csqc, vcp, iMaturityDate, 1., dblPrice), 1.,
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);

<span class="nc bnc" id="L597" title="All 4 branches missed.">			if (null == _eosCall &amp;&amp; null != _eosPut)</span>
<span class="nc" id="L598">				return exercisePutYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L600" title="All 4 branches missed.">			if (null != _eosCall &amp;&amp; null == _eosPut)</span>
<span class="nc" id="L601">				return exerciseCallYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc" id="L603">			org.drip.param.valuation.WorkoutInfo wiPut = exercisePutYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc" id="L606">			org.drip.param.valuation.WorkoutInfo wiCall = exerciseCallYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc bnc" id="L609" title="All 4 branches missed.">			if (null == wiPut || null == wiCall) return null;</span>

<span class="nc bnc" id="L611" title="All 2 branches missed.">			return wiPut.date() &lt; wiCall.date() ? wiPut : wiCall;</span>
<span class="nc" id="L612">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L616">		return null;</span>
	}

	private double indexRate (
		final int iValueDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.analytics.cashflow.CompositeFloatingPeriod cup)
		throws java.lang.Exception
	{
<span class="fc" id="L625">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState (fundingLabel());</span>

<span class="fc" id="L627">		int iFreq = freq();</span>

<span class="pc bpc" id="L629" title="1 of 2 branches missed.">		if (null != cup) {</span>
<span class="fc" id="L630">			org.drip.analytics.cashflow.ComposableUnitPeriod cupFirst = cup.periods().get (0);</span>

<span class="pc bpc" id="L632" title="1 of 2 branches missed.">			if (!(cupFirst instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod))</span>
<span class="nc" id="L633">				throw new java.lang.Exception (&quot;BondComponent::indexRate =&gt; Not a floater&quot;);</span>

<span class="fc" id="L635">			int iFixingDate = ((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)</span>
<span class="fc" id="L636">				cupFirst).referenceIndexPeriod().fixingDate();</span>

<span class="pc bpc" id="L638" title="1 of 2 branches missed.">			org.drip.state.identifier.ForwardLabel forwardLabel = null == _floaterSetting ? null :</span>
<span class="fc" id="L639">				_floaterSetting.fri();</span>

<span class="pc bpc" id="L641" title="1 of 2 branches missed.">			if (!csqc.available (iFixingDate, forwardLabel)) {</span>
<span class="fc" id="L642">				org.drip.state.forward.ForwardRateEstimator fc = null;</span>

<span class="fc" id="L644">				int iPayDate = cup.payDate();</span>

<span class="fc" id="L646">				int iStartDate = cup.startDate();</span>

<span class="pc bpc" id="L648" title="2 of 4 branches missed.">				if (null == forwardLabel || null == (fc = csqc.forwardState (forwardLabel)) ||</span>
<span class="nc bnc" id="L649" title="All 2 branches missed.">					!forwardLabel.match (fc.index()))</span>
<span class="fc" id="L650">					fc = dc.forwardRateEstimator (iPayDate, forwardLabel);</span>

<span class="pc bpc" id="L652" title="1 of 2 branches missed.">				if (null != fc) return fc.forward (iPayDate);</span>

<span class="pc bpc" id="L654" title="2 of 4 branches missed.">				return iStartDate &lt; iValueDate &amp;&amp; 0 != iFreq ? dc.libor (iValueDate, (12 / iFreq) + &quot;M&quot;) :</span>
<span class="nc" id="L655">					dc.libor (iStartDate, cup.endDate());</span>
			}

<span class="nc" id="L658">			return csqc.fixing (iFixingDate, forwardLabel);</span>
		}

<span class="nc bnc" id="L661" title="All 2 branches missed.">		return dc.libor (iValueDate, 0 != iFreq ? iValueDate + 365 / iFreq : iValueDate +</span>
			LOCAL_FORWARD_RATE_WIDTH);
	}

	private org.drip.analytics.output.BondWorkoutMeasures workoutMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
	{
<span class="pc bpc" id="L672" title="2 of 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="fc" id="L674">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L676" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L678">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L680" title="All 2 branches covered.">		if (null == dcFunding) return null;</span>

<span class="fc bfc" id="L682" title="All 2 branches covered.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="fc bfc" id="L684" title="All 2 branches covered.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="fc" id="L685">			_creditSetting.recovery();</span>

<span class="fc bfc" id="L687" title="All 2 branches covered.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="fc bfc" id="L689" title="All 2 branches covered.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L691">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="fc" id="L693">		double dblAccrued01 = 0.;</span>
<span class="fc" id="L694">		double dblRecoveryPV = 0.;</span>
<span class="fc" id="L695">		boolean bPeriodZero = true;</span>
<span class="fc" id="L696">		double dblExpectedRecovery = 0.;</span>
<span class="fc" id="L697">		double dblCreditRiskyDirtyDV01 = 0.;</span>
<span class="fc" id="L698">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L699">		double dblCreditRiskyPrincipalPV = 0.;</span>
<span class="fc" id="L700">		double dblCreditRisklessDirtyDV01 = 0.;</span>
<span class="fc" id="L701">		double dblCreditRiskyDirtyCouponPV = 0.;</span>
<span class="fc" id="L702">		double dblCreditRisklessPrincipalPV = 0.;</span>
<span class="fc" id="L703">		double dblCreditRisklessDirtyCouponPV = 0.;</span>
<span class="fc" id="L704">		double dblFirstCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L705">		double dblCreditRiskyDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L706">		double dblFirstIndexRate = java.lang.Double.NaN;</span>
<span class="fc" id="L707">		double dblCreditRisklessDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L708">		double dblCreditRiskyParPV = java.lang.Double.NaN;</span>
<span class="fc" id="L709">		double dblFlatForwardCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L710">		double dblCreditRisklessParPV = java.lang.Double.NaN;</span>

<span class="fc bfc" id="L712" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L713">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L715" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

		try {
<span class="pc bpc" id="L718" title="1 of 2 branches missed.">			for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L719">				int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L721" title="All 2 branches covered.">				if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L723">				int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L725">				int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L727" title="All 2 branches covered.">				if (iWorkoutDate &lt;= iPeriodEndDate) {</span>
<span class="fc" id="L728">					bTerminateCouponFlow = true;</span>
<span class="fc" id="L729">					iPeriodEndDate = iWorkoutDate;</span>
				}

<span class="fc" id="L732">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L735" title="1 of 2 branches missed.">				if (null == cpcm) return null;</span>

<span class="fc bfc" id="L737" title="All 2 branches covered.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardCoupon))</span>
<span class="fc" id="L738">					dblFlatForwardCoupon = cpcm.rate();</span>

<span class="fc" id="L740">				double dblPeriodBaseRate = period.periods().get (0).baseRate (csqc);</span>

<span class="fc" id="L742">				double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="pc bpc" id="L744" title="1 of 2 branches missed.">				double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardCoupon : cpcm.rate();</span>

<span class="fc bfc" id="L746" title="All 2 branches covered.">				if (bPeriodZero) {</span>
<span class="fc" id="L747">					bPeriodZero = false;</span>
<span class="fc" id="L748">					dblFirstCoupon = dblPeriodCoupon;</span>

<span class="pc bpc" id="L750" title="1 of 2 branches missed.">					if (iPeriodStartDate &lt; iValueDate)</span>
<span class="fc" id="L751">						dblAccrued01 = 0.0001 * period.accrualDCF (iValueDate) * notional (iPeriodStartDate,</span>
							iValueDate);

<span class="fc bfc" id="L754" title="All 2 branches covered.">					if (null != _floaterSetting) dblFirstIndexRate = dblPeriodBaseRate;</span>
				}

<span class="fc" id="L757">				double dblPeriodCreditRisklessDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) *</span>
<span class="fc" id="L758">					dblPeriodAnnuity * notional (iPeriodStartDate);</span>

<span class="fc" id="L760">				double dblPeriodCreditRiskessPrincipalPV = (notional (iPeriodStartDate) - notional</span>
<span class="fc" id="L761">					(iPeriodEndDate)) * dblPeriodAnnuity;</span>

<span class="fc" id="L763">				double dblPeriodCreditRiskyDirtyDV01 = dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L764">				double dblPeriodCreditRiskyPrincipalPV = dblPeriodCreditRiskessPrincipalPV;</span>

<span class="pc bpc" id="L766" title="3 of 4 branches missed.">				if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L767" title="All 2 branches missed.">					double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
						iPeriodEndDate);

<span class="nc" id="L770">					dblPeriodCreditRiskyDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L771">					dblPeriodCreditRiskyPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L773" title="All 2 branches missed.">					for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
<span class="nc" id="L774">						valParams, pricerParams, terminationAdjust (iWorkoutDate), csqc)) {</span>
<span class="nc bnc" id="L775" title="All 2 branches missed.">						if (null == lqm) continue;</span>

<span class="nc" id="L777">						int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L779">						int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L781">						double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
							iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L784">						double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L786">						double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L787">							(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L789" title="All 2 branches missed.">						if (bAccrualOnDefault)</span>
<span class="nc" id="L790">							dblPeriodCreditRiskyDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival</span>
								* dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L793" title="All 2 branches missed.">						double dblRecovery = bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
							iSubPeriodEndDate) : dblProductRecovery;

<span class="nc" id="L796">						double dblSubPeriodExpRecovery = dblRecovery * dblSubPeriodSurvival *</span>
							dblSubPeriodNotional;
<span class="nc" id="L798">						dblRecoveryPV += dblSubPeriodExpRecovery * dblSubPeriodDF;</span>
<span class="nc" id="L799">						dblExpectedRecovery += dblSubPeriodExpRecovery;</span>
<span class="nc" id="L800">					}</span>
				}

<span class="fc" id="L803">				dblCreditRiskyDirtyDV01 += dblPeriodCreditRiskyDirtyDV01;</span>
<span class="fc" id="L804">				dblCreditRiskyPrincipalPV += dblPeriodCreditRiskyPrincipalPV;</span>
<span class="fc" id="L805">				dblCreditRisklessDirtyDV01 += dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L806">				dblCreditRisklessPrincipalPV += dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc" id="L808">				dblCreditRiskyDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRiskyDirtyDV01;

<span class="fc" id="L811">				dblCreditRisklessDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc" id="L814">				dblCreditRiskyDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRiskyDirtyDV01;
<span class="fc" id="L816">				dblCreditRisklessDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc bfc" id="L819" title="All 2 branches covered.">				if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L820">			}</span>
<span class="nc" id="L821">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L824">			return null;</span>
<span class="fc" id="L825">		}</span>

<span class="fc" id="L827">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>

		try {
<span class="fc bfc" id="L830" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L831">				valParams.cashPayDate();</span>
<span class="nc" id="L832">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L835">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L836">		}</span>

		try {
<span class="fc" id="L839">			double dblCashPayDF = dcFunding.df (iCashPayDate);</span>

<span class="fc" id="L841">			int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L843">			dblCreditRisklessParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate) *</span>
				dblWorkoutFactor;

<span class="pc bpc" id="L846" title="3 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams)</span>
<span class="nc" id="L847">				dblCreditRiskyParPV = dblCreditRisklessParPV * cc.survival (iMaturityDate);</span>

<span class="fc" id="L849">			org.drip.analytics.output.BondCouponMeasures bcmCreditRisklessDirty = new</span>
				org.drip.analytics.output.BondCouponMeasures (dblCreditRisklessDirtyDV01,
					dblCreditRisklessDirtyIndexCouponPV, dblCreditRisklessDirtyCouponPV,
						dblCreditRisklessDirtyCouponPV + dblCreditRisklessPrincipalPV +
							dblCreditRisklessParPV);

<span class="fc" id="L855">			double dblDefaultExposure = java.lang.Double.NaN;</span>
<span class="fc" id="L856">			double dblDefaultExposureNoRec = java.lang.Double.NaN;</span>
<span class="fc" id="L857">			double dblLossOnInstantaneousDefault = java.lang.Double.NaN;</span>
<span class="fc" id="L858">			org.drip.analytics.output.BondCouponMeasures bcmCreditRiskyDirty = null;</span>

<span class="pc bpc" id="L860" title="3 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc" id="L861">				double dblInitialNotional = notional (iValueDate);</span>

<span class="nc" id="L863">				double dblInitialRecovery = cc.recovery (iValueDate);</span>

<span class="nc" id="L865">				bcmCreditRiskyDirty = new org.drip.analytics.output.BondCouponMeasures</span>
					(dblCreditRiskyDirtyDV01, dblCreditRiskyDirtyIndexCouponPV, dblCreditRiskyDirtyCouponPV,
						dblCreditRiskyDirtyCouponPV + dblCreditRiskyPrincipalPV + dblCreditRiskyParPV);

<span class="nc" id="L869">				dblDefaultExposure = (dblDefaultExposureNoRec = dblInitialNotional) * dblInitialRecovery;</span>
<span class="nc" id="L870">				dblLossOnInstantaneousDefault = dblInitialNotional * (1. - dblInitialRecovery);</span>
			}

<span class="fc" id="L873">			return new org.drip.analytics.output.BondWorkoutMeasures (bcmCreditRiskyDirty,</span>
				bcmCreditRisklessDirty, dblCreditRiskyParPV, dblCreditRisklessParPV,
					dblCreditRiskyPrincipalPV, dblCreditRisklessPrincipalPV, dblRecoveryPV,
						dblExpectedRecovery, dblDefaultExposure, dblDefaultExposureNoRec,
							dblLossOnInstantaneousDefault, dblAccrued01, dblFirstCoupon, dblFirstIndexRate,
								dblCashPayDF);
<span class="nc" id="L879">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L883">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; rvMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice,
		final java.lang.String strPrefix)
	{
<span class="pc bpc" id="L895" title="1 of 2 branches missed.">		if (null == strPrefix) return null;</span>

<span class="fc" id="L897">		org.drip.analytics.output.BondRVMeasures bmRV = standardMeasures (valParams, pricerParams, csqc, vcp,</span>
			wi, dblPrice);

<span class="pc bpc" id="L900" title="1 of 2 branches missed.">		return null == bmRV ? null : bmRV.toMap (strPrefix);</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; fairMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L909">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L911">		org.drip.analytics.output.BondWorkoutMeasures bwmFair = workoutMeasures (valParams, pricerParams,</span>
			csqc, iMaturityDate, 1.);

<span class="pc bpc" id="L914" title="1 of 2 branches missed.">		if (null == bwmFair) return null;</span>

<span class="fc" id="L916">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = bwmFair.toMap (&quot;&quot;);</span>

<span class="fc" id="L918">		org.drip.analytics.output.BondCouponMeasures bcm = bwmFair.creditRiskyCleanbcm();</span>

<span class="pc bpc" id="L920" title="1 of 2 branches missed.">		double dblCreditRiskyPV = null == bcm ? java.lang.Double.NaN : bcm.pv();</span>

<span class="pc bpc" id="L922" title="1 of 2 branches missed.">		double dblPrice = !org.drip.quant.common.NumberUtil.IsValid (dblCreditRiskyPV) ?</span>
<span class="pc" id="L923">			bwmFair.creditRisklessCleanbcm().pv() : dblCreditRiskyPV;</span>

		try {
<span class="fc" id="L926">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, rvMeasures (valParams,</span>
				pricerParams, csqc, vcp, new org.drip.param.valuation.WorkoutInfo (iMaturityDate,
<span class="fc" id="L928">					yieldFromPrice (valParams, csqc, vcp, dblPrice / notional (valParams.valueDate())), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY), dblPrice, &quot;&quot;));

<span class="fc" id="L931">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L932">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Fair&quot;));</span>

<span class="fc" id="L934">			return mapMeasures;</span>
<span class="nc" id="L935">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L939">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; marketMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wiMarket)
	{
		try {
<span class="fc" id="L950">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = rvMeasures</span>
<span class="fc" id="L951">				(valParams, pricerParams, csqc, vcp, wiMarket, priceFromYield (valParams, csqc, vcp,</span>
<span class="fc" id="L952">					wiMarket.date(), wiMarket.factor(), wiMarket.yield()), &quot;&quot;);</span>

<span class="fc" id="L954">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L955">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Market&quot;));</span>

<span class="fc" id="L957">			return mapMeasures;</span>
<span class="nc" id="L958">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L962">		return null;</span>
	}

	private org.drip.analytics.cashflow.CompositePeriod currentPeriod (
		final int iDate)
	{
		try {
<span class="fc" id="L969">			return _stream.period (_stream.periodIndex (iDate));</span>
<span class="nc" id="L970">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L974">		return null;</span>
	}

	private double priceFromDiscountCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump,
		final int iDiscountCurveType)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L986" title="3 of 6 branches missed.">		if (null == valParams || null == csqc ||!org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L987" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L988">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L990">		org.drip.state.discount.DiscountCurve dc = null;</span>

<span class="pc bpc" id="L992" title="1 of 2 branches missed.">		if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="fc" id="L993">			dc = csqc.fundingState (fundingLabel());</span>
<span class="nc bnc" id="L994" title="All 2 branches missed.">		else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L995">			dc = csqc.govvieState (govvieLabel());</span>
		/* else if (PRICE_OFF_OF_OVERNIGHT_CURVE == iDiscountCurveType)
			dfe = csqc.overnightState (overnightLabel()); */

<span class="pc bpc" id="L999" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1000">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No Discount Curve&quot;);</span>

<span class="fc" id="L1002">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L1004" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1005">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L1006">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L1007">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L1009">		double dblPV = 0.;</span>
<span class="fc" id="L1010">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L1011">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L1012">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L1014" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L1015">			? 1. : notional (iValueDate);</span>

<span class="fc bfc" id="L1017" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L1018">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L1020" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L1022" title="1 of 2 branches missed.">		if (0. != dblBump) {</span>
<span class="nc bnc" id="L1023" title="All 2 branches missed.">			if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1024">				dc = (org.drip.state.discount.MergedDiscountForwardCurve) dc.parallelShiftManifestMeasure</span>
<span class="nc" id="L1025">					(&quot;SwapRate&quot;, dblBump);</span>
<span class="nc bnc" id="L1026" title="All 2 branches missed.">			else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1027">				dc = (org.drip.state.govvie.GovvieCurve) dc.parallelShiftManifestMeasure (&quot;Yield&quot;, dblBump);</span>
		}

<span class="pc bpc" id="L1030" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1031">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromDiscountCurve =&gt; Cannot shift Discount Curve&quot;);

<span class="pc bpc" id="L1034" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1035">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L1037" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L1039">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L1041">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L1043">			int iNotionalEndDate = period.endDate();</span>

<span class="fc bfc" id="L1045" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L1046">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L1047">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L1048">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L1051">			org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L1054" title="1 of 2 branches missed.">			if (null == pcm)</span>
<span class="nc" id="L1055">				throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No PCM&quot;);</span>

<span class="fc" id="L1057">			double dblPeriodAnnuity = dc.df (iPeriodPayDate) * pcm.cumulative();</span>

<span class="fc" id="L1059">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L1061">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L1063">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L1065">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L1067" title="1 of 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L1068">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L1069" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L1070">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L1071" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L1073">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc bfc" id="L1075" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L1076">				dblFlatForwardRate = pcm.rate();</span>

<span class="pc bpc" id="L1078" title="1 of 2 branches missed.">			dblPV += period.accrualDCF (iAccrualEndDate) * dblPeriodAnnuity * (bApplyFlatForward ?</span>
<span class="fc" id="L1079">				dblFlatForwardRate : pcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L1081">			dblPV += (dblPeriodStartNotional - dblPeriodEndNotional) * dblPeriodAnnuity;</span>

<span class="fc bfc" id="L1083" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L1084">		}</span>

		try {
<span class="fc bfc" id="L1087" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L1088">				valParams.cashPayDate();</span>
<span class="nc" id="L1089">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1092">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L1093">		}</span>

<span class="fc" id="L1095">		return ((dblPV + dblWorkoutFactor * dc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L1096">			(iWorkoutDate)) / dc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	/**
	 * Constructor: Construct an empty bond object
	 */

	public BondComponent()
<span class="fc" id="L1104">	{</span>
<span class="fc" id="L1105">	}</span>

	@Override public double[] secTreasurySpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1111" title="All 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="nc" id="L1113">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1114">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1116" title="All 4 branches missed.">		if (null == mapTSYQuote || 0 == mapTSYQuote.size()) return null;</span>

<span class="nc bnc" id="L1118" title="All 2 branches missed.">		java.lang.String[] astrTreasuryBenchmark = null == _treasuryBenchmarks ? null :</span>
<span class="nc" id="L1119">			_treasuryBenchmarks.secondary();</span>

<span class="nc bnc" id="L1121" title="All 2 branches missed.">		int iNumTreasuryBenchmark = null == astrTreasuryBenchmark ? 0 : astrTreasuryBenchmark.length;</span>
<span class="nc" id="L1122">		double[] adblSecTSYSpread = new double[iNumTreasuryBenchmark];</span>

<span class="nc bnc" id="L1124" title="All 2 branches missed.">		if (0 == iNumTreasuryBenchmark) return null;</span>

<span class="nc bnc" id="L1126" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="nc" id="L1127">			org.drip.param.definition.ProductQuote pqTSYBenchmark = mapTSYQuote.get</span>
<span class="nc" id="L1128">				(astrTreasuryBenchmark[i]);</span>

<span class="nc bnc" id="L1130" title="All 2 branches missed.">			org.drip.param.definition.Quote q = null == pqTSYBenchmark ? null : pqTSYBenchmark.quote</span>
<span class="nc" id="L1131">				(&quot;Yield&quot;);</span>

<span class="nc bnc" id="L1133" title="All 2 branches missed.">			adblSecTSYSpread[i] = null == q ? java.lang.Double.NaN : q.value (&quot;mid&quot;);</span>
		}

<span class="nc" id="L1136">		return adblSecTSYSpread;</span>
	}

	@Override public double effectiveTreasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1146" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1147">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Bad val/mkt Params&quot;);

<span class="nc" id="L1150">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1152" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L1153">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Invalid Work-out!&quot;);

<span class="nc bnc" id="L1156" title="All 2 branches missed.">		java.lang.String strTreasuryBenchmark = null != _treasuryBenchmarks ? _treasuryBenchmarks.primary() :</span>
			null;

<span class="nc" id="L1159">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1161">		int iWorkoutDate = wi.date();</span>

<span class="nc bnc" id="L1163" title="All 4 branches missed.">		if (null == strTreasuryBenchmark || strTreasuryBenchmark.isEmpty())</span>
<span class="nc" id="L1164">			strTreasuryBenchmark = org.drip.analytics.support.Helper.BaseTsyBmk (iValueDate, iWorkoutDate);</span>

<span class="nc" id="L1166">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1167">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1169" title="All 2 branches missed.">		org.drip.param.definition.ProductQuote pqTSYBenchmark = null != mapTSYQuote &amp;&amp;</span>
<span class="nc bnc" id="L1170" title="All 4 branches missed.">			mapTSYQuote.containsKey (strTreasuryBenchmark) &amp;&amp; !strTreasuryBenchmark.isEmpty() ?</span>
<span class="nc" id="L1171">				mapTSYQuote.get (strTreasuryBenchmark) : null;</span>

<span class="nc bnc" id="L1173" title="All 2 branches missed.">		org.drip.param.definition.Quote q = null != pqTSYBenchmark ? pqTSYBenchmark.quote (&quot;Yield&quot;) : null;</span>

<span class="nc bnc" id="L1175" title="All 2 branches missed.">		if (null != q) return q.value (&quot;mid&quot;);</span>

<span class="nc" id="L1177">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());;</span>

<span class="nc bnc" id="L1179" title="All 2 branches missed.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	@Override public boolean setTreasuryBenchmark (
		final org.drip.product.params.TreasuryBenchmarks treasuryBenchmarks)
	{
<span class="pc bpc" id="L1185" title="1 of 2 branches missed.">		return null != (_treasuryBenchmarks = treasuryBenchmarks);</span>
	}

	@Override public org.drip.product.params.TreasuryBenchmarks treasuryBenchmark()
	{
<span class="nc" id="L1190">		return _treasuryBenchmarks;</span>
	}

	@Override public boolean setIdentifierSet (
		final org.drip.product.params.IdentifierSet idParams)
	{
<span class="pc bpc" id="L1196" title="1 of 2 branches missed.">		return null != (_idParams = idParams);</span>
	}

	@Override public org.drip.product.params.IdentifierSet identifierSet()
	{
<span class="nc" id="L1201">		return _idParams;</span>
	}

	@Override public boolean setCouponSetting (
		final org.drip.product.params.CouponSetting couponSetting)
	{
<span class="pc bpc" id="L1207" title="1 of 2 branches missed.">		return null != (_couponSetting = couponSetting);</span>
	}

	@Override public org.drip.product.params.CouponSetting couponSetting()
	{
<span class="nc" id="L1212">		return _couponSetting;</span>
	}

	@Override public boolean setFloaterSetting (
		final org.drip.product.params.FloaterSetting fltParams)
	{
<span class="fc bfc" id="L1218" title="All 2 branches covered.">		return null == (_floaterSetting = fltParams);</span>
	}

	@Override public org.drip.product.params.FloaterSetting floaterSetting()
	{
<span class="nc" id="L1223">		return _floaterSetting;</span>
	}

	@Override public boolean setMarketConvention (
		final org.drip.product.params.QuoteConvention quoteConvention)
	{
<span class="pc bpc" id="L1229" title="1 of 2 branches missed.">		return null == (_quoteConvention = quoteConvention);</span>
	}

	@Override public org.drip.product.params.QuoteConvention marketConvention()
	{
<span class="nc" id="L1234">		return _quoteConvention;</span>
	}

	@Override public boolean setCreditSetting (
		final org.drip.product.params.CreditSetting creditSetting)
	{
<span class="pc bpc" id="L1240" title="1 of 2 branches missed.">		return null == (_creditSetting = creditSetting);</span>
	}

	@Override public org.drip.product.params.CreditSetting creditSetting()
	{
<span class="nc" id="L1245">		return _creditSetting;</span>
	}

	@Override public boolean setTerminationSetting (
		final org.drip.product.params.TerminationSetting terminationSetting)
	{
<span class="pc bpc" id="L1251" title="1 of 2 branches missed.">		return null == (_terminationSetting = terminationSetting);</span>
	}

	@Override public org.drip.product.params.TerminationSetting terminationSetting()
	{
<span class="nc" id="L1256">		return _terminationSetting;</span>
	}

	@Override public boolean setStream (
		final org.drip.product.params.BondStream stream)
	{
<span class="pc bpc" id="L1262" title="1 of 2 branches missed.">		return null != (_stream = stream);</span>
	}

	@Override public org.drip.product.params.BondStream stream()
	{
<span class="nc" id="L1267">		return _stream;</span>
	}

	@Override public boolean setNotionalSetting (
		final org.drip.product.params.NotionalSetting notionalSetting)
	{
<span class="pc bpc" id="L1273" title="1 of 2 branches missed.">		return null == (_notionalSetting = notionalSetting);</span>
	}

	@Override public org.drip.product.params.NotionalSetting notionalSetting()
	{
<span class="nc" id="L1278">		return _notionalSetting;</span>
	}

	@Override public java.lang.String primaryCode()
	{
<span class="pc bpc" id="L1283" title="1 of 2 branches missed.">		return null == _idParams ? null : &quot;BOND.&quot; + _idParams.id();</span>
	}

	@Override public void setPrimaryCode (
		final java.lang.String strCode)
	{
		// _strCode = strCode;
<span class="nc" id="L1290">	}</span>

	@Override public java.lang.String[] secondaryCode()
	{
<span class="fc" id="L1294">		return new java.lang.String[] {_idParams.id()};</span>
	}

	@Override public java.lang.String isin()
	{
<span class="nc bnc" id="L1299" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.isin();</span>
	}

	@Override public java.lang.String cusip()
	{
<span class="nc bnc" id="L1304" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.cusip();</span>
	}

	@Override public java.lang.String name()
	{
<span class="pc bpc" id="L1309" title="1 of 2 branches missed.">		return null == _idParams ? null : _idParams.id();</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; couponCurrency()
	{
<span class="nc" id="L1314">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; mapCouponCurrency = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt;();

<span class="nc" id="L1317">		mapCouponCurrency.put (name(), _stream.couponCurrency());</span>

<span class="nc" id="L1319">		return mapCouponCurrency;</span>
	}

	@Override public java.lang.String payCurrency()
	{
<span class="fc" id="L1324">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String principalCurrency()
	{
<span class="nc" id="L1329">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public double notional (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1336" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1337">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1339">		return _notionalSetting.outstandingFactorSchedule().y (iDate);</span>
	}

	@Override public double notional (
		final int iStartDate,
		final int iEndDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1347" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1348">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1350">		return _notionalSetting.outstandingFactorSchedule().y (iStartDate, iEndDate);</span>
	}

	@Override public double initialNotional()
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1356" title="1 of 2 branches missed.">		if (null == _notionalSetting)</span>
<span class="nc" id="L1357">			throw new java.lang.Exception (&quot;BondComponent::initialNotional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1359">		return _notionalSetting.notionalAmount();</span>
	}

	public double couponFactor (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1366" title="1 of 2 branches missed.">		if (null == _couponSetting) return 1.;</span>

<span class="fc" id="L1368">		org.drip.quant.common.Array2D fsCoupon = _couponSetting.factorSchedule();</span>

<span class="fc bfc" id="L1370" title="All 2 branches covered.">		return null == fsCoupon ? 1. : fsCoupon.y (iDate);</span>
	}

	@Override public double recovery (
		final int iDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1378" title="All 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="nc bnc" id="L1380" title="All 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.recovery (iDate) : _creditSetting.recovery();</span>
	}

	@Override public double recovery (
		final int iStartDate,
		final int iEndDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1389" title="1 of 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="pc bpc" id="L1391" title="1 of 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iStartDate, iEndDate) :</span>
<span class="nc" id="L1392">			_creditSetting.recovery();</span>
	}

	@Override public org.drip.product.params.CreditSetting creditValuationParams()
	{
<span class="fc" id="L1397">		return _creditSetting;</span>
	}

	@Override public org.drip.analytics.output.CompositePeriodCouponMetrics couponMetrics (
		final int iAccrualEndDate,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="fc" id="L1405">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iAccrualEndDate);</span>

<span class="pc bpc" id="L1407" title="1 of 2 branches missed.">		if (null == cp) return null;</span>

<span class="fc" id="L1409">		java.util.List&lt;org.drip.analytics.output.UnitPeriodMetrics&gt; lsUPM = new</span>
			java.util.ArrayList&lt;org.drip.analytics.output.UnitPeriodMetrics&gt;();

		try {
<span class="fc" id="L1413">			lsUPM.add (new org.drip.analytics.output.UnitPeriodMetrics (cp.startDate(), cp.endDate(),</span>
<span class="fc" id="L1414">				cp.couponDCF(), cp.couponMetrics (valParams.valueDate(), csqc).rate(), new</span>
					org.drip.analytics.output.ConvexityAdjustment()));
<span class="nc" id="L1416">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L1417">			e.printStackTrace();</span>

<span class="nc" id="L1419">			return null;</span>
<span class="fc" id="L1420">		}</span>

<span class="fc" id="L1422">		return org.drip.analytics.output.CompositePeriodCouponMetrics.Create (lsUPM);</span>
	}

	@Override public int freq()
	{
<span class="fc" id="L1427">		return couponPeriods().get (0).freq();</span>
	}

	@Override public org.drip.state.identifier.CreditLabel creditLabel()
	{
<span class="fc bfc" id="L1432" title="All 2 branches covered.">		if (null == _creditSetting) return null;</span>

<span class="fc" id="L1434">		java.lang.String strCreditCurveName = _creditSetting.creditCurveName();</span>

<span class="pc bpc" id="L1436" title="1 of 4 branches missed.">		return null == strCreditCurveName  || strCreditCurveName.isEmpty() ? null :</span>
<span class="fc" id="L1437">			org.drip.state.identifier.CreditLabel.Standard (strCreditCurveName);</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
			forwardLabel()
	{
<span class="pc bpc" id="L1444" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
<span class="fc" id="L1447">			mapForwardLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;();

<span class="fc" id="L1450">		mapForwardLabel.put (name(), _floaterSetting.fri());</span>

<span class="fc" id="L1452">		return mapForwardLabel;</span>
	}

	@Override public org.drip.state.identifier.FundingLabel fundingLabel()
	{
<span class="fc" id="L1457">		return org.drip.state.identifier.FundingLabel.Standard (payCurrency());</span>
	}

	@Override public org.drip.state.identifier.GovvieLabel govvieLabel()
	{
<span class="fc" id="L1462">		return org.drip.state.identifier.GovvieLabel.Standard</span>
<span class="fc" id="L1463">			(org.drip.market.issue.TreasurySettingContainer.CurrencyBenchmarkCode (payCurrency()));</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.FXLabel&gt;
		fxLabel()
	{
<span class="nc" id="L1469">		return null;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.VolatilityLabel&gt;
			volatilityLabel()
	{
<span class="nc" id="L1476">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate effectiveDate()
	{
<span class="fc" id="L1481">		return _stream.effective();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityDate()
	{
<span class="fc" id="L1486">		return _stream.maturity();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityPayDate()
	{
<span class="nc" id="L1491">		return new org.drip.analytics.date.JulianDate (terminationAdjust (maturityDate().julian()));</span>
	}

	@Override public org.drip.analytics.date.JulianDate firstCouponDate()
	{
<span class="fc" id="L1496">		return new org.drip.analytics.date.JulianDate (couponPeriods().get (0).endDate());</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; couponPeriods()
	{
<span class="fc" id="L1501">		return _stream.periods();</span>
	}

	@Override public org.drip.param.valuation.CashSettleParams cashSettleParams()
	{
<span class="nc bnc" id="L1506" title="All 2 branches missed.">		return null == _quoteConvention ? null : _quoteConvention.cashSettleParams();</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlow (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1514" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc) return null;</span>

<span class="nc" id="L1516">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1519" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1520" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1522">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1523">				(this, valParams, pricerParams, period.endDate(), csqc);</span>

<span class="nc bnc" id="L1525" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1526">		}</span>

<span class="nc" id="L1528">		return sLP;</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlowFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L1538" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc ||</span>
<span class="nc bnc" id="L1539" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1540">			return null;</span>

<span class="nc" id="L1542">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1544" title="All 2 branches missed.">		if (null == wi) return null;</span>

<span class="nc" id="L1546">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1548">		int iWorkoutDate = wi.date();</span>

<span class="nc" id="L1550">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1553" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1554" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1556">			int iPeriodEndDate = period.endDate();</span>

<span class="nc bnc" id="L1558" title="All 4 branches missed.">			if (null == period || iPeriodEndDate &lt; iValueDate) continue;</span>

<span class="nc bnc" id="L1560" title="All 2 branches missed.">			if (period.startDate() &gt; iWorkoutDate) break;</span>

<span class="nc" id="L1562">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1563">				(this, valParams, pricerParams, iPeriodEndDate, csqc);</span>

<span class="nc bnc" id="L1565" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1566">		}</span>

<span class="nc" id="L1568">		return sLP;</span>
	}

	@Override public boolean isFloater()
	{
<span class="fc bfc" id="L1573" title="All 2 branches covered.">		return null == _floaterSetting ? false : true;</span>
	}

	@Override public java.lang.String rateIndex()
	{
<span class="nc bnc" id="L1578" title="All 2 branches missed.">		return null == _floaterSetting ? &quot;&quot; : _floaterSetting.fri().fullyQualifiedName();</span>
	}

	@Override public double currentCoupon()
	{
<span class="nc bnc" id="L1583" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.currentFullCoupon();</span>
	}

	@Override public double floatSpread()
	{
<span class="nc bnc" id="L1588" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.spread();</span>
	}

	@Override public java.lang.String ticker()
	{
<span class="nc bnc" id="L1593" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.ticker();</span>
	}

	@Override public void setEmbeddedCallSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="pc bpc" id="L1599" title="2 of 4 branches missed.">		if (null == eos || eos.isPut()) return;</span>

<span class="fc" id="L1601">		_eosCall = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="fc" id="L1602">	}</span>

	@Override public void setEmbeddedPutSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="nc bnc" id="L1607" title="All 4 branches missed.">		if (null == eos || !eos.isPut()) return;</span>

<span class="nc" id="L1609">		_eosPut = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="nc" id="L1610">	}</span>

	@Override public boolean callable()
	{
<span class="nc bnc" id="L1614" title="All 2 branches missed.">		return null != _eosCall;</span>
	}

	@Override public boolean putable()
	{
<span class="nc bnc" id="L1619" title="All 2 branches missed.">		return null != _eosPut;</span>
	}

	@Override public boolean sinkable()
	{
<span class="nc bnc" id="L1624" title="All 2 branches missed.">		return null == _notionalSetting ? false : true;</span>
	}

	@Override public boolean variableCoupon()
	{
<span class="nc bnc" id="L1629" title="All 4 branches missed.">		return null == _couponSetting || null == _couponSetting.couponType() || !&quot;variable&quot;.equalsIgnoreCase</span>
<span class="nc bnc" id="L1630" title="All 2 branches missed.">			(_couponSetting.couponType()) ? false : true;</span>
	}

	@Override public boolean exercised()
	{
<span class="nc bnc" id="L1635" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.exercised();</span>
	}

	@Override public boolean defaulted()
	{
<span class="nc bnc" id="L1640" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.defaulted();</span>
	}

	@Override public boolean perpetual()
	{
<span class="nc bnc" id="L1645" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.perpetual();</span>
	}

	@Override public boolean tradeable (
		final org.drip.param.valuation.ValuationParams valParams)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1652" title="All 2 branches missed.">		if (null == valParams) throw new java.lang.Exception (&quot;BondComponent::tradeable =&gt; invalid Inputs&quot;);</span>

<span class="nc bnc" id="L1654" title="All 4 branches missed.">		return !_terminationSetting.exercised() &amp;&amp; !_terminationSetting.defaulted() &amp;&amp; valParams.valueDate()</span>
<span class="nc bnc" id="L1655" title="All 2 branches missed.">			&lt; maturityDate().julian();</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule callSchedule()
	{
<span class="fc" id="L1660">		return _eosCall;</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule putSchedule()
	{
<span class="nc" id="L1665">		return _eosPut;</span>
	}

	@Override public java.lang.String couponType()
	{
<span class="nc bnc" id="L1670" title="All 2 branches missed.">		return null == _couponSetting ? &quot;&quot; : _couponSetting.couponType();</span>
	}

	@Override public java.lang.String couponDC()
	{
<span class="pc bpc" id="L1675" title="1 of 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.couponDC();</span>
	}

	@Override public java.lang.String accrualDC()
	{
<span class="nc bnc" id="L1680" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.accrualDC();</span>
	}

	@Override public java.lang.String maturityType()
	{
<span class="nc bnc" id="L1685" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : maturityType();</span>
	}

	@Override public org.drip.analytics.date.JulianDate finalMaturity()
	{
<span class="nc bnc" id="L1690" title="All 2 branches missed.">		return null == _stream ? null : new org.drip.analytics.date.JulianDate (_stream.finalMaturityDate());</span>
	}

	@Override public java.lang.String calculationType()
	{
<span class="nc bnc" id="L1695" title="All 2 branches missed.">		return null == _quoteConvention ? &quot;&quot; : _quoteConvention.calculationType();</span>
	}

	@Override public double redemptionValue()
	{
<span class="nc bnc" id="L1700" title="All 2 branches missed.">		return null == _quoteConvention ? java.lang.Double.NaN : _quoteConvention.redemptionValue();</span>
	}

	@Override public java.lang.String currency()
	{
<span class="fc" id="L1705">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String redemptionCurrency()
	{
<span class="nc" id="L1710">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public boolean inFirstCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1717">		return _stream.firstPeriod().contains (iDate);</span>
	}

	@Override public boolean inLastCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1724">		return _stream.lastPeriod().contains (iDate);</span>
	}

	@Override public java.lang.String floatCouponConvention()
	{
<span class="nc bnc" id="L1729" title="All 2 branches missed.">		return null == _floaterSetting ? null : _floaterSetting.dayCount();</span>
	}

	@Override public org.drip.analytics.date.JulianDate periodFixingDate (
		final int iValueDate)
	{
<span class="nc bnc" id="L1735" title="All 4 branches missed.">		if (null == _floaterSetting || iValueDate &gt;= maturityDate().julian()) return null;</span>

<span class="nc bnc" id="L1737" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1738" title="All 2 branches missed.">			if (period.payDate() &lt; iValueDate) continue;</span>

<span class="nc" id="L1740">			org.drip.analytics.cashflow.ComposableUnitPeriod cup = period.periods().get (0);</span>

<span class="nc bnc" id="L1742" title="All 2 branches missed.">			if (!(cup instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)) continue;</span>

			try {
<span class="nc" id="L1745">				return new org.drip.analytics.date.JulianDate</span>
					(((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)
<span class="nc" id="L1747">						(cup)).referenceIndexPeriod().fixingDate());</span>
<span class="nc" id="L1748">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
<span class="nc" id="L1751">		}</span>

<span class="nc" id="L1753">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate previousCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="pc bpc" id="L1759" title="2 of 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="fc" id="L1762">			int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="pc bpc" id="L1764" title="1 of 2 branches missed.">			if (0 == iIndex) return new org.drip.analytics.date.JulianDate (_stream.period (0).startDate());</span>
			
<span class="fc" id="L1766">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex - 1);</span>

<span class="pc bpc" id="L1768" title="1 of 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1769">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1773">		return null;</span>
	}

	@Override public double previousCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1781" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1782">			throw new java.lang.Exception (&quot;BondComponent::previousCouponRate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1784">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1785">			(dt.julian()) - 1);</span>

<span class="nc bnc" id="L1787" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1788">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Cannot find previous period!&quot;);

<span class="nc" id="L1791">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1794" title="All 2 branches missed.">		if (null == cpcm)</span>
<span class="nc" id="L1795">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Invalid previous period metrics!&quot;);

<span class="nc" id="L1798">		return cpcm.rate();</span>
	}

	@Override public org.drip.analytics.date.JulianDate currentCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1804" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1807">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1808">				(dt.julian()));</span>

<span class="nc bnc" id="L1810" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1811">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1814">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate nextCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1820" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1823">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1824">				(dt.julian()) + 1);</span>

<span class="nc bnc" id="L1826" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1827">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1830">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseDateOfType (
		final org.drip.analytics.date.JulianDate dt,
		final boolean bPut)
	{
<span class="nc bnc" id="L1837" title="All 10 branches missed.">		if (null == dt || (bPut &amp;&amp; null == _eosPut) || (!bPut &amp;&amp; null == _eosCall)) return null;</span>

<span class="nc bnc" id="L1839" title="All 2 branches missed.">		org.drip.product.params.EmbeddedOptionSchedule eos = bPut ? _eosPut : _eosCall;</span>

<span class="nc" id="L1841">		int[] aiEOSExerciseDates = eos.dates();</span>

<span class="nc bnc" id="L1843" title="All 4 branches missed.">		if (null == eos || null == aiEOSExerciseDates) return null;</span>

<span class="nc" id="L1845">		int iNumExerciseDates = aiEOSExerciseDates.length;</span>

<span class="nc bnc" id="L1847" title="All 2 branches missed.">		if (0 == iNumExerciseDates) return null;</span>

<span class="nc bnc" id="L1849" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumExerciseDates; ++i) {</span>
<span class="nc bnc" id="L1850" title="All 2 branches missed.">			if (aiEOSExerciseDates[i] - dt.julian() &lt; eos.exerciseNoticePeriod())</span>
<span class="nc" id="L1851">				continue;</span>

			try {
<span class="nc bnc" id="L1854" title="All 2 branches missed.">				return new org.drip.analytics.output.ExerciseInfo (aiEOSExerciseDates[i], eos.factor (i),</span>
					bPut ? org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT :
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L1857">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1860">				return null;</span>
			}
		}

<span class="nc" id="L1864">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseInfo (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1870" title="All 2 branches missed.">		if (null == dt) return null;</span>

<span class="nc" id="L1872">		org.drip.analytics.output.ExerciseInfo neiNextCall = nextValidExerciseDateOfType (dt, false);</span>

<span class="nc" id="L1874">		org.drip.analytics.output.ExerciseInfo neiNextPut = nextValidExerciseDateOfType (dt, true);</span>

<span class="nc bnc" id="L1876" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null == neiNextPut) {</span>
			try {
<span class="nc" id="L1878">				return new org.drip.analytics.output.ExerciseInfo (maturityDate().julian(), 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L1880">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1883">				return null;</span>
			}
		}

<span class="nc bnc" id="L1887" title="All 4 branches missed.">		if (null != neiNextCall &amp;&amp; null == neiNextPut) return neiNextCall;</span>

<span class="nc bnc" id="L1889" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null != neiNextPut) return neiNextPut;</span>

<span class="nc bnc" id="L1891" title="All 2 branches missed.">		return neiNextCall.date() &lt; neiNextPut.date() ? neiNextCall : neiNextPut;</span>
	}

	@Override public double currentCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1899" title="All 4 branches missed.">		if (null == dt || null == csqc)</span>
<span class="nc" id="L1900">			throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc bnc" id="L1902" title="All 2 branches missed.">		if (null != _floaterSetting) {</span>
<span class="nc" id="L1903">			double dblCurrentFullCoupon = _floaterSetting.currentFullCoupon();</span>

<span class="nc bnc" id="L1905" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblCurrentFullCoupon))</span>
<span class="nc" id="L1906">				return dblCurrentFullCoupon;</span>
		}

<span class="nc" id="L1909">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (dt.julian(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1912" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1914">		return pcm.rate();</span>
	}

	@Override public double nextCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1922" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1923">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc" id="L1925">		int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="nc" id="L1927">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex + 1);</span>

<span class="nc bnc" id="L1929" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1930">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Cannot find next period!&quot;);</span>

<span class="nc" id="L1932">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1935" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1937">		return pcm.rate();</span>
	}

	@Override public double accrued (
		final int iDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L1945">		org.drip.analytics.date.JulianDate dt = new org.drip.analytics.date.JulianDate (iDate);</span>

<span class="pc bpc" id="L1947" title="1 of 2 branches missed.">		if (iDate &gt;= maturityDate().julian())</span>
<span class="nc" id="L1948">			throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Val date &quot; + dt +</span>
<span class="nc" id="L1949">				&quot; greater than maturity &quot; + maturityDate());</span>

<span class="fc" id="L1951">		org.drip.param.valuation.ValuationParams valParams = new org.drip.param.valuation.ValuationParams</span>
			(dt, dt, &quot;&quot;);

<span class="fc bfc" id="L1954" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1955">			int iEndDate = period.endDate();</span>

<span class="fc" id="L1957">			int iStartDate = period.startDate();</span>

<span class="fc bfc" id="L1959" title="All 4 branches covered.">			if (iStartDate &lt; iDate &amp;&amp; iEndDate &gt;= iDate) {</span>
<span class="fc" id="L1960">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iEndDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L1963" title="1 of 2 branches missed.">				if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; No PCM&quot;);</span>

<span class="fc" id="L1965">				double dblCoupon = cpcm.rate();</span>

<span class="pc bpc" id="L1967" title="1 of 2 branches missed.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblCoupon))</span>
<span class="nc" id="L1968">					throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Invalid Coupon For &quot; + dt);</span>

<span class="fc" id="L1970">				return period.accrualDCF (iDate) * dblCoupon * notional (iStartDate) * couponFactor</span>
<span class="fc" id="L1971">					(iEndDate);</span>
			}
<span class="fc" id="L1973">		}</span>

<span class="fc" id="L1975">		return 0.;</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1985" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L1986">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1988">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L1990" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1991">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Val date &quot; +</span>
<span class="nc" id="L1992">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L1993">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="nc" id="L1995">		int iPeriodEndDate = 0;</span>
<span class="nc" id="L1996">		double dblTotalCashflow = 0.;</span>
<span class="nc" id="L1997">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L1998">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="nc" id="L1999">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L2001" title="All 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="nc" id="L2002">			_quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L2004" title="All 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="nc bnc" id="L2006" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2007">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2009" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2011">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2013">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2015">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2016" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2018" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2019">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2020">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2021">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2024">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L2027" title="All 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2028">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; No CPCM&quot;);</span>

<span class="nc" id="L2030">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2032">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2034">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="nc" id="L2036">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="nc bnc" id="L2038" title="All 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2039">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="nc bnc" id="L2040" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="nc" id="L2041">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2042" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2044">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="nc" id="L2046">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2047">				(iAccrualStartDate);</span>

<span class="nc bnc" id="L2049" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L2050">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L2052" title="All 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="nc" id="L2053">				cpcm.rate()) * couponFactor (iPeriodEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="nc" id="L2056">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="nc" id="L2057">			iPeriodEndDate += (iAccrualEndDate - iAccrualStartDate);</span>
<span class="nc" id="L2058">			dblTimeWeightedTotalCashflow += iPeriodEndDate * dblPeriodCashflow;</span>

<span class="nc bnc" id="L2060" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2061">		}</span>

<span class="nc" id="L2063">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="nc" id="L2065">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="nc" id="L2066">		dblTimeWeightedTotalCashflow += iPeriodEndDate * dblTerminalCashflow;</span>
<span class="nc" id="L2067">		return (int) (dblTimeWeightedTotalCashflow / dblTotalCashflow);</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2075">		return weightedAverageMaturityDate (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2085" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2086">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2088">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L2090" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2091">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Val date &quot; +</span>
<span class="nc" id="L2092">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2093">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="nc" id="L2095">		double dblTotalCashflow = 0.;</span>
<span class="nc" id="L2096">		double dblPeriodEndTime = 0.;</span>
<span class="nc" id="L2097">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L2098">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="nc" id="L2099">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L2101" title="All 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="nc" id="L2102">			_quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L2104" title="All 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="nc bnc" id="L2106" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2107">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2109" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2111">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2113">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2115">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2116" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2118" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2119">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2120">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2121">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2124">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L2127" title="All 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2128">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; No CPCM&quot;);</span>

<span class="nc" id="L2130">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2132">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2134">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="nc" id="L2136">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="nc bnc" id="L2138" title="All 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2139">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="nc bnc" id="L2140" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="nc" id="L2141">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2142" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2144">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="nc" id="L2146">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2147">				(iAccrualStartDate);</span>

<span class="nc bnc" id="L2149" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L2150">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L2152" title="All 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="nc" id="L2153">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="nc" id="L2156">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="nc" id="L2157">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="nc" id="L2158">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="nc bnc" id="L2160" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2161">		}</span>

<span class="nc" id="L2163">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="nc" id="L2165">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="nc" id="L2166">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="nc" id="L2167">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2175">		return weightedAverageLife (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2185" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2186">			throw new java.lang.Exception</span>
				(&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Invalid Inputs&quot;);

<span class="nc" id="L2189">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L2191" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2192">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2193">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2194">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="nc" id="L2196">		double dblTotalCashflow = 0.;</span>
<span class="nc" id="L2197">		double dblPeriodEndTime = 0.;</span>
<span class="nc" id="L2198">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L2199">		double dblTimeWeightedTotalCashflow = 0.;</span>

<span class="nc bnc" id="L2201" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2202">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2204" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2206">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2208">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2210">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2211" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2213" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2214">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2215">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2216">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2219">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2221">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2223">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2224">				(iAccrualStartDate);</span>

<span class="nc" id="L2226">			double dblPeriodCashflow = dblPeriodStartNotional - dblPeriodEndNotional;</span>
<span class="nc" id="L2227">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>
<span class="nc" id="L2228">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="nc" id="L2229">			dblPeriodEndTime += dblPeriodTimeWidth;</span>

<span class="nc bnc" id="L2231" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2232">		}</span>

<span class="nc" id="L2234">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="nc" id="L2236">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="nc" id="L2237">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="nc" id="L2238">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2246">		return weightedAverageLifePrincipalOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2256" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2257">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2259">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L2261" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2262">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2263">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2264">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="nc" id="L2266">		double dblTotalCashflow = 0.;</span>
<span class="nc" id="L2267">		double dblPeriodEndTime = 0.;</span>
<span class="nc" id="L2268">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L2269">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="nc" id="L2270">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L2272" title="All 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="nc" id="L2273">			_quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L2275" title="All 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="nc bnc" id="L2277" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2278">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2280" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2282">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2284">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2286">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2287" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2289" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2290">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2291">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2292">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2295">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L2298" title="All 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2299">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; No CPCM&quot;);</span>

<span class="nc" id="L2301">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2303">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2305">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="nc" id="L2307">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="nc bnc" id="L2309" title="All 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2310">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="nc bnc" id="L2311" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="nc" id="L2312">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2313" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2315">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="nc" id="L2317">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2318">				(iAccrualStartDate);</span>

<span class="nc bnc" id="L2320" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L2321">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L2323" title="All 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="nc" id="L2324">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="nc" id="L2326">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="nc" id="L2327">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="nc" id="L2328">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="nc bnc" id="L2330" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2331">		}</span>

<span class="nc" id="L2333">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2341">		return weightedAverageLifeCouponOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2351" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2352">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2354">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L2356">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc bnc" id="L2358" title="All 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2359">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2361">		double dblPeriodEndTime = 0.;</span>
<span class="nc" id="L2362">		double dblTotalLossCashflow = 0.;</span>
<span class="nc" id="L2363">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L2364">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="nc" id="L2365">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L2367" title="All 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="nc" id="L2368">			_quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L2370" title="All 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="nc bnc" id="L2372" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2373">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2375" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2377">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2379">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2381">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2382" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2384" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2385">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2386">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2387">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2390">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L2393" title="All 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2394">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; No CPCM&quot;);</span>

<span class="nc" id="L2396">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2398">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2400">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="nc" id="L2402">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="nc bnc" id="L2404" title="All 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2405">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="nc bnc" id="L2406" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="nc" id="L2407">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2408" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2410">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="nc" id="L2412">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2413">				(iAccrualStartDate);</span>

<span class="nc bnc" id="L2415" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L2416">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L2418" title="All 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="nc" id="L2419">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="nc" id="L2420">					dblPeriodEndNotional) * cc.survival (iPeriodPayDate) * (1. - cc.effectiveRecovery</span>
<span class="nc" id="L2421">						(iPeriodStartDate, period.endDate()));</span>

<span class="nc" id="L2423">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="nc" id="L2424">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="nc" id="L2425">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="nc bnc" id="L2427" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2428">		}</span>

<span class="nc" id="L2430">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * cc.survival</span>
<span class="nc" id="L2431">			(iWorkoutDate) * (1. - cc.recovery (iWorkoutDate));</span>

<span class="nc" id="L2433">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="nc" id="L2434">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="nc" id="L2435">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2443">		return weightedAverageLifeLossOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2453" title="All 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2454">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2456">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L2458">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc bnc" id="L2460" title="All 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2461">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L2463">		double dblPeriodEndTime = 0.;</span>
<span class="nc" id="L2464">		double dblTotalLossCashflow = 0.;</span>
<span class="nc" id="L2465">		boolean bTerminateCouponFlow = false;</span>
<span class="nc" id="L2466">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="nc" id="L2467">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L2469" title="All 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="nc" id="L2470">			_quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L2472" title="All 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="nc bnc" id="L2474" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L2475">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L2477" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L2479">			int iNotionalEndDate = period.endDate();</span>

<span class="nc" id="L2481">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L2483">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="nc bnc" id="L2484" title="All 2 branches missed.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="nc bnc" id="L2486" title="All 2 branches missed.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="nc" id="L2487">				bTerminateCouponFlow = true;</span>
<span class="nc" id="L2488">				iAccrualEndDate = iWorkoutDate;</span>
<span class="nc" id="L2489">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="nc" id="L2492">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L2495" title="All 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2496">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; No CPCM&quot;);</span>

<span class="nc" id="L2498">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="nc" id="L2500">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="nc" id="L2502">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="nc" id="L2504">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="nc bnc" id="L2506" title="All 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2507">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="nc bnc" id="L2508" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="nc" id="L2509">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2510" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2512">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="nc" id="L2514">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="nc" id="L2515">				(iAccrualStartDate);</span>

<span class="nc bnc" id="L2517" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L2518">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc" id="L2520">			double dblPeriodSurvival = cc.survival (iPeriodPayDate);</span>

<span class="nc bnc" id="L2522" title="All 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="nc" id="L2523">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional) * (dblPeriodSurvival * (1. - cc.effectiveRecovery
<span class="nc" id="L2525">						(iPeriodStartDate, iNotionalEndDate)) + 1. - dblPeriodSurvival);</span>

<span class="nc" id="L2527">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="nc" id="L2528">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="nc" id="L2529">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="nc bnc" id="L2531" title="All 2 branches missed.">			if (bTerminateCouponFlow) break;</span>
<span class="nc" id="L2532">		}</span>

<span class="nc" id="L2534">		double dblTerminalSurvival = cc.survival (iWorkoutDate);</span>

<span class="nc" id="L2536">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * (dblTerminalSurvival *</span>
<span class="nc" id="L2537">			(1. - cc.recovery (iWorkoutDate)) + 1. - dblTerminalSurvival);</span>

<span class="nc" id="L2539">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="nc" id="L2540">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="nc" id="L2541">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2549">		return weightedAverageLifeCredit (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double priceFromZeroCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iZeroCurveBaseDC,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2562" title="1 of 2 branches missed.">		if (null == valParams)</span>
<span class="nc" id="L2563">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2565">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2567" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == csqc || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L2568" title="2 of 4 branches missed.">			(dblWorkoutFactor) || !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L2569">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs &quot; + dblBump);</span>

<span class="fc" id="L2571">		double dblPV = 0.;</span>
<span class="fc" id="L2572">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2573">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L2574">		org.drip.state.discount.ZeroCurve zc = null;</span>
<span class="fc" id="L2575">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2576">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2578" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2579">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2581" title="1 of 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L2582">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="fc bfc" id="L2584" title="All 2 branches covered.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="fc" id="L2585">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2587" title="1 of 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc bfc" id="L2590" title="All 2 branches covered.">		org.drip.state.discount.DiscountCurve dcBase = ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE ==</span>
<span class="fc" id="L2591">			iZeroCurveBaseDC ? csqc.fundingState (fundingLabel()) : csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L2593" title="All 2 branches covered.">		if (null == dcBase)</span>
<span class="fc" id="L2594">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Discount Curve&quot;);</span>

		try {
<span class="fc bfc" id="L2597" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L2598">				valParams.cashPayDate();</span>
<span class="nc" id="L2599">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2602">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2603">		}</span>

<span class="fc" id="L2605">		java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; lsCompositePeriod = couponPeriods();</span>

		try {
<span class="fc" id="L2608">			zc = org.drip.state.curve.DerivedZeroRate.FromBaseCurve (freq(), couponDC(), currency(),</span>
<span class="pc bpc" id="L2609" title="1 of 4 branches missed.">				_stream.couponEOMAdjustment(), lsCompositePeriod, terminationAdjust (iWorkoutDate),</span>
					iValueDate, iCashPayDate, dcBase, dblBump, null == vcp ? (null == _quoteConvention ? null
<span class="pc" id="L2611">						: _quoteConvention.valuationCustomizationParams()) : vcp, new</span>
							org.drip.spline.params.SegmentCustomBuilderControl
								(org.drip.spline.stretch.MultiSegmentSequenceBuilder.BASIS_SPLINE_POLYNOMIAL,
									new org.drip.spline.basis.PolynomialFunctionSetParams (2),
<span class="fc" id="L2615">										org.drip.spline.params.SegmentInelasticDesignControl.Create (0, 2),</span>
											new org.drip.spline.params.ResponseScalingShapeControl (true, new
												org.drip.function.r1tor1.QuadraticRationalShapeControl (0.)),
													null));
<span class="nc" id="L2619">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L2620">			e.printStackTrace();</span>
<span class="fc" id="L2621">		}</span>

<span class="pc bpc" id="L2623" title="1 of 2 branches missed.">		if (null == zc)</span>
<span class="nc" id="L2624">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Cannot create shifted ZC&quot;);</span>

<span class="pc bpc" id="L2626" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : lsCompositePeriod) {</span>
<span class="fc" id="L2627">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2629" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2631">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2633">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2635">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L2637">			int iNotionalEndDate = iAccrualEndDate;</span>
<span class="fc" id="L2638">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2640">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc bfc" id="L2642" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2643">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2644">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2645">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2648">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START ==</span>
<span class="fc bfc" id="L2649" title="All 2 branches covered.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2650">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="fc" id="L2651">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END ==</span>
<span class="pc bpc" id="L2652" title="1 of 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2653">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc" id="L2654">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
<span class="nc bnc" id="L2655" title="All 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="nc" id="L2656">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2658">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2661" title="1 of 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2663" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2664">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2666" title="1 of 2 branches missed.">			dblPV += (period.accrualDCF (iAccrualEndDate) * (bApplyFlatForwardRate ? dblFlatForwardRate :</span>
<span class="fc" id="L2667">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2668">					dblPeriodEndNotional) * zc.df (iPeriodPayDate);</span>

<span class="fc bfc" id="L2670" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2671">		}</span>

<span class="fc" id="L2673">		return ((dblPV + dblWorkoutFactor * zc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L2674">			(iWorkoutDate)) / zc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	@Override public double priceFromFundingCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="fc" id="L2685">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_FUNDING_CURVE);
	}

	@Override public double priceFromTreasuryCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="nc" id="L2697">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_TREASURY_CURVE);
	}

	@Override public double priceFromCreditCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis,
		final boolean bFlat)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2710" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L2711" title="1 of 4 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblCreditBasis) || null == _creditSetting)</span>
<span class="fc" id="L2712">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2714">		org.drip.state.credit.CreditCurve ccIn = csqc.creditState (creditLabel());</span>

<span class="fc bfc" id="L2716" title="All 2 branches covered.">		if (null == ccIn)</span>
<span class="fc" id="L2717">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2719">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L2721" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L2722">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No funding curve&quot;);</span>

<span class="fc" id="L2724">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2726" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2727">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L2728">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2729">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="pc bpc" id="L2731" title="1 of 2 branches missed.">		double dblRecoveryToUse = !_creditSetting.useCurveRecovery() ? _creditSetting.recovery() :</span>
			java.lang.Double.NaN;

<span class="pc bpc" id="L2734" title="1 of 2 branches missed.">		org.drip.state.credit.CreditCurve cc = bFlat ? ccIn.flatCurve (dblCreditBasis, true,</span>
			dblRecoveryToUse) : (org.drip.state.credit.CreditCurve) ccIn.parallelShiftManifestMeasure
<span class="fc" id="L2736">				(&quot;SwapRate&quot;, dblCreditBasis);</span>

<span class="pc bpc" id="L2738" title="1 of 2 branches missed.">		if (null == cc)</span>
<span class="nc" id="L2739">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromCreditCurve =&gt; Cannot create adjusted Curve&quot;);

<span class="fc" id="L2742">		double dblPV = 0.;</span>
<span class="fc" id="L2743">		boolean bTerminateCashFlow = false;</span>
<span class="fc" id="L2744">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2745">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2747" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2748">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2750" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2751">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2753" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="fc" id="L2755">		org.drip.param.pricer.CreditPricerParams pricerParams = new org.drip.param.pricer.CreditPricerParams</span>
			(7, null, false, s_iDiscretizationScheme);

<span class="fc" id="L2758">		int iLossPayLag = _creditSetting.lossPayLag();</span>

<span class="fc" id="L2760">		boolean bAccrualOnDefault = _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L2762">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2764" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="pc bpc" id="L2765" title="1 of 2 branches missed.">			if (bTerminateCashFlow) continue;</span>

<span class="fc" id="L2767">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2769" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2771">			int iPeriodEndDate = period.endDate();</span>

<span class="fc bfc" id="L2773" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2774">				bTerminateCashFlow = true;</span>
<span class="fc" id="L2775">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2778">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L2780" title="All 2 branches covered.">			if (iPeriodStartDate &lt; iValueDate) iPeriodStartDate = iValueDate;</span>

<span class="fc" id="L2782">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2785" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2786">				throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2788" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2789">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2791" title="1 of 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="fc" id="L2793">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2795">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L2797">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L2799" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2800">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L2801" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2802">				dblCouponNotional = notional (iPeriodEndDate);</span>
<span class="nc bnc" id="L2803" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2805">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc" id="L2807">			dblPV += (period.accrualDCF (iPeriodEndDate) * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dcFunding.df
<span class="fc" id="L2809">					(iPeriodPayDate) * cpcm.cumulative() * cc.survival (iPeriodEndDate);</span>

<span class="fc bfc" id="L2811" title="All 2 branches covered.">			for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this, valParams,</span>
				pricerParams, iPeriodEndDate, csqc)) {
<span class="pc bpc" id="L2813" title="1 of 2 branches missed.">				if (null == lqm) continue;</span>

<span class="fc" id="L2815">				int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L2817">				int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L2819">				double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
					iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L2822">				double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L2824">				double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L2825">					(iSubPeriodEndDate);</span>

<span class="fc bfc" id="L2827" title="All 2 branches covered.">				if (bAccrualOnDefault)</span>
<span class="fc" id="L2828">					dblPV += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival * dblSubPeriodDF *</span>
						dblSubPeriodNotional * dblPeriodCoupon;

<span class="pc bpc" id="L2831" title="1 of 2 branches missed.">				dblPV += (_creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
<span class="pc" id="L2832">					iSubPeriodEndDate) : _creditSetting.recovery()) * dblSubPeriodSurvival *</span>
						dblSubPeriodNotional * dblSubPeriodDF;
<span class="fc" id="L2834">			}</span>
<span class="fc" id="L2835">		}</span>

		try {
<span class="pc bpc" id="L2838" title="1 of 2 branches missed.">			iCashPayDate = null == _quoteConvention ? valParams.cashPayDate() : _quoteConvention.settleDate</span>
<span class="fc" id="L2839">				(valParams);</span>
<span class="nc" id="L2840">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2843">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2844">		}</span>

<span class="fc" id="L2846">		return ((dblPV + dblWorkoutFactor * dcFunding.df (terminationAdjust (iWorkoutDate)) * cc.survival</span>
<span class="fc" id="L2847">			(iWorkoutDate) * notional (iWorkoutDate)) / dcFunding.df (iCashPayDate) - accrued (iValueDate,</span>
				csqc)) / dblScalingNotional;
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2860">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L2861">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2871">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2881" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2882">			throw new java.lang.Exception (&quot;BondComponent::aswFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Bond Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2885">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2897">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L2898">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2908">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2918" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2919">			throw new java.lang.Exception (&quot;BondComponent::aswFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Credit Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2922">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2934">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L2935">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2945">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2955" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2956">			throw new java.lang.Exception (&quot;BondComponent::aswFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L2959">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L2971">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L2972">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L2982">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2992" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2993">			throw new java.lang.Exception (&quot;BondComponent::aswFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L2996">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3008">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L3009">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3019">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3029" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3030">			throw new java.lang.Exception (&quot;BondComponent::aswFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3033">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3045">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L3046">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3056">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3066" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3067">			throw new java.lang.Exception (&quot;BondComponent::aswFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3070">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3082">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L3083">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3093">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3103" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3104">			throw new java.lang.Exception (&quot;BondComponent::aswFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3107">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3119">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L3120">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3130">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3140" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3141">			throw new java.lang.Exception (&quot;BondComponent::aswFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3144">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3156">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3167">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3177" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3178">			throw new java.lang.Exception (&quot;BondComponent::aswFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3181">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3193">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L3194">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3204">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3214" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3215">			throw new java.lang.Exception (&quot;BondComponent::aswFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3218">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3230" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L3231" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L3232">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3234">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L3236" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L3237">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3239">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="pc bpc" id="L3242" title="1 of 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; No CPCM&quot;);</span>

<span class="fc" id="L3244">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L3246" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L3247">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3249">		return cpcm.rate() - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + 0.0001 *</span>
<span class="fc" id="L3250">			(dblWorkoutFactor - dblPrice) / dcFunding.parSwapDV01 (iWorkoutDate);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3260">		return aswFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double aswFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3270">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L3272" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3273">			throw new java.lang.Exception</span>
				(&quot;BondComponent::aswFromPriceToOptimalExercise =&gt; Can't determine Optimal Work-out&quot;);

<span class="nc" id="L3276">		return aswFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L3288">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="fc" id="L3289">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3299">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3309" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3310">			throw new java.lang.Exception (&quot;BondComponent::aswFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3313">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3325">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3336">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3346" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3347">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3350">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3362">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L3363">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3373">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3383" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3384">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3387">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3399">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L3400">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3410">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double aswFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3420" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3421">			throw new java.lang.Exception (&quot;BondComponent::aswFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3424">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3436">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L3437">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3447">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3457" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3458">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3461">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3473">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3474">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3484">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3494" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3495">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3498">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3510">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3511">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3522">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3533" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3534">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3537">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3550">		return bondBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3551">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3561">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3571" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3572">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3575">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3587">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L3588">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3598">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3608" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3609">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3612">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3624">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L3625">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3635">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3645" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3646">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3649">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3661">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L3662">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3672">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3682" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3683">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3686">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3698">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L3699">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3709">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3719" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3720">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3723">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3735">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L3736">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3746">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3756" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3757">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3760">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3772">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L3773">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3783">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3793" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3794">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3797">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3809">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L3810">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3820">		return bondBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double bondBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3830">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>
		
<span class="nc bnc" id="L3832" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3833">			throw new java.lang.Exception</span>
				(&quot;BondComponent::bondBasisFromPriceToOptimalExercise =&gt; cant calc Work-out info&quot;);

<span class="nc" id="L3836">		return bondBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3848">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L3849">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3859">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3869" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3870">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3873">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3885" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L3886">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L3888">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L3889">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3899">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3909" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3910">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3913">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3925">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3926">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3936">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3946" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3947">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3950">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3962">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L3963">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3973">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3983" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3984">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3987">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3999">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4000">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4010">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4020" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4021">			throw new java.lang.Exception (&quot;BondComponent::convexityFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4024">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4036">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L4037">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4047">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4057" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4058">			throw new java.lang.Exception (&quot;BondComponent::convexityFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4061">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4073">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4074">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4084">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4094" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4095">			throw new java.lang.Exception (&quot;BondComponent::convexityFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4098">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4110">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4111">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4122">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4133" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4134">			throw new java.lang.Exception (&quot;BondComponent::convexityFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Convexity from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4137">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4150">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4151">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4161">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4171" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4172">			throw new java.lang.Exception (&quot;BondComponent::convexityFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4175">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4187">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4188">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4198">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4208" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4209">			throw new java.lang.Exception (&quot;BondComponent::convexityFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4212">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4224">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4225">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4235">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4245" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4246">			throw new java.lang.Exception (&quot;BondComponent::convexityFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4249">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4261">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4262">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4272">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4282" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4283">			throw new java.lang.Exception (&quot;BondComponent::convexityFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4286">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4298">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4299">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4309">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4319" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4320">			throw new java.lang.Exception (&quot;BondComponent::convexityFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4323">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4335">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4336">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4346">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4356" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4357">			throw new java.lang.Exception (&quot;BondComponent::convexityFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4360">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4372">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4373">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4383">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4393" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4394">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4397">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L4409" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L4410">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc" id="L4412">		double dblYield = yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>

<span class="fc" id="L4414">		return (priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield - 0.0001) +</span>
<span class="fc" id="L4415">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001) - 2. *</span>
<span class="fc" id="L4416">				dblPrice) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4426">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4436" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4437">			throw new java.lang.Exception (&quot;BondComponent::calcConvexityFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4440">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4452">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L4453">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4463">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4473" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4474">			throw new java.lang.Exception (&quot;BondComponent::convexityFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4477">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4489">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L4490">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4500">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4510" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4511">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4514">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4526">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L4527">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4537">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4547" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4548">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4551">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4563">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L4564">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4574">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4584" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4585">			throw new java.lang.Exception (&quot;BondComponent::convexityFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4588">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4600">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4601">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4611">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4621" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4622">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Credit Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4625">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4637">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4638">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4648">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4658" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4659">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4662">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4674">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4675">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4686">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4697" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4698">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Credit Basis from Discnt Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4702">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4715">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4716">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4726">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4736" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4737">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4740">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4752">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4753">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4763">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4773" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4774">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4777">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4789">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4790">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4800">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4810" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4811">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4814">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4826">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4827">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4837">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4847" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4848">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4851">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4863">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4864">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4874">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4884" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4885">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4888">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4900">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4901">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4911">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4921" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4922">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4925">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4937">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4938">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4948">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4958" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4959">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4962">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4974">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, false);
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L4985">		return creditBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double creditBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L4995">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L4997" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L4998">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromPriceToOptimalExercise =&gt; cant calc Work-out&quot;);

<span class="nc" id="L5001">		return creditBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L5013">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5014">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5024">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5034" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5035">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5038">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5050">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L5051">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5061">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5071" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5072">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5075">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5087">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5088">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5098">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws	java.lang.Exception
	{
<span class="nc bnc" id="L5109" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5110">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5113">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5126">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L5127">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5137">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5147" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5148">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5151">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5163">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L5164">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5174">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5184" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5185">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5188">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5200">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5201">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5211">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5221" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5222">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5225">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5237">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5238">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5248">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5259" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5260">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Crdit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5264">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5277">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5278">			yieldFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5288">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5298" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5299">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromESpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5302">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5314">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5315">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5325">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5335" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5336">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromGSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5339">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5351">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5352">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5362">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5372" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5373">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromISpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5376">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5388">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5389">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5399">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5409" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5410">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromJSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5413">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5425">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5426">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5436">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5446" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5447">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromNSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5450">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5462">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L5463">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5473">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5483" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5484">			throw new java.lang.Exception (&quot;BondComponent::calcDiscountMarginFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5487">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5499">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L5500">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5510">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5520" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5521">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5524">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5536">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5537">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5547">		return discountMarginFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double discountMarginFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5557">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5559" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5560">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L5563">		return discountMarginFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5575">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5576">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5586">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5596" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5597">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromTSYSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5600">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L5612" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L5613">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5615">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L5617" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L5618">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5620">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L5622">		int iFreq = freq();</span>

<span class="fc" id="L5624">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L5626" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L5627">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L5629" title="2 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
<span class="fc" id="L5630">			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblYield - dcFunding.libor (iValueDate,</span>
<span class="fc" id="L5631">				((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblYield - indexRate (iValueDate, csqc,</span>
					(org.drip.analytics.cashflow.CompositeFloatingPeriod) cp);
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5642">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5652" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5653">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5656">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5668">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5669">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5679">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5690" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5691">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5695">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5708">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5709">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5719">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5729" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5730">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromZSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5733">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5745">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L5746">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5756">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5766" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5767">			throw new java.lang.Exception (&quot;BondComponent::durationFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5770">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5782">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L5783">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5793">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5803" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5804">			throw new java.lang.Exception (&quot;BondComponent::durationFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5807">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5819">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5820">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5830">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5840" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5841">			throw new java.lang.Exception (&quot;BondComponent::durationFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5844">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5856">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5857">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5868">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5879" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5880">			throw new java.lang.Exception (&quot;BondComponent::durationFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Duration from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5883">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5896">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L5897">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5907">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5917" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5918">			throw new java.lang.Exception (&quot;BondComponent::durationFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5921">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5933">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L5934">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5944">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5954" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5955">			throw new java.lang.Exception (&quot;BondComponent::durationFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5958">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5970">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L5971">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5981">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5991" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5992">			throw new java.lang.Exception (&quot;BondComponent::durationFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5995">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6007">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6008">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6018">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6028" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6029">			throw new java.lang.Exception (&quot;BondComponent::durationFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6032">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6044">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6045">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6055">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6065" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6066">			throw new java.lang.Exception (&quot;BondComponent::durationFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6069">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6081">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6082">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6092">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6102" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6103">			throw new java.lang.Exception (&quot;BondComponent::durationFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6106">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6118">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6119">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6129">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6139" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6140">			throw new java.lang.Exception (&quot;BondComponent::durationFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6143">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6155">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6165">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6175" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6176">			throw new java.lang.Exception (&quot;BondComponent::durationFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6179">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6191">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6192">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6202">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6212" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6213">			throw new java.lang.Exception (&quot;BondComponent::durationFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6216">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6228">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6229">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6239">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6249" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6250">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6253">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6265">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6266">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6276">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6286" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6287">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6290">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6302">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L6303">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6313">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6323" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6324">			throw new java.lang.Exception (&quot;BondComponent::durationFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6327">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6339">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L6340">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6350">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6360" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6361">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6364">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6376">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L6377">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6387">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6397" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6398">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6401">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6413">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L6414">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6424">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6434" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6435">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6438">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6450">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6451">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6462">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6473" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6474">			throw new java.lang.Exception</span>
				(&quot;BondComponent::eSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc E Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6478">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6491">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L6492">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6502">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6512" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6513">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6516">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6528">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6529">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6539">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6549" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6550">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6553">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6565">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6566">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6576">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6586" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6587">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6590">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6602">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6603">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6613">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6623" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6624">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6627">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6639">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6640">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6650">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6660" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6661">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6664">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6676">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6677">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6687">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6697" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6698">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6701">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6713">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6724">		return eSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double eSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6734">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L6736" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L6737">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6740">		return eSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6752">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6753">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6763">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6773" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6774">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6777">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6789">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6790">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6800">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6810" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6811">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6814">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6826">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L6827">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6837">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double eSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6847" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6848">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6851">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6863">		return gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L6864">			(valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6874">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6884" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6885">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6888">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6900">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L6901">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6911">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6921" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6922">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6925">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6937">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L6938">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6948">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6958" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6959">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6962">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6974">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6975">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6986">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6997" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6998">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc G Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7001">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7014">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7015">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7025">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7035" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7036">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7039">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7051">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L7052">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7062">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7072" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7073">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7076">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7088">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7089">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7099">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7109" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7110">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7113">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7125">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7126">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7136">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7146" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7147">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7150">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7162">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7163">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7173">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7183" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7184">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7187">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7199">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7200">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7210">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7220" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7221">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7224">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7236">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7237">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7247">		return gSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double gSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7257">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7259" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7260">			throw new java.lang.Exception</span>
				(&quot;BondComponent::gSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7263">		return gSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7275">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7276">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7286">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7296" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7297">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7300">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7312" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield) ||</span>
<span class="pc bpc" id="L7313" title="1 of 2 branches missed.">			valParams.valueDate() &gt;= iWorkoutDate)</span>
<span class="nc" id="L7314">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7316">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L7318" title="All 2 branches covered.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7320">		return dblYield - gc.yield (iWorkoutDate);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7330">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7340" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7341">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7344">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7356">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7357">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7367">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7377" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7378">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7381">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7393">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7394">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7404">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double gSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7414" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7415">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7418">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7430">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7431">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7441">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7451" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7452">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7455">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7467">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L7468">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7478">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7488" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7489">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7492">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7504">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L7505">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7515">		return iSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7525" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7526">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7529">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7541">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7542">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7553">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7564" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7565">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc I Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7568">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7581">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7582">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7592">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7602" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7603">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7606">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7618">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L7619">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7629">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7639" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7640">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7643">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7655">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7656">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7666">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7676" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7677">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7680">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7692">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7693">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7703">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7713" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7714">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7717">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7729">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7730">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7740">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7750" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7751">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7754">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7766">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7767">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7777">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7787" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7788">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7791">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7803">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7804">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7814">		return iSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double iSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7824">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7826" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7827">			throw new java.lang.Exception</span>
				(&quot;BondComponent::iSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7830">		return iSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7842">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7843">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7853">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7863" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7864">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7867">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7879" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L7880">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7882">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L7884" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L7885">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7887">		return dblYield - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7897">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7907" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7908">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7911">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7923">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7924">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7934">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7944" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7945">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7948">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7960">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7961">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7971">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7981" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7982">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7985">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7997">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7998">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8008">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8018" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8019">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8022">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8034">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L8035">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8045">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8055" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8056">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8059">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8071">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L8072">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8082">		return jSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8092" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8093">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8096">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8108">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8109">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8120">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8131" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8132">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc J Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8135">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8148">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L8149">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8159">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8169" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8170">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8173">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8185">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L8186">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8196">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8206" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8207">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8210">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8222">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L8223">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8233">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8243" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8244">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8247">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8259">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L8260">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8270">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8280" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8281">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8284">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8296">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L8297">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8307">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8317" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8318">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8321">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8333">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L8334">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8344">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8354" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8355">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8358">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8370">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L8371">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8381">		return jSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double jSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8391">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L8393" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L8394">			throw new java.lang.Exception</span>
				(&quot;BondComponent::jSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L8397">		return jSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8409">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L8410">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8420">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8430" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8431">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8434">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8446" title="All 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L8447">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="nc" id="L8449">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L8451" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="nc" id="L8453">		return dblYield - gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L8464">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8474" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8475">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8478">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8490">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L8491">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8501">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8511" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8512">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8515">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8527">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8528">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8538">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8548" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8549">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8552">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8564">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8565">			yieldFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8575">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8585" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8586">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8590">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8602">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8603">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8613">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8624" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8625">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8629">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8642">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8643">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8653">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8664" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8665">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8669">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8682">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8683">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8694">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8705" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8706">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8710">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8723">		return macaulayDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8724">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8734">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8744" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8745">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8749">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8761">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8762">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8772">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8782" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8783">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8787">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8799">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8800">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8810">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8820" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8821">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8825">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8837">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8838">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8848">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8858" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8859">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8863">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8875">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8876">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8886">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8896" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8897">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8901">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8913">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8914">			yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8924">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double mnacaulayDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8934" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8935">			throw new java.lang.Exception</span>
				(&quot;BondComponent::mnacaulayDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8939">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8951">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8952">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8962">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8972" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8973">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8977">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8989">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L8990">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9000">		return macaulayDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double macaulayDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9010">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9012" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9013">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9016">		return macaulayDurationFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9028">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9029">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9039">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9050" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9051">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9055">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9068" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L9069">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9071">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L9073" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L9074">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9076">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L9077">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L9078">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L9079">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L9080">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L9081">		double dblCumulativePeriodDuration = 0.;</span>
<span class="fc" id="L9082">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L9083">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>
<span class="fc" id="L9084">		org.drip.analytics.cashflow.CompositePeriod periodRef = null;</span>

<span class="fc" id="L9086">		int iFrequency = freq();</span>

<span class="fc" id="L9088">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L9090">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L9092">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L9094" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L9096" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L9097">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L9099" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L9100">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L9102">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L9104">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L9106">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L9108">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L9109" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L9110">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L9112">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L9114">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L9116">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L9118">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L9121">		int iAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L9123" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L9124">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L9126" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L9128" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L9129">				bFirstPeriod = false;</span>

<span class="fc" id="L9131">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L9133">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L9135">			periodRef = period;</span>

<span class="fc" id="L9137">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L9139">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L9141" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L9142">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L9143">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L9146">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L9149" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L9150">				throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; No CPCM&quot;);</span>

<span class="pc bpc" id="L9152" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L9153" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L9154">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L9156" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L9157" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L9158">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L9161">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L9164">			double dblYearFract = org.drip.analytics.daycount.Convention.YearFraction (iValueDate,</span>
				iPeriodPayDate, strDC, bApplyCpnEOMAdj, aap, strCalendar);

<span class="fc" id="L9167">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L9168">				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract : dblYearFract) * cpcm.cumulative();</span>

<span class="fc" id="L9170">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L9172">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L9174">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="pc bpc" id="L9176" title="1 of 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iAmortizationMode)</span>
<span class="nc" id="L9177">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L9178" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iAmortizationMode)</span>
<span class="fc" id="L9179">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L9180" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE == iAmortizationMode)</span>
<span class="nc" id="L9181">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L9183" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L9184">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L9186" title="1 of 2 branches missed.">			double dblCouponPV = period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="fc" id="L9187">				dblFlatForwardRate : cpcm.rate()) * couponFactor (iPeriodEndDate) * dblYieldAnnuity *</span>
					dblCouponNotional;

<span class="fc" id="L9190">			double dblPeriodNotionalPV = (dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;</span>
<span class="fc" id="L9191">			dblCumulativePeriodDuration += dblPeriodYearFract * (dblCouponPV + dblPeriodNotionalPV);</span>
<span class="fc" id="L9192">			dblCumulativePeriodPV += (dblCouponPV + dblPeriodNotionalPV);</span>

<span class="fc bfc" id="L9194" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L9195">		}</span>

<span class="pc bpc" id="L9197" title="1 of 2 branches missed.">		if (null != periodRef)</span>
<span class="fc" id="L9198">			aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, periodRef.endDate() -</span>
<span class="fc" id="L9199">				periodRef.startDate());</span>

<span class="fc" id="L9201">		double dblRedemptionPV = dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (iFrequency,</span>
			dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L9204">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate);</span>

<span class="fc" id="L9206">		return (dblCumulativePeriodDuration + dblPeriodYearFract * dblRedemptionPV) / (dblCumulativePeriodPV</span>
			+ dblRedemptionPV);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9217">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9227" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9228">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Macaulay Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9231">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9243">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9244">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9254">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9265" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9266">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9270">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9283">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9284">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9294">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9304" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9305">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9309">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9321">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9322">			priceFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9332">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9342" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9343">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9347">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9359">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9360">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9370">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9381" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9382">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9386">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9399">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9400">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9410">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9421" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9422">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9426">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9439">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9440">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9451">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9462" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9463">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9467">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9480">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9481">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9491">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9501" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9502">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9506">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9518">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9519">			priceFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9529">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9539" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9540">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9544">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9556">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9557">			priceFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9567">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9577" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9578">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9582">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9594">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9595">			priceFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9605">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9615" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9616">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9620">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9632">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9633">			priceFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9643">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9653" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9654">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9658">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9670">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9671">			priceFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9681">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9691" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9692">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9696">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9708">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9709">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9719">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9729" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9730">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9734">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9746" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L9747">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc bfc" id="L9749" title="All 2 branches covered.">		if (null == _floaterSetting)</span>
<span class="fc" id="L9750">			return (dblPrice - priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9751">				yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) + 0.0001)) /</span>
<span class="fc" id="L9752">					(dblPrice + accrued (valParams.valueDate(), csqc));</span>

<span class="fc" id="L9754">		return (dblPrice - priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9755">			discountMarginFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) +</span>
<span class="fc" id="L9756">				0.0001)) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9766">		return modifiedDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double modifiedDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9776">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9778" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9779">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9782">		return modifiedDurationFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9794">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9795">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9805">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9816" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9817">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9821">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9834">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9835">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9845">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9855" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9856">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Modified Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9859">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9871">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9872">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9882">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9893" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9894">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9898">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9911">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9912">			priceFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9922">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9932" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9933">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9937">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9949">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L9950">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9960">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9970" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9971">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9974">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9986">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L9987">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9997">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10007" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10008">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10011">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10023">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L10024">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10034">		return nSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10044" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10045">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10048">		return nSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10060">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L10061">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10072">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10083" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10084">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc N Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10087">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10100">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L10101">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10111">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10121" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10122">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10125">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10137">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L10138">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10148">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10158" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10159">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10162">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10174">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L10175">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10185">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10195" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10196">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10199">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10211">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L10212">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10222">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10232" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10233">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10236">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10248">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L10249">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10259">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10269" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10270">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10273">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10285">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L10286">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10296">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10306" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10307">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10310">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10322">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10323">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10333">		return nSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double nSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10343">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10345" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10346">			throw new java.lang.Exception</span>
				(&quot;BondComponent::nSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L10349">		return nSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10361">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L10362">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10372">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10382" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10383">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10386">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10398" title="All 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L10399">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="nc" id="L10401">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L10403" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L10404">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="nc" id="L10406">		return dblYield - dcFunding.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10416">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10426" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10427">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10430">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10442">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L10443">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10453">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10463" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10464">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10467">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10479">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L10480">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10490">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10500" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10501">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10504">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10516">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10527">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10537" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10538">			throw new java.lang.Exception (&quot;BondComponent::oasFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10541">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10553">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L10554">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10564">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10574" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10575">			throw new java.lang.Exception (&quot;BondComponent::oasFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10578">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10590">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L10591">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10601">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10611" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10612">			throw new java.lang.Exception (&quot;BondComponent::oasFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10615">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10627">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L10628">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10638">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10648" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10649">			throw new java.lang.Exception (&quot;BondComponent::oasFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10652">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10664">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L10665">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10675">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10685" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10686">			throw new java.lang.Exception (&quot;BondComponent::oasFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10689">		return oasFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10701">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L10702">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10712">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10722" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10723">			throw new java.lang.Exception (&quot;BondComponent::oasFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10726">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10738">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L10739">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10749">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10759" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10760">			throw new java.lang.Exception (&quot;BondComponent::oasFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10763">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10775">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L10776">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10786">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10796" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10797">			throw new java.lang.Exception (&quot;BondComponent::oasFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10800">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10812">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L10813">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10823">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10833" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10834">			throw new java.lang.Exception (&quot;BondComponent::oasFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10837">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10849">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10850">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10860">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10870" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10871">			throw new java.lang.Exception (&quot;BondComponent::oasFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10874">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10886">		return new BondCalibrator (this, false).calibrateOASFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10897">		return oasFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double oasFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10907">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10909" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10910">			throw new java.lang.Exception</span>
				(&quot;BondComponent::oasFromPriceToOptimalExercise - cant calc Work-out&quot;);

<span class="nc" id="L10913">		return oasFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10925">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L10926">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10936">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10946" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10947">			throw new java.lang.Exception (&quot;BondComponent::oasFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10950">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10962">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L10963">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10973">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10983" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10984">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10987">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10999">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11000">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11010">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11020" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11021">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11024">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11036">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11037">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11047">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11057" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11058">			throw new java.lang.Exception (&quot;BondComponent::oasFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11061">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11073">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L11074">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11084">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11094" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11095">			throw new java.lang.Exception (&quot;BondComponent::pecsFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11098">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11110">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L11111">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11121">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11131" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11132">			throw new java.lang.Exception (&quot;BondComponent::pecsFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11135">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11147">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L11148">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11158">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11168" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11169">			throw new java.lang.Exception (&quot;BondComponent::pecsFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11172">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11184">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L11185">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11195">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11205" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11206">			throw new java.lang.Exception (&quot;BondComponent::pecsFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11209">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11221">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L11222">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11232">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11242" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11243">			throw new java.lang.Exception (&quot;BondComponent::pecsFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11246">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11258">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L11259">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11269">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11279" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11280">			throw new java.lang.Exception (&quot;BondComponent::pecsFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11283">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11295">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L11296">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11306">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11316" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11317">			throw new java.lang.Exception (&quot;BondComponent::pecsFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11320">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11332">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L11333">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11343">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11353" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11354">			throw new java.lang.Exception (&quot;BondComponent::pecsFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11357">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11369">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L11370">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11380">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11390" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11391">			throw new java.lang.Exception (&quot;BondComponent::pecsFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11394">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11406">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L11407">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11417">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11427" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11428">			throw new java.lang.Exception (&quot;BondComponent::pecsFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11431">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11443">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, true);
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11454">		return pecsFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double pecsFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11464">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L11466" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L11467">			throw new java.lang.Exception</span>
				(&quot;BondComponent::pecsFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L11470">		return pecsFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11482">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L11483">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11493">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11503" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11504">			throw new java.lang.Exception (&quot;BondComponent::pecsFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11507">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11519">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L11520">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11530">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11540" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11541">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11544">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11556">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11557">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11567">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11577" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11578">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11581">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11593">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11594">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11604">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11614" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11615">			throw new java.lang.Exception (&quot;BondComponent::pecsFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11618">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11630" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="nc bnc" id="L11631" title="All 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblASW))</span>
<span class="nc" id="L11632">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11634">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L11636" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L11637">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11639">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L11641" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L11642">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11644">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="nc bnc" id="L11647" title="All 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; No CPCM&quot;);</span>

<span class="nc" id="L11649">		return dblWorkoutFactor - 100. * dcFunding.parSwapDV01 (iWorkoutDate) * (dblASW +</span>
<span class="nc" id="L11650">			dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) - cpcm.rate());</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11660">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11670" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11671">			throw new java.lang.Exception (&quot;BondComponent::priceFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11674">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11686">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L11687">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11697">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11707" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11708">			throw new java.lang.Exception (&quot;BondComponent::priceFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11711">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11723">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblCreditBasis,</span>
			false);
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11734">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11744" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11745">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11748">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="fc" id="L11760">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L11761">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11772">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11783" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11784">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11787">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11800">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L11801">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11811">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11821" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11822">			throw new java.lang.Exception (&quot;BondComponent::priceFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11825">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11837">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L11838">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11848">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11858" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11859">			throw new java.lang.Exception (&quot;BondComponent::priceFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11862">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11874">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L11875">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11885">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11895" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11896">			throw new java.lang.Exception (&quot;BondComponent::priceFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11899">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11911">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L11912">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11922">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11932" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11933">			throw new java.lang.Exception (&quot;BondComponent::priceFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11936">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11948">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L11949">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11959">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11969" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11970">			throw new java.lang.Exception (&quot;BondComponent::priceFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11973">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L11985">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblOAS);
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L11996">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12006" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12007">			throw new java.lang.Exception (&quot;BondComponent::priceFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12010">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12022">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblPECS, true);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12032">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12042" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12043">			throw new java.lang.Exception (&quot;BondComponent::priceFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12046">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12058">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="fc" id="L12059">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12069">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12079" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12080">			throw new java.lang.Exception (&quot;BondComponent::priceFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12083">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12095">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield, false);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12105">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12115" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12116">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc exercise px from yld for bonds w emb option&quot;);

<span class="nc" id="L12119">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12131">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L12132">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12142">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12152" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12153">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12156">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12168">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblZSpread);
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12179">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12189" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12190">			throw new java.lang.Exception (&quot;BondComponent::priceFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12193">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12205">		return tsySpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12206">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12216">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12226" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12227">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12230">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12242">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L12243">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12253">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12263" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12264">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12267">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12279">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12280">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12290">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12300" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12301">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12304">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12316">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12317">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12328">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12339" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12340">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc TSY Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12343">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12356">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L12357">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12367">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12377" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12378">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12381">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12393">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L12394">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12404">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12414" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12415">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12418">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12430">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L12431">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12441">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12451" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12452">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12455">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12467">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L12468">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12478">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12488" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12489">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12492">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12504">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12505">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12515">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12525" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12526">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12529">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12541">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L12542">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12552">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12562" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12563">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12566">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12578">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L12579">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12589">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12599" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12600">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12603">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12615">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L12616">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12626">		return tsySpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double tsySpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L12636">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L12638" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L12639">			throw new java.lang.Exception</span>
				(&quot;BondComponent::tsySpreadFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L12642">		return tsySpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12654">		return dblYield - treasuryBenchmarkYield (valParams, csqc, iWorkoutDate);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L12664">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12674" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12675">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12678">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12690">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12691">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12701">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12711" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12712">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12715">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12727">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L12728">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12738">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12748" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12749">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12752">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12764">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12765">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12775">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12785" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12786">			throw new java.lang.Exception (&quot;BondComponent::yieldFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12789">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12801" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblBondBasis))</span>
<span class="nc" id="L12802">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasis =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L12804">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L12805">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblBondBasis;</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L12815">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12825" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12826">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12829">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12841">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L12842">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12852">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12862" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12863">			throw new java.lang.Exception (&quot;BondComponent::yieldFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12866">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12878" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L12879" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblDiscountMargin))</span>
<span class="nc" id="L12880">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12882">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L12884" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L12885">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12887">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L12889">		int iFreq = freq();</span>

<span class="fc" id="L12891">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L12893" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L12894">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L12896" title="4 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblDiscountMargin + dcFunding.libor
<span class="pc" id="L12898">				(iValueDate, ((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblDiscountMargin + indexRate</span>
<span class="fc" id="L12899">					(iValueDate, csqc, (org.drip.analytics.cashflow.CompositeFloatingPeriod) currentPeriod</span>
<span class="fc" id="L12900">						(iValueDate));</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12910">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12921">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12934">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L12935">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblESpread));
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12946">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12956" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12957">			throw new java.lang.Exception (&quot;BondComponent::yieldFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12960">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12972" title="All 6 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblGSpread) || valParams.valueDate() &gt;= iWorkoutDate</span>
			|| null == csqc)
<span class="nc" id="L12974">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L12976">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L12978" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L12980">		return gc.yield (iWorkoutDate) + dblGSpread;</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12990">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13000" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13001">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13004">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13016" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13017" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblISpread))</span>
<span class="nc" id="L13018">			throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13020">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13021">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13023" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13025">		return dc.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblISpread;</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13035">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13045">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13057" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13058" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblJSpread))</span>
<span class="nc" id="L13059">			throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13061">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13063" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13065">		return dblJSpread + gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13076">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13086">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13098" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13099" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblNSpread))</span>
<span class="nc" id="L13100">			throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13102">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13103">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13105" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13107">		return dc.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblNSpread;</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13117">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13127">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13139">		return yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13150">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13160" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13161">			throw new java.lang.Exception (&quot;BondComponent::yieldFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13164">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13176">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L13177">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13187">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13197" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13198">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13201">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13213">		return new BondCalibrator (this, false).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13224">		return yieldFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13234">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13236" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13237">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13240">		return wi.yield();</span>
	}

	@Override public double yieldFromPriceTC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13252">		return new BondCalibrator (this, true).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13265" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblTSYSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13267">			throw new java.lang.Exception (&quot;BondComponent::calcYieldFromTSYSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13269">		return treasuryBenchmarkYield (valParams, csqc, iWorkoutDate) + dblTSYSpread;</span>
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13279">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13289" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13290">			throw new java.lang.Exception (&quot;BondComponent::yieldFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13293">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13305" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYieldSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13307">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13309">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L13310">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblYieldSpread;</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L13320">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13330" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13331">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13334">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13346">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L13347">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblZSpread));
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13358">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13368" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13369">			throw new java.lang.Exception (&quot;BondComponent::yieldFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13372">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13384">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13385">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13395">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13405" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13406">			throw new java.lang.Exception (&quot;BondComponent::yield01FromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13409">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13421">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L13422">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13432">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13442" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13443">			throw new java.lang.Exception (&quot;BondComponent::yield01FromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13446">		return yield01FromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13458">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L13459">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13469">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13479" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13480">			throw new java.lang.Exception (&quot;BondComponent::yield01FromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13483">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13495">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13496">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13507">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13518" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13519">			throw new java.lang.Exception (&quot;BondComponent::yield01FromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Yield01 from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13522">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13535">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L13536">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13546">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13556" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13557">			throw new java.lang.Exception (&quot;BondComponent::yield01FromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13560">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13572">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L13573">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13583">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13593" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13594">			throw new java.lang.Exception (&quot;BondComponent::yield01FromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13597">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13609">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L13610">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13620">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13630" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13631">			throw new java.lang.Exception (&quot;BondComponent::yield01FromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13634">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13646">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L13647">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13657">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13667" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13668">			throw new java.lang.Exception (&quot;BondComponent::yield01FromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13671">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13683">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L13684">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13694">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13705">			throw new java.lang.Exception (&quot;BondComponent::yield01FromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13708">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13720">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L13721">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13731">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13741" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13742">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13745">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13757">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L13758">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13768">		return yield01FromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13778">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13780" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13781">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13784">		return yield01FromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13796">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L13797">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13807">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13817" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13818">			throw new java.lang.Exception (&quot;BondComponent::yield01FromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13821">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13833" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L13834">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13836">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield) -</span>
<span class="fc" id="L13837">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L13847">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13857" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13858">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13861">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13873">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L13874">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13884">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13894" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13895">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13898">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13910">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L13911">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13921">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13931" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13932">			throw new java.lang.Exception (&quot;BondComponent::yield01FromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13935">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13947">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13948">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13958">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13968" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13969">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13972">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13984">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13985">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13995">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14005" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14006">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromBondBasisToOptimalExercise =&gt; &quot;</span>
				+ &quot;Cant calc Yield Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14009">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14021">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14022">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14032">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14043" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14044">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromCreditBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Yield Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14047">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14060">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14061">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14072">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14083" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14084">			throw new java.lang.Exception</span>
				(&quot;BondComponent::yieldSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Yield Spread from Disc Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14088">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14101">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L14102">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14112">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14122" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14123">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14126">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14138">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L14139">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14149">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14159" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14160">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14163">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14175">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L14176">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14186">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14196" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14197">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14200">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14212">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L14213">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14223">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14233" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14234">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14237">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14249">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L14250">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14260">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14270" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14271">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14274">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14286">		return yieldSpreadFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L14287">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14297">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14307" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14308">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14311">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14323">		return yieldSpreadFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L14324">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14334">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14344" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14345">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14348">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14360">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L14361">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14371">		return yieldSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14381">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14383" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14384">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14387">		return yieldSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14399">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14400">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14410">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14420" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14421">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14424">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14436" title="All 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L14437">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L14439">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14440">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14450">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14460" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14461">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14464">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14476">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L14477">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14487">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14497" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14498">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14501">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14513">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L14514">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14524">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14534" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14535">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14538">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14550">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L14551">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14561">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14571" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14572">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14575">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14587">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L14588">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14598">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14608" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14609">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14612">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14624">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14625">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14636">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14647" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14648">			throw new java.lang.Exception</span>
				(&quot;BondComponent::zSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Z Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14652">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14665">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L14666">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14676">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14686" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14687">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14690">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14702">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L14703">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14713">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14723" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14724">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14727">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14739">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L14740">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14750">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14760" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14761">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14764">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14776">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L14777">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14787">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14797" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14798">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14801">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14813">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L14814">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14824">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14834" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14835">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14838">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14850">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L14851">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14861">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14871" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14872">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14875">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14887">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14898">		return zSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double zSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14908">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14910" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14911">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14914">		return zSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14926">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L14927">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14937">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14947" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14948">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14951">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14963">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L14964">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14974">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14984" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14985">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14988">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15000">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L15001">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15011">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double zSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15021" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15022">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15025">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public org.drip.analytics.output.BondRVMeasures standardMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice)
	{
<span class="pc bpc" id="L15036" title="3 of 6 branches missed.">		if (null == valParams || null == csqs || null == wi || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L15037" title="1 of 2 branches missed.">			(dblPrice))</span>
<span class="nc" id="L15038">			return null;</span>

<span class="fc" id="L15040">		int iWorkoutDate = wi.date();</span>

<span class="fc" id="L15042">		double dblWorkoutYield = wi.yield();</span>

<span class="fc" id="L15044">		double dblWorkoutFactor = wi.factor();</span>

<span class="pc bpc" id="L15046" title="1 of 2 branches missed.">		if (valParams.valueDate() &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L15048">		double dblASW = java.lang.Double.NaN;</span>
<span class="fc" id="L15049">		double dblPECS = java.lang.Double.NaN;</span>
<span class="fc" id="L15050">		double dblGSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15051">		double dblISpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15052">		double dblYield01 = java.lang.Double.NaN;</span>
<span class="fc" id="L15053">		double dblZSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15054">		double dblOASpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15055">		double dblBondBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15056">		double dblConvexity = java.lang.Double.NaN;</span>
<span class="fc" id="L15057">		double dblTSYSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15058">		double dblCreditBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15059">		double dblDiscountMargin = java.lang.Double.NaN;</span>
<span class="fc" id="L15060">		double dblMacaulayDuration = java.lang.Double.NaN;</span>
<span class="fc" id="L15061">		double dblModifiedDuration = java.lang.Double.NaN;</span>

		try {
<span class="fc" id="L15064">			dblDiscountMargin = discountMarginFromYield (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblWorkoutYield);
<span class="nc" id="L15066">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15068">		}</span>

<span class="fc bfc" id="L15070" title="All 2 branches covered.">		if (null == _floaterSetting) {</span>
			try {
<span class="fc" id="L15072">				dblZSpread = zSpreadFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
					dblPrice);
<span class="nc" id="L15074">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15076">			}</span>
		}

		try {
<span class="fc" id="L15080">			dblOASpread = oasFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15081">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15083">		}</span>

		try {
<span class="fc" id="L15086">			dblISpread = iSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15088">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15090">		}</span>

		try {
<span class="fc" id="L15093">			dblGSpread = gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15095">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15097">		}</span>

		try {
<span class="fc" id="L15100">			dblTSYSpread = tsySpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15102">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15104">		}</span>

		try {
<span class="fc" id="L15107">			dblMacaulayDuration = macaulayDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15109">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15111">		}</span>

		try {
<span class="fc" id="L15114">			dblModifiedDuration = modifiedDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15116">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15118">		}</span>

		try {
<span class="fc" id="L15121">			dblASW = aswFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15122">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15124">		}</span>

		try {
<span class="fc" id="L15127">			dblConvexity = convexityFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="nc" id="L15129">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15131">		}</span>

		try {
<span class="nc" id="L15134">			dblCreditBasis = creditBasisFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="fc" id="L15136">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15138">		}</span>

		try {
			// dblPECS = pecsFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);
		} catch (java.lang.Exception e) {
			if (!s_bSuppressErrors) e.printStackTrace();
		}

		try {
<span class="fc" id="L15147">			dblBondBasis = bondBasisFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15149">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15151">		}</span>

		try {
<span class="fc" id="L15154">			dblYield01 = yield01FromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15156">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15158">		}</span>

		try {
<span class="fc" id="L15161">			return new org.drip.analytics.output.BondRVMeasures (dblPrice, dblBondBasis, dblZSpread,</span>
				dblGSpread, dblISpread, dblOASpread, dblTSYSpread, dblDiscountMargin, dblASW, dblCreditBasis,
					dblPECS, dblYield01, dblModifiedDuration, dblMacaulayDuration, dblConvexity, wi);
<span class="nc" id="L15164">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L15168">		return null;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; value (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="pc bpc" id="L15177" title="2 of 4 branches missed.">		if (null == valParams || null == csqs) return null;</span>

<span class="fc bfc" id="L15179" title="All 2 branches covered.">		if (null != pricerParams) {</span>
<span class="fc" id="L15180">			org.drip.param.definition.CalibrationParams calibParams = pricerParams.calibParams();</span>

<span class="fc bfc" id="L15182" title="All 2 branches covered.">			if (null != calibParams) {</span>
<span class="fc" id="L15183">				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures =</span>
<span class="fc" id="L15184">					calibMeasures (valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15186" title="2 of 4 branches missed.">				if (null != mapCalibMeasures &amp;&amp; mapCalibMeasures.containsKey (calibParams.measure()))</span>
<span class="fc" id="L15187">					return mapCalibMeasures;</span>
			}
		}

<span class="fc" id="L15191">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = fairMeasures</span>
<span class="fc" id="L15192">			(valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15194" title="1 of 2 branches missed.">		if (null == mapMeasures) return null;</span>

<span class="fc" id="L15196">		java.lang.String strName = name();</span>

<span class="fc" id="L15198">		org.drip.param.definition.ProductQuote pq = csqs.productQuote (strName);</span>

<span class="fc bfc" id="L15200" title="All 2 branches covered.">		if (null == pq) return mapMeasures;</span>

<span class="fc" id="L15202">		int iMaturityDate = maturityDate().julian();</span>

<span class="pc bpc" id="L15204" title="1 of 2 branches missed.">		if (null == _floaterSetting) {</span>
<span class="fc" id="L15205">			double dblParSpread = (mapMeasures.get (&quot;FairDirtyPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15206">				mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairDirtyDV01&quot;);</span>

<span class="fc" id="L15208">			mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15210">			mapMeasures.put (&quot;FairParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15211">		} else {</span>
<span class="nc bnc" id="L15212" title="All 2 branches missed.">			double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15213">				mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15214">					(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15216">			double dblZeroDiscountMargin = (mapMeasures.get (&quot;FairCleanPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15217">				dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15218">					(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15220">			mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15222">			mapMeasures.put (&quot;FairZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
		}

<span class="fc" id="L15225">		org.drip.param.valuation.WorkoutInfo wiMarket = null;</span>

<span class="pc bpc" id="L15227" title="1 of 2 branches missed.">		if (pq.containsQuote (&quot;Price&quot;)) {</span>
<span class="fc" id="L15228">			double dblMarketPrice = pq.quote (&quot;Price&quot;).value (&quot;mid&quot;);</span>

<span class="fc" id="L15230">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblMarketPrice);</span>

<span class="fc" id="L15232">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblMarketPrice);</span>
<span class="pc bnc" id="L15233" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CleanPrice&quot;)) {</span>
<span class="nc" id="L15234">			double dblCleanMarketPrice = pq.quote (&quot;CleanPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15236">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblCleanMarketPrice);</span>

<span class="nc" id="L15238">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblCleanMarketPrice);</span>
<span class="nc bnc" id="L15239" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;QuotedMargin&quot;)) {</span>
<span class="nc" id="L15240">			double dblQuotedMargin = pq.quote (&quot;QuotedMargin&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15242">			mapMeasures.put (&quot;MarketInputType=QuotedMargin&quot;, dblQuotedMargin);</span>

			try {
<span class="nc" id="L15245">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, priceFromDiscountMargin (valParams,</span>
					csqs, vcp, dblQuotedMargin));
<span class="nc" id="L15247">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15249">			}</span>
<span class="nc bnc" id="L15250" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;DirtyPrice&quot;)) {</span>
			try {
<span class="nc" id="L15252">				double dblDirtyMarketPrice = pq.quote (&quot;DirtyPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15254">				mapMeasures.put (&quot;MarketInputType=DirtyPrice&quot;, dblDirtyMarketPrice);</span>

<span class="nc" id="L15256">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblDirtyMarketPrice - accrued</span>
<span class="nc" id="L15257">					(valParams.valueDate(), csqs));</span>
<span class="nc" id="L15258">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15261">				wiMarket = null;</span>
<span class="nc" id="L15262">			}</span>
<span class="nc bnc" id="L15263" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;TSYSpread&quot;)) {</span>
			try {
<span class="nc" id="L15265">				double dblTSYSpread = pq.quote (&quot;TSYSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15267">				mapMeasures.put (&quot;MarketInputType=TSYSpread&quot;, dblTSYSpread);</span>

<span class="nc" id="L15269">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, treasuryBenchmarkYield</span>
<span class="nc" id="L15270">					(valParams, csqs, iMaturityDate) + dblTSYSpread, 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15272">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15275">				wiMarket = null;</span>
<span class="nc" id="L15276">			}</span>
<span class="nc bnc" id="L15277" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;Yield&quot;)) {</span>
			try {
<span class="nc" id="L15279">				double dblYield = pq.quote (&quot;Yield&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15281">				mapMeasures.put (&quot;MarketInputType=Yield&quot;, dblYield);</span>

<span class="nc" id="L15283">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, dblYield, 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15285">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15288">				wiMarket = null;</span>
<span class="nc" id="L15289">			}</span>
<span class="nc bnc" id="L15290" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ZSpread&quot;)) {</span>
			try {
<span class="nc" id="L15292">				double dblZSpread = pq.quote (&quot;ZSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15294">				mapMeasures.put (&quot;MarketInputType=ZSpread&quot;, dblZSpread);</span>

<span class="nc" id="L15296">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromZSpread</span>
<span class="nc" id="L15297">					(valParams, csqs, vcp, dblZSpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15299">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15302">				wiMarket = null;</span>
<span class="nc" id="L15303">			}</span>
<span class="nc bnc" id="L15304" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ISpread&quot;)) {</span>
			try {
<span class="nc" id="L15306">				double dblISpread = pq.quote (&quot;ISpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15308">				mapMeasures.put (&quot;MarketInputType=ISpread&quot;, dblISpread);</span>

<span class="nc" id="L15310">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromISpread</span>
<span class="nc" id="L15311">					(valParams, csqs, vcp, dblISpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15313">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15316">				wiMarket = null;</span>
<span class="nc" id="L15317">			}</span>
<span class="nc bnc" id="L15318" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CreditBasis&quot;)) {</span>
			try {
<span class="nc" id="L15320">				double dblCreditBasis = pq.quote (&quot;CreditBasis&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15322">				mapMeasures.put (&quot;MarketInputType=CreditBasis&quot;, dblCreditBasis);</span>

<span class="nc" id="L15324">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromCreditBasis</span>
<span class="nc" id="L15325">					(valParams, csqs, vcp, dblCreditBasis), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15327">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15330">				wiMarket = null;</span>
<span class="nc" id="L15331">			}</span>
<span class="nc bnc" id="L15332" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;PECS&quot;)) {</span>
			try {
<span class="nc" id="L15334">				double dblCreditBasis = pq.quote (&quot;PECS&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15336">				mapMeasures.put (&quot;MarketInputType=PECS&quot;, dblCreditBasis);</span>

<span class="nc" id="L15338">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPECS (valParams,</span>
					csqs, vcp, dblCreditBasis), 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15340">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15343">				wiMarket = null;</span>
<span class="nc" id="L15344">			}</span>
		}

<span class="pc bpc" id="L15347" title="1 of 2 branches missed.">		if (null != wiMarket) {</span>
<span class="fc" id="L15348">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapWorkoutMeasures =</span>
<span class="fc" id="L15349">				marketMeasures (valParams, pricerParams, csqs, vcp, wiMarket);</span>

<span class="pc bpc" id="L15351" title="1 of 2 branches missed.">			if (null == _floaterSetting) {</span>
<span class="fc" id="L15352">				double dblParSpread = (mapWorkoutMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15353">					mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairCleanDV01&quot;);</span>

<span class="fc" id="L15355">				mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15357">				mapMeasures.put (&quot;MarketParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15358">			} else {</span>
<span class="nc bnc" id="L15359" title="All 2 branches missed.">				double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15360">					mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15361">						(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15363">				double dblZeroDiscountMargin = (mapMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15364">					dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15365">						(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15367">				mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15369">				mapMeasures.put (&quot;MarketZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
			}

<span class="fc" id="L15372">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapWorkoutMeasures);</span>

<span class="fc" id="L15374">			org.drip.state.credit.CreditCurve cc = csqs.creditState (creditLabel());</span>

<span class="pc bpc" id="L15376" title="1 of 2 branches missed.">			if (null != mapMeasures.get (&quot;FairYield&quot;)) {</span>
<span class="fc" id="L15377">				org.drip.param.market.CurveSurfaceQuoteContainer csqsMarket =</span>
					org.drip.param.creator.MarketParamsBuilder.Create
<span class="fc" id="L15379">						((org.drip.state.discount.MergedDiscountForwardCurve) csqs.fundingState</span>
<span class="fc" id="L15380">							(fundingLabel()).parallelShiftQuantificationMetric (wiMarket.yield() -</span>
<span class="fc" id="L15381">								mapMeasures.get (&quot;FairYield&quot;)), csqs.govvieState (govvieLabel()), cc,</span>
<span class="fc" id="L15382">									strName, csqs.productQuote (strName), csqs.quoteMap(), csqs.fixings());</span>

<span class="pc bpc" id="L15384" title="1 of 2 branches missed.">				if (null != csqsMarket) {</span>
<span class="fc" id="L15385">					org.drip.analytics.output.BondWorkoutMeasures bwmMarket = workoutMeasures (valParams,</span>
<span class="fc" id="L15386">						pricerParams, csqsMarket, wiMarket.date(), wiMarket.factor());</span>

<span class="pc bpc" id="L15388" title="1 of 2 branches missed.">					if (null != bwmMarket) {</span>
<span class="nc" id="L15389">						org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMarketMeasures</span>
<span class="nc" id="L15390">							= bwmMarket.toMap (&quot;&quot;);</span>

<span class="nc" id="L15392">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMarketMeasures,</span>
<span class="nc" id="L15393">							org.drip.quant.common.CollectionUtil.PrefixKeys (mapMarketMeasures, &quot;Market&quot;));</span>

<span class="nc" id="L15395">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapMarketMeasures);</span>
					}
				}
			}
		}

<span class="fc" id="L15401">		return mapMeasures;</span>
	}

	@Override public java.util.Set&lt;java.lang.String&gt; measureNames()
	{
<span class="nc" id="L15406">		java.util.Set&lt;java.lang.String&gt; setstrMeasureNames = new java.util.TreeSet&lt;java.lang.String&gt;();</span>

<span class="nc" id="L15408">		setstrMeasureNames.add (&quot;Accrued&quot;);</span>

<span class="nc" id="L15410">		setstrMeasureNames.add (&quot;Accrued01&quot;);</span>

<span class="nc" id="L15412">		setstrMeasureNames.add (&quot;AssetSwapSpread&quot;);</span>

<span class="nc" id="L15414">		setstrMeasureNames.add (&quot;ASW&quot;);</span>

<span class="nc" id="L15416">		setstrMeasureNames.add (&quot;BondBasis&quot;);</span>

<span class="nc" id="L15418">		setstrMeasureNames.add (&quot;CleanCouponPV&quot;);</span>

<span class="nc" id="L15420">		setstrMeasureNames.add (&quot;CleanDV01&quot;);</span>

<span class="nc" id="L15422">		setstrMeasureNames.add (&quot;CleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15424">		setstrMeasureNames.add (&quot;CleanPrice&quot;);</span>

<span class="nc" id="L15426">		setstrMeasureNames.add (&quot;CleanPV&quot;);</span>

<span class="nc" id="L15428">		setstrMeasureNames.add (&quot;Convexity&quot;);</span>

<span class="nc" id="L15430">		setstrMeasureNames.add (&quot;CreditRisklessParPV&quot;);</span>

<span class="nc" id="L15432">		setstrMeasureNames.add (&quot;CreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15434">		setstrMeasureNames.add (&quot;CreditRiskyParPV&quot;);</span>

<span class="nc" id="L15436">		setstrMeasureNames.add (&quot;CreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15438">		setstrMeasureNames.add (&quot;CreditBasis&quot;);</span>

<span class="nc" id="L15440">		setstrMeasureNames.add (&quot;DiscountMargin&quot;);</span>

<span class="nc" id="L15442">		setstrMeasureNames.add (&quot;DefaultExposure&quot;);</span>

<span class="nc" id="L15444">		setstrMeasureNames.add (&quot;DefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15446">		setstrMeasureNames.add (&quot;DirtyCouponPV&quot;);</span>

<span class="nc" id="L15448">		setstrMeasureNames.add (&quot;DirtyDV01&quot;);</span>

<span class="nc" id="L15450">		setstrMeasureNames.add (&quot;DirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15452">		setstrMeasureNames.add (&quot;DirtyPrice&quot;);</span>

<span class="nc" id="L15454">		setstrMeasureNames.add (&quot;DirtyPV&quot;);</span>

<span class="nc" id="L15456">		setstrMeasureNames.add (&quot;Duration&quot;);</span>

<span class="nc" id="L15458">		setstrMeasureNames.add (&quot;DV01&quot;);</span>

<span class="nc" id="L15460">		setstrMeasureNames.add (&quot;ExpectedRecovery&quot;);</span>

<span class="nc" id="L15462">		setstrMeasureNames.add (&quot;FairAccrued&quot;);</span>

<span class="nc" id="L15464">		setstrMeasureNames.add (&quot;FairAccrued01&quot;);</span>

<span class="nc" id="L15466">		setstrMeasureNames.add (&quot;FairAssetSwapSpread&quot;);</span>

<span class="nc" id="L15468">		setstrMeasureNames.add (&quot;FairASW&quot;);</span>

<span class="nc" id="L15470">		setstrMeasureNames.add (&quot;FairBondBasis&quot;);</span>

<span class="nc" id="L15472">		setstrMeasureNames.add (&quot;FairCleanCouponPV&quot;);</span>

<span class="nc" id="L15474">		setstrMeasureNames.add (&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15476">		setstrMeasureNames.add (&quot;FairCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15478">		setstrMeasureNames.add (&quot;FairCleanPrice&quot;);</span>

<span class="nc" id="L15480">		setstrMeasureNames.add (&quot;FairCleanPV&quot;);</span>

<span class="nc" id="L15482">		setstrMeasureNames.add (&quot;FairConvexity&quot;);</span>

<span class="nc" id="L15484">		setstrMeasureNames.add (&quot;FairCreditBasis&quot;);</span>

<span class="nc" id="L15486">		setstrMeasureNames.add (&quot;FairCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15488">		setstrMeasureNames.add (&quot;FairCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15490">		setstrMeasureNames.add (&quot;FairCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15492">		setstrMeasureNames.add (&quot;FairCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15494">		setstrMeasureNames.add (&quot;FairDefaultExposure&quot;);</span>

<span class="nc" id="L15496">		setstrMeasureNames.add (&quot;FairDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15498">		setstrMeasureNames.add (&quot;FairDirtyCouponPV&quot;);</span>

<span class="nc" id="L15500">		setstrMeasureNames.add (&quot;FairDirtyDV01&quot;);</span>

<span class="nc" id="L15502">		setstrMeasureNames.add (&quot;FairDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15504">		setstrMeasureNames.add (&quot;FairDirtyPrice&quot;);</span>

<span class="nc" id="L15506">		setstrMeasureNames.add (&quot;FairDirtyPV&quot;);</span>

<span class="nc" id="L15508">		setstrMeasureNames.add (&quot;FairDiscountMargin&quot;);</span>

<span class="nc" id="L15510">		setstrMeasureNames.add (&quot;FairDuration&quot;);</span>

<span class="nc" id="L15512">		setstrMeasureNames.add (&quot;FairDV01&quot;);</span>

<span class="nc" id="L15514">		setstrMeasureNames.add (&quot;FairExpectedRecovery&quot;);</span>

<span class="nc" id="L15516">		setstrMeasureNames.add (&quot;FairFirstIndexRate&quot;);</span>

<span class="nc" id="L15518">		setstrMeasureNames.add (&quot;FairGSpread&quot;);</span>

<span class="nc" id="L15520">		setstrMeasureNames.add (&quot;FairISpread&quot;);</span>

<span class="nc" id="L15522">		setstrMeasureNames.add (&quot;FairLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15524">		setstrMeasureNames.add (&quot;FairMacaulayDuration&quot;);</span>

<span class="nc" id="L15526">		setstrMeasureNames.add (&quot;FairModifiedDuration&quot;);</span>

<span class="nc" id="L15528">		setstrMeasureNames.add (&quot;FairOAS&quot;);</span>

<span class="nc" id="L15530">		setstrMeasureNames.add (&quot;FairOASpread&quot;);</span>

<span class="nc" id="L15532">		setstrMeasureNames.add (&quot;FairOptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15534">		setstrMeasureNames.add (&quot;FairParPV&quot;);</span>

<span class="nc" id="L15536">		setstrMeasureNames.add (&quot;FairParSpread&quot;);</span>

<span class="nc" id="L15538">		setstrMeasureNames.add (&quot;FairPECS&quot;);</span>

<span class="nc" id="L15540">		setstrMeasureNames.add (&quot;FairPrice&quot;);</span>

<span class="nc" id="L15542">		setstrMeasureNames.add (&quot;FairPrincipalPV&quot;);</span>

<span class="nc" id="L15544">		setstrMeasureNames.add (&quot;FairPV&quot;);</span>

<span class="nc" id="L15546">		setstrMeasureNames.add (&quot;FairRecoveryPV&quot;);</span>

<span class="nc" id="L15548">		setstrMeasureNames.add (&quot;FairRisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15550">		setstrMeasureNames.add (&quot;FairRisklessCleanDV01&quot;);</span>

<span class="nc" id="L15552">		setstrMeasureNames.add (&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15554">		setstrMeasureNames.add (&quot;FairRisklessCleanPV&quot;);</span>

<span class="nc" id="L15556">		setstrMeasureNames.add (&quot;FairRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15558">		setstrMeasureNames.add (&quot;FairRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15560">		setstrMeasureNames.add (&quot;FairRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15562">		setstrMeasureNames.add (&quot;FairRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15564">		setstrMeasureNames.add (&quot;FairRiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15566">		setstrMeasureNames.add (&quot;FairRiskyCleanDV01&quot;);</span>

<span class="nc" id="L15568">		setstrMeasureNames.add (&quot;FairRiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15570">		setstrMeasureNames.add (&quot;FairRiskyCleanPV&quot;);</span>

<span class="nc" id="L15572">		setstrMeasureNames.add (&quot;FairRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15574">		setstrMeasureNames.add (&quot;FairRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15576">		setstrMeasureNames.add (&quot;FairRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15578">		setstrMeasureNames.add (&quot;FairRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15580">		setstrMeasureNames.add (&quot;FairTSYSpread&quot;);</span>

<span class="nc" id="L15582">		setstrMeasureNames.add (&quot;FairWorkoutDate&quot;);</span>

<span class="nc" id="L15584">		setstrMeasureNames.add (&quot;FairWorkoutFactor&quot;);</span>

<span class="nc" id="L15586">		setstrMeasureNames.add (&quot;FairWorkoutType&quot;);</span>

<span class="nc" id="L15588">		setstrMeasureNames.add (&quot;FairWorkoutYield&quot;);</span>

<span class="nc" id="L15590">		setstrMeasureNames.add (&quot;FairYield&quot;);</span>

<span class="nc" id="L15592">		setstrMeasureNames.add (&quot;FairYield01&quot;);</span>

<span class="nc" id="L15594">		setstrMeasureNames.add (&quot;FairYieldBasis&quot;);</span>

<span class="nc" id="L15596">		setstrMeasureNames.add (&quot;FairYieldSpread&quot;);</span>

<span class="nc" id="L15598">		setstrMeasureNames.add (&quot;FairZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15600">		setstrMeasureNames.add (&quot;FairZSpread&quot;);</span>

<span class="nc" id="L15602">		setstrMeasureNames.add (&quot;FirstCouponRate&quot;);</span>

<span class="nc" id="L15604">		setstrMeasureNames.add (&quot;FirstIndexRate&quot;);</span>

<span class="nc" id="L15606">		setstrMeasureNames.add (&quot;GSpread&quot;);</span>

<span class="nc" id="L15608">		setstrMeasureNames.add (&quot;ISpread&quot;);</span>

<span class="nc" id="L15610">		setstrMeasureNames.add (&quot;LossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15612">		setstrMeasureNames.add (&quot;MacaulayDuration&quot;);</span>

<span class="nc" id="L15614">		setstrMeasureNames.add (&quot;MarketAccrued&quot;);</span>

<span class="nc" id="L15616">		setstrMeasureNames.add (&quot;MarketAccrued01&quot;);</span>

<span class="nc" id="L15618">		setstrMeasureNames.add (&quot;MarketCleanCouponPV&quot;);</span>

<span class="nc" id="L15620">		setstrMeasureNames.add (&quot;MarketCleanDV01&quot;);</span>

<span class="nc" id="L15622">		setstrMeasureNames.add (&quot;MarketCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15624">		setstrMeasureNames.add (&quot;MarketCleanPrice&quot;);</span>

<span class="nc" id="L15626">		setstrMeasureNames.add (&quot;MarketCleanPV&quot;);</span>

<span class="nc" id="L15628">		setstrMeasureNames.add (&quot;MarketCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15630">		setstrMeasureNames.add (&quot;MarketCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15632">		setstrMeasureNames.add (&quot;MarketCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15634">		setstrMeasureNames.add (&quot;MarketCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15636">		setstrMeasureNames.add (&quot;MarketDefaultExposure&quot;);</span>

<span class="nc" id="L15638">		setstrMeasureNames.add (&quot;MarketDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15640">		setstrMeasureNames.add (&quot;MarketDirtyCouponPV&quot;);</span>

<span class="nc" id="L15642">		setstrMeasureNames.add (&quot;MarketDirtyDV01&quot;);</span>

<span class="nc" id="L15644">		setstrMeasureNames.add (&quot;MarketDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15646">		setstrMeasureNames.add (&quot;MarketDirtyPrice&quot;);</span>

<span class="nc" id="L15648">		setstrMeasureNames.add (&quot;MarketDirtyPV&quot;);</span>

<span class="nc" id="L15650">		setstrMeasureNames.add (&quot;MarketDV01&quot;);</span>

<span class="nc" id="L15652">		setstrMeasureNames.add (&quot;MarketExpectedRecovery&quot;);</span>

<span class="nc" id="L15654">		setstrMeasureNames.add (&quot;MarketFirstCouponRate&quot;);</span>

<span class="nc" id="L15656">		setstrMeasureNames.add (&quot;MarketFirstIndexRate&quot;);</span>

<span class="nc" id="L15658">		setstrMeasureNames.add (&quot;MarketInputType=CleanPrice&quot;);</span>

<span class="nc" id="L15660">		setstrMeasureNames.add (&quot;MarketInputType=CreditBasis&quot;);</span>

<span class="nc" id="L15662">		setstrMeasureNames.add (&quot;MarketInputType=DirtyPrice&quot;);</span>

<span class="nc" id="L15664">		setstrMeasureNames.add (&quot;MarketInputType=GSpread&quot;);</span>

<span class="nc" id="L15666">		setstrMeasureNames.add (&quot;MarketInputType=ISpread&quot;);</span>

<span class="nc" id="L15668">		setstrMeasureNames.add (&quot;MarketInputType=PECS&quot;);</span>

<span class="nc" id="L15670">		setstrMeasureNames.add (&quot;MarketInputType=QuotedMargin&quot;);</span>

<span class="nc" id="L15672">		setstrMeasureNames.add (&quot;MarketInputType=TSYSpread&quot;);</span>

<span class="nc" id="L15674">		setstrMeasureNames.add (&quot;MarketInputType=Yield&quot;);</span>

<span class="nc" id="L15676">		setstrMeasureNames.add (&quot;MarketInputType=ZSpread&quot;);</span>

<span class="nc" id="L15678">		setstrMeasureNames.add (&quot;MarketLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15680">		setstrMeasureNames.add (&quot;MarketParPV&quot;);</span>

<span class="nc" id="L15682">		setstrMeasureNames.add (&quot;MarketPrincipalPV&quot;);</span>

<span class="nc" id="L15684">		setstrMeasureNames.add (&quot;MarketPV&quot;);</span>

<span class="nc" id="L15686">		setstrMeasureNames.add (&quot;MarketRecoveryPV&quot;);</span>

<span class="nc" id="L15688">		setstrMeasureNames.add (&quot;MarketRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15690">		setstrMeasureNames.add (&quot;MarketRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15692">		setstrMeasureNames.add (&quot;MarketRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15694">		setstrMeasureNames.add (&quot;MarketRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15696">		setstrMeasureNames.add (&quot;MarketRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15698">		setstrMeasureNames.add (&quot;MarketRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15700">		setstrMeasureNames.add (&quot;MarketRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15702">		setstrMeasureNames.add (&quot;MarketRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15704">		setstrMeasureNames.add (&quot;ModifiedDuration&quot;);</span>

<span class="nc" id="L15706">		setstrMeasureNames.add (&quot;OAS&quot;);</span>

<span class="nc" id="L15708">		setstrMeasureNames.add (&quot;OASpread&quot;);</span>

<span class="nc" id="L15710">		setstrMeasureNames.add (&quot;OptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15712">		setstrMeasureNames.add (&quot;ParEquivalentCDSSpread&quot;);</span>

<span class="nc" id="L15714">		setstrMeasureNames.add (&quot;ParPV&quot;);</span>

<span class="nc" id="L15716">		setstrMeasureNames.add (&quot;ParSpread&quot;);</span>

<span class="nc" id="L15718">		setstrMeasureNames.add (&quot;PECS&quot;);</span>

<span class="nc" id="L15720">		setstrMeasureNames.add (&quot;Price&quot;);</span>

<span class="nc" id="L15722">		setstrMeasureNames.add (&quot;PrincipalPV&quot;);</span>

<span class="nc" id="L15724">		setstrMeasureNames.add (&quot;PV&quot;);</span>

<span class="nc" id="L15726">		setstrMeasureNames.add (&quot;RecoveryPV&quot;);</span>

<span class="nc" id="L15728">		setstrMeasureNames.add (&quot;RisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15730">		setstrMeasureNames.add (&quot;RisklessCleanDV01&quot;);</span>

<span class="nc" id="L15732">		setstrMeasureNames.add (&quot;RisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15734">		setstrMeasureNames.add (&quot;RisklessCleanPV&quot;);</span>

<span class="nc" id="L15736">		setstrMeasureNames.add (&quot;RisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15738">		setstrMeasureNames.add (&quot;RisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15740">		setstrMeasureNames.add (&quot;RisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15742">		setstrMeasureNames.add (&quot;RisklessDirtyPV&quot;);</span>

<span class="nc" id="L15744">		setstrMeasureNames.add (&quot;RiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15746">		setstrMeasureNames.add (&quot;RiskyCleanDV01&quot;);</span>

<span class="nc" id="L15748">		setstrMeasureNames.add (&quot;RiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15750">		setstrMeasureNames.add (&quot;RiskyCleanPV&quot;);</span>

<span class="nc" id="L15752">		setstrMeasureNames.add (&quot;RiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15754">		setstrMeasureNames.add (&quot;RiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15756">		setstrMeasureNames.add (&quot;RiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15758">		setstrMeasureNames.add (&quot;RiskyDirtyPV&quot;);</span>

<span class="nc" id="L15760">		setstrMeasureNames.add (&quot;TSYSpread&quot;);</span>

<span class="nc" id="L15762">		setstrMeasureNames.add (&quot;WorkoutDate&quot;);</span>

<span class="nc" id="L15764">		setstrMeasureNames.add (&quot;WorkoutFactor&quot;);</span>

<span class="nc" id="L15766">		setstrMeasureNames.add (&quot;WorkoutType&quot;);</span>

<span class="nc" id="L15768">		setstrMeasureNames.add (&quot;WorkoutYield&quot;);</span>

<span class="nc" id="L15770">		setstrMeasureNames.add (&quot;Yield&quot;);</span>

<span class="nc" id="L15772">		setstrMeasureNames.add (&quot;Yield01&quot;);</span>

<span class="nc" id="L15774">		setstrMeasureNames.add (&quot;YieldBasis&quot;);</span>

<span class="nc" id="L15776">		setstrMeasureNames.add (&quot;YieldSpread&quot;);</span>

<span class="nc" id="L15778">		setstrMeasureNames.add (&quot;ZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15780">		setstrMeasureNames.add (&quot;ZSpread&quot;);</span>

<span class="nc" id="L15782">		return setstrMeasureNames;</span>
	}

	@Override public double pv (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParamsIn,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15792" title="All 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L15793">			throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc" id="L15795">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L15797">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L15799" title="All 2 branches missed.">		if (null == dcFunding) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15801" title="All 2 branches missed.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="nc bnc" id="L15803" title="All 2 branches missed.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="nc" id="L15804">			_creditSetting.recovery();</span>

<span class="nc bnc" id="L15806" title="All 2 branches missed.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="nc bnc" id="L15808" title="All 2 branches missed.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="nc" id="L15810">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc" id="L15812">		double dblRecoveryPV = 0.;</span>
<span class="nc" id="L15813">		double dblPrincipalPV = 0.;</span>
<span class="nc" id="L15814">		double dblDirtyCouponPV = 0.;</span>
<span class="nc" id="L15815">		boolean bApplyFlatForwardRate = false;</span>
<span class="nc" id="L15816">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L15818" title="All 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L15819">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="nc bnc" id="L15821" title="All 2 branches missed.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="nc" id="L15822">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L15824" title="All 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="nc" id="L15827">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc bnc" id="L15829" title="All 2 branches missed.">		org.drip.param.pricer.CreditPricerParams pricerParams = null != pricerParamsIn ? pricerParamsIn : new</span>
			org.drip.param.pricer.CreditPricerParams (7, null, false,
				org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_FULL_COUPON);

<span class="nc bnc" id="L15833" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L15834">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L15836" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L15838">			int iPeriodEndDate = period.endDate();</span>

<span class="nc" id="L15840">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L15842">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L15845" title="All 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15847" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L15848">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L15850" title="All 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="nc" id="L15852">			double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="nc" id="L15854">			double dblPeriodDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) * dblPeriodAnnuity *</span>
<span class="nc" id="L15855">				notional (iPeriodStartDate);</span>

<span class="nc" id="L15857">			double dblPeriodPrincipalPV = (notional (iPeriodStartDate) - notional (iPeriodEndDate)) *</span>
				dblPeriodAnnuity;

<span class="nc bnc" id="L15860" title="All 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L15861" title="All 2 branches missed.">				double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
					iPeriodEndDate);

<span class="nc" id="L15864">				dblPeriodDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L15865">				dblPeriodPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L15867" title="All 2 branches missed.">				for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
					valParams, pricerParams, iMaturityDate, csqc)) {
<span class="nc bnc" id="L15869" title="All 2 branches missed.">					if (null == lqm) continue;</span>

<span class="nc" id="L15871">					int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L15873">					int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L15875">					double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
						iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L15878">					double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L15880">					double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L15881">						(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L15883" title="All 2 branches missed.">					if (bAccrualOnDefault)</span>
<span class="nc" id="L15884">						dblPeriodDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival *</span>
							dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L15887" title="All 2 branches missed.">					dblRecoveryPV += (bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
						iSubPeriodEndDate) : dblProductRecovery) * dblSubPeriodSurvival *
							dblSubPeriodNotional * dblSubPeriodDF;
<span class="nc" id="L15890">				}</span>
			}

<span class="nc" id="L15893">			dblPrincipalPV += dblPeriodPrincipalPV;</span>

<span class="nc" id="L15895">			dblDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblPeriodDirtyDV01;
<span class="nc" id="L15897">		}</span>

<span class="nc" id="L15899">		double dblParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate);</span>

<span class="nc bnc" id="L15901" title="All 4 branches missed.">		if (null != cc &amp;&amp; null != pricerParams) dblParPV *= cc.survival (iMaturityDate);</span>

<span class="nc bnc" id="L15903" title="All 2 branches missed.">		return (dblDirtyCouponPV + dblPrincipalPV + dblParPV + dblRecoveryPV) / dcFunding.df (null !=</span>
<span class="nc" id="L15904">			_quoteConvention ? _quoteConvention.settleDate (valParams) : valParams.cashPayDate());</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian jackDDirtyPVDManifestMeasure (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15913">		return null;</span>
	}

	@Override public org.drip.product.calib.ProductQuoteSet calibQuoteSet (
		final org.drip.state.representation.LatentStateSpecification[] aLSS)
	{
<span class="nc" id="L15919">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15929">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint forwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15939">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingForwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15949">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fxPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15959">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint govviePRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15969">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint volatilityPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15979">		return null;</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian manifestMeasureDFMicroJack (
		final java.lang.String strManifestMeasure,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15989">		return null;</span>
	}

	/**
	 * The BondCalibrator implements a calibrator that calibrates the yield, the credit basis, or the Z
	 * 		Spread for the bond given the price input. Calibration happens via either Newton-Raphson method,
	 * 		or via bracketing/root searching.
	 * 
	 * @author Lakshmi Krishnamurthy
	 *
	 */

	public class BondCalibrator {
<span class="fc" id="L16002">		private BondComponent _bond = null;</span>
<span class="fc" id="L16003">		private boolean _bApplyCouponExtension = false;</span>

		/**
		 * Constructor: Construct the calibrator from the parent bond.
		 * 
		 * @param bond Parent
		 * @param bApplyCouponExtension TRUE - Apply the Coupon Extension
		 * 
		 * @throws java.lang.Exception Thrown if the inputs are invalid
		 */

		public BondCalibrator (
			final BondComponent bond,
			final boolean bApplyCouponExtension)
			throws java.lang.Exception
<span class="fc" id="L16018">		{</span>
<span class="pc bpc" id="L16019" title="1 of 2 branches missed.">			if (null == (_bond = bond))</span>
<span class="nc" id="L16020">				throw new java.lang.Exception (&quot;BondComponent::BondCalibrator ctr =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L16022">			_bApplyCouponExtension = bApplyCouponExtension;</span>
<span class="fc" id="L16023">		}</span>

		/**
		 * Calibrate the bond yield from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Yield
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibrateYieldFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16049" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16050">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16053">			org.drip.function.definition.R1ToR1 ofYieldToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16054">				(null) {</span>
				@Override public double evaluate (
					final double dblYield)
					throws java.lang.Exception
				{
<span class="fc" id="L16059">					return _bond.priceFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L16060">						dblYield, _bApplyCouponExtension) - dblPrice;</span>
				}
			};

<span class="fc" id="L16064">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
<span class="fc" id="L16065">				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofYieldToPrice, true).findRoot();</span>

<span class="pc bpc" id="L16067" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16068">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofYieldToPrice,</span>
<span class="nc" id="L16069">					true).findRoot();</span>

<span class="pc bpc" id="L16071" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16072">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofYieldToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16074">						true).findRoot();</span>

<span class="pc bpc" id="L16076" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16077">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16080">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the Z Spread cannot be calibrated
		 */

		public double calibrateZSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16109" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16110">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="pc bpc" id="L16113" title="1 of 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16114">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="fc" id="L16117">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16118">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16123">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16128">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="fc" id="L16130">					true).findRoot();</span>

<span class="pc bpc" id="L16132" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16133">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16134">					true).findRoot();</span>

<span class="pc bpc" id="L16136" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16137">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					new org.drip.function.r1tor1solver.ExecutionControl (ofZSpreadToPrice, new
						org.drip.function.r1tor1solver.ExecutionControlParams (200, false, 1.e-02, 1.e-02,
							1.e-01, 1.e-01)),
								org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16142">									true).findRoot();</span>

<span class="pc bpc" id="L16144" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16145">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16148">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the Bond OAS from the Market Price using the Root Bracketing Technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The Calibrated OAS
		 * 
		 * @throws java.lang.Exception Thrown if the OAS cannot be calibrated
		 */

		public double calibrateOASFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16177" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16178">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16181">			org.drip.function.definition.R1ToR1 r1ToR1OASToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16182">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16187">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16192">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., r1ToR1OASToPrice,
<span class="fc" id="L16194">					true).findRoot();</span>

<span class="pc bpc" id="L16196" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16197">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., r1ToR1OASToPrice,</span>
<span class="fc" id="L16198">					true).findRoot();</span>

<span class="pc bpc" id="L16200" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16201">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., r1ToR1OASToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16203">						true).findRoot();</span>

<span class="pc bpc" id="L16205" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16206">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16209">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the discount
		 * 	curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibDiscCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16235" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16236">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateDiscCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc" id="L16239">			org.drip.function.definition.R1ToR1 ofDiscCurveSpreadToPrice = new</span>
<span class="nc" id="L16240">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16245">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16250">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofDiscCurveSpreadToPrice,
<span class="nc" id="L16252">					true).findRoot();</span>

<span class="nc bnc" id="L16254" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16255">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0.,</span>
<span class="nc" id="L16256">					ofDiscCurveSpreadToPrice, true).findRoot();</span>

<span class="nc bnc" id="L16258" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16259">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0.,</span>
					ofDiscCurveSpreadToPrice, null,
						org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16262">							true).findRoot();</span>

<span class="nc bnc" id="L16264" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16265">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibDiscCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16268">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the Zero Curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibZeroCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16293" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16294">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZeroCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc bnc" id="L16297" title="All 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16298">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibZeroCurveSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="nc" id="L16301">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="nc" id="L16302">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16307">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16312">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="nc" id="L16314">					true).findRoot();</span>

<span class="nc bnc" id="L16316" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16317">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16318">					true).findRoot();</span>

<span class="nc bnc" id="L16320" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16321">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16323">						true).findRoot();</span>

<span class="nc bnc" id="L16325" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16326">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibZeroCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16329">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Credit Basis from the market price
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * @param bFlat TRUE - Calibrate to Flat Curve
		 * 
		 * @return The calibrated Credit Basis
		 * 
		 * @throws java.lang.Exception Thrown if the Credit Basis cannot be calibrated
		 */

		public double calibrateCreditBasisFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice,
			final boolean bFlat)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16356" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16357">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateCreditBasisFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16360">			org.drip.function.definition.R1ToR1 ofCreditBasisToPrice = new</span>
<span class="fc" id="L16361">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblCreditBasis)
					throws java.lang.Exception
				{
<span class="fc" id="L16366">					return _bond.priceFromCreditCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblCreditBasis, bFlat) - dblPrice;
				}
			};

<span class="fc" id="L16371">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofCreditBasisToPrice,
<span class="fc" id="L16373">					true).findRoot();</span>

<span class="pc bpc" id="L16375" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16376">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofCreditBasisToPrice,</span>
<span class="fc" id="L16377">					true).findRoot();</span>

<span class="pc bpc" id="L16379" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16380">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofCreditBasisToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16382">						true).findRoot();</span>

<span class="pc bpc" id="L16384" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16385">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibrateCreditBasisFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16388">			return rfop.getRoot();</span>
		}
	}

	/**
	 * Generate the EOS Callable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics callMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16415" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16417">		org.drip.product.params.EmbeddedOptionSchedule eosCall = callSchedule();</span>

<span class="pc bpc" id="L16419" title="1 of 2 branches missed.">		if (null == eosCall) return null;</span>

<span class="fc" id="L16421">		int iNumDimension = gbs.dimension();</span>

<span class="fc" id="L16423">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L16425">		int[] aiExerciseDate = eosCall.exerciseDates (iValueDate);</span>

<span class="fc" id="L16427">		double[] adblExercisePrice = eosCall.exerciseFactors (iValueDate);</span>

<span class="pc bpc" id="L16429" title="2 of 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="fc" id="L16431">		double dblOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L16432">		int iNumVertex = aiExerciseDate.length;</span>
<span class="fc" id="L16433">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="fc" id="L16434">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="fc" id="L16435">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="fc" id="L16436">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="fc" id="L16437">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="fc" id="L16438">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="fc" id="L16439">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="fc" id="L16440">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="fc" id="L16441">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="fc" id="L16442">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="fc" id="L16443">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="fc" id="L16444">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="fc" id="L16446">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="fc bfc" id="L16449" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="fc bfc" id="L16450" title="All 2 branches covered.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="fc bfc" id="L16451" title="All 2 branches covered.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="pc bpc" id="L16455" title="1 of 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16459">				return null;</span>
<span class="nc" id="L16460">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16461">			e.printStackTrace();</span>

<span class="nc" id="L16463">			return null;</span>
<span class="fc" id="L16464">		}</span>

<span class="fc" id="L16466">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="pc bpc" id="L16468" title="1 of 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="fc" id="L16471">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16472">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16473">			e.printStackTrace();</span>

<span class="nc" id="L16475">			return null;</span>
<span class="fc" id="L16476">		}</span>

<span class="fc bfc" id="L16478" title="All 2 branches covered.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16479">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="pc bpc" id="L16480" title="1 of 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16481">				return null;</span>
		}

<span class="fc" id="L16484">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L16486" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc bfc" id="L16487" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="fc" id="L16489">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="fc" id="L16490">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16492">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16493">					e.printStackTrace();</span>

<span class="nc" id="L16495">					return null;</span>
<span class="fc" id="L16496">				}</span>
			}
		}

<span class="fc bfc" id="L16500" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16501">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="fc" id="L16502">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="fc" id="L16503">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="fc" id="L16505">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="fc bfc" id="L16507" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16508">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="fc" id="L16509">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="fc" id="L16512">					dblExercisePV = (aadblForwardPrice[iPath][iVertex] - adblExercisePrice[iVertex]) *</span>
<span class="fc" id="L16513">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16514">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16515">					e.printStackTrace();</span>
<span class="fc" id="L16516">				}</span>

<span class="fc bfc" id="L16518" title="All 2 branches covered.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="fc" id="L16519">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="fc" id="L16522">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="fc" id="L16523">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="fc" id="L16524">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="fc" id="L16525">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="fc bfc" id="L16530" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16531">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="fc" id="L16534">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16537">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16540">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16542">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16543">				e.printStackTrace();</span>

<span class="nc" id="L16545">				return null;</span>
<span class="fc" id="L16546">			}</span>

<span class="fc" id="L16548">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="fc" id="L16552">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16556">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16557">			e.printStackTrace();</span>
		}

<span class="nc" id="L16560">		return null;</span>
	}

	/**
	 * Generate the EOS Putable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics putMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="nc bnc" id="L16586" title="All 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="nc" id="L16588">		org.drip.product.params.EmbeddedOptionSchedule eosPut = putSchedule();</span>

<span class="nc bnc" id="L16590" title="All 2 branches missed.">		if (null == eosPut) return null;</span>

<span class="nc" id="L16592">		int iNumDimension = gbs.dimension();</span>

<span class="nc" id="L16594">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L16596">		int[] aiExerciseDate = eosPut.exerciseDates (iValueDate);</span>

<span class="nc" id="L16598">		double[] adblExercisePrice = eosPut.exerciseFactors (iValueDate);</span>

<span class="nc bnc" id="L16600" title="All 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="nc" id="L16602">		double dblOAS = java.lang.Double.NaN;</span>
<span class="nc" id="L16603">		int iNumVertex = aiExerciseDate.length;</span>
<span class="nc" id="L16604">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="nc" id="L16605">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="nc" id="L16606">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="nc" id="L16607">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="nc" id="L16608">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="nc" id="L16609">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="nc" id="L16610">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="nc" id="L16611">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="nc" id="L16612">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="nc" id="L16613">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="nc" id="L16614">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="nc" id="L16615">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="nc" id="L16617">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="nc bnc" id="L16620" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="nc bnc" id="L16621" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="nc bnc" id="L16622" title="All 2 branches missed.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="nc bnc" id="L16626" title="All 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16630">				return null;</span>
<span class="nc" id="L16631">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16632">			e.printStackTrace();</span>

<span class="nc" id="L16634">			return null;</span>
<span class="nc" id="L16635">		}</span>

<span class="nc" id="L16637">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="nc bnc" id="L16639" title="All 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="nc" id="L16642">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16643">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16644">			e.printStackTrace();</span>

<span class="nc" id="L16646">			return null;</span>
<span class="nc" id="L16647">		}</span>

<span class="nc bnc" id="L16649" title="All 2 branches missed.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16650">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="nc bnc" id="L16651" title="All 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16652">				return null;</span>
		}

<span class="nc" id="L16655">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L16657" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc bnc" id="L16658" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="nc" id="L16660">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="nc" id="L16661">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16663">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16664">					e.printStackTrace();</span>

<span class="nc" id="L16666">					return null;</span>
<span class="nc" id="L16667">				}</span>
			}
		}

<span class="nc bnc" id="L16671" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16672">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="nc" id="L16673">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="nc" id="L16674">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="nc" id="L16676">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="nc bnc" id="L16678" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16679">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="nc" id="L16680">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="nc" id="L16683">					dblExercisePV = (adblExercisePrice[iVertex] - aadblForwardPrice[iPath][iVertex]) *</span>
<span class="nc" id="L16684">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16685">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16686">					e.printStackTrace();</span>
<span class="nc" id="L16687">				}</span>

<span class="nc bnc" id="L16689" title="All 2 branches missed.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="nc" id="L16690">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="nc" id="L16693">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="nc" id="L16694">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="nc" id="L16695">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="nc" id="L16696">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="nc bnc" id="L16701" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16702">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="nc" id="L16705">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16708">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16711">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16713">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16714">				e.printStackTrace();</span>

<span class="nc" id="L16716">				return null;</span>
<span class="nc" id="L16717">			}</span>

<span class="nc" id="L16719">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="nc" id="L16723">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16727">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16728">			e.printStackTrace();</span>
		}

<span class="nc" id="L16731">		return null;</span>
	}

	@Override public void showPeriods()
		throws java.lang.Exception
	{
<span class="nc bnc" id="L16737" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods())</span>
<span class="nc" id="L16738">			System.out.println (&quot;\t&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.startDate()) +</span>
<span class="nc" id="L16739">				&quot;-&gt;&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.endDate()) + &quot;    &quot; +</span>
<span class="nc" id="L16740">					period.accrualDCF (period.endDate()));</span>
<span class="nc" id="L16741">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>