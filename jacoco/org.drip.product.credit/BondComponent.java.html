<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BondComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.product.credit</a> &gt; <span class="el_source">BondComponent.java</span></div><h1>BondComponent.java</h1><pre class="source lang-java linenums">
package org.drip.product.credit;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * Copyright (C) 2014 Lakshmi Krishnamurthy
 * Copyright (C) 2013 Lakshmi Krishnamurthy
 * Copyright (C) 2012 Lakshmi Krishnamurthy
 * Copyright (C) 2011 Lakshmi Krishnamurthy
 * 
 *  This file is part of DRIP, a free-software/open-source library for buy/side financial/trading model
 *  	libraries targeting analysts and developers
 *  	https://lakshmidrip.github.io/DRIP/
 *  
 *  DRIP is composed of four main libraries:
 *  
 *  - DRIP Fixed Income - https://lakshmidrip.github.io/DRIP-Fixed-Income/
 *  - DRIP Asset Allocation - https://lakshmidrip.github.io/DRIP-Asset-Allocation/
 *  - DRIP Numerical Optimizer - https://lakshmidrip.github.io/DRIP-Numerical-Optimizer/
 *  - DRIP Statistical Learning - https://lakshmidrip.github.io/DRIP-Statistical-Learning/
 * 
 *  - DRIP Fixed Income: Library for Instrument/Trading Conventions, Treasury Futures/Options,
 *  	Funding/Forward/Overnight Curves, Multi-Curve Construction/Valuation, Collateral Valuation and XVA
 *  	Metric Generation, Calibration and Hedge Attributions, Statistical Curve Construction, Bond RV
 *  	Metrics, Stochastic Evolution and Option Pricing, Interest Rate Dynamics and Option Pricing, LMM
 *  	Extensions/Calibrations/Greeks, Algorithmic Differentiation, and Asset Backed Models and Analytics.
 * 
 *  - DRIP Asset Allocation: Library for model libraries for MPT framework, Black Litterman Strategy
 *  	Incorporator, Holdings Constraint, and Transaction Costs.
 * 
 *  - DRIP Numerical Optimizer: Library for Numerical Optimization and Spline Functionality.
 * 
 *  - DRIP Statistical Learning: Library for Statistical Evaluation and Machine Learning.
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * BondComponent is the base class that extends CreditComponent abstract class and implements the
 * 	functionality behind bonds of all kinds. Bond static data is captured in a set of 11 container classes â€“
 *  BondTSYParams, BondCouponParams, BondNotionalParams, BondFloaterParams, BondCurrencyParams,
 *  BondIdentifierParams, CompCRValParams, BondCFTerminationEvent, BondFixedPeriodGenerationParams, and one
 *  EmbeddedOptionSchedule object instance each for the call and the put objects. Each of these parameter set
 *  can be set separately.
 *
 * @author Lakshmi Krishnamurthy
 */

public class BondComponent extends org.drip.product.definition.Bond implements
	org.drip.product.definition.BondProduct
{
	private static final boolean s_bSuppressErrors = true;
	private static final boolean s_bYieldDFOffofCouponAccrualDCF = true;

	/*
	 * Width for calculating local forward rate width
	 */

	private static final int LOCAL_FORWARD_RATE_WIDTH = 1;

	/*
	 * Recovery Period discretization Mode
	 */

	private static final int s_iDiscretizationScheme =
		org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_DAY_STEP;

	/*
	 * Discount Curve to derive the zero curve off of
	 */

	private static final int ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE = 1;
	private static final int ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE = 2;

	/*
	 * Discount Curve to derive Bumped Prices
	 */

	private static final int PRICE_OFF_OF_FUNDING_CURVE = 1;
	private static final int PRICE_OFF_OF_TREASURY_CURVE = 2;
	// private static final int PRICE_OFF_OF_OVERNIGHT_CURVE = 3;

<span class="fc" id="L101">	private org.drip.product.params.BondStream _stream = null;</span>
<span class="fc" id="L102">	private org.drip.product.params.IdentifierSet _idParams = null;</span>
<span class="fc" id="L103">	private org.drip.product.params.CouponSetting _couponSetting = null;</span>
<span class="fc" id="L104">	private org.drip.product.params.CreditSetting _creditSetting = null;</span>
<span class="fc" id="L105">	private org.drip.product.params.FloaterSetting _floaterSetting = null;</span>
<span class="fc" id="L106">	private org.drip.product.params.NotionalSetting _notionalSetting = null;</span>
<span class="fc" id="L107">	private org.drip.product.params.QuoteConvention _quoteConvention = null;</span>
<span class="fc" id="L108">	private org.drip.product.params.TerminationSetting _terminationSetting = null;</span>
<span class="fc" id="L109">	private org.drip.product.params.TreasuryBenchmarks _treasuryBenchmarks = null;</span>

	/*
	 * Bond EOS Params
	 */

<span class="fc" id="L115">	protected org.drip.product.params.EmbeddedOptionSchedule _eosPut = null;</span>
<span class="fc" id="L116">	protected org.drip.product.params.EmbeddedOptionSchedule _eosCall = null;</span>

	private int terminationAdjust (
		final int iDate)
	{
<span class="fc bfc" id="L121" title="All 2 branches covered.">		org.drip.analytics.daycount.DateAdjustParams dap = null == _terminationSetting ? null :</span>
<span class="fc" id="L122">			_terminationSetting.dap();</span>

		try {
<span class="pc bpc" id="L125" title="1 of 2 branches missed.">			return null == dap ? iDate : dap.roll (iDate);</span>
<span class="nc" id="L126">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L127">			e.printStackTrace();</span>
		}

<span class="nc" id="L130">		return iDate;</span>
	}

	private double treasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L139" title="2 of 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L140">			throw new java.lang.Exception (&quot;BondComponent::treasuryBenchmarkYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L142">		java.lang.String strTsyBmk = null;</span>
<span class="fc" id="L143">		org.drip.param.definition.ProductQuote pqTsyBmkYield = null;</span>

<span class="pc bpc" id="L145" title="1 of 2 branches missed.">		if (null != _treasuryBenchmarks) strTsyBmk = _treasuryBenchmarks.primary();</span>

<span class="fc" id="L147">		int iValDate = valParams.valueDate();</span>

<span class="pc bpc" id="L149" title="3 of 4 branches missed.">		if (null == strTsyBmk || strTsyBmk.isEmpty())</span>
<span class="fc" id="L150">			strTsyBmk = org.drip.analytics.support.Helper.BaseTsyBmk (iValDate, iWorkoutDate);</span>

<span class="fc" id="L152">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; pqMap =</span>
<span class="fc" id="L153">			csqc.quoteMap();</span>

<span class="pc bpc" id="L155" title="2 of 6 branches missed.">		if (null != pqMap &amp;&amp; null != strTsyBmk &amp;&amp; !strTsyBmk.isEmpty())</span>
<span class="fc" id="L156">			pqTsyBmkYield = pqMap.get (strTsyBmk);</span>

<span class="fc bfc" id="L158" title="All 2 branches covered.">		if (null != pqTsyBmkYield) {</span>
<span class="fc" id="L159">			 org.drip.param.definition.Quote q = pqTsyBmkYield.quote (&quot;Yield&quot;);</span>

<span class="pc bpc" id="L161" title="1 of 2 branches missed.">			 if (null != q) return q.value (&quot;mid&quot;);</span>
		}

<span class="fc" id="L164">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L166" title="All 2 branches covered.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	private org.drip.param.valuation.WorkoutInfo exerciseCallYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L175" title="4 of 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosCall)
<span class="nc" id="L177">			return null;</span>

<span class="fc" id="L179">		int iValDate = valParams.valueDate();</span>

<span class="fc" id="L181">		int[] aiEOSDate = _eosCall.dates();</span>

<span class="fc" id="L183">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L185">		double[] adblEOSFactor = _eosCall.factors();</span>

<span class="fc" id="L187">		int iNoticePeriod = _eosCall.exerciseNoticePeriod();</span>

<span class="fc" id="L189">		int iExercise = -1;</span>
<span class="fc" id="L190">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="pc bpc" id="L191" title="1 of 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="fc" id="L194">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L195">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L198">			return null;</span>
<span class="fc" id="L199">		}</span>

<span class="fc bfc" id="L201" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="fc bfc" id="L202" title="All 4 branches covered.">			if (iValDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="fc" id="L205">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="fc bfc" id="L208" title="All 2 branches covered.">				if (dblYield &lt; dblExerciseYield) {</span>
<span class="fc" id="L209">					iExercise = i;</span>
<span class="fc" id="L210">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L212">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L214">			}</span>
		}

		try {
<span class="fc bfc" id="L218" title="All 2 branches covered.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L222">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L226">		return null;</span>
	}

	private org.drip.param.valuation.WorkoutInfo exercisePutYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L235" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosPut)
<span class="nc" id="L237">			return null;</span>

<span class="nc" id="L239">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L241">		int[] aiEOSDate = _eosPut.dates();</span>

<span class="nc" id="L243">		double[] adblEOSFactor = _eosPut.factors();</span>

<span class="nc" id="L245">		int iNoticePeriod = _eosPut.exerciseNoticePeriod();</span>

<span class="nc" id="L247">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L249">		int iExercise = -1;</span>
<span class="nc" id="L250">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L254">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L255">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L258">			return null;</span>
<span class="nc" id="L259">		}</span>

<span class="nc bnc" id="L261" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L262" title="All 4 branches missed.">			if (iValueDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValueDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L265">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L268" title="All 2 branches missed.">				if (dblYield &gt; dblExerciseYield) {</span>
<span class="nc" id="L269">					iExercise = i;</span>
<span class="nc" id="L270">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L272">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L274">			}</span>
		}

		try {
<span class="nc bnc" id="L278" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT);
<span class="nc" id="L282">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L286">		return null;</span>
	}

	private double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield,
		final boolean bApplyCouponExtension)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L299" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L300">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L302">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L304" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L305">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L307">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L308">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L309">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L310">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L311">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L312">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L313">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L314">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>

<span class="pc bpc" id="L316" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L317">			? 1. : notional (iValueDate);</span>

<span class="fc" id="L319">		int iFrequency = freq();</span>

<span class="fc" id="L321">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L323">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L325">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L327" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L329" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L330">			_quoteConvention.valuationCustomizationParams();</span>

<span class="fc bfc" id="L332" title="All 2 branches covered.">		if (null != vcp) {</span>
<span class="fc" id="L333">			strDC = vcp.yieldDayCount();</span>

<span class="fc" id="L335">			iFrequency = vcp.yieldFreq();</span>

<span class="fc" id="L337">			strCalendar = vcp.yieldCalendar();</span>

<span class="fc" id="L339">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="fc" id="L341">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L342" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L343">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L345">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L347">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L349">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L351">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L354">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L356" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L357">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L359" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L361" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L362">				bFirstPeriod = false;</span>

<span class="fc" id="L364">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L366">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L368">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L370">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L372" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L373">				iPeriodEndDate = iWorkoutDate;</span>
<span class="fc" id="L374">				bTerminateCouponFlow = true;</span>
			}

<span class="fc" id="L377">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L380" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L381">				throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; No PCM for &quot; + new</span>
<span class="nc" id="L382">					org.drip.analytics.date.JulianDate (iValueDate) + &quot; | &quot; + effectiveDate());</span>

<span class="fc bfc" id="L384" title="All 2 branches covered.">			if (null != vcp) {</span>
<span class="pc bpc" id="L385" title="1 of 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="fc" id="L386">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L388" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L390">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L393">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L396">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
					org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iPeriodPayDate, strDC,
<span class="fc" id="L399">						bApplyCpnEOMAdj, aap, strCalendar)) * cpcm.cumulative();</span>

<span class="fc" id="L401">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L403">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L405">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L407" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L408">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L409" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L410">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L413">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L415" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L416">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc bfc" id="L418" title="All 2 branches covered.">			dblCumulativePeriodPV += (period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="pc bpc" id="L419" title="1 of 2 branches missed.">				dblFlatForwardRate : cpcm.rate() + (bApplyCouponExtension ?</span>
<span class="pc" id="L420">					_couponSetting.couponRateExtension() : 0.)) * couponFactor (iPeriodEndDate) *</span>
						dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;

<span class="fc bfc" id="L423" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L424">		}</span>

		try {
<span class="fc bfc" id="L427" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L428">				valParams.cashPayDate();</span>
<span class="nc" id="L429">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L432">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L433">		}</span>

<span class="fc" id="L435">		double dblCleanPrice = (((dblCumulativePeriodPV + dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (</span>
			iFrequency,
			dblYield,
			s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (
					iValueDate,
					terminationAdjust (iWorkoutDate),
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
<span class="fc" id="L447">			) * notional (iWorkoutDate)) /</span>
<span class="fc" id="L448">			org.drip.analytics.support.Helper.Yield2DF (</span>
				iFrequency,
				dblYield,
<span class="fc" id="L451">				org.drip.analytics.daycount.Convention.YearFraction (</span>
					iValueDate,
					iCashPayDate,
					strDC,
					bApplyCpnEOMAdj,
					aap,
					strCalendar
				)
			)
<span class="fc" id="L460">		) - accrued (</span>
			iValueDate,
			csqc
		)) / dblScalingNotional;

<span class="fc" id="L465">		return dblCleanPrice;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; calibMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L474">		double dblCleanPrice = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L476" title="1 of 2 branches missed.">		org.drip.param.definition.CalibrationParams calibParams = null == pricerParams ? null :</span>
<span class="fc" id="L477">			pricerParams.calibParams();</span>

<span class="pc bpc" id="L479" title="1 of 2 branches missed.">		if (null == calibParams) return null;</span>

<span class="fc" id="L481">		org.drip.param.valuation.WorkoutInfo wi = calibParams.workout();</span>

<span class="fc bfc" id="L483" title="All 2 branches covered.">		double dblExerciseFactor = null == wi ? 1. : wi.factor();</span>

<span class="fc bfc" id="L485" title="All 2 branches covered.">		int iExerciseDate = null == wi ? maturityDate().julian() : wi.date();</span>

<span class="fc" id="L487">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

		try {
<span class="fc bfc" id="L490" title="All 2 branches covered.">			dblCleanPrice = null == cc ? priceFromFundingCurve (valParams, csqc, iExerciseDate,</span>
<span class="fc" id="L491">				dblExerciseFactor, 0.) : priceFromCreditCurve (valParams, csqc, iExerciseDate,</span>
					dblExerciseFactor, 0., false);
<span class="nc" id="L493">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L496">			return null;</span>
<span class="fc" id="L497">		}</span>

<span class="pc bpc" id="L499" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblCleanPrice)) return null;</span>

<span class="fc" id="L501">		java.lang.String strCalibMeasure = calibParams.measure();</span>

<span class="fc" id="L503">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

<span class="fc bfc" id="L506" title="All 2 branches covered.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CleanPrice&quot;, &quot;FairCleanPrice&quot;, &quot;FairPrice&quot;, &quot;Price&quot;}, false)) {
<span class="fc" id="L508">			mapCalibMeasures.put (strCalibMeasure, dblCleanPrice);</span>

<span class="fc" id="L510">			return mapCalibMeasures;</span>
		}

<span class="pc bpc" id="L513" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;DirtyPrice&quot;, &quot;FairDirtyPrice&quot;}, false)) {
			try {
<span class="nc" id="L516">				mapCalibMeasures.put (strCalibMeasure, dblCleanPrice + accrued (valParams.valueDate(),</span>
					csqc));

<span class="nc" id="L519">				return mapCalibMeasures;</span>
<span class="nc" id="L520">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="pc bpc" id="L525" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;Yield&quot;, &quot;FairYield&quot;}, false)) {
			try {
<span class="fc" id="L528">				mapCalibMeasures.put (strCalibMeasure, yieldFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="fc" id="L531">				return mapCalibMeasures;</span>
<span class="nc" id="L532">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L537" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;TSYSpread&quot;, &quot;FairTSYSpread&quot;}, false)) {
			try {
<span class="nc" id="L540">				mapCalibMeasures.put (strCalibMeasure, tsySpreadFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L543">				return mapCalibMeasures;</span>
<span class="nc" id="L544">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L549" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;OAS&quot;, &quot;OASpread&quot;, &quot;OptionAdjustedSpread&quot;}, false)) {
			try {
<span class="nc" id="L552">				mapCalibMeasures.put (strCalibMeasure, oasFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L555">				return mapCalibMeasures;</span>
<span class="nc" id="L556">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L561" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;BondBasis&quot;, &quot;YieldBasis&quot;, &quot;YieldSpread&quot;}, false)) {
			try {
<span class="nc" id="L564">				mapCalibMeasures.put (strCalibMeasure, bondBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L567">				return mapCalibMeasures;</span>
<span class="nc" id="L568">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L573" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CreditBasis&quot;}, false)) {
<span class="nc bnc" id="L575" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L578">				mapCalibMeasures.put (strCalibMeasure, creditBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L581">				return mapCalibMeasures;</span>
<span class="nc" id="L582">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L587" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;PECS&quot;, &quot;ParEquivalentCDSSpread&quot;}, false)) {
<span class="nc bnc" id="L589" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L592">				mapCalibMeasures.put (strCalibMeasure, pecsFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L595">				return mapCalibMeasures;</span>
<span class="nc" id="L596">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc" id="L601">		return null;</span>
	}

	@Override public org.drip.param.valuation.WorkoutInfo exerciseYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L610" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L611">			return null;</span>

<span class="fc" id="L613">		int iMaturityDate = maturityDate().julian();</span>

		try {
<span class="pc bpc" id="L616" title="1 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L617">				return new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPrice (valParams,</span>
					csqc, vcp, iMaturityDate, 1., dblPrice), 1.,
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);

<span class="pc bpc" id="L621" title="3 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null != _eosPut)</span>
<span class="nc" id="L622">				return exercisePutYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="pc bpc" id="L624" title="2 of 4 branches missed.">			if (null != _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L625">				return exerciseCallYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc" id="L627">			org.drip.param.valuation.WorkoutInfo wiPut = exercisePutYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc" id="L630">			org.drip.param.valuation.WorkoutInfo wiCall = exerciseCallYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc bnc" id="L633" title="All 4 branches missed.">			if (null == wiPut || null == wiCall) return null;</span>

<span class="nc bnc" id="L635" title="All 2 branches missed.">			return wiPut.date() &lt; wiCall.date() ? wiPut : wiCall;</span>
<span class="nc" id="L636">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L640">		return null;</span>
	}

	private double indexRate (
		final int iValueDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.analytics.cashflow.CompositeFloatingPeriod cup)
		throws java.lang.Exception
	{
<span class="fc" id="L649">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState (fundingLabel());</span>

<span class="fc" id="L651">		int iFreq = freq();</span>

<span class="pc bpc" id="L653" title="1 of 2 branches missed.">		if (null != cup) {</span>
<span class="fc" id="L654">			org.drip.analytics.cashflow.ComposableUnitPeriod cupFirst = cup.periods().get (0);</span>

<span class="pc bpc" id="L656" title="1 of 2 branches missed.">			if (!(cupFirst instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod))</span>
<span class="nc" id="L657">				throw new java.lang.Exception (&quot;BondComponent::indexRate =&gt; Not a floater&quot;);</span>

<span class="fc" id="L659">			return ((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod) cupFirst).baseRate (csqc);</span>
		}

<span class="nc bnc" id="L662" title="All 2 branches missed.">		return dc.libor (iValueDate, 0 != iFreq ? iValueDate + 365 / iFreq : iValueDate +</span>
			LOCAL_FORWARD_RATE_WIDTH);
	}

	private org.drip.analytics.output.BondWorkoutMeasures workoutMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
	{
<span class="pc bpc" id="L673" title="2 of 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="fc" id="L675">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L677" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L679">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L681" title="All 2 branches covered.">		if (null == dcFunding) return null;</span>

<span class="fc bfc" id="L683" title="All 2 branches covered.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="fc bfc" id="L685" title="All 2 branches covered.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="fc" id="L686">			_creditSetting.recovery();</span>

<span class="fc bfc" id="L688" title="All 2 branches covered.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="fc bfc" id="L690" title="All 2 branches covered.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L692">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="fc" id="L694">		double dblAccrued01 = 0.;</span>
<span class="fc" id="L695">		double dblRecoveryPV = 0.;</span>
<span class="fc" id="L696">		boolean bPeriodZero = true;</span>
<span class="fc" id="L697">		double dblExpectedRecovery = 0.;</span>
<span class="fc" id="L698">		double dblCreditRiskyDirtyDV01 = 0.;</span>
<span class="fc" id="L699">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L700">		double dblCreditRiskyPrincipalPV = 0.;</span>
<span class="fc" id="L701">		double dblCreditRisklessDirtyDV01 = 0.;</span>
<span class="fc" id="L702">		double dblCreditRiskyDirtyCouponPV = 0.;</span>
<span class="fc" id="L703">		double dblCreditRisklessPrincipalPV = 0.;</span>
<span class="fc" id="L704">		double dblCreditRisklessDirtyCouponPV = 0.;</span>
<span class="fc" id="L705">		double dblFirstCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L706">		double dblCreditRiskyDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L707">		double dblFirstIndexRate = java.lang.Double.NaN;</span>
<span class="fc" id="L708">		double dblCreditRisklessDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L709">		double dblCreditRiskyParPV = java.lang.Double.NaN;</span>
<span class="fc" id="L710">		double dblFlatForwardCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L711">		double dblCreditRisklessParPV = java.lang.Double.NaN;</span>

<span class="fc bfc" id="L713" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L714">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L716" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

		try {
<span class="pc bpc" id="L719" title="1 of 2 branches missed.">			for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L720">				int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L722" title="All 2 branches covered.">				if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L724">				int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L726">				int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L728" title="All 2 branches covered.">				if (iWorkoutDate &lt;= iPeriodEndDate) {</span>
<span class="fc" id="L729">					bTerminateCouponFlow = true;</span>
<span class="fc" id="L730">					iPeriodEndDate = iWorkoutDate;</span>
				}

<span class="fc" id="L733">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L736" title="1 of 2 branches missed.">				if (null == cpcm) return null;</span>

<span class="fc bfc" id="L738" title="All 2 branches covered.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardCoupon))</span>
<span class="fc" id="L739">					dblFlatForwardCoupon = cpcm.rate();</span>

<span class="fc" id="L741">				double dblPeriodBaseRate = period.periods().get (0).baseRate (csqc);</span>

<span class="fc" id="L743">				double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="pc bpc" id="L745" title="1 of 2 branches missed.">				double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardCoupon : cpcm.rate();</span>

<span class="fc bfc" id="L747" title="All 2 branches covered.">				if (bPeriodZero) {</span>
<span class="fc" id="L748">					bPeriodZero = false;</span>
<span class="fc" id="L749">					dblFirstCoupon = dblPeriodCoupon;</span>

<span class="pc bpc" id="L751" title="1 of 2 branches missed.">					if (iPeriodStartDate &lt; iValueDate)</span>
<span class="fc" id="L752">						dblAccrued01 = 0.0001 * period.accrualDCF (iValueDate) * notional (iPeriodStartDate,</span>
							iValueDate);

<span class="fc bfc" id="L755" title="All 2 branches covered.">					if (null != _floaterSetting) dblFirstIndexRate = dblPeriodBaseRate;</span>
				}

<span class="fc" id="L758">				double dblPeriodCreditRisklessDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) *</span>
<span class="fc" id="L759">					dblPeriodAnnuity * notional (iPeriodStartDate);</span>

<span class="fc" id="L761">				double dblPeriodCreditRiskessPrincipalPV = (notional (iPeriodStartDate) - notional</span>
<span class="fc" id="L762">					(iPeriodEndDate)) * dblPeriodAnnuity;</span>

<span class="fc" id="L764">				double dblPeriodCreditRiskyDirtyDV01 = dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L765">				double dblPeriodCreditRiskyPrincipalPV = dblPeriodCreditRiskessPrincipalPV;</span>

<span class="pc bpc" id="L767" title="1 of 4 branches missed.">				if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L768" title="All 2 branches missed.">					double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
						iPeriodEndDate);

<span class="nc" id="L771">					dblPeriodCreditRiskyDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L772">					dblPeriodCreditRiskyPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L774" title="All 2 branches missed.">					for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
<span class="nc" id="L775">						valParams, pricerParams, terminationAdjust (iWorkoutDate), csqc)) {</span>
<span class="nc bnc" id="L776" title="All 2 branches missed.">						if (null == lqm) continue;</span>

<span class="nc" id="L778">						int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L780">						int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L782">						double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
							iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L785">						double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L787">						double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L788">							(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L790" title="All 2 branches missed.">						if (bAccrualOnDefault)</span>
<span class="nc" id="L791">							dblPeriodCreditRiskyDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival</span>
								* dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L794" title="All 2 branches missed.">						double dblRecovery = bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
							iSubPeriodEndDate) : dblProductRecovery;

<span class="nc" id="L797">						double dblSubPeriodExpRecovery = dblRecovery * dblSubPeriodSurvival *</span>
							dblSubPeriodNotional;
<span class="nc" id="L799">						dblRecoveryPV += dblSubPeriodExpRecovery * dblSubPeriodDF;</span>
<span class="nc" id="L800">						dblExpectedRecovery += dblSubPeriodExpRecovery;</span>
<span class="nc" id="L801">					}</span>
				}

<span class="fc" id="L804">				dblCreditRiskyDirtyDV01 += dblPeriodCreditRiskyDirtyDV01;</span>
<span class="fc" id="L805">				dblCreditRiskyPrincipalPV += dblPeriodCreditRiskyPrincipalPV;</span>
<span class="fc" id="L806">				dblCreditRisklessDirtyDV01 += dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L807">				dblCreditRisklessPrincipalPV += dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc" id="L809">				dblCreditRiskyDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRiskyDirtyDV01;

<span class="fc" id="L812">				dblCreditRisklessDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc" id="L815">				dblCreditRiskyDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRiskyDirtyDV01;
<span class="fc" id="L817">				dblCreditRisklessDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc bfc" id="L820" title="All 2 branches covered.">				if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L821">			}</span>
<span class="nc" id="L822">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L825">			return null;</span>
<span class="fc" id="L826">		}</span>

<span class="fc" id="L828">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>

		try {
<span class="fc bfc" id="L831" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L832">				valParams.cashPayDate();</span>
<span class="nc" id="L833">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L836">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L837">		}</span>

		try {
<span class="fc" id="L840">			double dblCashPayDF = dcFunding.df (iCashPayDate);</span>

<span class="fc" id="L842">			int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L844">			dblCreditRisklessParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate) *</span>
				dblWorkoutFactor;

<span class="pc bpc" id="L847" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams)</span>
<span class="nc" id="L848">				dblCreditRiskyParPV = dblCreditRisklessParPV * cc.survival (iMaturityDate);</span>

<span class="fc" id="L850">			org.drip.analytics.output.BondCouponMeasures bcmCreditRisklessDirty = new</span>
				org.drip.analytics.output.BondCouponMeasures (dblCreditRisklessDirtyDV01,
					dblCreditRisklessDirtyIndexCouponPV, dblCreditRisklessDirtyCouponPV,
						dblCreditRisklessDirtyCouponPV + dblCreditRisklessPrincipalPV +
							dblCreditRisklessParPV);

<span class="fc" id="L856">			double dblDefaultExposure = java.lang.Double.NaN;</span>
<span class="fc" id="L857">			double dblDefaultExposureNoRec = java.lang.Double.NaN;</span>
<span class="fc" id="L858">			double dblLossOnInstantaneousDefault = java.lang.Double.NaN;</span>
<span class="fc" id="L859">			org.drip.analytics.output.BondCouponMeasures bcmCreditRiskyDirty = null;</span>

<span class="pc bpc" id="L861" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc" id="L862">				double dblInitialNotional = notional (iValueDate);</span>

<span class="nc" id="L864">				double dblInitialRecovery = cc.recovery (iValueDate);</span>

<span class="nc" id="L866">				bcmCreditRiskyDirty = new org.drip.analytics.output.BondCouponMeasures</span>
					(dblCreditRiskyDirtyDV01, dblCreditRiskyDirtyIndexCouponPV, dblCreditRiskyDirtyCouponPV,
						dblCreditRiskyDirtyCouponPV + dblCreditRiskyPrincipalPV + dblCreditRiskyParPV);

<span class="nc" id="L870">				dblDefaultExposure = (dblDefaultExposureNoRec = dblInitialNotional) * dblInitialRecovery;</span>
<span class="nc" id="L871">				dblLossOnInstantaneousDefault = dblInitialNotional * (1. - dblInitialRecovery);</span>
			}

<span class="fc" id="L874">			return new org.drip.analytics.output.BondWorkoutMeasures (bcmCreditRiskyDirty,</span>
				bcmCreditRisklessDirty, dblCreditRiskyParPV, dblCreditRisklessParPV,
					dblCreditRiskyPrincipalPV, dblCreditRisklessPrincipalPV, dblRecoveryPV,
						dblExpectedRecovery, dblDefaultExposure, dblDefaultExposureNoRec,
							dblLossOnInstantaneousDefault, dblAccrued01, dblFirstCoupon, dblFirstIndexRate,
								dblCashPayDF);
<span class="nc" id="L880">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L884">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; rvMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice,
		final java.lang.String strPrefix)
	{
<span class="pc bpc" id="L896" title="1 of 2 branches missed.">		if (null == strPrefix) return null;</span>

<span class="fc" id="L898">		org.drip.analytics.output.BondRVMeasures bmRV = standardMeasures (valParams, pricerParams, csqc, vcp,</span>
			wi, dblPrice);

<span class="pc bpc" id="L901" title="1 of 2 branches missed.">		return null == bmRV ? null : bmRV.toMap (strPrefix);</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; fairMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L910">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L912">		org.drip.analytics.output.BondWorkoutMeasures bwmFair = workoutMeasures (valParams, pricerParams,</span>
			csqc, iMaturityDate, 1.);

<span class="pc bpc" id="L915" title="1 of 2 branches missed.">		if (null == bwmFair) return null;</span>

<span class="fc" id="L917">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = bwmFair.toMap (&quot;&quot;);</span>

<span class="fc" id="L919">		org.drip.analytics.output.BondCouponMeasures bcm = bwmFair.creditRiskyCleanbcm();</span>

<span class="pc bpc" id="L921" title="1 of 2 branches missed.">		double dblCreditRiskyPV = null == bcm ? java.lang.Double.NaN : bcm.pv();</span>

<span class="pc bpc" id="L923" title="1 of 2 branches missed.">		double dblPrice = !org.drip.quant.common.NumberUtil.IsValid (dblCreditRiskyPV) ?</span>
<span class="pc" id="L924">			bwmFair.creditRisklessCleanbcm().pv() : dblCreditRiskyPV;</span>

		try {
<span class="fc" id="L927">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, rvMeasures (valParams,</span>
				pricerParams, csqc, vcp, new org.drip.param.valuation.WorkoutInfo (iMaturityDate,
<span class="fc" id="L929">					yieldFromPrice (valParams, csqc, vcp, dblPrice / notional (valParams.valueDate())), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY), dblPrice, &quot;&quot;));

<span class="fc" id="L932">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L933">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Fair&quot;));</span>

<span class="fc" id="L935">			return mapMeasures;</span>
<span class="nc" id="L936">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L940">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; marketMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wiMarket)
	{
		try {
<span class="fc" id="L951">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = rvMeasures</span>
<span class="fc" id="L952">				(valParams, pricerParams, csqc, vcp, wiMarket, priceFromYield (valParams, csqc, vcp,</span>
<span class="fc" id="L953">					wiMarket.date(), wiMarket.factor(), wiMarket.yield()), &quot;&quot;);</span>

<span class="fc" id="L955">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L956">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Market&quot;));</span>

<span class="fc" id="L958">			return mapMeasures;</span>
<span class="nc" id="L959">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L963">		return null;</span>
	}

	private org.drip.analytics.cashflow.CompositePeriod currentPeriod (
		final int iDate)
	{
		try {
<span class="fc" id="L970">			return _stream.period (_stream.periodIndex (iDate));</span>
<span class="nc" id="L971">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L975">		return null;</span>
	}

	private double priceFromDiscountCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump,
		final int iDiscountCurveType)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L987" title="3 of 6 branches missed.">		if (null == valParams || null == csqc ||!org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L988" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L989">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L991">		org.drip.state.discount.DiscountCurve dc = null;</span>

<span class="pc bpc" id="L993" title="1 of 2 branches missed.">		if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="fc" id="L994">			dc = csqc.fundingState (fundingLabel());</span>
<span class="nc bnc" id="L995" title="All 2 branches missed.">		else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L996">			dc = csqc.govvieState (govvieLabel());</span>
		/* else if (PRICE_OFF_OF_OVERNIGHT_CURVE == iDiscountCurveType)
			dfe = csqc.overnightState (overnightLabel()); */

<span class="pc bpc" id="L1000" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1001">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No Discount Curve&quot;);</span>

<span class="fc" id="L1003">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L1005" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1006">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L1007">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L1008">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L1010">		double dblPV = 0.;</span>
<span class="fc" id="L1011">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L1012">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L1013">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L1015" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L1016">			? 1. : notional (iValueDate);</span>

<span class="fc bfc" id="L1018" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L1019">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L1021" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L1023" title="1 of 2 branches missed.">		if (0. != dblBump) {</span>
<span class="nc bnc" id="L1024" title="All 2 branches missed.">			if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1025">				dc = (org.drip.state.discount.MergedDiscountForwardCurve) dc.parallelShiftManifestMeasure</span>
<span class="nc" id="L1026">					(&quot;SwapRate&quot;, dblBump);</span>
<span class="nc bnc" id="L1027" title="All 2 branches missed.">			else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1028">				dc = (org.drip.state.govvie.GovvieCurve) dc.parallelShiftManifestMeasure (&quot;Yield&quot;, dblBump);</span>
		}

<span class="pc bpc" id="L1031" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1032">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromDiscountCurve =&gt; Cannot shift Discount Curve&quot;);

<span class="pc bpc" id="L1035" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1036">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L1038" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L1040">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L1042">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L1044">			int iNotionalEndDate = period.endDate();</span>

<span class="fc bfc" id="L1046" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L1047">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L1048">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L1049">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L1052">			org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L1055" title="1 of 2 branches missed.">			if (null == pcm)</span>
<span class="nc" id="L1056">				throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No PCM&quot;);</span>

<span class="fc" id="L1058">			double dblPeriodAnnuity = dc.df (iPeriodPayDate) * pcm.cumulative();</span>

<span class="fc" id="L1060">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L1062">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L1064">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L1066">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L1068" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L1069">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L1070" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L1071">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L1072" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L1074">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc bfc" id="L1076" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L1077">				dblFlatForwardRate = pcm.rate();</span>

<span class="pc bpc" id="L1079" title="1 of 2 branches missed.">			dblPV += period.accrualDCF (iAccrualEndDate) * dblPeriodAnnuity * (bApplyFlatForward ?</span>
<span class="fc" id="L1080">				dblFlatForwardRate : pcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L1082">			dblPV += (dblPeriodStartNotional - dblPeriodEndNotional) * dblPeriodAnnuity;</span>

<span class="fc bfc" id="L1084" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L1085">		}</span>

		try {
<span class="fc bfc" id="L1088" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L1089">				valParams.cashPayDate();</span>
<span class="nc" id="L1090">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1093">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L1094">		}</span>

<span class="fc" id="L1096">		return ((dblPV + dblWorkoutFactor * dc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L1097">			(iWorkoutDate)) / dc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	/**
	 * Constructor: Construct an empty bond object
	 */

	public BondComponent()
<span class="fc" id="L1105">	{</span>
<span class="fc" id="L1106">	}</span>

	@Override public double[] secTreasurySpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1112" title="All 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="nc" id="L1114">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1115">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1117" title="All 4 branches missed.">		if (null == mapTSYQuote || 0 == mapTSYQuote.size()) return null;</span>

<span class="nc bnc" id="L1119" title="All 2 branches missed.">		java.lang.String[] astrTreasuryBenchmark = null == _treasuryBenchmarks ? null :</span>
<span class="nc" id="L1120">			_treasuryBenchmarks.secondary();</span>

<span class="nc bnc" id="L1122" title="All 2 branches missed.">		int iNumTreasuryBenchmark = null == astrTreasuryBenchmark ? 0 : astrTreasuryBenchmark.length;</span>
<span class="nc" id="L1123">		double[] adblSecTSYSpread = new double[iNumTreasuryBenchmark];</span>

<span class="nc bnc" id="L1125" title="All 2 branches missed.">		if (0 == iNumTreasuryBenchmark) return null;</span>

<span class="nc bnc" id="L1127" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="nc" id="L1128">			org.drip.param.definition.ProductQuote pqTSYBenchmark = mapTSYQuote.get</span>
<span class="nc" id="L1129">				(astrTreasuryBenchmark[i]);</span>

<span class="nc bnc" id="L1131" title="All 2 branches missed.">			org.drip.param.definition.Quote q = null == pqTSYBenchmark ? null : pqTSYBenchmark.quote</span>
<span class="nc" id="L1132">				(&quot;Yield&quot;);</span>

<span class="nc bnc" id="L1134" title="All 2 branches missed.">			adblSecTSYSpread[i] = null == q ? java.lang.Double.NaN : q.value (&quot;mid&quot;);</span>
		}

<span class="nc" id="L1137">		return adblSecTSYSpread;</span>
	}

	@Override public double effectiveTreasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1147" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1148">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Bad val/mkt Params&quot;);

<span class="nc" id="L1151">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1153" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L1154">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Invalid Work-out!&quot;);

<span class="nc bnc" id="L1157" title="All 2 branches missed.">		java.lang.String strTreasuryBenchmark = null != _treasuryBenchmarks ? _treasuryBenchmarks.primary() :</span>
			null;

<span class="nc" id="L1160">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1162">		int iWorkoutDate = wi.date();</span>

<span class="nc bnc" id="L1164" title="All 4 branches missed.">		if (null == strTreasuryBenchmark || strTreasuryBenchmark.isEmpty())</span>
<span class="nc" id="L1165">			strTreasuryBenchmark = org.drip.analytics.support.Helper.BaseTsyBmk (iValueDate, iWorkoutDate);</span>

<span class="nc" id="L1167">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1168">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1170" title="All 2 branches missed.">		org.drip.param.definition.ProductQuote pqTSYBenchmark = null != mapTSYQuote &amp;&amp;</span>
<span class="nc bnc" id="L1171" title="All 4 branches missed.">			mapTSYQuote.containsKey (strTreasuryBenchmark) &amp;&amp; !strTreasuryBenchmark.isEmpty() ?</span>
<span class="nc" id="L1172">				mapTSYQuote.get (strTreasuryBenchmark) : null;</span>

<span class="nc bnc" id="L1174" title="All 2 branches missed.">		org.drip.param.definition.Quote q = null != pqTSYBenchmark ? pqTSYBenchmark.quote (&quot;Yield&quot;) : null;</span>

<span class="nc bnc" id="L1176" title="All 2 branches missed.">		if (null != q) return q.value (&quot;mid&quot;);</span>

<span class="nc" id="L1178">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());;</span>

<span class="nc bnc" id="L1180" title="All 2 branches missed.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	@Override public boolean setTreasuryBenchmark (
		final org.drip.product.params.TreasuryBenchmarks treasuryBenchmarks)
	{
<span class="pc bpc" id="L1186" title="1 of 2 branches missed.">		return null != (_treasuryBenchmarks = treasuryBenchmarks);</span>
	}

	@Override public org.drip.product.params.TreasuryBenchmarks treasuryBenchmark()
	{
<span class="nc" id="L1191">		return _treasuryBenchmarks;</span>
	}

	@Override public boolean setIdentifierSet (
		final org.drip.product.params.IdentifierSet idParams)
	{
<span class="pc bpc" id="L1197" title="1 of 2 branches missed.">		return null != (_idParams = idParams);</span>
	}

	@Override public org.drip.product.params.IdentifierSet identifierSet()
	{
<span class="nc" id="L1202">		return _idParams;</span>
	}

	@Override public boolean setCouponSetting (
		final org.drip.product.params.CouponSetting couponSetting)
	{
<span class="pc bpc" id="L1208" title="1 of 2 branches missed.">		return null != (_couponSetting = couponSetting);</span>
	}

	@Override public org.drip.product.params.CouponSetting couponSetting()
	{
<span class="nc" id="L1213">		return _couponSetting;</span>
	}

	@Override public boolean setFloaterSetting (
		final org.drip.product.params.FloaterSetting fltParams)
	{
<span class="fc bfc" id="L1219" title="All 2 branches covered.">		return null == (_floaterSetting = fltParams);</span>
	}

	@Override public org.drip.product.params.FloaterSetting floaterSetting()
	{
<span class="fc" id="L1224">		return _floaterSetting;</span>
	}

	@Override public boolean setMarketConvention (
		final org.drip.product.params.QuoteConvention quoteConvention)
	{
<span class="pc bpc" id="L1230" title="1 of 2 branches missed.">		return null == (_quoteConvention = quoteConvention);</span>
	}

	@Override public org.drip.product.params.QuoteConvention marketConvention()
	{
<span class="nc" id="L1235">		return _quoteConvention;</span>
	}

	@Override public boolean setCreditSetting (
		final org.drip.product.params.CreditSetting creditSetting)
	{
<span class="pc bpc" id="L1241" title="1 of 2 branches missed.">		return null == (_creditSetting = creditSetting);</span>
	}

	@Override public org.drip.product.params.CreditSetting creditSetting()
	{
<span class="nc" id="L1246">		return _creditSetting;</span>
	}

	@Override public boolean setTerminationSetting (
		final org.drip.product.params.TerminationSetting terminationSetting)
	{
<span class="pc bpc" id="L1252" title="1 of 2 branches missed.">		return null == (_terminationSetting = terminationSetting);</span>
	}

	@Override public org.drip.product.params.TerminationSetting terminationSetting()
	{
<span class="nc" id="L1257">		return _terminationSetting;</span>
	}

	@Override public boolean setStream (
		final org.drip.product.params.BondStream stream)
	{
<span class="pc bpc" id="L1263" title="1 of 2 branches missed.">		return null != (_stream = stream);</span>
	}

	@Override public org.drip.product.params.BondStream stream()
	{
<span class="fc" id="L1268">		return _stream;</span>
	}

	@Override public boolean setNotionalSetting (
		final org.drip.product.params.NotionalSetting notionalSetting)
	{
<span class="pc bpc" id="L1274" title="1 of 2 branches missed.">		return null == (_notionalSetting = notionalSetting);</span>
	}

	@Override public org.drip.product.params.NotionalSetting notionalSetting()
	{
<span class="nc" id="L1279">		return _notionalSetting;</span>
	}

	@Override public java.lang.String primaryCode()
	{
<span class="pc bpc" id="L1284" title="1 of 2 branches missed.">		return null == _idParams ? null : &quot;BOND.&quot; + _idParams.id();</span>
	}

	@Override public void setPrimaryCode (
		final java.lang.String strCode)
	{
		// _strCode = strCode;
<span class="nc" id="L1291">	}</span>

	@Override public java.lang.String[] secondaryCode()
	{
<span class="fc" id="L1295">		return new java.lang.String[] {_idParams.id()};</span>
	}

	@Override public java.lang.String isin()
	{
<span class="nc bnc" id="L1300" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.isin();</span>
	}

	@Override public java.lang.String cusip()
	{
<span class="nc bnc" id="L1305" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.cusip();</span>
	}

	@Override public java.lang.String name()
	{
<span class="pc bpc" id="L1310" title="1 of 2 branches missed.">		return null == _idParams ? null : _idParams.id();</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; couponCurrency()
	{
<span class="nc" id="L1315">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; mapCouponCurrency = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt;();

<span class="nc" id="L1318">		mapCouponCurrency.put (name(), _stream.couponCurrency());</span>

<span class="nc" id="L1320">		return mapCouponCurrency;</span>
	}

	@Override public java.lang.String payCurrency()
	{
<span class="fc" id="L1325">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String principalCurrency()
	{
<span class="nc" id="L1330">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public double notional (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1337" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1338">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1340">		return _notionalSetting.outstandingFactorSchedule().y (iDate);</span>
	}

	@Override public double notional (
		final int iStartDate,
		final int iEndDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1348" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1349">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1351">		return _notionalSetting.outstandingFactorSchedule().y (iStartDate, iEndDate);</span>
	}

	@Override public double initialNotional()
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1357" title="1 of 2 branches missed.">		if (null == _notionalSetting)</span>
<span class="nc" id="L1358">			throw new java.lang.Exception (&quot;BondComponent::initialNotional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1360">		return _notionalSetting.notionalAmount();</span>
	}

	public double couponFactor (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1367" title="1 of 2 branches missed.">		if (null == _couponSetting) return 1.;</span>

<span class="fc" id="L1369">		org.drip.quant.common.Array2D fsCoupon = _couponSetting.factorSchedule();</span>

<span class="fc bfc" id="L1371" title="All 2 branches covered.">		return null == fsCoupon ? 1. : fsCoupon.y (iDate);</span>
	}

	@Override public double recovery (
		final int iDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1379" title="All 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="nc bnc" id="L1381" title="All 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.recovery (iDate) : _creditSetting.recovery();</span>
	}

	@Override public double recovery (
		final int iStartDate,
		final int iEndDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1390" title="1 of 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="pc bpc" id="L1392" title="1 of 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iStartDate, iEndDate) :</span>
<span class="nc" id="L1393">			_creditSetting.recovery();</span>
	}

	@Override public org.drip.product.params.CreditSetting creditValuationParams()
	{
<span class="fc" id="L1398">		return _creditSetting;</span>
	}

	@Override public org.drip.analytics.output.CompositePeriodCouponMetrics couponMetrics (
		final int iAccrualEndDate,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="fc" id="L1406">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iAccrualEndDate);</span>

<span class="pc bpc" id="L1408" title="1 of 2 branches missed.">		if (null == cp) return null;</span>

<span class="fc" id="L1410">		java.util.List&lt;org.drip.analytics.output.UnitPeriodMetrics&gt; lsUPM = new</span>
			java.util.ArrayList&lt;org.drip.analytics.output.UnitPeriodMetrics&gt;();

		try {
<span class="fc" id="L1414">			lsUPM.add (new org.drip.analytics.output.UnitPeriodMetrics (cp.startDate(), cp.endDate(),</span>
<span class="fc" id="L1415">				cp.couponDCF(), cp.couponMetrics (valParams.valueDate(), csqc).rate(), new</span>
					org.drip.analytics.output.ConvexityAdjustment()));
<span class="nc" id="L1417">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L1418">			e.printStackTrace();</span>

<span class="nc" id="L1420">			return null;</span>
<span class="fc" id="L1421">		}</span>

<span class="fc" id="L1423">		return org.drip.analytics.output.CompositePeriodCouponMetrics.Create (lsUPM);</span>
	}

	@Override public int freq()
	{
<span class="fc" id="L1428">		return couponPeriods().get (0).freq();</span>
	}

	@Override public org.drip.state.identifier.EntityCDSLabel creditLabel()
	{
<span class="fc bfc" id="L1433" title="All 2 branches covered.">		if (null == _creditSetting) return null;</span>

<span class="fc" id="L1435">		java.lang.String strCreditCurveName = _creditSetting.creditCurveName();</span>

<span class="pc bpc" id="L1437" title="1 of 4 branches missed.">		return null == strCreditCurveName  || strCreditCurveName.isEmpty() ? null :</span>
<span class="fc" id="L1438">			org.drip.state.identifier.EntityCDSLabel.Standard (strCreditCurveName, currency());</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
			forwardLabel()
	{
<span class="pc bpc" id="L1445" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1447">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1449" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.ForwardLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
<span class="fc" id="L1452">			mapForwardLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;();

<span class="fc" id="L1455">		mapForwardLabel.put (</span>
<span class="fc" id="L1456">			name(),</span>
			(org.drip.state.identifier.ForwardLabel) floaterLabel
		);

<span class="fc" id="L1460">		return mapForwardLabel;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
			otcFixFloatLabel()
	{
<span class="pc bpc" id="L1467" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1469">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1471" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.OTCFixFloatLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
<span class="fc" id="L1474">			mapOTCFixFloatLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;();

<span class="fc" id="L1477">		mapOTCFixFloatLabel.put (</span>
<span class="fc" id="L1478">			name(),</span>
			(org.drip.state.identifier.OTCFixFloatLabel) floaterLabel
		);

<span class="fc" id="L1482">		return mapOTCFixFloatLabel;</span>
	}

	@Override public org.drip.state.identifier.FundingLabel fundingLabel()
	{
<span class="fc" id="L1487">		return org.drip.state.identifier.FundingLabel.Standard (payCurrency());</span>
	}

	@Override public org.drip.state.identifier.GovvieLabel govvieLabel()
	{
<span class="fc" id="L1492">		return org.drip.state.identifier.GovvieLabel.Standard</span>
<span class="fc" id="L1493">			(org.drip.market.issue.TreasurySettingContainer.CurrencyBenchmarkCode (payCurrency()));</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.FXLabel&gt;
		fxLabel()
	{
<span class="nc" id="L1499">		return null;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.VolatilityLabel&gt;
			volatilityLabel()
	{
<span class="nc" id="L1506">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate effectiveDate()
	{
<span class="fc" id="L1511">		return _stream.effective();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityDate()
	{
<span class="fc" id="L1516">		return _stream.maturity();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityPayDate()
	{
<span class="fc" id="L1521">		return new org.drip.analytics.date.JulianDate (terminationAdjust (maturityDate().julian()));</span>
	}

	@Override public org.drip.analytics.date.JulianDate firstCouponDate()
	{
<span class="fc" id="L1526">		return new org.drip.analytics.date.JulianDate (couponPeriods().get (0).endDate());</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; couponPeriods()
	{
<span class="fc" id="L1531">		return _stream.periods();</span>
	}

	@Override public org.drip.param.valuation.CashSettleParams cashSettleParams()
	{
<span class="nc bnc" id="L1536" title="All 2 branches missed.">		return null == _quoteConvention ? null : _quoteConvention.cashSettleParams();</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlow (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1544" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc) return null;</span>

<span class="nc" id="L1546">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1549" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1550" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1552">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1553">				(this, valParams, pricerParams, period.endDate(), csqc);</span>

<span class="nc bnc" id="L1555" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1556">		}</span>

<span class="nc" id="L1558">		return sLP;</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlowFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L1568" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc ||</span>
<span class="nc bnc" id="L1569" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1570">			return null;</span>

<span class="nc" id="L1572">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1574" title="All 2 branches missed.">		if (null == wi) return null;</span>

<span class="nc" id="L1576">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1578">		int iWorkoutDate = wi.date();</span>

<span class="nc" id="L1580">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1583" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1584" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1586">			int iPeriodEndDate = period.endDate();</span>

<span class="nc bnc" id="L1588" title="All 4 branches missed.">			if (null == period || iPeriodEndDate &lt; iValueDate) continue;</span>

<span class="nc bnc" id="L1590" title="All 2 branches missed.">			if (period.startDate() &gt; iWorkoutDate) break;</span>

<span class="nc" id="L1592">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1593">				(this, valParams, pricerParams, iPeriodEndDate, csqc);</span>

<span class="nc bnc" id="L1595" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1596">		}</span>

<span class="nc" id="L1598">		return sLP;</span>
	}

	@Override public boolean isFloater()
	{
<span class="fc bfc" id="L1603" title="All 2 branches covered.">		return null == _floaterSetting ? false : true;</span>
	}

	@Override public java.lang.String rateIndex()
	{
<span class="nc bnc" id="L1608" title="All 2 branches missed.">		return null == _floaterSetting ? &quot;&quot; : _floaterSetting.fri().fullyQualifiedName();</span>
	}

	@Override public double currentCoupon()
	{
<span class="nc bnc" id="L1613" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.currentFullCoupon();</span>
	}

	@Override public double floatSpread()
	{
<span class="pc bpc" id="L1618" title="1 of 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.spread();</span>
	}

	@Override public java.lang.String ticker()
	{
<span class="nc bnc" id="L1623" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.ticker();</span>
	}

	@Override public void setEmbeddedCallSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="pc bpc" id="L1629" title="2 of 4 branches missed.">		if (null == eos || eos.isPut()) return;</span>

<span class="fc" id="L1631">		_eosCall = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="fc" id="L1632">	}</span>

	@Override public void setEmbeddedPutSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="nc bnc" id="L1637" title="All 4 branches missed.">		if (null == eos || !eos.isPut()) return;</span>

<span class="nc" id="L1639">		_eosPut = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="nc" id="L1640">	}</span>

	@Override public boolean callable()
	{
<span class="fc bfc" id="L1644" title="All 2 branches covered.">		return null != _eosCall;</span>
	}

	@Override public boolean putable()
	{
<span class="pc bpc" id="L1649" title="1 of 2 branches missed.">		return null != _eosPut;</span>
	}

	@Override public boolean sinkable()
	{
<span class="nc bnc" id="L1654" title="All 2 branches missed.">		return null == _notionalSetting ? false : true;</span>
	}

	@Override public boolean variableCoupon()
	{
<span class="nc bnc" id="L1659" title="All 4 branches missed.">		return null == _couponSetting || null == _couponSetting.couponType() || !&quot;variable&quot;.equalsIgnoreCase</span>
<span class="nc bnc" id="L1660" title="All 2 branches missed.">			(_couponSetting.couponType()) ? false : true;</span>
	}

	@Override public boolean exercised()
	{
<span class="nc bnc" id="L1665" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.exercised();</span>
	}

	@Override public boolean defaulted()
	{
<span class="nc bnc" id="L1670" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.defaulted();</span>
	}

	@Override public boolean perpetual()
	{
<span class="nc bnc" id="L1675" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.perpetual();</span>
	}

	@Override public boolean tradeable (
		final org.drip.param.valuation.ValuationParams valParams)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1682" title="All 2 branches missed.">		if (null == valParams) throw new java.lang.Exception (&quot;BondComponent::tradeable =&gt; invalid Inputs&quot;);</span>

<span class="nc bnc" id="L1684" title="All 4 branches missed.">		return !_terminationSetting.exercised() &amp;&amp; !_terminationSetting.defaulted() &amp;&amp; valParams.valueDate()</span>
<span class="nc bnc" id="L1685" title="All 2 branches missed.">			&lt; maturityDate().julian();</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule callSchedule()
	{
<span class="fc" id="L1690">		return _eosCall;</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule putSchedule()
	{
<span class="fc" id="L1695">		return _eosPut;</span>
	}

	@Override public java.lang.String couponType()
	{
<span class="nc bnc" id="L1700" title="All 2 branches missed.">		return null == _couponSetting ? &quot;&quot; : _couponSetting.couponType();</span>
	}

	@Override public java.lang.String couponDC()
	{
<span class="pc bpc" id="L1705" title="1 of 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.couponDC();</span>
	}

	@Override public java.lang.String accrualDC()
	{
<span class="nc bnc" id="L1710" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.accrualDC();</span>
	}

	@Override public java.lang.String maturityType()
	{
<span class="nc bnc" id="L1715" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : maturityType();</span>
	}

	@Override public org.drip.analytics.date.JulianDate finalMaturity()
	{
<span class="nc bnc" id="L1720" title="All 2 branches missed.">		return null == _stream ? null : new org.drip.analytics.date.JulianDate (_stream.finalMaturityDate());</span>
	}

	@Override public java.lang.String calculationType()
	{
<span class="nc bnc" id="L1725" title="All 2 branches missed.">		return null == _quoteConvention ? &quot;&quot; : _quoteConvention.calculationType();</span>
	}

	@Override public double redemptionValue()
	{
<span class="nc bnc" id="L1730" title="All 2 branches missed.">		return null == _quoteConvention ? java.lang.Double.NaN : _quoteConvention.redemptionValue();</span>
	}

	@Override public java.lang.String currency()
	{
<span class="fc" id="L1735">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String redemptionCurrency()
	{
<span class="nc" id="L1740">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public boolean inFirstCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1747">		return _stream.firstPeriod().contains (iDate);</span>
	}

	@Override public boolean inLastCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1754">		return _stream.lastPeriod().contains (iDate);</span>
	}

	@Override public java.lang.String floatCouponConvention()
	{
<span class="nc bnc" id="L1759" title="All 2 branches missed.">		return null == _floaterSetting ? null : _floaterSetting.dayCount();</span>
	}

	@Override public org.drip.analytics.date.JulianDate periodFixingDate (
		final int iValueDate)
	{
<span class="nc bnc" id="L1765" title="All 4 branches missed.">		if (null == _floaterSetting || iValueDate &gt;= maturityDate().julian()) return null;</span>

<span class="nc bnc" id="L1767" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1768" title="All 2 branches missed.">			if (period.payDate() &lt; iValueDate) continue;</span>

<span class="nc" id="L1770">			org.drip.analytics.cashflow.ComposableUnitPeriod cup = period.periods().get (0);</span>

<span class="nc bnc" id="L1772" title="All 2 branches missed.">			if (!(cup instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)) continue;</span>

			try {
<span class="nc" id="L1775">				return new org.drip.analytics.date.JulianDate</span>
					(((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)
<span class="nc" id="L1777">						(cup)).referenceIndexPeriod().fixingDate());</span>
<span class="nc" id="L1778">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
<span class="nc" id="L1781">		}</span>

<span class="nc" id="L1783">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate previousCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="pc bpc" id="L1789" title="2 of 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="fc" id="L1792">			int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="fc bfc" id="L1794" title="All 2 branches covered.">			if (0 == iIndex) return new org.drip.analytics.date.JulianDate (_stream.period (0).startDate());</span>
			
<span class="fc" id="L1796">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex - 1);</span>

<span class="pc bpc" id="L1798" title="1 of 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1799">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1803">		return null;</span>
	}

	@Override public double previousCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1811" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1812">			throw new java.lang.Exception (&quot;BondComponent::previousCouponRate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1814">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1815">			(dt.julian()) - 1);</span>

<span class="nc bnc" id="L1817" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1818">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Cannot find previous period!&quot;);

<span class="nc" id="L1821">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1824" title="All 2 branches missed.">		if (null == cpcm)</span>
<span class="nc" id="L1825">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Invalid previous period metrics!&quot;);

<span class="nc" id="L1828">		return cpcm.rate();</span>
	}

	@Override public org.drip.analytics.date.JulianDate currentCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1834" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1837">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1838">				(dt.julian()));</span>

<span class="nc bnc" id="L1840" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1841">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1844">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate nextCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1850" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1853">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1854">				(dt.julian()) + 1);</span>

<span class="nc bnc" id="L1856" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1857">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1860">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseDateOfType (
		final org.drip.analytics.date.JulianDate dt,
		final boolean bPut)
	{
<span class="nc bnc" id="L1867" title="All 10 branches missed.">		if (null == dt || (bPut &amp;&amp; null == _eosPut) || (!bPut &amp;&amp; null == _eosCall)) return null;</span>

<span class="nc bnc" id="L1869" title="All 2 branches missed.">		org.drip.product.params.EmbeddedOptionSchedule eos = bPut ? _eosPut : _eosCall;</span>

<span class="nc" id="L1871">		int[] aiEOSExerciseDates = eos.dates();</span>

<span class="nc bnc" id="L1873" title="All 4 branches missed.">		if (null == eos || null == aiEOSExerciseDates) return null;</span>

<span class="nc" id="L1875">		int iNumExerciseDates = aiEOSExerciseDates.length;</span>

<span class="nc bnc" id="L1877" title="All 2 branches missed.">		if (0 == iNumExerciseDates) return null;</span>

<span class="nc bnc" id="L1879" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumExerciseDates; ++i) {</span>
<span class="nc bnc" id="L1880" title="All 2 branches missed.">			if (aiEOSExerciseDates[i] - dt.julian() &lt; eos.exerciseNoticePeriod())</span>
<span class="nc" id="L1881">				continue;</span>

			try {
<span class="nc bnc" id="L1884" title="All 2 branches missed.">				return new org.drip.analytics.output.ExerciseInfo (aiEOSExerciseDates[i], eos.factor (i),</span>
					bPut ? org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT :
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L1887">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1890">				return null;</span>
			}
		}

<span class="nc" id="L1894">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseInfo (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1900" title="All 2 branches missed.">		if (null == dt) return null;</span>

<span class="nc" id="L1902">		org.drip.analytics.output.ExerciseInfo neiNextCall = nextValidExerciseDateOfType (dt, false);</span>

<span class="nc" id="L1904">		org.drip.analytics.output.ExerciseInfo neiNextPut = nextValidExerciseDateOfType (dt, true);</span>

<span class="nc bnc" id="L1906" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null == neiNextPut) {</span>
			try {
<span class="nc" id="L1908">				return new org.drip.analytics.output.ExerciseInfo (maturityDate().julian(), 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L1910">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1913">				return null;</span>
			}
		}

<span class="nc bnc" id="L1917" title="All 4 branches missed.">		if (null != neiNextCall &amp;&amp; null == neiNextPut) return neiNextCall;</span>

<span class="nc bnc" id="L1919" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null != neiNextPut) return neiNextPut;</span>

<span class="nc bnc" id="L1921" title="All 2 branches missed.">		return neiNextCall.date() &lt; neiNextPut.date() ? neiNextCall : neiNextPut;</span>
	}

	@Override public double currentCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1929" title="All 4 branches missed.">		if (null == dt || null == csqc)</span>
<span class="nc" id="L1930">			throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc bnc" id="L1932" title="All 2 branches missed.">		if (null != _floaterSetting) {</span>
<span class="nc" id="L1933">			double dblCurrentFullCoupon = _floaterSetting.currentFullCoupon();</span>

<span class="nc bnc" id="L1935" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblCurrentFullCoupon))</span>
<span class="nc" id="L1936">				return dblCurrentFullCoupon;</span>
		}

<span class="nc" id="L1939">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (dt.julian(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1942" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1944">		return pcm.rate();</span>
	}

	@Override public double nextCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1952" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1953">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc" id="L1955">		int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="nc" id="L1957">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex + 1);</span>

<span class="nc bnc" id="L1959" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1960">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Cannot find next period!&quot;);</span>

<span class="nc" id="L1962">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1965" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1967">		return pcm.rate();</span>
	}

	@Override public double accrued (
		final int iDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L1975">		org.drip.analytics.date.JulianDate dt = new org.drip.analytics.date.JulianDate (iDate);</span>

<span class="pc bpc" id="L1977" title="1 of 2 branches missed.">		if (iDate &gt;= maturityDate().julian())</span>
<span class="nc" id="L1978">			throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Val date &quot; + dt +</span>
<span class="nc" id="L1979">				&quot; greater than maturity &quot; + maturityDate());</span>

<span class="fc" id="L1981">		org.drip.param.valuation.ValuationParams valParams = new org.drip.param.valuation.ValuationParams</span>
			(dt, dt, &quot;&quot;);

<span class="fc bfc" id="L1984" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1985">			int iEndDate = period.endDate();</span>

<span class="fc" id="L1987">			int iStartDate = period.startDate();</span>

<span class="fc bfc" id="L1989" title="All 4 branches covered.">			if (iStartDate &lt; iDate &amp;&amp; iEndDate &gt;= iDate) {</span>
<span class="fc" id="L1990">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iEndDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L1993" title="1 of 2 branches missed.">				if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; No PCM&quot;);</span>

<span class="fc" id="L1995">				double dblCoupon = cpcm.rate();</span>

<span class="pc bpc" id="L1997" title="1 of 2 branches missed.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblCoupon))</span>
<span class="nc" id="L1998">					throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Invalid Coupon For &quot; + dt);</span>

<span class="fc" id="L2000">				return period.accrualDCF (iDate) * dblCoupon * notional (iStartDate) * couponFactor</span>
<span class="fc" id="L2001">					(iEndDate);</span>
			}
<span class="fc" id="L2003">		}</span>

<span class="fc" id="L2005">		return 0.;</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2015" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2016">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2018">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2020" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2021">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Val date &quot; +</span>
<span class="nc" id="L2022">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2023">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2025">		int iPeriodEndDate = 0;</span>
<span class="fc" id="L2026">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2027">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2028">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2029">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2031" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2032">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2034" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2036" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2037">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2039" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2041">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2043">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2045">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2046" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2048" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2049">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2050">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2051">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2054">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2057" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2058">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2060">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2062">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2064">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2066">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2068" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2069">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2070" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2071">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2072" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2074">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2076">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2077">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2079" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2080">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2082" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2083">				cpcm.rate()) * couponFactor (iPeriodEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2086">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2087">			iPeriodEndDate += (iAccrualEndDate - iAccrualStartDate);</span>
<span class="fc" id="L2088">			dblTimeWeightedTotalCashflow += iPeriodEndDate * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2090" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2091">		}</span>

<span class="fc" id="L2093">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2095">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2096">		dblTimeWeightedTotalCashflow += iPeriodEndDate * dblTerminalCashflow;</span>
<span class="fc" id="L2097">		return (int) (dblTimeWeightedTotalCashflow / dblTotalCashflow);</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2105">		return weightedAverageMaturityDate (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2115" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2116">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2118">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2120" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2121">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Val date &quot; +</span>
<span class="nc" id="L2122">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2123">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2125">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2126">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2127">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2128">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2129">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2131" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2132">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2134" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2136" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2137">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2139" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2141">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2143">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2145">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2146" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2148" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2149">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2150">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2151">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2154">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2157" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2158">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2160">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2162">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2164">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2166">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2168" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2169">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2170" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2171">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2172" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2174">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2176">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2177">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2179" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2180">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2182" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2183">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2186">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2187">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2188">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2190" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2191">		}</span>

<span class="fc" id="L2193">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2195">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2196">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2197">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2205">		return weightedAverageLife (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2215" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2216">			throw new java.lang.Exception</span>
				(&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Invalid Inputs&quot;);

<span class="fc" id="L2219">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2221" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2222">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2223">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2224">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2226">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2227">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2228">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2229">		double dblTimeWeightedTotalCashflow = 0.;</span>

<span class="pc bpc" id="L2231" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2232">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2234" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2236">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2238">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2240">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2241" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2243" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2244">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2245">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2246">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2249">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2251">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2253">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2254">				(iAccrualStartDate);</span>

<span class="fc" id="L2256">			double dblPeriodCashflow = dblPeriodStartNotional - dblPeriodEndNotional;</span>
<span class="fc" id="L2257">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>
<span class="fc" id="L2258">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2259">			dblPeriodEndTime += dblPeriodTimeWidth;</span>

<span class="fc bfc" id="L2261" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2262">		}</span>

<span class="fc" id="L2264">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2266">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2267">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2268">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2276">		return weightedAverageLifePrincipalOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2286" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2287">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2289">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2291" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2292">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2293">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2294">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2296">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2297">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2298">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2299">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2300">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2302" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2303">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2305" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2307" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2308">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2310" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2312">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2314">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2316">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2317" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2319" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2320">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2321">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2322">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2325">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2328" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2329">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2331">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2333">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2335">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2337">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2339" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2340">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2341" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2342">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2343" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2345">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2347">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2348">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2350" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2351">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2353" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2354">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L2356">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2357">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2358">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2360" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2361">		}</span>

<span class="fc" id="L2363">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2371">		return weightedAverageLifeCouponOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2381" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2382">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2384">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2386">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2388" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2389">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2391">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2392">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2393">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2394">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2395">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2397" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2398">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2400" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2402" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2403">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2405" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2407">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2409">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2411">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2412" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2414" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2415">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2416">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2417">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2420">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2423" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2424">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2426">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2428">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2430">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2432">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2434" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2435">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2436" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2437">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2438" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2440">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2442">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2443">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2445" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2446">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2448" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2449">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2450">					dblPeriodEndNotional) * cc.survival (iPeriodPayDate) * (1. - cc.effectiveRecovery</span>
<span class="fc" id="L2451">						(iPeriodStartDate, period.endDate()));</span>

<span class="fc" id="L2453">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2454">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2455">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2457" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2458">		}</span>

<span class="fc" id="L2460">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * cc.survival</span>
<span class="fc" id="L2461">			(iWorkoutDate) * (1. - cc.recovery (iWorkoutDate));</span>

<span class="fc" id="L2463">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2464">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2465">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2473">		return weightedAverageLifeLossOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2483" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2484">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2486">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2488">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2490" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2491">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2493">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2494">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2495">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2496">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2497">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2499" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2500">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2502" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2504" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2505">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2507" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2509">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2511">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2513">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2514" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2516" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2517">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2518">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2519">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2522">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2525" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2526">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2528">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2530">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2532">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2534">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2536" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2537">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2538" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2539">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2540" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2542">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2544">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2545">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2547" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2548">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc" id="L2550">			double dblPeriodSurvival = cc.survival (iPeriodPayDate);</span>

<span class="pc bpc" id="L2552" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2553">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional) * (dblPeriodSurvival * (1. - cc.effectiveRecovery
<span class="fc" id="L2555">						(iPeriodStartDate, iNotionalEndDate)) + 1. - dblPeriodSurvival);</span>

<span class="fc" id="L2557">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2558">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2559">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2561" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2562">		}</span>

<span class="fc" id="L2564">		double dblTerminalSurvival = cc.survival (iWorkoutDate);</span>

<span class="fc" id="L2566">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * (dblTerminalSurvival *</span>
<span class="fc" id="L2567">			(1. - cc.recovery (iWorkoutDate)) + 1. - dblTerminalSurvival);</span>

<span class="fc" id="L2569">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2570">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2571">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2579">		return weightedAverageLifeCredit (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double priceFromZeroCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iZeroCurveBaseDC,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2592" title="1 of 2 branches missed.">		if (null == valParams)</span>
<span class="nc" id="L2593">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2595">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2597" title="1 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == csqc || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L2598" title="2 of 4 branches missed.">			(dblWorkoutFactor) || !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="fc" id="L2599">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs &quot; + dblBump);</span>

<span class="fc" id="L2601">		double dblPV = 0.;</span>
<span class="fc" id="L2602">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2603">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L2604">		org.drip.state.discount.ZeroCurve zc = null;</span>
<span class="fc" id="L2605">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2606">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2608" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2609">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2611" title="1 of 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L2612">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="fc bfc" id="L2614" title="All 2 branches covered.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="fc" id="L2615">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2617" title="1 of 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc bfc" id="L2620" title="All 2 branches covered.">		org.drip.state.discount.DiscountCurve dcBase = ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE ==</span>
<span class="fc" id="L2621">			iZeroCurveBaseDC ? csqc.fundingState (fundingLabel()) : csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L2623" title="All 2 branches covered.">		if (null == dcBase)</span>
<span class="fc" id="L2624">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Discount Curve&quot;);</span>

		try {
<span class="fc bfc" id="L2627" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L2628">				valParams.cashPayDate();</span>
<span class="nc" id="L2629">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2632">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2633">		}</span>

<span class="fc" id="L2635">		java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; lsCompositePeriod = couponPeriods();</span>

		try {
<span class="fc" id="L2638">			zc = org.drip.state.curve.DerivedZeroRate.FromBaseCurve (freq(), couponDC(), currency(),</span>
<span class="pc bpc" id="L2639" title="1 of 4 branches missed.">				_stream.couponEOMAdjustment(), lsCompositePeriod, terminationAdjust (iWorkoutDate),</span>
					iValueDate, iCashPayDate, dcBase, dblBump, null == vcp ? (null == _quoteConvention ? null
<span class="pc" id="L2641">						: _quoteConvention.valuationCustomizationParams()) : vcp, new</span>
							org.drip.spline.params.SegmentCustomBuilderControl
								(org.drip.spline.stretch.MultiSegmentSequenceBuilder.BASIS_SPLINE_POLYNOMIAL,
									new org.drip.spline.basis.PolynomialFunctionSetParams (2),
<span class="fc" id="L2645">										org.drip.spline.params.SegmentInelasticDesignControl.Create (0, 2),</span>
											new org.drip.spline.params.ResponseScalingShapeControl (true, new
												org.drip.function.r1tor1.QuadraticRationalShapeControl (0.)),
													null));
<span class="nc" id="L2649">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L2650">			e.printStackTrace();</span>
<span class="fc" id="L2651">		}</span>

<span class="pc bpc" id="L2653" title="1 of 2 branches missed.">		if (null == zc)</span>
<span class="nc" id="L2654">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Cannot create shifted ZC&quot;);</span>

<span class="pc bpc" id="L2656" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : lsCompositePeriod) {</span>
<span class="fc" id="L2657">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2659" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2661">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2663">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2665">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L2667">			int iNotionalEndDate = iAccrualEndDate;</span>
<span class="fc" id="L2668">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2670">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc bfc" id="L2672" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2673">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2674">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2675">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2678">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START ==</span>
<span class="fc bfc" id="L2679" title="All 2 branches covered.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2680">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="fc" id="L2681">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END ==</span>
<span class="pc bpc" id="L2682" title="1 of 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2683">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc" id="L2684">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
<span class="nc bnc" id="L2685" title="All 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="nc" id="L2686">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2688">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2691" title="1 of 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2693" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2694">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2696" title="1 of 2 branches missed.">			dblPV += (period.accrualDCF (iAccrualEndDate) * (bApplyFlatForwardRate ? dblFlatForwardRate :</span>
<span class="fc" id="L2697">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2698">					dblPeriodEndNotional) * zc.df (iPeriodPayDate);</span>

<span class="fc bfc" id="L2700" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2701">		}</span>

<span class="fc" id="L2703">		return ((dblPV + dblWorkoutFactor * zc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L2704">			(iWorkoutDate)) / zc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	@Override public double priceFromFundingCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="fc" id="L2715">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_FUNDING_CURVE);
	}

	@Override public double priceFromTreasuryCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="nc" id="L2727">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_TREASURY_CURVE);
	}

	@Override public double priceFromCreditCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis,
		final boolean bFlat)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2740" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L2741" title="1 of 4 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblCreditBasis) || null == _creditSetting)</span>
<span class="fc" id="L2742">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2744">		org.drip.state.credit.CreditCurve ccIn = csqc.creditState (creditLabel());</span>

<span class="fc bfc" id="L2746" title="All 2 branches covered.">		if (null == ccIn)</span>
<span class="fc" id="L2747">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2749">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L2751" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L2752">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No funding curve&quot;);</span>

<span class="fc" id="L2754">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2756" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2757">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L2758">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2759">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="pc bpc" id="L2761" title="1 of 2 branches missed.">		double dblRecoveryToUse = !_creditSetting.useCurveRecovery() ? _creditSetting.recovery() :</span>
			java.lang.Double.NaN;

<span class="pc bpc" id="L2764" title="1 of 2 branches missed.">		org.drip.state.credit.CreditCurve cc = bFlat ? ccIn.flatCurve (dblCreditBasis, true,</span>
			dblRecoveryToUse) : (org.drip.state.credit.CreditCurve) ccIn.parallelShiftManifestMeasure
<span class="fc" id="L2766">				(&quot;SwapRate&quot;, dblCreditBasis);</span>

<span class="pc bpc" id="L2768" title="1 of 2 branches missed.">		if (null == cc)</span>
<span class="nc" id="L2769">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromCreditCurve =&gt; Cannot create adjusted Curve&quot;);

<span class="fc" id="L2772">		double dblPV = 0.;</span>
<span class="fc" id="L2773">		boolean bTerminateCashFlow = false;</span>
<span class="fc" id="L2774">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2775">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2777" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2778">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2780" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2781">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2783" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="fc" id="L2785">		org.drip.param.pricer.CreditPricerParams pricerParams = new org.drip.param.pricer.CreditPricerParams</span>
			(7, null, false, s_iDiscretizationScheme);

<span class="fc" id="L2788">		int iLossPayLag = _creditSetting.lossPayLag();</span>

<span class="fc" id="L2790">		boolean bAccrualOnDefault = _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L2792">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2794" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc bfc" id="L2795" title="All 2 branches covered.">			if (bTerminateCashFlow) continue;</span>

<span class="fc" id="L2797">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2799" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2801">			int iPeriodEndDate = period.endDate();</span>

<span class="fc bfc" id="L2803" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2804">				bTerminateCashFlow = true;</span>
<span class="fc" id="L2805">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2808">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L2810" title="All 2 branches covered.">			if (iPeriodStartDate &lt; iValueDate) iPeriodStartDate = iValueDate;</span>

<span class="fc" id="L2812">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2815" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2816">				throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2818" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2819">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2821" title="1 of 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="fc" id="L2823">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2825">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L2827">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L2829" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2830">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L2831" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2832">				dblCouponNotional = notional (iPeriodEndDate);</span>
<span class="nc bnc" id="L2833" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2835">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc" id="L2837">			dblPV += (period.accrualDCF (iPeriodEndDate) * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dcFunding.df
<span class="fc" id="L2839">					(iPeriodPayDate) * cpcm.cumulative() * cc.survival (iPeriodEndDate);</span>

<span class="fc bfc" id="L2841" title="All 2 branches covered.">			for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this, valParams,</span>
				pricerParams, iPeriodEndDate, csqc)) {
<span class="pc bpc" id="L2843" title="1 of 2 branches missed.">				if (null == lqm) continue;</span>

<span class="fc" id="L2845">				int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L2847">				int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L2849">				double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
					iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L2852">				double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L2854">				double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L2855">					(iSubPeriodEndDate);</span>

<span class="fc bfc" id="L2857" title="All 2 branches covered.">				if (bAccrualOnDefault)</span>
<span class="fc" id="L2858">					dblPV += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival * dblSubPeriodDF *</span>
						dblSubPeriodNotional * dblPeriodCoupon;

<span class="pc bpc" id="L2861" title="1 of 2 branches missed.">				dblPV += (_creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
<span class="pc" id="L2862">					iSubPeriodEndDate) : _creditSetting.recovery()) * dblSubPeriodSurvival *</span>
						dblSubPeriodNotional * dblSubPeriodDF;
<span class="fc" id="L2864">			}</span>
<span class="fc" id="L2865">		}</span>

		try {
<span class="pc bpc" id="L2868" title="1 of 2 branches missed.">			iCashPayDate = null == _quoteConvention ? valParams.cashPayDate() : _quoteConvention.settleDate</span>
<span class="fc" id="L2869">				(valParams);</span>
<span class="nc" id="L2870">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2873">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2874">		}</span>

<span class="fc" id="L2876">		return ((dblPV + dblWorkoutFactor * dcFunding.df (terminationAdjust (iWorkoutDate)) * cc.survival</span>
<span class="fc" id="L2877">			(iWorkoutDate) * notional (iWorkoutDate)) / dcFunding.df (iCashPayDate) - accrued (iValueDate,</span>
				csqc)) / dblScalingNotional;
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2890">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L2891">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2901">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2911" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2912">			throw new java.lang.Exception (&quot;BondComponent::aswFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Bond Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2915">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2927">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L2928">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2938">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2948" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2949">			throw new java.lang.Exception (&quot;BondComponent::aswFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Credit Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2952">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2964">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L2965">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2975">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2985" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2986">			throw new java.lang.Exception (&quot;BondComponent::aswFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L2989">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3001">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3002">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3012">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3022" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3023">			throw new java.lang.Exception (&quot;BondComponent::aswFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3026">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3038">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L3039">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3049">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3059" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3060">			throw new java.lang.Exception (&quot;BondComponent::aswFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3063">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3075">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L3076">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3086">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3096" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3097">			throw new java.lang.Exception (&quot;BondComponent::aswFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3100">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3112">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L3113">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3123">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3133" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3134">			throw new java.lang.Exception (&quot;BondComponent::aswFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3137">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3149">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L3150">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3160">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3170" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3171">			throw new java.lang.Exception (&quot;BondComponent::aswFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3174">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3186">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3197">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3207" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3208">			throw new java.lang.Exception (&quot;BondComponent::aswFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3211">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3223">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L3224">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3234">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3244" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3245">			throw new java.lang.Exception (&quot;BondComponent::aswFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3248">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3260" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L3261" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L3262">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3264">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L3266" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L3267">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3269">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="pc bpc" id="L3272" title="1 of 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; No CPCM&quot;);</span>

<span class="fc" id="L3274">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L3276" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L3277">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3279">		return cpcm.rate() - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + 0.0001 *</span>
<span class="fc" id="L3280">			(dblWorkoutFactor - dblPrice) / dcFunding.parSwapDV01 (iWorkoutDate);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3290">		return aswFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double aswFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3300">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L3302" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3303">			throw new java.lang.Exception</span>
				(&quot;BondComponent::aswFromPriceToOptimalExercise =&gt; Can't determine Optimal Work-out&quot;);

<span class="nc" id="L3306">		return aswFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L3318">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="fc" id="L3319">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3329">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3339" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3340">			throw new java.lang.Exception (&quot;BondComponent::aswFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3343">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3355">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3366">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3376" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3377">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3380">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3392">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L3393">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3403">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3413" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3414">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3417">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3429">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L3430">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3440">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double aswFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3450" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3451">			throw new java.lang.Exception (&quot;BondComponent::aswFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3454">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3466">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L3467">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3477">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3487" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3488">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3491">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3503">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3504">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3514">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3524" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3525">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3528">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3540">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3541">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3552">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3563" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3564">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3567">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3580">		return bondBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3581">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3591">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3601" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3602">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3605">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3617">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L3618">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3628">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3638" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3639">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3642">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3654">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L3655">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3665">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3675" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3676">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3679">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3691">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L3692">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3702">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3712" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3713">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3716">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3728">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L3729">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3739">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3749" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3750">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3753">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3765">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L3766">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3776">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3786" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3787">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3790">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3802">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L3803">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3813">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3823" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3824">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3827">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3839">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L3840">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3850">		return bondBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double bondBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3860">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>
		
<span class="nc bnc" id="L3862" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3863">			throw new java.lang.Exception</span>
				(&quot;BondComponent::bondBasisFromPriceToOptimalExercise =&gt; cant calc Work-out info&quot;);

<span class="nc" id="L3866">		return bondBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3878">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L3879">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3889">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3899" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3900">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3903">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3915" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L3916">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L3918">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L3919">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3929">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3939" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3940">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3943">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3955">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3956">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3966">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3976" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3977">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3980">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3992">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L3993">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4003">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4013" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4014">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4017">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4029">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4030">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4040">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4050" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4051">			throw new java.lang.Exception (&quot;BondComponent::convexityFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4054">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4066">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L4067">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4077">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4087" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4088">			throw new java.lang.Exception (&quot;BondComponent::convexityFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4091">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4103">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4104">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4114">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4124" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4125">			throw new java.lang.Exception (&quot;BondComponent::convexityFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4128">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4140">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4141">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4152">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4163" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4164">			throw new java.lang.Exception (&quot;BondComponent::convexityFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Convexity from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4167">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4180">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4181">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4191">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4201" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4202">			throw new java.lang.Exception (&quot;BondComponent::convexityFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4205">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4217">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4218">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4228">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4238" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4239">			throw new java.lang.Exception (&quot;BondComponent::convexityFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4242">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4254">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4255">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4265">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4275" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4276">			throw new java.lang.Exception (&quot;BondComponent::convexityFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4279">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4291">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4292">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4302">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4312" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4313">			throw new java.lang.Exception (&quot;BondComponent::convexityFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4316">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4328">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4329">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4339">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4349" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4350">			throw new java.lang.Exception (&quot;BondComponent::convexityFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4353">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4365">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4366">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4376">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4386" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4387">			throw new java.lang.Exception (&quot;BondComponent::convexityFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4390">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4402">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4403">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4413">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4423" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4424">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4427">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L4439" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L4440">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc" id="L4442">		double dblYield = yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>

<span class="fc" id="L4444">		return (priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield - 0.0001) +</span>
<span class="fc" id="L4445">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001) - 2. *</span>
<span class="fc" id="L4446">				dblPrice) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4456">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4466" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4467">			throw new java.lang.Exception (&quot;BondComponent::calcConvexityFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4470">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4482">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L4483">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4493">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4503" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4504">			throw new java.lang.Exception (&quot;BondComponent::convexityFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4507">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4519">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L4520">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4530">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4540" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4541">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4544">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4556">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L4557">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4567">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4577" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4578">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4581">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4593">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L4594">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4604">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4614" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4615">			throw new java.lang.Exception (&quot;BondComponent::convexityFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4618">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4630">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4631">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4641">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4651" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4652">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Credit Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4655">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4667">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4668">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4678">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4688" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4689">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4692">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4704">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4705">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4716">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4727" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4728">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Credit Basis from Discnt Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4732">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4745">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4746">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4756">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4766" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4767">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4770">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4782">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4783">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4793">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4803" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4804">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4807">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4819">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4820">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4830">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4840" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4841">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4844">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4856">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4857">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4867">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4877" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4878">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4881">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4893">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4894">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4904">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4915">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4918">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4930">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4931">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4941">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4951" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4952">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4955">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4967">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4968">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4978">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4989">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4992">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5004">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, false);
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5015">		return creditBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double creditBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5025">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5027" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5028">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromPriceToOptimalExercise =&gt; cant calc Work-out&quot;);

<span class="nc" id="L5031">		return creditBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L5043">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5044">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5054">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5064" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5065">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5068">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5080">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L5081">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5091">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5101" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5102">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5105">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5117">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5118">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5128">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws	java.lang.Exception
	{
<span class="nc bnc" id="L5139" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5140">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5143">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5156">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L5157">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5167">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5177" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5178">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5181">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5193">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L5194">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5204">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5214" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5215">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5218">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5230">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5231">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5241">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5251" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5252">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5255">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5267">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5268">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5278">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5289" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5290">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Crdit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5294">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5307">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5308">			yieldFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5318">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5328" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5329">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromESpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5332">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5344">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5345">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5355">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5365" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5366">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromGSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5369">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5381">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5382">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5392">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5402" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5403">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromISpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5406">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5418">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5419">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5429">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5439" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5440">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromJSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5443">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5455">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5456">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5466">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5476" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5477">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromNSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5480">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5492">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L5493">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5503">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5513" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5514">			throw new java.lang.Exception (&quot;BondComponent::calcDiscountMarginFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5517">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5529">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L5530">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5540">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5550" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5551">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5554">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5566">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5567">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5577">		return discountMarginFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double discountMarginFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5587">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5589" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5590">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L5593">		return discountMarginFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5605">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5606">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5616">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5626" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5627">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromTSYSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5630">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L5642" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L5643">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5645">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L5647" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L5648">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5650">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L5652">		int iFreq = freq();</span>

<span class="fc" id="L5654">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L5656" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L5657">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L5659" title="1 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
<span class="fc" id="L5660">			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblYield - dcFunding.libor (iValueDate,</span>
<span class="fc" id="L5661">				((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblYield - indexRate (iValueDate, csqc,</span>
					(org.drip.analytics.cashflow.CompositeFloatingPeriod) cp);
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5672">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5682" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5683">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5686">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5698">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5699">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5709">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5720" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5721">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5725">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5738">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5739">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5749">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5759" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5760">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromZSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5763">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5775">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L5776">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5786">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5796" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5797">			throw new java.lang.Exception (&quot;BondComponent::durationFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5800">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5812">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L5813">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5823">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5833" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5834">			throw new java.lang.Exception (&quot;BondComponent::durationFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5837">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5849">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5850">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5860">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5870" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5871">			throw new java.lang.Exception (&quot;BondComponent::durationFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5874">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5886">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5887">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5898">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5909" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5910">			throw new java.lang.Exception (&quot;BondComponent::durationFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Duration from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5913">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5926">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L5927">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5937">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5947" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5948">			throw new java.lang.Exception (&quot;BondComponent::durationFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5951">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5963">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L5964">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5974">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5984" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5985">			throw new java.lang.Exception (&quot;BondComponent::durationFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5988">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6000">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6001">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6011">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6021" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6022">			throw new java.lang.Exception (&quot;BondComponent::durationFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6025">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6037">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6038">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6048">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6058" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6059">			throw new java.lang.Exception (&quot;BondComponent::durationFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6062">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6074">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6075">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6085">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6095" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6096">			throw new java.lang.Exception (&quot;BondComponent::durationFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6099">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6111">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6112">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6122">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6132" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6133">			throw new java.lang.Exception (&quot;BondComponent::durationFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6136">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6148">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6149">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6159">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6169" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6170">			throw new java.lang.Exception (&quot;BondComponent::durationFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6173">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6185">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6195">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6205" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6206">			throw new java.lang.Exception (&quot;BondComponent::durationFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6209">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6221">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6222">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6232">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6242" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6243">			throw new java.lang.Exception (&quot;BondComponent::durationFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6246">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6258">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6259">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6269">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6279" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6280">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6283">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6295">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6296">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6306">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6316" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6317">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6320">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6332">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L6333">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6343">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6353" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6354">			throw new java.lang.Exception (&quot;BondComponent::durationFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6357">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6369">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L6370">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6380">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6390" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6391">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6394">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6406">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L6407">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6417">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6427" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6428">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6431">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6443">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L6444">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6454">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6464" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6465">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6468">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6480">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6481">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6492">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6503" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6504">			throw new java.lang.Exception</span>
				(&quot;BondComponent::eSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc E Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6508">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6521">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L6522">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6532">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6542" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6543">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6546">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6558">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6559">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6569">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6579" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6580">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6583">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6595">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6596">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6606">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6616" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6617">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6620">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6632">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6633">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6643">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6653" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6654">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6657">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6669">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6670">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6680">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6690" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6691">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6694">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6706">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6707">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6717">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6727" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6728">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6731">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6743">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6754">		return eSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double eSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6764">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L6766" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L6767">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6770">		return eSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6782">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6783">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6793">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6803" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6804">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6807">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6819">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6820">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6830">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6840" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6841">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6844">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6856">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L6857">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6867">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double eSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6877" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6878">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6881">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6893">		return gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L6894">			(valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6904">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6915">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6918">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6930">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L6931">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6941">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6951" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6952">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6955">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6967">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L6968">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6978">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6989">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6992">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7004">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7005">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7016">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7027" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7028">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc G Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7031">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7044">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7045">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7055">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7065" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7066">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7069">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7081">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L7082">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7092">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7102" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7103">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7106">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7118">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7119">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7129">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7139" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7140">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7143">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7155">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7156">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7166">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7176" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7177">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7180">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7192">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7193">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7203">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7213" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7214">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7217">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7229">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7230">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7240">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7250" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7251">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7254">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7266">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7267">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7277">		return gSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double gSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7287">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7289" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7290">			throw new java.lang.Exception</span>
				(&quot;BondComponent::gSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7293">		return gSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7305">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7306">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7316">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7326" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7327">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7330">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7342" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield) ||</span>
<span class="pc bpc" id="L7343" title="1 of 2 branches missed.">			valParams.valueDate() &gt;= iWorkoutDate)</span>
<span class="nc" id="L7344">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7346">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L7348" title="All 2 branches covered.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7350">		return dblYield - gc.yield (iWorkoutDate);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7360">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7370" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7371">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7374">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7386">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7387">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7397">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7407" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7408">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7411">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7423">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7424">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7434">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double gSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7444" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7445">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7448">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7460">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7461">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7471">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7481" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7482">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7485">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7497">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L7498">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7508">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7518" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7519">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7522">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7534">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L7535">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7545">		return iSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7555" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7556">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7559">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7571">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7572">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7583">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7594" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7595">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc I Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7598">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7611">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7612">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7622">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7632" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7633">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7636">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7648">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L7649">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7659">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7669" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7670">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7673">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7685">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7686">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7696">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7706" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7707">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7710">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7722">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7723">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7733">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7743" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7744">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7747">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7759">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7760">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7770">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7780" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7781">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7784">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7796">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7797">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7807">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7817" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7818">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7821">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7833">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7834">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7844">		return iSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double iSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7854">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7856" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7857">			throw new java.lang.Exception</span>
				(&quot;BondComponent::iSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7860">		return iSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7872">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7873">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7883">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7893" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7894">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7897">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7909" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L7910">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7912">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L7914" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L7915">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7917">		return dblYield - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7927">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7937" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7938">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7941">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7953">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7954">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7964">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7974" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7975">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7978">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7990">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7991">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8001">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8011" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8012">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8015">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8027">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L8028">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8038">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8048" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8049">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8052">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8064">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L8065">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8075">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8085" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8086">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8089">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8101">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L8102">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8112">		return jSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8122" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8123">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8126">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8138">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8139">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8150">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8161" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8162">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc J Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8165">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8178">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L8179">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8189">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8199" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8200">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8203">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8215">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L8216">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8226">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8236" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8237">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8240">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8252">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L8253">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8263">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8273" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8274">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8277">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8289">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L8290">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8300">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8310" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8311">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8314">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8326">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L8327">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8337">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8347" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8348">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8351">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8363">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L8364">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8374">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8384" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8385">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8388">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8400">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L8401">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8411">		return jSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double jSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8421">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L8423" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L8424">			throw new java.lang.Exception</span>
				(&quot;BondComponent::jSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L8427">		return jSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8439">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L8440">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8450">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8460" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8461">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8464">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L8476" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L8477">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8479">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="pc bpc" id="L8481" title="1 of 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8483">		return dblYield - gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L8494">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8504" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8505">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8508">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8520">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L8521">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8531">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8541" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8542">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8545">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8557">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8558">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8568">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8578" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8579">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8582">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8594">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8595">			yieldFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8605">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8615" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8616">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8620">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8632">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8633">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8643">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8654" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8655">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8659">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8672">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8673">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8683">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8694" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8695">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8699">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8712">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8713">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8724">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8735" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8736">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8740">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8753">		return macaulayDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8754">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8764">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8774" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8775">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8779">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8791">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8792">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8802">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8812" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8813">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8817">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8829">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8830">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8840">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8850" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8851">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8855">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8867">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8868">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8878">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8888" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8889">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8893">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8905">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8906">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8916">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8926" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8927">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8931">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8943">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8944">			yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8954">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double mnacaulayDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8964" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8965">			throw new java.lang.Exception</span>
				(&quot;BondComponent::mnacaulayDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8969">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8981">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8982">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8992">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9002" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9003">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9007">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9019">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9020">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9030">		return macaulayDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double macaulayDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9040">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9042" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9043">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9046">		return macaulayDurationFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9058">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9059">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9069">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9080" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9081">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9085">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9098" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L9099">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9101">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L9103" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L9104">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9106">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L9107">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L9108">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L9109">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L9110">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L9111">		double dblCumulativePeriodDuration = 0.;</span>
<span class="fc" id="L9112">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L9113">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>
<span class="fc" id="L9114">		org.drip.analytics.cashflow.CompositePeriod periodRef = null;</span>

<span class="fc" id="L9116">		int iFrequency = freq();</span>

<span class="fc" id="L9118">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L9120">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L9122">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L9124" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L9126" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L9127">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L9129" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L9130">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L9132">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L9134">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L9136">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L9138">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L9139" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L9140">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L9142">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L9144">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L9146">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L9148">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L9151">		int iAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L9153" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L9154">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L9156" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L9158" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L9159">				bFirstPeriod = false;</span>

<span class="fc" id="L9161">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L9163">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L9165">			periodRef = period;</span>

<span class="fc" id="L9167">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L9169">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L9171" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L9172">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L9173">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L9176">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L9179" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L9180">				throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; No CPCM&quot;);</span>

<span class="pc bpc" id="L9182" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L9183" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L9184">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L9186" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L9187" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L9188">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L9191">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L9194">			double dblYearFract = org.drip.analytics.daycount.Convention.YearFraction (iValueDate,</span>
				iPeriodPayDate, strDC, bApplyCpnEOMAdj, aap, strCalendar);

<span class="fc" id="L9197">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L9198">				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract : dblYearFract) * cpcm.cumulative();</span>

<span class="fc" id="L9200">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L9202">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L9204">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L9206" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iAmortizationMode)</span>
<span class="fc" id="L9207">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L9208" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iAmortizationMode)</span>
<span class="fc" id="L9209">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L9210" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE == iAmortizationMode)</span>
<span class="nc" id="L9211">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L9213" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L9214">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L9216" title="1 of 2 branches missed.">			double dblCouponPV = period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="fc" id="L9217">				dblFlatForwardRate : cpcm.rate()) * couponFactor (iPeriodEndDate) * dblYieldAnnuity *</span>
					dblCouponNotional;

<span class="fc" id="L9220">			double dblPeriodNotionalPV = (dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;</span>
<span class="fc" id="L9221">			dblCumulativePeriodDuration += dblPeriodYearFract * (dblCouponPV + dblPeriodNotionalPV);</span>
<span class="fc" id="L9222">			dblCumulativePeriodPV += (dblCouponPV + dblPeriodNotionalPV);</span>

<span class="fc bfc" id="L9224" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L9225">		}</span>

<span class="pc bpc" id="L9227" title="1 of 2 branches missed.">		if (null != periodRef)</span>
<span class="fc" id="L9228">			aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, periodRef.endDate() -</span>
<span class="fc" id="L9229">				periodRef.startDate());</span>

<span class="fc" id="L9231">		double dblRedemptionPV = dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (iFrequency,</span>
			dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L9234">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate);</span>

<span class="fc" id="L9236">		return (dblCumulativePeriodDuration + dblPeriodYearFract * dblRedemptionPV) / (dblCumulativePeriodPV</span>
			+ dblRedemptionPV);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9247">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9257" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9258">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Macaulay Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9261">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9273">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9274">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9284">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9295" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9296">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9300">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9313">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9314">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9324">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9334" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9335">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9339">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9351">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9352">			priceFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9362">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9372" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9373">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9377">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9389">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9390">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9400">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9411" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9412">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9416">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9429">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9430">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9440">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9451" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9452">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9456">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9469">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9470">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9481">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9492" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9493">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9497">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9510">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9511">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9521">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9531" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9532">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9536">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9548">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9549">			priceFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9559">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9569" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9570">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9574">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9586">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9587">			priceFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9597">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9607" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9608">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9612">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9624">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9625">			priceFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9635">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9645" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9646">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9650">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9662">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9663">			priceFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9673">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9683" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9684">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9688">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9700">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9701">			priceFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9711">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9721" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9722">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9726">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9738">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9739">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9749">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9759" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9760">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9764">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9776" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L9777">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc bfc" id="L9779" title="All 2 branches covered.">		if (null == _floaterSetting)</span>
<span class="fc" id="L9780">			return (dblPrice - priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9781">				yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) + 0.0001)) /</span>
<span class="fc" id="L9782">					(dblPrice + accrued (valParams.valueDate(), csqc));</span>

<span class="fc" id="L9784">		return (dblPrice - priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9785">			discountMarginFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) +</span>
<span class="fc" id="L9786">				0.0001)) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9796">		return modifiedDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double modifiedDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9806">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9808" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9809">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9812">		return modifiedDurationFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9824">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9825">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9835">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9846" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9847">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9851">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9864">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9865">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9875">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9885" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9886">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Modified Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9889">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9901">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9902">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9912">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9923" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9924">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9928">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9941">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9942">			priceFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9952">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9962" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9963">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9967">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9979">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L9980">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9990">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10000" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10001">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10004">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10016">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L10017">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10027">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10037" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10038">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10041">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10053">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L10054">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10064">		return nSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10074" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10075">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10078">		return nSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10090">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L10091">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10102">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10113" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10114">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc N Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10117">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10130">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L10131">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10141">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10151" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10152">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10155">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10167">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L10168">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10178">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10188" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10189">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10192">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10204">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L10205">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10215">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10225" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10226">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10229">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10241">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L10242">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10252">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10262" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10263">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10266">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10278">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L10279">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10289">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10299" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10300">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10303">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10315">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L10316">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10326">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10336" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10337">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10340">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10352">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L10353">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10363">		return nSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double nSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10373">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10375" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10376">			throw new java.lang.Exception</span>
				(&quot;BondComponent::nSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L10379">		return nSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10391">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L10392">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10402">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10412" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10413">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10416">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L10428" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L10429">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10431">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L10433" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L10434">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10436">		return dblYield - dcFunding.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10446">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10456" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10457">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10460">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10472">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L10473">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10483">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10493" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10494">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10497">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10509">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L10510">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10520">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10530" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10531">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10534">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10546">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10557">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10567" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10568">			throw new java.lang.Exception (&quot;BondComponent::oasFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10571">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10583">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L10584">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10594">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10604" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10605">			throw new java.lang.Exception (&quot;BondComponent::oasFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10608">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10620">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L10621">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10631">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10641" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10642">			throw new java.lang.Exception (&quot;BondComponent::oasFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10645">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10657">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L10658">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10668">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10678" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10679">			throw new java.lang.Exception (&quot;BondComponent::oasFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10682">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10694">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L10695">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10705">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10715" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10716">			throw new java.lang.Exception (&quot;BondComponent::oasFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10719">		return oasFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10731">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L10732">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10742">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10752" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10753">			throw new java.lang.Exception (&quot;BondComponent::oasFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10756">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10768">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L10769">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10779">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10789" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10790">			throw new java.lang.Exception (&quot;BondComponent::oasFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10793">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10805">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L10806">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10816">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10826" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10827">			throw new java.lang.Exception (&quot;BondComponent::oasFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10830">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10842">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L10843">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10853">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10863" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10864">			throw new java.lang.Exception (&quot;BondComponent::oasFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10867">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10879">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10880">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10890">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10900" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10901">			throw new java.lang.Exception (&quot;BondComponent::oasFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10904">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10916">		return new BondCalibrator (this, false).calibrateOASFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10927">		return oasFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double oasFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10937">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10939" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10940">			throw new java.lang.Exception</span>
				(&quot;BondComponent::oasFromPriceToOptimalExercise - cant calc Work-out&quot;);

<span class="nc" id="L10943">		return oasFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10955">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L10956">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10966">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10976" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10977">			throw new java.lang.Exception (&quot;BondComponent::oasFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10980">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L10992">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L10993">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11003">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11013" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11014">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11017">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11029">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11030">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11040">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11050" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11051">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11054">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11066">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11067">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11077">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11087" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11088">			throw new java.lang.Exception (&quot;BondComponent::oasFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11091">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11103">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L11104">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11114">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11124" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11125">			throw new java.lang.Exception (&quot;BondComponent::pecsFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11128">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11140">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L11141">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11151">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11161" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11162">			throw new java.lang.Exception (&quot;BondComponent::pecsFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11165">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11177">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L11178">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11188">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11198" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11199">			throw new java.lang.Exception (&quot;BondComponent::pecsFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11202">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11214">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L11215">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11225">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11235" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11236">			throw new java.lang.Exception (&quot;BondComponent::pecsFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11239">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11251">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L11252">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11262">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11272" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11273">			throw new java.lang.Exception (&quot;BondComponent::pecsFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11276">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11288">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L11289">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11299">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11309" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11310">			throw new java.lang.Exception (&quot;BondComponent::pecsFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11313">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11325">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L11326">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11336">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11346" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11347">			throw new java.lang.Exception (&quot;BondComponent::pecsFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11350">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11362">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L11363">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11373">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11383" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11384">			throw new java.lang.Exception (&quot;BondComponent::pecsFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11387">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11399">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L11400">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11410">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11420" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11421">			throw new java.lang.Exception (&quot;BondComponent::pecsFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11424">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11436">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L11437">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11447">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11457" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11458">			throw new java.lang.Exception (&quot;BondComponent::pecsFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11461">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11473">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, true);
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11484">		return pecsFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double pecsFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11494">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L11496" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L11497">			throw new java.lang.Exception</span>
				(&quot;BondComponent::pecsFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L11500">		return pecsFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11512">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L11513">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11523">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11533" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11534">			throw new java.lang.Exception (&quot;BondComponent::pecsFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11537">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11549">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L11550">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11560">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11570" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11571">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11574">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11586">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11587">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11597">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11607" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11608">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11611">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11623">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11624">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11634">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11644" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11645">			throw new java.lang.Exception (&quot;BondComponent::pecsFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11648">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11660" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="nc bnc" id="L11661" title="All 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblASW))</span>
<span class="nc" id="L11662">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11664">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L11666" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L11667">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11669">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L11671" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L11672">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11674">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="nc bnc" id="L11677" title="All 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; No CPCM&quot;);</span>

<span class="nc" id="L11679">		return dblWorkoutFactor - 100. * dcFunding.parSwapDV01 (iWorkoutDate) * (dblASW +</span>
<span class="nc" id="L11680">			dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) - cpcm.rate());</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11690">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11700" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11701">			throw new java.lang.Exception (&quot;BondComponent::priceFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11704">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11716">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="fc" id="L11717">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11727">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11737" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11738">			throw new java.lang.Exception (&quot;BondComponent::priceFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11741">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11753">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblCreditBasis,</span>
			false);
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11764">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11774" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11775">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11778">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="fc" id="L11790">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L11791">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11802">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11813" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11814">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11817">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11830">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L11831">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11841">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11851" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11852">			throw new java.lang.Exception (&quot;BondComponent::priceFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11855">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11867">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L11868">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11878">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11888" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11889">			throw new java.lang.Exception (&quot;BondComponent::priceFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11892">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11904">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L11905">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11915">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11925" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11926">			throw new java.lang.Exception (&quot;BondComponent::priceFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11929">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11941">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L11942">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11952">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11962" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11963">			throw new java.lang.Exception (&quot;BondComponent::priceFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11966">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11978">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L11979">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11989">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11999" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12000">			throw new java.lang.Exception (&quot;BondComponent::priceFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12003">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12015">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblOAS);
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12026">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12036" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12037">			throw new java.lang.Exception (&quot;BondComponent::priceFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12040">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12052">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblPECS, true);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12062">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12072" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12073">			throw new java.lang.Exception (&quot;BondComponent::priceFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12076">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12088">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="fc" id="L12089">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12099">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12109" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12110">			throw new java.lang.Exception (&quot;BondComponent::priceFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12113">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12125">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield, false);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12135">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12145" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12146">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc exercise px from yld for bonds w emb option&quot;);

<span class="nc" id="L12149">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12161">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L12162">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12172">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12182" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12183">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12186">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12198">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblZSpread);
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12209">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12219" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12220">			throw new java.lang.Exception (&quot;BondComponent::priceFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12223">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12235">		return tsySpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12236">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12246">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12256" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12257">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12260">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12272">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L12273">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12283">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12293" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12294">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12297">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12309">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12310">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12320">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12330" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12331">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12334">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12346">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12347">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12358">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12369" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12370">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc TSY Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12373">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12386">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L12387">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12397">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12407" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12408">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12411">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12423">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L12424">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12434">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12444" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12445">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12448">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12460">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L12461">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12471">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12481" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12482">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12485">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12497">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L12498">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12508">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12518" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12519">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12522">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12534">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12535">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12545">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12555" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12556">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12559">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12571">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L12572">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12582">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12592" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12593">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12596">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12608">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L12609">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12619">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12629" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12630">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12633">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12645">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L12646">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12656">		return tsySpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double tsySpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L12666">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L12668" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L12669">			throw new java.lang.Exception</span>
				(&quot;BondComponent::tsySpreadFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L12672">		return tsySpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12684">		return dblYield - treasuryBenchmarkYield (valParams, csqc, iWorkoutDate);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L12694">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12705">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12708">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12720">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12721">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12731">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12741" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12742">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12745">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12757">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L12758">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12768">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12778" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12779">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12782">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12794">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12795">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12805">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12815" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12816">			throw new java.lang.Exception (&quot;BondComponent::yieldFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12819">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12831" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblBondBasis))</span>
<span class="nc" id="L12832">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasis =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L12834">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L12835">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblBondBasis;</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L12845">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12855" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12856">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12859">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12871">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L12872">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12882">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12892" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12893">			throw new java.lang.Exception (&quot;BondComponent::yieldFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12896">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12908" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L12909" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblDiscountMargin))</span>
<span class="nc" id="L12910">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12912">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L12914" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L12915">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12917">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L12919">		int iFreq = freq();</span>

<span class="fc" id="L12921">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L12923" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L12924">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L12926" title="2 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblDiscountMargin + dcFunding.libor
<span class="fc" id="L12928">				(iValueDate, ((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblDiscountMargin + indexRate</span>
<span class="fc" id="L12929">					(iValueDate, csqc, (org.drip.analytics.cashflow.CompositeFloatingPeriod) currentPeriod</span>
<span class="fc" id="L12930">						(iValueDate));</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12940">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12951">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12964">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L12965">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblESpread));
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12976">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12986" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12987">			throw new java.lang.Exception (&quot;BondComponent::yieldFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12990">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13002" title="All 6 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblGSpread) || valParams.valueDate() &gt;= iWorkoutDate</span>
			|| null == csqc)
<span class="nc" id="L13004">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13006">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13008" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13010">		return gc.yield (iWorkoutDate) + dblGSpread;</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13020">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13030" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13031">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13034">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13046" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13047" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblISpread))</span>
<span class="nc" id="L13048">			throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13050">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13051">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13053" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13055">		return dc.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblISpread;</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13065">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13075">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13087" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13088" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblJSpread))</span>
<span class="nc" id="L13089">			throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13091">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13093" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13095">		return dblJSpread + gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13106">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13116">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13128" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13129" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblNSpread))</span>
<span class="nc" id="L13130">			throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13132">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13133">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13135" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13137">		return dc.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblNSpread;</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13147">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13157">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13169">		return yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13180">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13190" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13191">			throw new java.lang.Exception (&quot;BondComponent::yieldFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13194">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13206">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L13207">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13217">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13227" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13228">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13231">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13243">		return new BondCalibrator (this, false).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13254">		return yieldFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13264">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13266" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13267">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13270">		return wi.yield();</span>
	}

	@Override public double yieldFromPriceTC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13282">		return new BondCalibrator (this, true).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13295" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblTSYSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13297">			throw new java.lang.Exception (&quot;BondComponent::calcYieldFromTSYSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13299">		return treasuryBenchmarkYield (valParams, csqc, iWorkoutDate) + dblTSYSpread;</span>
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13309">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13319" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13320">			throw new java.lang.Exception (&quot;BondComponent::yieldFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13323">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13335" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYieldSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13337">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13339">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L13340">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblYieldSpread;</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L13350">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13360" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13361">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13364">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13376">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L13377">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblZSpread));
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13388">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13398" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13399">			throw new java.lang.Exception (&quot;BondComponent::yieldFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13402">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13414">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13415">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13425">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13435" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13436">			throw new java.lang.Exception (&quot;BondComponent::yield01FromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13439">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13451">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L13452">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13462">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13472" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13473">			throw new java.lang.Exception (&quot;BondComponent::yield01FromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13476">		return yield01FromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13488">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L13489">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13499">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13509" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13510">			throw new java.lang.Exception (&quot;BondComponent::yield01FromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13513">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13525">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13526">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13537">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13548" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13549">			throw new java.lang.Exception (&quot;BondComponent::yield01FromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Yield01 from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13552">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13565">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L13566">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13576">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13586" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13587">			throw new java.lang.Exception (&quot;BondComponent::yield01FromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13590">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13602">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L13603">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13613">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13623" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13624">			throw new java.lang.Exception (&quot;BondComponent::yield01FromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13627">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13639">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L13640">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13650">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13660" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13661">			throw new java.lang.Exception (&quot;BondComponent::yield01FromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13664">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13676">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L13677">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13687">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13697" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13698">			throw new java.lang.Exception (&quot;BondComponent::yield01FromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13701">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13713">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L13714">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13724">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13734" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13735">			throw new java.lang.Exception (&quot;BondComponent::yield01FromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13738">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13750">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L13751">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13761">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13771" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13772">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13775">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13787">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L13788">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13798">		return yield01FromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13808">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13810" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13811">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13814">		return yield01FromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13826">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L13827">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13837">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13847" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13848">			throw new java.lang.Exception (&quot;BondComponent::yield01FromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13851">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13863" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L13864">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13866">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield) -</span>
<span class="fc" id="L13867">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L13877">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13887" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13888">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13891">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13903">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L13904">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13914">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13924" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13925">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13928">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13940">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L13941">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13951">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13961" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13962">			throw new java.lang.Exception (&quot;BondComponent::yield01FromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13965">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13977">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13978">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13988">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13998" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13999">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14002">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14014">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14015">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14025">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14035" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14036">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromBondBasisToOptimalExercise =&gt; &quot;</span>
				+ &quot;Cant calc Yield Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14039">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14051">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14052">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14062">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14073" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14074">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromCreditBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Yield Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14077">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14090">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14091">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14102">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14113" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14114">			throw new java.lang.Exception</span>
				(&quot;BondComponent::yieldSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Yield Spread from Disc Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14118">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14131">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L14132">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14142">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14152" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14153">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14156">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14168">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L14169">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14179">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14189" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14190">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14193">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14205">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L14206">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14216">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14226" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14227">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14230">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14242">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L14243">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14253">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14263" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14264">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14267">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14279">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L14280">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14290">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14300" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14301">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14304">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14316">		return yieldSpreadFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L14317">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14327">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14337" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14338">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14341">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14353">		return yieldSpreadFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L14354">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14364">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14374" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14375">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14378">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14390">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L14391">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14401">		return yieldSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14411">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14413" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14414">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14417">		return yieldSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14429">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14430">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14440">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14450" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14451">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14454">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14466" title="All 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L14467">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L14469">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14470">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14480">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14490" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14491">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14494">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14506">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L14507">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14517">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14527" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14528">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14531">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14543">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L14544">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14554">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14564" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14565">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14568">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14580">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L14581">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14591">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14601" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14602">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14605">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14617">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L14618">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14628">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14638" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14639">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14642">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14654">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14655">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14666">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14677" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14678">			throw new java.lang.Exception</span>
				(&quot;BondComponent::zSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Z Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14682">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14695">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L14696">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14706">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14716" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14717">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14720">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14732">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L14733">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14743">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14753" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14754">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14757">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14769">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L14770">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14780">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14790" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14791">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14794">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14806">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L14807">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14817">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14827" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14828">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14831">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14843">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L14844">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14854">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14864" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14865">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14868">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14880">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L14881">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14891">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14901" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14902">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14905">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14917">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14928">		return zSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double zSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14938">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14940" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14941">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14944">		return zSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14956">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L14957">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14967">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14977" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14978">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14981">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L14993">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L14994">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L15004">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15014" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15015">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15018">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15030">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L15031">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15041">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double zSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15051" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15052">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15055">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public org.drip.analytics.output.BondRVMeasures standardMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice)
	{
<span class="pc bpc" id="L15066" title="3 of 6 branches missed.">		if (null == valParams || null == csqs || null == wi || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L15067" title="1 of 2 branches missed.">			(dblPrice))</span>
<span class="nc" id="L15068">			return null;</span>

<span class="fc" id="L15070">		int iWorkoutDate = wi.date();</span>

<span class="fc" id="L15072">		double dblWorkoutYield = wi.yield();</span>

<span class="fc" id="L15074">		double dblWorkoutFactor = wi.factor();</span>

<span class="pc bpc" id="L15076" title="1 of 2 branches missed.">		if (valParams.valueDate() &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L15078">		double dblASW = java.lang.Double.NaN;</span>
<span class="fc" id="L15079">		double dblPECS = java.lang.Double.NaN;</span>
<span class="fc" id="L15080">		double dblGSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15081">		double dblISpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15082">		double dblYield01 = java.lang.Double.NaN;</span>
<span class="fc" id="L15083">		double dblZSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15084">		double dblOASpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15085">		double dblBondBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15086">		double dblConvexity = java.lang.Double.NaN;</span>
<span class="fc" id="L15087">		double dblTSYSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15088">		double dblCreditBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15089">		double dblDiscountMargin = java.lang.Double.NaN;</span>
<span class="fc" id="L15090">		double dblMacaulayDuration = java.lang.Double.NaN;</span>
<span class="fc" id="L15091">		double dblModifiedDuration = java.lang.Double.NaN;</span>

		try {
<span class="fc" id="L15094">			dblDiscountMargin = discountMarginFromYield (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblWorkoutYield);
<span class="nc" id="L15096">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15098">		}</span>

<span class="fc bfc" id="L15100" title="All 2 branches covered.">		if (null == _floaterSetting) {</span>
			try {
<span class="fc" id="L15102">				dblZSpread = zSpreadFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
					dblPrice);
<span class="nc" id="L15104">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15106">			}</span>
		}

		try {
<span class="fc" id="L15110">			dblOASpread = oasFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15111">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15113">		}</span>

		try {
<span class="fc" id="L15116">			dblISpread = iSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15118">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15120">		}</span>

		try {
<span class="fc" id="L15123">			dblGSpread = gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15125">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15127">		}</span>

		try {
<span class="fc" id="L15130">			dblTSYSpread = tsySpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15132">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15134">		}</span>

		try {
<span class="fc" id="L15137">			dblMacaulayDuration = macaulayDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15139">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15141">		}</span>

		try {
<span class="fc" id="L15144">			dblModifiedDuration = modifiedDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15146">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15148">		}</span>

		try {
<span class="fc" id="L15151">			dblASW = aswFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15152">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15154">		}</span>

		try {
<span class="fc" id="L15157">			dblConvexity = convexityFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="nc" id="L15159">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15161">		}</span>

		try {
<span class="fc" id="L15164">			dblCreditBasis = creditBasisFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="fc" id="L15166">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15168">		}</span>

		try {
			// dblPECS = pecsFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);
		} catch (java.lang.Exception e) {
			if (!s_bSuppressErrors) e.printStackTrace();
		}

		try {
<span class="fc" id="L15177">			dblBondBasis = bondBasisFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15179">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15181">		}</span>

		try {
<span class="fc" id="L15184">			dblYield01 = yield01FromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15186">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15188">		}</span>

		try {
<span class="fc" id="L15191">			return new org.drip.analytics.output.BondRVMeasures (dblPrice, dblBondBasis, dblZSpread,</span>
				dblGSpread, dblISpread, dblOASpread, dblTSYSpread, dblDiscountMargin, dblASW, dblCreditBasis,
					dblPECS, dblYield01, dblModifiedDuration, dblMacaulayDuration, dblConvexity, wi);
<span class="nc" id="L15194">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L15198">		return null;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; value (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="pc bpc" id="L15207" title="2 of 4 branches missed.">		if (null == valParams || null == csqs) return null;</span>

<span class="fc bfc" id="L15209" title="All 2 branches covered.">		if (null != pricerParams) {</span>
<span class="fc" id="L15210">			org.drip.param.definition.CalibrationParams calibParams = pricerParams.calibParams();</span>

<span class="fc bfc" id="L15212" title="All 2 branches covered.">			if (null != calibParams) {</span>
<span class="fc" id="L15213">				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures =</span>
<span class="fc" id="L15214">					calibMeasures (valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15216" title="2 of 4 branches missed.">				if (null != mapCalibMeasures &amp;&amp; mapCalibMeasures.containsKey (calibParams.measure()))</span>
<span class="fc" id="L15217">					return mapCalibMeasures;</span>
			}
		}

<span class="fc" id="L15221">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = fairMeasures</span>
<span class="fc" id="L15222">			(valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15224" title="1 of 2 branches missed.">		if (null == mapMeasures) return null;</span>

<span class="fc" id="L15226">		java.lang.String strName = name();</span>

<span class="fc" id="L15228">		org.drip.param.definition.ProductQuote pq = csqs.productQuote (strName);</span>

<span class="fc bfc" id="L15230" title="All 2 branches covered.">		if (null == pq) return mapMeasures;</span>

<span class="fc" id="L15232">		int iMaturityDate = maturityDate().julian();</span>

<span class="pc bpc" id="L15234" title="1 of 2 branches missed.">		if (null == _floaterSetting) {</span>
<span class="fc" id="L15235">			double dblParSpread = (mapMeasures.get (&quot;FairDirtyPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15236">				mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairDirtyDV01&quot;);</span>

<span class="fc" id="L15238">			mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15240">			mapMeasures.put (&quot;FairParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15241">		} else {</span>
<span class="nc bnc" id="L15242" title="All 2 branches missed.">			double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15243">				mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15244">					(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15246">			double dblZeroDiscountMargin = (mapMeasures.get (&quot;FairCleanPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15247">				dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15248">					(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15250">			mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15252">			mapMeasures.put (&quot;FairZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
		}

<span class="fc" id="L15255">		org.drip.param.valuation.WorkoutInfo wiMarket = null;</span>

<span class="pc bpc" id="L15257" title="1 of 2 branches missed.">		if (pq.containsQuote (&quot;Price&quot;)) {</span>
<span class="fc" id="L15258">			double dblMarketPrice = pq.quote (&quot;Price&quot;).value (&quot;mid&quot;);</span>

<span class="fc" id="L15260">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblMarketPrice);</span>

<span class="fc" id="L15262">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblMarketPrice);</span>
<span class="pc bnc" id="L15263" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CleanPrice&quot;)) {</span>
<span class="nc" id="L15264">			double dblCleanMarketPrice = pq.quote (&quot;CleanPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15266">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblCleanMarketPrice);</span>

<span class="nc" id="L15268">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblCleanMarketPrice);</span>
<span class="nc bnc" id="L15269" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;QuotedMargin&quot;)) {</span>
<span class="nc" id="L15270">			double dblQuotedMargin = pq.quote (&quot;QuotedMargin&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15272">			mapMeasures.put (&quot;MarketInputType=QuotedMargin&quot;, dblQuotedMargin);</span>

			try {
<span class="nc" id="L15275">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, priceFromDiscountMargin (valParams,</span>
					csqs, vcp, dblQuotedMargin));
<span class="nc" id="L15277">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15279">			}</span>
<span class="nc bnc" id="L15280" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;DirtyPrice&quot;)) {</span>
			try {
<span class="nc" id="L15282">				double dblDirtyMarketPrice = pq.quote (&quot;DirtyPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15284">				mapMeasures.put (&quot;MarketInputType=DirtyPrice&quot;, dblDirtyMarketPrice);</span>

<span class="nc" id="L15286">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblDirtyMarketPrice - accrued</span>
<span class="nc" id="L15287">					(valParams.valueDate(), csqs));</span>
<span class="nc" id="L15288">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15291">				wiMarket = null;</span>
<span class="nc" id="L15292">			}</span>
<span class="nc bnc" id="L15293" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;TSYSpread&quot;)) {</span>
			try {
<span class="nc" id="L15295">				double dblTSYSpread = pq.quote (&quot;TSYSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15297">				mapMeasures.put (&quot;MarketInputType=TSYSpread&quot;, dblTSYSpread);</span>

<span class="nc" id="L15299">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, treasuryBenchmarkYield</span>
<span class="nc" id="L15300">					(valParams, csqs, iMaturityDate) + dblTSYSpread, 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15302">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15305">				wiMarket = null;</span>
<span class="nc" id="L15306">			}</span>
<span class="nc bnc" id="L15307" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;Yield&quot;)) {</span>
			try {
<span class="nc" id="L15309">				double dblYield = pq.quote (&quot;Yield&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15311">				mapMeasures.put (&quot;MarketInputType=Yield&quot;, dblYield);</span>

<span class="nc" id="L15313">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, dblYield, 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15315">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15318">				wiMarket = null;</span>
<span class="nc" id="L15319">			}</span>
<span class="nc bnc" id="L15320" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ZSpread&quot;)) {</span>
			try {
<span class="nc" id="L15322">				double dblZSpread = pq.quote (&quot;ZSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15324">				mapMeasures.put (&quot;MarketInputType=ZSpread&quot;, dblZSpread);</span>

<span class="nc" id="L15326">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromZSpread</span>
<span class="nc" id="L15327">					(valParams, csqs, vcp, dblZSpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15329">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15332">				wiMarket = null;</span>
<span class="nc" id="L15333">			}</span>
<span class="nc bnc" id="L15334" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ISpread&quot;)) {</span>
			try {
<span class="nc" id="L15336">				double dblISpread = pq.quote (&quot;ISpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15338">				mapMeasures.put (&quot;MarketInputType=ISpread&quot;, dblISpread);</span>

<span class="nc" id="L15340">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromISpread</span>
<span class="nc" id="L15341">					(valParams, csqs, vcp, dblISpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15343">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15346">				wiMarket = null;</span>
<span class="nc" id="L15347">			}</span>
<span class="nc bnc" id="L15348" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CreditBasis&quot;)) {</span>
			try {
<span class="nc" id="L15350">				double dblCreditBasis = pq.quote (&quot;CreditBasis&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15352">				mapMeasures.put (&quot;MarketInputType=CreditBasis&quot;, dblCreditBasis);</span>

<span class="nc" id="L15354">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromCreditBasis</span>
<span class="nc" id="L15355">					(valParams, csqs, vcp, dblCreditBasis), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15357">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15360">				wiMarket = null;</span>
<span class="nc" id="L15361">			}</span>
<span class="nc bnc" id="L15362" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;PECS&quot;)) {</span>
			try {
<span class="nc" id="L15364">				double dblCreditBasis = pq.quote (&quot;PECS&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15366">				mapMeasures.put (&quot;MarketInputType=PECS&quot;, dblCreditBasis);</span>

<span class="nc" id="L15368">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPECS (valParams,</span>
					csqs, vcp, dblCreditBasis), 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15370">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15373">				wiMarket = null;</span>
<span class="nc" id="L15374">			}</span>
		}

<span class="pc bpc" id="L15377" title="1 of 2 branches missed.">		if (null != wiMarket) {</span>
<span class="fc" id="L15378">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapWorkoutMeasures =</span>
<span class="fc" id="L15379">				marketMeasures (valParams, pricerParams, csqs, vcp, wiMarket);</span>

<span class="pc bpc" id="L15381" title="1 of 2 branches missed.">			if (null == _floaterSetting) {</span>
<span class="fc" id="L15382">				double dblParSpread = (mapWorkoutMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15383">					mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairCleanDV01&quot;);</span>

<span class="fc" id="L15385">				mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15387">				mapMeasures.put (&quot;MarketParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15388">			} else {</span>
<span class="nc bnc" id="L15389" title="All 2 branches missed.">				double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15390">					mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15391">						(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15393">				double dblZeroDiscountMargin = (mapMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15394">					dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15395">						(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15397">				mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15399">				mapMeasures.put (&quot;MarketZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
			}

<span class="fc" id="L15402">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapWorkoutMeasures);</span>

<span class="fc" id="L15404">			org.drip.state.credit.CreditCurve cc = csqs.creditState (creditLabel());</span>

<span class="pc bpc" id="L15406" title="1 of 2 branches missed.">			if (null != mapMeasures.get (&quot;FairYield&quot;)) {</span>
<span class="fc" id="L15407">				org.drip.param.market.CurveSurfaceQuoteContainer csqsMarket =</span>
					org.drip.param.creator.MarketParamsBuilder.Create
<span class="fc" id="L15409">						((org.drip.state.discount.MergedDiscountForwardCurve) csqs.fundingState</span>
<span class="fc" id="L15410">							(fundingLabel()).parallelShiftQuantificationMetric (wiMarket.yield() -</span>
<span class="fc" id="L15411">								mapMeasures.get (&quot;FairYield&quot;)), csqs.govvieState (govvieLabel()), cc,</span>
<span class="fc" id="L15412">									strName, csqs.productQuote (strName), csqs.quoteMap(), csqs.fixings());</span>

<span class="pc bpc" id="L15414" title="1 of 2 branches missed.">				if (null != csqsMarket) {</span>
<span class="fc" id="L15415">					org.drip.analytics.output.BondWorkoutMeasures bwmMarket = workoutMeasures (valParams,</span>
<span class="fc" id="L15416">						pricerParams, csqsMarket, wiMarket.date(), wiMarket.factor());</span>

<span class="pc bpc" id="L15418" title="1 of 2 branches missed.">					if (null != bwmMarket) {</span>
<span class="nc" id="L15419">						org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMarketMeasures</span>
<span class="nc" id="L15420">							= bwmMarket.toMap (&quot;&quot;);</span>

<span class="nc" id="L15422">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMarketMeasures,</span>
<span class="nc" id="L15423">							org.drip.quant.common.CollectionUtil.PrefixKeys (mapMarketMeasures, &quot;Market&quot;));</span>

<span class="nc" id="L15425">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapMarketMeasures);</span>
					}
				}
			}
		}

<span class="fc" id="L15431">		return mapMeasures;</span>
	}

	@Override public java.util.Set&lt;java.lang.String&gt; measureNames()
	{
<span class="nc" id="L15436">		java.util.Set&lt;java.lang.String&gt; setstrMeasureNames = new java.util.TreeSet&lt;java.lang.String&gt;();</span>

<span class="nc" id="L15438">		setstrMeasureNames.add (&quot;Accrued&quot;);</span>

<span class="nc" id="L15440">		setstrMeasureNames.add (&quot;Accrued01&quot;);</span>

<span class="nc" id="L15442">		setstrMeasureNames.add (&quot;AssetSwapSpread&quot;);</span>

<span class="nc" id="L15444">		setstrMeasureNames.add (&quot;ASW&quot;);</span>

<span class="nc" id="L15446">		setstrMeasureNames.add (&quot;BondBasis&quot;);</span>

<span class="nc" id="L15448">		setstrMeasureNames.add (&quot;CleanCouponPV&quot;);</span>

<span class="nc" id="L15450">		setstrMeasureNames.add (&quot;CleanDV01&quot;);</span>

<span class="nc" id="L15452">		setstrMeasureNames.add (&quot;CleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15454">		setstrMeasureNames.add (&quot;CleanPrice&quot;);</span>

<span class="nc" id="L15456">		setstrMeasureNames.add (&quot;CleanPV&quot;);</span>

<span class="nc" id="L15458">		setstrMeasureNames.add (&quot;Convexity&quot;);</span>

<span class="nc" id="L15460">		setstrMeasureNames.add (&quot;CreditRisklessParPV&quot;);</span>

<span class="nc" id="L15462">		setstrMeasureNames.add (&quot;CreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15464">		setstrMeasureNames.add (&quot;CreditRiskyParPV&quot;);</span>

<span class="nc" id="L15466">		setstrMeasureNames.add (&quot;CreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15468">		setstrMeasureNames.add (&quot;CreditBasis&quot;);</span>

<span class="nc" id="L15470">		setstrMeasureNames.add (&quot;DiscountMargin&quot;);</span>

<span class="nc" id="L15472">		setstrMeasureNames.add (&quot;DefaultExposure&quot;);</span>

<span class="nc" id="L15474">		setstrMeasureNames.add (&quot;DefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15476">		setstrMeasureNames.add (&quot;DirtyCouponPV&quot;);</span>

<span class="nc" id="L15478">		setstrMeasureNames.add (&quot;DirtyDV01&quot;);</span>

<span class="nc" id="L15480">		setstrMeasureNames.add (&quot;DirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15482">		setstrMeasureNames.add (&quot;DirtyPrice&quot;);</span>

<span class="nc" id="L15484">		setstrMeasureNames.add (&quot;DirtyPV&quot;);</span>

<span class="nc" id="L15486">		setstrMeasureNames.add (&quot;Duration&quot;);</span>

<span class="nc" id="L15488">		setstrMeasureNames.add (&quot;DV01&quot;);</span>

<span class="nc" id="L15490">		setstrMeasureNames.add (&quot;ExpectedRecovery&quot;);</span>

<span class="nc" id="L15492">		setstrMeasureNames.add (&quot;FairAccrued&quot;);</span>

<span class="nc" id="L15494">		setstrMeasureNames.add (&quot;FairAccrued01&quot;);</span>

<span class="nc" id="L15496">		setstrMeasureNames.add (&quot;FairAssetSwapSpread&quot;);</span>

<span class="nc" id="L15498">		setstrMeasureNames.add (&quot;FairASW&quot;);</span>

<span class="nc" id="L15500">		setstrMeasureNames.add (&quot;FairBondBasis&quot;);</span>

<span class="nc" id="L15502">		setstrMeasureNames.add (&quot;FairCleanCouponPV&quot;);</span>

<span class="nc" id="L15504">		setstrMeasureNames.add (&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15506">		setstrMeasureNames.add (&quot;FairCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15508">		setstrMeasureNames.add (&quot;FairCleanPrice&quot;);</span>

<span class="nc" id="L15510">		setstrMeasureNames.add (&quot;FairCleanPV&quot;);</span>

<span class="nc" id="L15512">		setstrMeasureNames.add (&quot;FairConvexity&quot;);</span>

<span class="nc" id="L15514">		setstrMeasureNames.add (&quot;FairCreditBasis&quot;);</span>

<span class="nc" id="L15516">		setstrMeasureNames.add (&quot;FairCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15518">		setstrMeasureNames.add (&quot;FairCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15520">		setstrMeasureNames.add (&quot;FairCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15522">		setstrMeasureNames.add (&quot;FairCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15524">		setstrMeasureNames.add (&quot;FairDefaultExposure&quot;);</span>

<span class="nc" id="L15526">		setstrMeasureNames.add (&quot;FairDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15528">		setstrMeasureNames.add (&quot;FairDirtyCouponPV&quot;);</span>

<span class="nc" id="L15530">		setstrMeasureNames.add (&quot;FairDirtyDV01&quot;);</span>

<span class="nc" id="L15532">		setstrMeasureNames.add (&quot;FairDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15534">		setstrMeasureNames.add (&quot;FairDirtyPrice&quot;);</span>

<span class="nc" id="L15536">		setstrMeasureNames.add (&quot;FairDirtyPV&quot;);</span>

<span class="nc" id="L15538">		setstrMeasureNames.add (&quot;FairDiscountMargin&quot;);</span>

<span class="nc" id="L15540">		setstrMeasureNames.add (&quot;FairDuration&quot;);</span>

<span class="nc" id="L15542">		setstrMeasureNames.add (&quot;FairDV01&quot;);</span>

<span class="nc" id="L15544">		setstrMeasureNames.add (&quot;FairExpectedRecovery&quot;);</span>

<span class="nc" id="L15546">		setstrMeasureNames.add (&quot;FairFirstIndexRate&quot;);</span>

<span class="nc" id="L15548">		setstrMeasureNames.add (&quot;FairGSpread&quot;);</span>

<span class="nc" id="L15550">		setstrMeasureNames.add (&quot;FairISpread&quot;);</span>

<span class="nc" id="L15552">		setstrMeasureNames.add (&quot;FairLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15554">		setstrMeasureNames.add (&quot;FairMacaulayDuration&quot;);</span>

<span class="nc" id="L15556">		setstrMeasureNames.add (&quot;FairModifiedDuration&quot;);</span>

<span class="nc" id="L15558">		setstrMeasureNames.add (&quot;FairOAS&quot;);</span>

<span class="nc" id="L15560">		setstrMeasureNames.add (&quot;FairOASpread&quot;);</span>

<span class="nc" id="L15562">		setstrMeasureNames.add (&quot;FairOptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15564">		setstrMeasureNames.add (&quot;FairParPV&quot;);</span>

<span class="nc" id="L15566">		setstrMeasureNames.add (&quot;FairParSpread&quot;);</span>

<span class="nc" id="L15568">		setstrMeasureNames.add (&quot;FairPECS&quot;);</span>

<span class="nc" id="L15570">		setstrMeasureNames.add (&quot;FairPrice&quot;);</span>

<span class="nc" id="L15572">		setstrMeasureNames.add (&quot;FairPrincipalPV&quot;);</span>

<span class="nc" id="L15574">		setstrMeasureNames.add (&quot;FairPV&quot;);</span>

<span class="nc" id="L15576">		setstrMeasureNames.add (&quot;FairRecoveryPV&quot;);</span>

<span class="nc" id="L15578">		setstrMeasureNames.add (&quot;FairRisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15580">		setstrMeasureNames.add (&quot;FairRisklessCleanDV01&quot;);</span>

<span class="nc" id="L15582">		setstrMeasureNames.add (&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15584">		setstrMeasureNames.add (&quot;FairRisklessCleanPV&quot;);</span>

<span class="nc" id="L15586">		setstrMeasureNames.add (&quot;FairRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15588">		setstrMeasureNames.add (&quot;FairRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15590">		setstrMeasureNames.add (&quot;FairRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15592">		setstrMeasureNames.add (&quot;FairRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15594">		setstrMeasureNames.add (&quot;FairRiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15596">		setstrMeasureNames.add (&quot;FairRiskyCleanDV01&quot;);</span>

<span class="nc" id="L15598">		setstrMeasureNames.add (&quot;FairRiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15600">		setstrMeasureNames.add (&quot;FairRiskyCleanPV&quot;);</span>

<span class="nc" id="L15602">		setstrMeasureNames.add (&quot;FairRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15604">		setstrMeasureNames.add (&quot;FairRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15606">		setstrMeasureNames.add (&quot;FairRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15608">		setstrMeasureNames.add (&quot;FairRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15610">		setstrMeasureNames.add (&quot;FairTSYSpread&quot;);</span>

<span class="nc" id="L15612">		setstrMeasureNames.add (&quot;FairWorkoutDate&quot;);</span>

<span class="nc" id="L15614">		setstrMeasureNames.add (&quot;FairWorkoutFactor&quot;);</span>

<span class="nc" id="L15616">		setstrMeasureNames.add (&quot;FairWorkoutType&quot;);</span>

<span class="nc" id="L15618">		setstrMeasureNames.add (&quot;FairWorkoutYield&quot;);</span>

<span class="nc" id="L15620">		setstrMeasureNames.add (&quot;FairYield&quot;);</span>

<span class="nc" id="L15622">		setstrMeasureNames.add (&quot;FairYield01&quot;);</span>

<span class="nc" id="L15624">		setstrMeasureNames.add (&quot;FairYieldBasis&quot;);</span>

<span class="nc" id="L15626">		setstrMeasureNames.add (&quot;FairYieldSpread&quot;);</span>

<span class="nc" id="L15628">		setstrMeasureNames.add (&quot;FairZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15630">		setstrMeasureNames.add (&quot;FairZSpread&quot;);</span>

<span class="nc" id="L15632">		setstrMeasureNames.add (&quot;FirstCouponRate&quot;);</span>

<span class="nc" id="L15634">		setstrMeasureNames.add (&quot;FirstIndexRate&quot;);</span>

<span class="nc" id="L15636">		setstrMeasureNames.add (&quot;GSpread&quot;);</span>

<span class="nc" id="L15638">		setstrMeasureNames.add (&quot;ISpread&quot;);</span>

<span class="nc" id="L15640">		setstrMeasureNames.add (&quot;LossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15642">		setstrMeasureNames.add (&quot;MacaulayDuration&quot;);</span>

<span class="nc" id="L15644">		setstrMeasureNames.add (&quot;MarketAccrued&quot;);</span>

<span class="nc" id="L15646">		setstrMeasureNames.add (&quot;MarketAccrued01&quot;);</span>

<span class="nc" id="L15648">		setstrMeasureNames.add (&quot;MarketCleanCouponPV&quot;);</span>

<span class="nc" id="L15650">		setstrMeasureNames.add (&quot;MarketCleanDV01&quot;);</span>

<span class="nc" id="L15652">		setstrMeasureNames.add (&quot;MarketCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15654">		setstrMeasureNames.add (&quot;MarketCleanPrice&quot;);</span>

<span class="nc" id="L15656">		setstrMeasureNames.add (&quot;MarketCleanPV&quot;);</span>

<span class="nc" id="L15658">		setstrMeasureNames.add (&quot;MarketCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15660">		setstrMeasureNames.add (&quot;MarketCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15662">		setstrMeasureNames.add (&quot;MarketCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15664">		setstrMeasureNames.add (&quot;MarketCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15666">		setstrMeasureNames.add (&quot;MarketDefaultExposure&quot;);</span>

<span class="nc" id="L15668">		setstrMeasureNames.add (&quot;MarketDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15670">		setstrMeasureNames.add (&quot;MarketDirtyCouponPV&quot;);</span>

<span class="nc" id="L15672">		setstrMeasureNames.add (&quot;MarketDirtyDV01&quot;);</span>

<span class="nc" id="L15674">		setstrMeasureNames.add (&quot;MarketDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15676">		setstrMeasureNames.add (&quot;MarketDirtyPrice&quot;);</span>

<span class="nc" id="L15678">		setstrMeasureNames.add (&quot;MarketDirtyPV&quot;);</span>

<span class="nc" id="L15680">		setstrMeasureNames.add (&quot;MarketDV01&quot;);</span>

<span class="nc" id="L15682">		setstrMeasureNames.add (&quot;MarketExpectedRecovery&quot;);</span>

<span class="nc" id="L15684">		setstrMeasureNames.add (&quot;MarketFirstCouponRate&quot;);</span>

<span class="nc" id="L15686">		setstrMeasureNames.add (&quot;MarketFirstIndexRate&quot;);</span>

<span class="nc" id="L15688">		setstrMeasureNames.add (&quot;MarketInputType=CleanPrice&quot;);</span>

<span class="nc" id="L15690">		setstrMeasureNames.add (&quot;MarketInputType=CreditBasis&quot;);</span>

<span class="nc" id="L15692">		setstrMeasureNames.add (&quot;MarketInputType=DirtyPrice&quot;);</span>

<span class="nc" id="L15694">		setstrMeasureNames.add (&quot;MarketInputType=GSpread&quot;);</span>

<span class="nc" id="L15696">		setstrMeasureNames.add (&quot;MarketInputType=ISpread&quot;);</span>

<span class="nc" id="L15698">		setstrMeasureNames.add (&quot;MarketInputType=PECS&quot;);</span>

<span class="nc" id="L15700">		setstrMeasureNames.add (&quot;MarketInputType=QuotedMargin&quot;);</span>

<span class="nc" id="L15702">		setstrMeasureNames.add (&quot;MarketInputType=TSYSpread&quot;);</span>

<span class="nc" id="L15704">		setstrMeasureNames.add (&quot;MarketInputType=Yield&quot;);</span>

<span class="nc" id="L15706">		setstrMeasureNames.add (&quot;MarketInputType=ZSpread&quot;);</span>

<span class="nc" id="L15708">		setstrMeasureNames.add (&quot;MarketLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15710">		setstrMeasureNames.add (&quot;MarketParPV&quot;);</span>

<span class="nc" id="L15712">		setstrMeasureNames.add (&quot;MarketPrincipalPV&quot;);</span>

<span class="nc" id="L15714">		setstrMeasureNames.add (&quot;MarketPV&quot;);</span>

<span class="nc" id="L15716">		setstrMeasureNames.add (&quot;MarketRecoveryPV&quot;);</span>

<span class="nc" id="L15718">		setstrMeasureNames.add (&quot;MarketRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15720">		setstrMeasureNames.add (&quot;MarketRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15722">		setstrMeasureNames.add (&quot;MarketRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15724">		setstrMeasureNames.add (&quot;MarketRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15726">		setstrMeasureNames.add (&quot;MarketRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15728">		setstrMeasureNames.add (&quot;MarketRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15730">		setstrMeasureNames.add (&quot;MarketRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15732">		setstrMeasureNames.add (&quot;MarketRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15734">		setstrMeasureNames.add (&quot;ModifiedDuration&quot;);</span>

<span class="nc" id="L15736">		setstrMeasureNames.add (&quot;OAS&quot;);</span>

<span class="nc" id="L15738">		setstrMeasureNames.add (&quot;OASpread&quot;);</span>

<span class="nc" id="L15740">		setstrMeasureNames.add (&quot;OptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15742">		setstrMeasureNames.add (&quot;ParEquivalentCDSSpread&quot;);</span>

<span class="nc" id="L15744">		setstrMeasureNames.add (&quot;ParPV&quot;);</span>

<span class="nc" id="L15746">		setstrMeasureNames.add (&quot;ParSpread&quot;);</span>

<span class="nc" id="L15748">		setstrMeasureNames.add (&quot;PECS&quot;);</span>

<span class="nc" id="L15750">		setstrMeasureNames.add (&quot;Price&quot;);</span>

<span class="nc" id="L15752">		setstrMeasureNames.add (&quot;PrincipalPV&quot;);</span>

<span class="nc" id="L15754">		setstrMeasureNames.add (&quot;PV&quot;);</span>

<span class="nc" id="L15756">		setstrMeasureNames.add (&quot;RecoveryPV&quot;);</span>

<span class="nc" id="L15758">		setstrMeasureNames.add (&quot;RisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15760">		setstrMeasureNames.add (&quot;RisklessCleanDV01&quot;);</span>

<span class="nc" id="L15762">		setstrMeasureNames.add (&quot;RisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15764">		setstrMeasureNames.add (&quot;RisklessCleanPV&quot;);</span>

<span class="nc" id="L15766">		setstrMeasureNames.add (&quot;RisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15768">		setstrMeasureNames.add (&quot;RisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15770">		setstrMeasureNames.add (&quot;RisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15772">		setstrMeasureNames.add (&quot;RisklessDirtyPV&quot;);</span>

<span class="nc" id="L15774">		setstrMeasureNames.add (&quot;RiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15776">		setstrMeasureNames.add (&quot;RiskyCleanDV01&quot;);</span>

<span class="nc" id="L15778">		setstrMeasureNames.add (&quot;RiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15780">		setstrMeasureNames.add (&quot;RiskyCleanPV&quot;);</span>

<span class="nc" id="L15782">		setstrMeasureNames.add (&quot;RiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15784">		setstrMeasureNames.add (&quot;RiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15786">		setstrMeasureNames.add (&quot;RiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15788">		setstrMeasureNames.add (&quot;RiskyDirtyPV&quot;);</span>

<span class="nc" id="L15790">		setstrMeasureNames.add (&quot;TSYSpread&quot;);</span>

<span class="nc" id="L15792">		setstrMeasureNames.add (&quot;WorkoutDate&quot;);</span>

<span class="nc" id="L15794">		setstrMeasureNames.add (&quot;WorkoutFactor&quot;);</span>

<span class="nc" id="L15796">		setstrMeasureNames.add (&quot;WorkoutType&quot;);</span>

<span class="nc" id="L15798">		setstrMeasureNames.add (&quot;WorkoutYield&quot;);</span>

<span class="nc" id="L15800">		setstrMeasureNames.add (&quot;Yield&quot;);</span>

<span class="nc" id="L15802">		setstrMeasureNames.add (&quot;Yield01&quot;);</span>

<span class="nc" id="L15804">		setstrMeasureNames.add (&quot;YieldBasis&quot;);</span>

<span class="nc" id="L15806">		setstrMeasureNames.add (&quot;YieldSpread&quot;);</span>

<span class="nc" id="L15808">		setstrMeasureNames.add (&quot;ZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15810">		setstrMeasureNames.add (&quot;ZSpread&quot;);</span>

<span class="nc" id="L15812">		return setstrMeasureNames;</span>
	}

	@Override public double pv (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParamsIn,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15822" title="All 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L15823">			throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc" id="L15825">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L15827">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L15829" title="All 2 branches missed.">		if (null == dcFunding) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15831" title="All 2 branches missed.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="nc bnc" id="L15833" title="All 2 branches missed.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="nc" id="L15834">			_creditSetting.recovery();</span>

<span class="nc bnc" id="L15836" title="All 2 branches missed.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="nc bnc" id="L15838" title="All 2 branches missed.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="nc" id="L15840">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc" id="L15842">		double dblRecoveryPV = 0.;</span>
<span class="nc" id="L15843">		double dblPrincipalPV = 0.;</span>
<span class="nc" id="L15844">		double dblDirtyCouponPV = 0.;</span>
<span class="nc" id="L15845">		boolean bApplyFlatForwardRate = false;</span>
<span class="nc" id="L15846">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L15848" title="All 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L15849">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="nc bnc" id="L15851" title="All 2 branches missed.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="nc" id="L15852">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L15854" title="All 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="nc" id="L15857">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc bnc" id="L15859" title="All 2 branches missed.">		org.drip.param.pricer.CreditPricerParams pricerParams = null != pricerParamsIn ? pricerParamsIn : new</span>
			org.drip.param.pricer.CreditPricerParams (7, null, false,
				org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_FULL_COUPON);

<span class="nc bnc" id="L15863" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L15864">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L15866" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L15868">			int iPeriodEndDate = period.endDate();</span>

<span class="nc" id="L15870">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L15872">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L15875" title="All 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15877" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L15878">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L15880" title="All 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="nc" id="L15882">			double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="nc" id="L15884">			double dblPeriodDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) * dblPeriodAnnuity *</span>
<span class="nc" id="L15885">				notional (iPeriodStartDate);</span>

<span class="nc" id="L15887">			double dblPeriodPrincipalPV = (notional (iPeriodStartDate) - notional (iPeriodEndDate)) *</span>
				dblPeriodAnnuity;

<span class="nc bnc" id="L15890" title="All 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L15891" title="All 2 branches missed.">				double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
					iPeriodEndDate);

<span class="nc" id="L15894">				dblPeriodDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L15895">				dblPeriodPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L15897" title="All 2 branches missed.">				for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
					valParams, pricerParams, iMaturityDate, csqc)) {
<span class="nc bnc" id="L15899" title="All 2 branches missed.">					if (null == lqm) continue;</span>

<span class="nc" id="L15901">					int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L15903">					int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L15905">					double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
						iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L15908">					double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L15910">					double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L15911">						(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L15913" title="All 2 branches missed.">					if (bAccrualOnDefault)</span>
<span class="nc" id="L15914">						dblPeriodDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival *</span>
							dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L15917" title="All 2 branches missed.">					dblRecoveryPV += (bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
						iSubPeriodEndDate) : dblProductRecovery) * dblSubPeriodSurvival *
							dblSubPeriodNotional * dblSubPeriodDF;
<span class="nc" id="L15920">				}</span>
			}

<span class="nc" id="L15923">			dblPrincipalPV += dblPeriodPrincipalPV;</span>

<span class="nc" id="L15925">			dblDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblPeriodDirtyDV01;
<span class="nc" id="L15927">		}</span>

<span class="nc" id="L15929">		double dblParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate);</span>

<span class="nc bnc" id="L15931" title="All 4 branches missed.">		if (null != cc &amp;&amp; null != pricerParams) dblParPV *= cc.survival (iMaturityDate);</span>

<span class="nc bnc" id="L15933" title="All 2 branches missed.">		return (dblDirtyCouponPV + dblPrincipalPV + dblParPV + dblRecoveryPV) / dcFunding.df (null !=</span>
<span class="nc" id="L15934">			_quoteConvention ? _quoteConvention.settleDate (valParams) : valParams.cashPayDate());</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian jackDDirtyPVDManifestMeasure (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15943">		return null;</span>
	}

	@Override public org.drip.product.calib.ProductQuoteSet calibQuoteSet (
		final org.drip.state.representation.LatentStateSpecification[] aLSS)
	{
<span class="nc" id="L15949">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15959">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint forwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15969">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingForwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15979">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fxPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15989">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint govviePRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15999">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint volatilityPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L16009">		return null;</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian manifestMeasureDFMicroJack (
		final java.lang.String strManifestMeasure,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L16019">		return null;</span>
	}

	/**
	 * The BondCalibrator implements a calibrator that calibrates the yield, the credit basis, or the Z
	 * 		Spread for the bond given the price input. Calibration happens via either Newton-Raphson method,
	 * 		or via bracketing/root searching.
	 * 
	 * @author Lakshmi Krishnamurthy
	 *
	 */

	public class BondCalibrator {
<span class="fc" id="L16032">		private BondComponent _bond = null;</span>
<span class="fc" id="L16033">		private boolean _bApplyCouponExtension = false;</span>

		/**
		 * Constructor: Construct the calibrator from the parent bond.
		 * 
		 * @param bond Parent
		 * @param bApplyCouponExtension TRUE - Apply the Coupon Extension
		 * 
		 * @throws java.lang.Exception Thrown if the inputs are invalid
		 */

		public BondCalibrator (
			final BondComponent bond,
			final boolean bApplyCouponExtension)
			throws java.lang.Exception
<span class="fc" id="L16048">		{</span>
<span class="pc bpc" id="L16049" title="1 of 2 branches missed.">			if (null == (_bond = bond))</span>
<span class="nc" id="L16050">				throw new java.lang.Exception (&quot;BondComponent::BondCalibrator ctr =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L16052">			_bApplyCouponExtension = bApplyCouponExtension;</span>
<span class="fc" id="L16053">		}</span>

		/**
		 * Calibrate the bond yield from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Yield
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibrateYieldFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16079" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16080">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16083">			org.drip.function.definition.R1ToR1 ofYieldToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16084">				(null) {</span>
				@Override public double evaluate (
					final double dblYield)
					throws java.lang.Exception
				{
<span class="fc" id="L16089">					return _bond.priceFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L16090">						dblYield, _bApplyCouponExtension) - dblPrice;</span>
				}
			};

<span class="fc" id="L16094">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
<span class="fc" id="L16095">				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofYieldToPrice, true).findRoot();</span>

<span class="pc bpc" id="L16097" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16098">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofYieldToPrice,</span>
<span class="nc" id="L16099">					true).findRoot();</span>

<span class="pc bpc" id="L16101" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16102">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofYieldToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16104">						true).findRoot();</span>

<span class="pc bpc" id="L16106" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16107">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16110">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the Z Spread cannot be calibrated
		 */

		public double calibrateZSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16139" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16140">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="pc bpc" id="L16143" title="1 of 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16144">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="fc" id="L16147">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16148">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16153">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16158">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="fc" id="L16160">					true).findRoot();</span>

<span class="pc bpc" id="L16162" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16163">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16164">					true).findRoot();</span>

<span class="pc bpc" id="L16166" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16167">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					new org.drip.function.r1tor1solver.ExecutionControl (ofZSpreadToPrice, new
						org.drip.function.r1tor1solver.ExecutionControlParams (200, false, 1.e-02, 1.e-02,
							1.e-01, 1.e-01)),
								org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16172">									true).findRoot();</span>

<span class="pc bpc" id="L16174" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16175">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16178">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the Bond OAS from the Market Price using the Root Bracketing Technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The Calibrated OAS
		 * 
		 * @throws java.lang.Exception Thrown if the OAS cannot be calibrated
		 */

		public double calibrateOASFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16207" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16208">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16211">			org.drip.function.definition.R1ToR1 r1ToR1OASToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16212">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16217">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16222">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., r1ToR1OASToPrice,
<span class="fc" id="L16224">					true).findRoot();</span>

<span class="pc bpc" id="L16226" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16227">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., r1ToR1OASToPrice,</span>
<span class="fc" id="L16228">					true).findRoot();</span>

<span class="pc bpc" id="L16230" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16231">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., r1ToR1OASToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16233">						true).findRoot();</span>

<span class="pc bpc" id="L16235" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16236">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16239">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the discount
		 * 	curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibDiscCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16265" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16266">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateDiscCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc" id="L16269">			org.drip.function.definition.R1ToR1 ofDiscCurveSpreadToPrice = new</span>
<span class="nc" id="L16270">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16275">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16280">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofDiscCurveSpreadToPrice,
<span class="nc" id="L16282">					true).findRoot();</span>

<span class="nc bnc" id="L16284" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16285">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0.,</span>
<span class="nc" id="L16286">					ofDiscCurveSpreadToPrice, true).findRoot();</span>

<span class="nc bnc" id="L16288" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16289">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0.,</span>
					ofDiscCurveSpreadToPrice, null,
						org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16292">							true).findRoot();</span>

<span class="nc bnc" id="L16294" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16295">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibDiscCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16298">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the Zero Curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibZeroCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16323" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16324">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZeroCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc bnc" id="L16327" title="All 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16328">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibZeroCurveSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="nc" id="L16331">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="nc" id="L16332">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16337">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16342">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="nc" id="L16344">					true).findRoot();</span>

<span class="nc bnc" id="L16346" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16347">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16348">					true).findRoot();</span>

<span class="nc bnc" id="L16350" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16351">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16353">						true).findRoot();</span>

<span class="nc bnc" id="L16355" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16356">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibZeroCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16359">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Credit Basis from the market price
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * @param bFlat TRUE - Calibrate to Flat Curve
		 * 
		 * @return The calibrated Credit Basis
		 * 
		 * @throws java.lang.Exception Thrown if the Credit Basis cannot be calibrated
		 */

		public double calibrateCreditBasisFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice,
			final boolean bFlat)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16386" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16387">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateCreditBasisFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16390">			org.drip.function.definition.R1ToR1 ofCreditBasisToPrice = new</span>
<span class="fc" id="L16391">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblCreditBasis)
					throws java.lang.Exception
				{
<span class="fc" id="L16396">					return _bond.priceFromCreditCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblCreditBasis, bFlat) - dblPrice;
				}
			};

<span class="fc" id="L16401">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofCreditBasisToPrice,
<span class="fc" id="L16403">					true).findRoot();</span>

<span class="pc bpc" id="L16405" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16406">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofCreditBasisToPrice,</span>
<span class="fc" id="L16407">					true).findRoot();</span>

<span class="pc bpc" id="L16409" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16410">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofCreditBasisToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16412">						true).findRoot();</span>

<span class="pc bpc" id="L16414" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16415">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibrateCreditBasisFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16418">			return rfop.getRoot();</span>
		}
	}

	/**
	 * Generate the EOS Callable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics callMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16445" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16447">		org.drip.product.params.EmbeddedOptionSchedule eosCall = callSchedule();</span>

<span class="pc bpc" id="L16449" title="1 of 2 branches missed.">		if (null == eosCall) return null;</span>

<span class="fc" id="L16451">		int iNumDimension = gbs.dimension();</span>

<span class="fc" id="L16453">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L16455">		int[] aiExerciseDate = eosCall.exerciseDates (iValueDate);</span>

<span class="fc" id="L16457">		double[] adblExercisePrice = eosCall.exerciseFactors (iValueDate);</span>

<span class="pc bpc" id="L16459" title="2 of 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="fc" id="L16461">		double dblOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L16462">		int iNumVertex = aiExerciseDate.length;</span>
<span class="fc" id="L16463">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="fc" id="L16464">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="fc" id="L16465">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="fc" id="L16466">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="fc" id="L16467">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="fc" id="L16468">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="fc" id="L16469">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="fc" id="L16470">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="fc" id="L16471">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="fc" id="L16472">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="fc" id="L16473">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="fc" id="L16474">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="fc" id="L16476">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="fc bfc" id="L16479" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="fc bfc" id="L16480" title="All 2 branches covered.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="fc bfc" id="L16481" title="All 2 branches covered.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="pc bpc" id="L16485" title="1 of 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16489">				return null;</span>
<span class="nc" id="L16490">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16491">			e.printStackTrace();</span>

<span class="nc" id="L16493">			return null;</span>
<span class="fc" id="L16494">		}</span>

<span class="fc" id="L16496">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="pc bpc" id="L16498" title="1 of 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="fc" id="L16501">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16502">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16503">			e.printStackTrace();</span>

<span class="nc" id="L16505">			return null;</span>
<span class="fc" id="L16506">		}</span>

<span class="fc bfc" id="L16508" title="All 2 branches covered.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16509">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="pc bpc" id="L16510" title="1 of 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16511">				return null;</span>
		}

<span class="fc" id="L16514">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L16516" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc bfc" id="L16517" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="fc" id="L16519">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="fc" id="L16520">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="fc" id="L16522">				} catch (java.lang.Exception e) {</span>
<span class="fc" id="L16523">					e.printStackTrace();</span>

<span class="fc" id="L16525">					return null;</span>
<span class="fc" id="L16526">				}</span>
			}
		}

<span class="fc bfc" id="L16530" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16531">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="fc" id="L16532">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="fc" id="L16533">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="fc" id="L16535">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="fc bfc" id="L16537" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16538">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="fc" id="L16539">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="fc" id="L16542">					dblExercisePV = (aadblForwardPrice[iPath][iVertex] - adblExercisePrice[iVertex]) *</span>
<span class="fc" id="L16543">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16544">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16545">					e.printStackTrace();</span>
<span class="fc" id="L16546">				}</span>

<span class="fc bfc" id="L16548" title="All 2 branches covered.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="fc" id="L16549">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="fc" id="L16552">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="fc" id="L16553">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="fc" id="L16554">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="fc" id="L16555">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="fc bfc" id="L16560" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16561">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="fc" id="L16564">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16567">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16570">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16572">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16573">				e.printStackTrace();</span>

<span class="nc" id="L16575">				return null;</span>
<span class="fc" id="L16576">			}</span>

<span class="fc" id="L16578">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="fc" id="L16582">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16586">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16587">			e.printStackTrace();</span>
		}

<span class="nc" id="L16590">		return null;</span>
	}

	/**
	 * Generate the EOS Putable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics putMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16616" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16618">		org.drip.product.params.EmbeddedOptionSchedule eosPut = putSchedule();</span>

<span class="pc bpc" id="L16620" title="1 of 2 branches missed.">		if (null == eosPut) return null;</span>

<span class="nc" id="L16622">		int iNumDimension = gbs.dimension();</span>

<span class="nc" id="L16624">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L16626">		int[] aiExerciseDate = eosPut.exerciseDates (iValueDate);</span>

<span class="nc" id="L16628">		double[] adblExercisePrice = eosPut.exerciseFactors (iValueDate);</span>

<span class="nc bnc" id="L16630" title="All 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="nc" id="L16632">		double dblOAS = java.lang.Double.NaN;</span>
<span class="nc" id="L16633">		int iNumVertex = aiExerciseDate.length;</span>
<span class="nc" id="L16634">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="nc" id="L16635">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="nc" id="L16636">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="nc" id="L16637">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="nc" id="L16638">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="nc" id="L16639">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="nc" id="L16640">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="nc" id="L16641">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="nc" id="L16642">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="nc" id="L16643">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="nc" id="L16644">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="nc" id="L16645">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="nc" id="L16647">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="nc bnc" id="L16650" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="nc bnc" id="L16651" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="nc bnc" id="L16652" title="All 2 branches missed.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="nc bnc" id="L16656" title="All 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16660">				return null;</span>
<span class="nc" id="L16661">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16662">			e.printStackTrace();</span>

<span class="nc" id="L16664">			return null;</span>
<span class="nc" id="L16665">		}</span>

<span class="nc" id="L16667">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="nc bnc" id="L16669" title="All 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="nc" id="L16672">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16673">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16674">			e.printStackTrace();</span>

<span class="nc" id="L16676">			return null;</span>
<span class="nc" id="L16677">		}</span>

<span class="nc bnc" id="L16679" title="All 2 branches missed.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16680">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="nc bnc" id="L16681" title="All 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16682">				return null;</span>
		}

<span class="nc" id="L16685">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L16687" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc bnc" id="L16688" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="nc" id="L16690">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="nc" id="L16691">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16693">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16694">					e.printStackTrace();</span>

<span class="nc" id="L16696">					return null;</span>
<span class="nc" id="L16697">				}</span>
			}
		}

<span class="nc bnc" id="L16701" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16702">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="nc" id="L16703">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="nc" id="L16704">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="nc" id="L16706">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="nc bnc" id="L16708" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16709">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="nc" id="L16710">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="nc" id="L16713">					dblExercisePV = (adblExercisePrice[iVertex] - aadblForwardPrice[iPath][iVertex]) *</span>
<span class="nc" id="L16714">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16715">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16716">					e.printStackTrace();</span>
<span class="nc" id="L16717">				}</span>

<span class="nc bnc" id="L16719" title="All 2 branches missed.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="nc" id="L16720">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="nc" id="L16723">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="nc" id="L16724">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="nc" id="L16725">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="nc" id="L16726">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="nc bnc" id="L16731" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16732">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="nc" id="L16735">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16738">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16741">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16743">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16744">				e.printStackTrace();</span>

<span class="nc" id="L16746">				return null;</span>
<span class="nc" id="L16747">			}</span>

<span class="nc" id="L16749">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="nc" id="L16753">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16757">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16758">			e.printStackTrace();</span>
		}

<span class="nc" id="L16761">		return null;</span>
	}

	@Override public void showPeriods()
		throws java.lang.Exception
	{
<span class="nc bnc" id="L16767" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods())</span>
<span class="nc" id="L16768">			System.out.println (&quot;\t&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.startDate()) +</span>
<span class="nc" id="L16769">				&quot;-&gt;&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.endDate()) + &quot;    &quot; +</span>
<span class="nc" id="L16770">					period.accrualDCF (period.endDate()));</span>
<span class="nc" id="L16771">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>