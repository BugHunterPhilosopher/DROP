<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BondComponent.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">DROP</a> &gt; <a href="index.source.html" class="el_package">org.drip.product.credit</a> &gt; <span class="el_source">BondComponent.java</span></div><h1>BondComponent.java</h1><pre class="source lang-java linenums">
package org.drip.product.credit;

/*
 * -*- mode: java; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*-
 */

/*!
 * Copyright (C) 2018 Lakshmi Krishnamurthy
 * Copyright (C) 2017 Lakshmi Krishnamurthy
 * Copyright (C) 2016 Lakshmi Krishnamurthy
 * Copyright (C) 2015 Lakshmi Krishnamurthy
 * Copyright (C) 2014 Lakshmi Krishnamurthy
 * Copyright (C) 2013 Lakshmi Krishnamurthy
 * Copyright (C) 2012 Lakshmi Krishnamurthy
 * Copyright (C) 2011 Lakshmi Krishnamurthy
 * 
 *  This file is part of DRIP, a free-software/open-source library for buy/side financial/trading model
 *  	libraries targeting analysts and developers
 *  	https://lakshmidrip.github.io/DRIP/
 *  
 *  DRIP is composed of four main libraries:
 *  
 *  - DRIP Fixed Income - https://lakshmidrip.github.io/DRIP-Fixed-Income/
 *  - DRIP Asset Allocation - https://lakshmidrip.github.io/DRIP-Asset-Allocation/
 *  - DRIP Numerical Optimizer - https://lakshmidrip.github.io/DRIP-Numerical-Optimizer/
 *  - DRIP Statistical Learning - https://lakshmidrip.github.io/DRIP-Statistical-Learning/
 * 
 *  - DRIP Fixed Income: Library for Instrument/Trading Conventions, Treasury Futures/Options,
 *  	Funding/Forward/Overnight Curves, Multi-Curve Construction/Valuation, Collateral Valuation and XVA
 *  	Metric Generation, Calibration and Hedge Attributions, Statistical Curve Construction, Bond RV
 *  	Metrics, Stochastic Evolution and Option Pricing, Interest Rate Dynamics and Option Pricing, LMM
 *  	Extensions/Calibrations/Greeks, Algorithmic Differentiation, and Asset Backed Models and Analytics.
 * 
 *  - DRIP Asset Allocation: Library for model libraries for MPT framework, Black Litterman Strategy
 *  	Incorporator, Holdings Constraint, and Transaction Costs.
 * 
 *  - DRIP Numerical Optimizer: Library for Numerical Optimization and Spline Functionality.
 * 
 *  - DRIP Statistical Learning: Library for Statistical Evaluation and Machine Learning.
 * 
 *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 *   	you may not use this file except in compliance with the License.
 *   
 *  You may obtain a copy of the License at
 *  	http://www.apache.org/licenses/LICENSE-2.0
 *  
 *  Unless required by applicable law or agreed to in writing, software
 *  	distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 *  	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  
 *  See the License for the specific language governing permissions and
 *  	limitations under the License.
 */

/**
 * BondComponent is the base class that extends CreditComponent abstract class and implements the
 * 	functionality behind bonds of all kinds. Bond static data is captured in a set of 11 container classes â€“
 *  BondTSYParams, BondCouponParams, BondNotionalParams, BondFloaterParams, BondCurrencyParams,
 *  BondIdentifierParams, CompCRValParams, BondCFTerminationEvent, BondFixedPeriodGenerationParams, and one
 *  EmbeddedOptionSchedule object instance each for the call and the put objects. Each of these parameter set
 *  can be set separately.
 *
 * @author Lakshmi Krishnamurthy
 */

public class BondComponent extends org.drip.product.definition.Bond implements
	org.drip.product.definition.BondProduct
{
	private static final boolean s_bSuppressErrors = true;
	private static final boolean s_bYieldDFOffofCouponAccrualDCF = true;

	/*
	 * Width for calculating local forward rate width
	 */

	private static final int LOCAL_FORWARD_RATE_WIDTH = 1;

	/*
	 * Recovery Period discretization Mode
	 */

	private static final int s_iDiscretizationScheme =
		org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_DAY_STEP;

	/*
	 * Discount Curve to derive the zero curve off of
	 */

	private static final int ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE = 1;
	private static final int ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE = 2;

	/*
	 * Discount Curve to derive Bumped Prices
	 */

	private static final int PRICE_OFF_OF_FUNDING_CURVE = 1;
	private static final int PRICE_OFF_OF_TREASURY_CURVE = 2;
	// private static final int PRICE_OFF_OF_OVERNIGHT_CURVE = 3;

<span class="fc" id="L101">	private org.drip.product.params.BondStream _stream = null;</span>
<span class="fc" id="L102">	private org.drip.product.params.IdentifierSet _idParams = null;</span>
<span class="fc" id="L103">	private org.drip.product.params.CouponSetting _couponSetting = null;</span>
<span class="fc" id="L104">	private org.drip.product.params.CreditSetting _creditSetting = null;</span>
<span class="fc" id="L105">	private org.drip.product.params.FloaterSetting _floaterSetting = null;</span>
<span class="fc" id="L106">	private org.drip.product.params.NotionalSetting _notionalSetting = null;</span>
<span class="fc" id="L107">	private org.drip.product.params.QuoteConvention _quoteConvention = null;</span>
<span class="fc" id="L108">	private org.drip.product.params.TerminationSetting _terminationSetting = null;</span>
<span class="fc" id="L109">	private org.drip.product.params.TreasuryBenchmarks _treasuryBenchmarks = null;</span>

	/*
	 * Bond EOS Params
	 */

<span class="fc" id="L115">	protected org.drip.product.params.EmbeddedOptionSchedule _eosPut = null;</span>
<span class="fc" id="L116">	protected org.drip.product.params.EmbeddedOptionSchedule _eosCall = null;</span>

	private int terminationAdjust (
		final int iDate)
	{
<span class="fc bfc" id="L121" title="All 2 branches covered.">		org.drip.analytics.daycount.DateAdjustParams dap = null == _terminationSetting ? null :</span>
<span class="fc" id="L122">			_terminationSetting.dap();</span>

		try {
<span class="pc bpc" id="L125" title="1 of 2 branches missed.">			return null == dap ? iDate : dap.roll (iDate);</span>
<span class="nc" id="L126">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L127">			e.printStackTrace();</span>
		}

<span class="nc" id="L130">		return iDate;</span>
	}

	private double treasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L139" title="2 of 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L140">			throw new java.lang.Exception (&quot;BondComponent::treasuryBenchmarkYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L142">		java.lang.String strTsyBmk = null;</span>
<span class="fc" id="L143">		org.drip.param.definition.ProductQuote pqTsyBmkYield = null;</span>

<span class="pc bpc" id="L145" title="1 of 2 branches missed.">		if (null != _treasuryBenchmarks) strTsyBmk = _treasuryBenchmarks.primary();</span>

<span class="fc" id="L147">		int iValDate = valParams.valueDate();</span>

<span class="pc bpc" id="L149" title="3 of 4 branches missed.">		if (null == strTsyBmk || strTsyBmk.isEmpty())</span>
<span class="fc" id="L150">			strTsyBmk = org.drip.analytics.support.Helper.BaseTsyBmk (iValDate, iWorkoutDate);</span>

<span class="fc" id="L152">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; pqMap =</span>
<span class="fc" id="L153">			csqc.quoteMap();</span>

<span class="pc bpc" id="L155" title="2 of 6 branches missed.">		if (null != pqMap &amp;&amp; null != strTsyBmk &amp;&amp; !strTsyBmk.isEmpty())</span>
<span class="fc" id="L156">			pqTsyBmkYield = pqMap.get (strTsyBmk);</span>

<span class="fc bfc" id="L158" title="All 2 branches covered.">		if (null != pqTsyBmkYield) {</span>
<span class="fc" id="L159">			 org.drip.param.definition.Quote q = pqTsyBmkYield.quote (&quot;Yield&quot;);</span>

<span class="pc bpc" id="L161" title="1 of 2 branches missed.">			 if (null != q) return q.value (&quot;mid&quot;);</span>
		}

<span class="fc" id="L164">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L166" title="All 2 branches covered.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	private org.drip.param.valuation.WorkoutInfo exerciseCallYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L175" title="4 of 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosCall)
<span class="nc" id="L177">			return null;</span>

<span class="fc" id="L179">		int iValDate = valParams.valueDate();</span>

<span class="fc" id="L181">		int[] aiEOSDate = _eosCall.dates();</span>

<span class="fc" id="L183">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L185">		double[] adblEOSFactor = _eosCall.factors();</span>

<span class="fc" id="L187">		int iNoticePeriod = _eosCall.exerciseNoticePeriod();</span>

<span class="fc" id="L189">		int iExercise = -1;</span>
<span class="fc" id="L190">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="pc bpc" id="L191" title="1 of 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="fc" id="L194">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L195">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L198">			return null;</span>
<span class="fc" id="L199">		}</span>

<span class="fc bfc" id="L201" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="fc bfc" id="L202" title="All 4 branches covered.">			if (iValDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="fc" id="L205">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="fc bfc" id="L208" title="All 2 branches covered.">				if (dblYield &lt; dblExerciseYield) {</span>
<span class="fc" id="L209">					iExercise = i;</span>
<span class="fc" id="L210">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L212">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L214">			}</span>
		}

		try {
<span class="fc bfc" id="L218" title="All 2 branches covered.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L222">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L226">		return null;</span>
	}

	private org.drip.param.valuation.WorkoutInfo exercisePutYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L235" title="All 8 branches missed.">		if (null == valParams || null == csqs || !org.drip.quant.common.NumberUtil.IsValid (dblPrice) || null</span>
			== _eosPut)
<span class="nc" id="L237">			return null;</span>

<span class="nc" id="L239">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L241">		int[] aiEOSDate = _eosPut.dates();</span>

<span class="nc" id="L243">		double[] adblEOSFactor = _eosPut.factors();</span>

<span class="nc" id="L245">		int iNoticePeriod = _eosPut.exerciseNoticePeriod();</span>

<span class="nc" id="L247">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc" id="L249">		int iExercise = -1;</span>
<span class="nc" id="L250">		double dblExerciseYield = java.lang.Double.NaN;</span>
<span class="nc bnc" id="L251" title="All 2 branches missed.">		int iNumEOSDate = null == aiEOSDate ? 0 : aiEOSDate.length;</span>

		try {
<span class="nc" id="L254">			dblExerciseYield = yieldFromPrice (valParams, csqs, vcp, iMaturityDate, 1., dblPrice);</span>
<span class="nc" id="L255">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L258">			return null;</span>
<span class="nc" id="L259">		}</span>

<span class="nc bnc" id="L261" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumEOSDate; ++i) {</span>
<span class="nc bnc" id="L262" title="All 4 branches missed.">			if (iValueDate &gt; aiEOSDate[i] || aiEOSDate[i] - iValueDate &lt; iNoticePeriod) continue;</span>

			try {
<span class="nc" id="L265">				double dblYield = yieldFromPrice (valParams, csqs, vcp, aiEOSDate[i], adblEOSFactor[i],</span>
					dblPrice);

<span class="nc bnc" id="L268" title="All 2 branches missed.">				if (dblYield &gt; dblExerciseYield) {</span>
<span class="nc" id="L269">					iExercise = i;</span>
<span class="nc" id="L270">					dblExerciseYield = dblYield;</span>
				}
<span class="nc" id="L272">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L274">			}</span>
		}

		try {
<span class="nc bnc" id="L278" title="All 2 branches missed.">			return -1 == iExercise ? new org.drip.param.valuation.WorkoutInfo (iMaturityDate,</span>
				dblExerciseYield, 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY) : new
					org.drip.param.valuation.WorkoutInfo (aiEOSDate[iExercise], dblExerciseYield,
						adblEOSFactor[iExercise], org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT);
<span class="nc" id="L282">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L286">		return null;</span>
	}

	private double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield,
		final boolean bApplyCouponExtension)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L299" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L300">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L302">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L304" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L305">			throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L307">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L308">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L309">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L310">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L311">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L312">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L313">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L314">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>

<span class="pc bpc" id="L316" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L317">			? 1. : notional (iValueDate);</span>

<span class="fc" id="L319">		int iFrequency = freq();</span>

<span class="fc" id="L321">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L323">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L325">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L327" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L329" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L330">			_quoteConvention.valuationCustomizationParams();</span>

<span class="fc bfc" id="L332" title="All 2 branches covered.">		if (null != vcp) {</span>
<span class="fc" id="L333">			strDC = vcp.yieldDayCount();</span>

<span class="fc" id="L335">			iFrequency = vcp.yieldFreq();</span>

<span class="fc" id="L337">			strCalendar = vcp.yieldCalendar();</span>

<span class="fc" id="L339">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="fc" id="L341">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L342" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L343">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L345">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L347">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L349">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L351">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L354">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L356" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L357">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L359" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L361" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L362">				bFirstPeriod = false;</span>

<span class="fc" id="L364">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L366">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L368">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L370">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L372" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L373">				iPeriodEndDate = iWorkoutDate;</span>
<span class="fc" id="L374">				bTerminateCouponFlow = true;</span>
			}

<span class="fc" id="L377">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L380" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L381">				throw new java.lang.Exception (&quot;BondComponent::priceFromYield =&gt; No PCM for &quot; + new</span>
<span class="nc" id="L382">					org.drip.analytics.date.JulianDate (iValueDate) + &quot; | &quot; + effectiveDate());</span>

<span class="fc bfc" id="L384" title="All 2 branches covered.">			if (null != vcp) {</span>
<span class="pc bpc" id="L385" title="1 of 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="fc" id="L386">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L388" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L390">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L393">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L396">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
					org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iPeriodPayDate, strDC,
<span class="fc" id="L399">						bApplyCpnEOMAdj, aap, strCalendar)) * cpcm.cumulative();</span>

<span class="fc" id="L401">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L403">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L405">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L407" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L408">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L409" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L410">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L411" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L413">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L415" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L416">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc bfc" id="L418" title="All 2 branches covered.">			dblCumulativePeriodPV += (period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="pc bpc" id="L419" title="1 of 2 branches missed.">				dblFlatForwardRate : cpcm.rate() + (bApplyCouponExtension ?</span>
<span class="pc" id="L420">					_couponSetting.couponRateExtension() : 0.)) * couponFactor (iPeriodEndDate) *</span>
						dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;

<span class="fc bfc" id="L423" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L424">		}</span>

		try {
<span class="fc bfc" id="L427" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L428">				valParams.cashPayDate();</span>
<span class="nc" id="L429">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L432">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L433">		}</span>

<span class="fc" id="L435">		return (((dblCumulativePeriodPV + dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF</span>
<span class="fc" id="L436">			(iFrequency, dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :</span>
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L438">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate)) /</span>
<span class="fc" id="L439">						org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L440">							org.drip.analytics.daycount.Convention.YearFraction (iValueDate, iCashPayDate,</span>
<span class="fc" id="L441">								strDC, bApplyCpnEOMAdj, aap, strCalendar))) - accrued (iValueDate, csqc)) /</span>
									dblScalingNotional;
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; calibMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L451">		double dblCleanPrice = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L453" title="1 of 2 branches missed.">		org.drip.param.definition.CalibrationParams calibParams = null == pricerParams ? null :</span>
<span class="fc" id="L454">			pricerParams.calibParams();</span>

<span class="pc bpc" id="L456" title="1 of 2 branches missed.">		if (null == calibParams) return null;</span>

<span class="fc" id="L458">		org.drip.param.valuation.WorkoutInfo wi = calibParams.workout();</span>

<span class="fc bfc" id="L460" title="All 2 branches covered.">		double dblExerciseFactor = null == wi ? 1. : wi.factor();</span>

<span class="fc bfc" id="L462" title="All 2 branches covered.">		int iExerciseDate = null == wi ? maturityDate().julian() : wi.date();</span>

<span class="fc" id="L464">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

		try {
<span class="fc bfc" id="L467" title="All 2 branches covered.">			dblCleanPrice = null == cc ? priceFromFundingCurve (valParams, csqc, iExerciseDate,</span>
<span class="fc" id="L468">				dblExerciseFactor, 0.) : priceFromCreditCurve (valParams, csqc, iExerciseDate,</span>
					dblExerciseFactor, 0., false);
<span class="fc" id="L470">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="fc" id="L473">			return null;</span>
<span class="fc" id="L474">		}</span>

<span class="pc bpc" id="L476" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblCleanPrice)) return null;</span>

<span class="fc" id="L478">		java.lang.String strCalibMeasure = calibParams.measure();</span>

<span class="fc" id="L480">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt;();

<span class="fc bfc" id="L483" title="All 2 branches covered.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CleanPrice&quot;, &quot;FairCleanPrice&quot;, &quot;FairPrice&quot;, &quot;Price&quot;}, false)) {
<span class="fc" id="L485">			mapCalibMeasures.put (strCalibMeasure, dblCleanPrice);</span>

<span class="fc" id="L487">			return mapCalibMeasures;</span>
		}

<span class="pc bpc" id="L490" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;DirtyPrice&quot;, &quot;FairDirtyPrice&quot;}, false)) {
			try {
<span class="nc" id="L493">				mapCalibMeasures.put (strCalibMeasure, dblCleanPrice + accrued (valParams.valueDate(),</span>
					csqc));

<span class="nc" id="L496">				return mapCalibMeasures;</span>
<span class="nc" id="L497">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="pc bpc" id="L502" title="1 of 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;Yield&quot;, &quot;FairYield&quot;}, false)) {
			try {
<span class="fc" id="L505">				mapCalibMeasures.put (strCalibMeasure, yieldFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="fc" id="L508">				return mapCalibMeasures;</span>
<span class="nc" id="L509">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L514" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;TSYSpread&quot;, &quot;FairTSYSpread&quot;}, false)) {
			try {
<span class="nc" id="L517">				mapCalibMeasures.put (strCalibMeasure, tsySpreadFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L520">				return mapCalibMeasures;</span>
<span class="nc" id="L521">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L526" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;OAS&quot;, &quot;OASpread&quot;, &quot;OptionAdjustedSpread&quot;}, false)) {
			try {
<span class="nc" id="L529">				mapCalibMeasures.put (strCalibMeasure, oasFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L532">				return mapCalibMeasures;</span>
<span class="nc" id="L533">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L538" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;BondBasis&quot;, &quot;YieldBasis&quot;, &quot;YieldSpread&quot;}, false)) {
			try {
<span class="nc" id="L541">				mapCalibMeasures.put (strCalibMeasure, bondBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L544">				return mapCalibMeasures;</span>
<span class="nc" id="L545">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L550" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;CreditBasis&quot;}, false)) {
<span class="nc bnc" id="L552" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L555">				mapCalibMeasures.put (strCalibMeasure, creditBasisFromPrice (valParams, csqc, vcp,</span>
					iExerciseDate, dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L558">				return mapCalibMeasures;</span>
<span class="nc" id="L559">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc bnc" id="L564" title="All 2 branches missed.">		if (org.drip.quant.common.StringUtil.MatchInStringArray (strCalibMeasure, new java.lang.String[]</span>
			{&quot;PECS&quot;, &quot;ParEquivalentCDSSpread&quot;}, false)) {
<span class="nc bnc" id="L566" title="All 2 branches missed.">			if (null == cc) return null;</span>

			try {
<span class="nc" id="L569">				mapCalibMeasures.put (strCalibMeasure, pecsFromPrice (valParams, csqc, vcp, iExerciseDate,</span>
					dblExerciseFactor, dblCleanPrice));

<span class="nc" id="L572">				return mapCalibMeasures;</span>
<span class="nc" id="L573">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
		}

<span class="nc" id="L578">		return null;</span>
	}

	@Override public org.drip.param.valuation.WorkoutInfo exerciseYieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="pc bpc" id="L587" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L588">			return null;</span>

<span class="fc" id="L590">		int iMaturityDate = maturityDate().julian();</span>

		try {
<span class="pc bpc" id="L593" title="1 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L594">				return new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPrice (valParams,</span>
					csqc, vcp, iMaturityDate, 1., dblPrice), 1.,
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);

<span class="pc bpc" id="L598" title="3 of 4 branches missed.">			if (null == _eosCall &amp;&amp; null != _eosPut)</span>
<span class="nc" id="L599">				return exercisePutYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="pc bpc" id="L601" title="2 of 4 branches missed.">			if (null != _eosCall &amp;&amp; null == _eosPut)</span>
<span class="fc" id="L602">				return exerciseCallYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc" id="L604">			org.drip.param.valuation.WorkoutInfo wiPut = exercisePutYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc" id="L607">			org.drip.param.valuation.WorkoutInfo wiCall = exerciseCallYieldFromPrice (valParams, csqc, vcp,</span>
				dblPrice);

<span class="nc bnc" id="L610" title="All 4 branches missed.">			if (null == wiPut || null == wiCall) return null;</span>

<span class="nc bnc" id="L612" title="All 2 branches missed.">			return wiPut.date() &lt; wiCall.date() ? wiPut : wiCall;</span>
<span class="nc" id="L613">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L617">		return null;</span>
	}

	private double indexRate (
		final int iValueDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.analytics.cashflow.CompositeFloatingPeriod cup)
		throws java.lang.Exception
	{
<span class="fc" id="L626">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState (fundingLabel());</span>

<span class="fc" id="L628">		int iFreq = freq();</span>

<span class="pc bpc" id="L630" title="1 of 2 branches missed.">		if (null != cup) {</span>
<span class="fc" id="L631">			org.drip.analytics.cashflow.ComposableUnitPeriod cupFirst = cup.periods().get (0);</span>

<span class="pc bpc" id="L633" title="1 of 2 branches missed.">			if (!(cupFirst instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod))</span>
<span class="nc" id="L634">				throw new java.lang.Exception (&quot;BondComponent::indexRate =&gt; Not a floater&quot;);</span>

<span class="fc" id="L636">			return ((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod) cupFirst).baseRate (csqc);</span>
		}

<span class="nc bnc" id="L639" title="All 2 branches missed.">		return dc.libor (iValueDate, 0 != iFreq ? iValueDate + 365 / iFreq : iValueDate +</span>
			LOCAL_FORWARD_RATE_WIDTH);
	}

	private org.drip.analytics.output.BondWorkoutMeasures workoutMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
	{
<span class="pc bpc" id="L650" title="2 of 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="fc" id="L652">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L654" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L656">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L658" title="All 2 branches covered.">		if (null == dcFunding) return null;</span>

<span class="fc bfc" id="L660" title="All 2 branches covered.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="fc bfc" id="L662" title="All 2 branches covered.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="fc" id="L663">			_creditSetting.recovery();</span>

<span class="fc bfc" id="L665" title="All 2 branches covered.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="fc bfc" id="L667" title="All 2 branches covered.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L669">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="fc" id="L671">		double dblAccrued01 = 0.;</span>
<span class="fc" id="L672">		double dblRecoveryPV = 0.;</span>
<span class="fc" id="L673">		boolean bPeriodZero = true;</span>
<span class="fc" id="L674">		double dblExpectedRecovery = 0.;</span>
<span class="fc" id="L675">		double dblCreditRiskyDirtyDV01 = 0.;</span>
<span class="fc" id="L676">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L677">		double dblCreditRiskyPrincipalPV = 0.;</span>
<span class="fc" id="L678">		double dblCreditRisklessDirtyDV01 = 0.;</span>
<span class="fc" id="L679">		double dblCreditRiskyDirtyCouponPV = 0.;</span>
<span class="fc" id="L680">		double dblCreditRisklessPrincipalPV = 0.;</span>
<span class="fc" id="L681">		double dblCreditRisklessDirtyCouponPV = 0.;</span>
<span class="fc" id="L682">		double dblFirstCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L683">		double dblCreditRiskyDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L684">		double dblFirstIndexRate = java.lang.Double.NaN;</span>
<span class="fc" id="L685">		double dblCreditRisklessDirtyIndexCouponPV = 0.;</span>
<span class="fc" id="L686">		double dblCreditRiskyParPV = java.lang.Double.NaN;</span>
<span class="fc" id="L687">		double dblFlatForwardCoupon = java.lang.Double.NaN;</span>
<span class="fc" id="L688">		double dblCreditRisklessParPV = java.lang.Double.NaN;</span>

<span class="fc bfc" id="L690" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L691">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L693" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

		try {
<span class="pc bpc" id="L696" title="1 of 2 branches missed.">			for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L697">				int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L699" title="All 2 branches covered.">				if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L701">				int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L703">				int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L705" title="All 2 branches covered.">				if (iWorkoutDate &lt;= iPeriodEndDate) {</span>
<span class="fc" id="L706">					bTerminateCouponFlow = true;</span>
<span class="fc" id="L707">					iPeriodEndDate = iWorkoutDate;</span>
				}

<span class="fc" id="L710">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L713" title="1 of 2 branches missed.">				if (null == cpcm) return null;</span>

<span class="fc bfc" id="L715" title="All 2 branches covered.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardCoupon))</span>
<span class="fc" id="L716">					dblFlatForwardCoupon = cpcm.rate();</span>

<span class="fc" id="L718">				double dblPeriodBaseRate = period.periods().get (0).baseRate (csqc);</span>

<span class="fc" id="L720">				double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="pc bpc" id="L722" title="1 of 2 branches missed.">				double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardCoupon : cpcm.rate();</span>

<span class="fc bfc" id="L724" title="All 2 branches covered.">				if (bPeriodZero) {</span>
<span class="fc" id="L725">					bPeriodZero = false;</span>
<span class="fc" id="L726">					dblFirstCoupon = dblPeriodCoupon;</span>

<span class="pc bpc" id="L728" title="1 of 2 branches missed.">					if (iPeriodStartDate &lt; iValueDate)</span>
<span class="fc" id="L729">						dblAccrued01 = 0.0001 * period.accrualDCF (iValueDate) * notional (iPeriodStartDate,</span>
							iValueDate);

<span class="fc bfc" id="L732" title="All 2 branches covered.">					if (null != _floaterSetting) dblFirstIndexRate = dblPeriodBaseRate;</span>
				}

<span class="fc" id="L735">				double dblPeriodCreditRisklessDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) *</span>
<span class="fc" id="L736">					dblPeriodAnnuity * notional (iPeriodStartDate);</span>

<span class="fc" id="L738">				double dblPeriodCreditRiskessPrincipalPV = (notional (iPeriodStartDate) - notional</span>
<span class="fc" id="L739">					(iPeriodEndDate)) * dblPeriodAnnuity;</span>

<span class="fc" id="L741">				double dblPeriodCreditRiskyDirtyDV01 = dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L742">				double dblPeriodCreditRiskyPrincipalPV = dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc bfc" id="L744" title="All 4 branches covered.">				if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="pc bpc" id="L745" title="1 of 2 branches missed.">					double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
						iPeriodEndDate);

<span class="fc" id="L748">					dblPeriodCreditRiskyDirtyDV01 *= dblSurvProb;</span>
<span class="fc" id="L749">					dblPeriodCreditRiskyPrincipalPV *= dblSurvProb;</span>

<span class="fc bfc" id="L751" title="All 2 branches covered.">					for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
<span class="fc" id="L752">						valParams, pricerParams, terminationAdjust (iWorkoutDate), csqc)) {</span>
<span class="pc bpc" id="L753" title="1 of 2 branches missed.">						if (null == lqm) continue;</span>

<span class="fc" id="L755">						int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L757">						int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L759">						double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
							iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L762">						double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L764">						double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L765">							(iSubPeriodEndDate);</span>

<span class="pc bpc" id="L767" title="1 of 2 branches missed.">						if (bAccrualOnDefault)</span>
<span class="fc" id="L768">							dblPeriodCreditRiskyDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival</span>
								* dblSubPeriodDF * dblSubPeriodNotional;

<span class="pc bpc" id="L771" title="1 of 2 branches missed.">						double dblRecovery = bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
							iSubPeriodEndDate) : dblProductRecovery;

<span class="fc" id="L774">						double dblSubPeriodExpRecovery = dblRecovery * dblSubPeriodSurvival *</span>
							dblSubPeriodNotional;
<span class="fc" id="L776">						dblRecoveryPV += dblSubPeriodExpRecovery * dblSubPeriodDF;</span>
<span class="fc" id="L777">						dblExpectedRecovery += dblSubPeriodExpRecovery;</span>
<span class="fc" id="L778">					}</span>
				}

<span class="fc" id="L781">				dblCreditRiskyDirtyDV01 += dblPeriodCreditRiskyDirtyDV01;</span>
<span class="fc" id="L782">				dblCreditRiskyPrincipalPV += dblPeriodCreditRiskyPrincipalPV;</span>
<span class="fc" id="L783">				dblCreditRisklessDirtyDV01 += dblPeriodCreditRisklessDirtyDV01;</span>
<span class="fc" id="L784">				dblCreditRisklessPrincipalPV += dblPeriodCreditRiskessPrincipalPV;</span>

<span class="fc" id="L786">				dblCreditRiskyDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRiskyDirtyDV01;

<span class="fc" id="L789">				dblCreditRisklessDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc" id="L792">				dblCreditRiskyDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRiskyDirtyDV01;
<span class="fc" id="L794">				dblCreditRisklessDirtyIndexCouponPV += 10000. * dblPeriodBaseRate *</span>
					dblPeriodCreditRisklessDirtyDV01;

<span class="fc bfc" id="L797" title="All 2 branches covered.">				if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L798">			}</span>
<span class="fc" id="L799">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="fc" id="L802">			return null;</span>
<span class="fc" id="L803">		}</span>

<span class="fc" id="L805">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>

		try {
<span class="fc bfc" id="L808" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L809">				valParams.cashPayDate();</span>
<span class="nc" id="L810">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L813">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L814">		}</span>

		try {
<span class="fc" id="L817">			double dblCashPayDF = dcFunding.df (iCashPayDate);</span>

<span class="fc" id="L819">			int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L821">			dblCreditRisklessParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate) *</span>
				dblWorkoutFactor;

<span class="pc bpc" id="L824" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams)</span>
<span class="nc" id="L825">				dblCreditRiskyParPV = dblCreditRisklessParPV * cc.survival (iMaturityDate);</span>

<span class="fc" id="L827">			org.drip.analytics.output.BondCouponMeasures bcmCreditRisklessDirty = new</span>
				org.drip.analytics.output.BondCouponMeasures (dblCreditRisklessDirtyDV01,
					dblCreditRisklessDirtyIndexCouponPV, dblCreditRisklessDirtyCouponPV,
						dblCreditRisklessDirtyCouponPV + dblCreditRisklessPrincipalPV +
							dblCreditRisklessParPV);

<span class="fc" id="L833">			double dblDefaultExposure = java.lang.Double.NaN;</span>
<span class="fc" id="L834">			double dblDefaultExposureNoRec = java.lang.Double.NaN;</span>
<span class="fc" id="L835">			double dblLossOnInstantaneousDefault = java.lang.Double.NaN;</span>
<span class="fc" id="L836">			org.drip.analytics.output.BondCouponMeasures bcmCreditRiskyDirty = null;</span>

<span class="pc bpc" id="L838" title="1 of 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc" id="L839">				double dblInitialNotional = notional (iValueDate);</span>

<span class="nc" id="L841">				double dblInitialRecovery = cc.recovery (iValueDate);</span>

<span class="nc" id="L843">				bcmCreditRiskyDirty = new org.drip.analytics.output.BondCouponMeasures</span>
					(dblCreditRiskyDirtyDV01, dblCreditRiskyDirtyIndexCouponPV, dblCreditRiskyDirtyCouponPV,
						dblCreditRiskyDirtyCouponPV + dblCreditRiskyPrincipalPV + dblCreditRiskyParPV);

<span class="nc" id="L847">				dblDefaultExposure = (dblDefaultExposureNoRec = dblInitialNotional) * dblInitialRecovery;</span>
<span class="nc" id="L848">				dblLossOnInstantaneousDefault = dblInitialNotional * (1. - dblInitialRecovery);</span>
			}

<span class="fc" id="L851">			return new org.drip.analytics.output.BondWorkoutMeasures (bcmCreditRiskyDirty,</span>
				bcmCreditRisklessDirty, dblCreditRiskyParPV, dblCreditRisklessParPV,
					dblCreditRiskyPrincipalPV, dblCreditRisklessPrincipalPV, dblRecoveryPV,
						dblExpectedRecovery, dblDefaultExposure, dblDefaultExposureNoRec,
							dblLossOnInstantaneousDefault, dblAccrued01, dblFirstCoupon, dblFirstIndexRate,
								dblCashPayDF);
<span class="nc" id="L857">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L861">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; rvMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice,
		final java.lang.String strPrefix)
	{
<span class="pc bpc" id="L873" title="1 of 2 branches missed.">		if (null == strPrefix) return null;</span>

<span class="fc" id="L875">		org.drip.analytics.output.BondRVMeasures bmRV = standardMeasures (valParams, pricerParams, csqc, vcp,</span>
			wi, dblPrice);

<span class="pc bpc" id="L878" title="1 of 2 branches missed.">		return null == bmRV ? null : bmRV.toMap (strPrefix);</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; fairMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="fc" id="L887">		int iMaturityDate = maturityDate().julian();</span>

<span class="fc" id="L889">		org.drip.analytics.output.BondWorkoutMeasures bwmFair = workoutMeasures (valParams, pricerParams,</span>
			csqc, iMaturityDate, 1.);

<span class="fc bfc" id="L892" title="All 2 branches covered.">		if (null == bwmFair) return null;</span>

<span class="fc" id="L894">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = bwmFair.toMap (&quot;&quot;);</span>

<span class="fc" id="L896">		org.drip.analytics.output.BondCouponMeasures bcm = bwmFair.creditRiskyCleanbcm();</span>

<span class="pc bpc" id="L898" title="1 of 2 branches missed.">		double dblCreditRiskyPV = null == bcm ? java.lang.Double.NaN : bcm.pv();</span>

<span class="pc bpc" id="L900" title="1 of 2 branches missed.">		double dblPrice = !org.drip.quant.common.NumberUtil.IsValid (dblCreditRiskyPV) ?</span>
<span class="pc" id="L901">			bwmFair.creditRisklessCleanbcm().pv() : dblCreditRiskyPV;</span>

		try {
<span class="fc" id="L904">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, rvMeasures (valParams,</span>
				pricerParams, csqc, vcp, new org.drip.param.valuation.WorkoutInfo (iMaturityDate,
<span class="fc" id="L906">					yieldFromPrice (valParams, csqc, vcp, dblPrice / notional (valParams.valueDate())), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY), dblPrice, &quot;&quot;));

<span class="fc" id="L909">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L910">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Fair&quot;));</span>

<span class="fc" id="L912">			return mapMeasures;</span>
<span class="nc" id="L913">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L917">		return null;</span>
	}

	private org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; marketMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wiMarket)
	{
		try {
<span class="fc" id="L928">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = rvMeasures</span>
<span class="fc" id="L929">				(valParams, pricerParams, csqc, vcp, wiMarket, priceFromYield (valParams, csqc, vcp,</span>
<span class="fc" id="L930">					wiMarket.date(), wiMarket.factor(), wiMarket.yield()), &quot;&quot;);</span>

<span class="fc" id="L932">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures,</span>
<span class="fc" id="L933">				org.drip.quant.common.CollectionUtil.PrefixKeys (mapMeasures, &quot;Market&quot;));</span>

<span class="fc" id="L935">			return mapMeasures;</span>
<span class="nc" id="L936">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L940">		return null;</span>
	}

	private org.drip.analytics.cashflow.CompositePeriod currentPeriod (
		final int iDate)
	{
		try {
<span class="fc" id="L947">			return _stream.period (_stream.periodIndex (iDate));</span>
<span class="nc" id="L948">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L952">		return null;</span>
	}

	private double priceFromDiscountCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump,
		final int iDiscountCurveType)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L964" title="3 of 6 branches missed.">		if (null == valParams || null == csqc ||!org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L965" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="nc" id="L966">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L968">		org.drip.state.discount.DiscountCurve dc = null;</span>

<span class="pc bpc" id="L970" title="1 of 2 branches missed.">		if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="fc" id="L971">			dc = csqc.fundingState (fundingLabel());</span>
<span class="nc bnc" id="L972" title="All 2 branches missed.">		else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L973">			dc = csqc.govvieState (govvieLabel());</span>
		/* else if (PRICE_OFF_OF_OVERNIGHT_CURVE == iDiscountCurveType)
			dfe = csqc.overnightState (overnightLabel()); */

<span class="pc bpc" id="L977" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L978">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No Discount Curve&quot;);</span>

<span class="fc" id="L980">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L982" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L983">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L984">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L985">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L987">		double dblPV = 0.;</span>
<span class="fc" id="L988">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L989">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L990">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L992" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L993">			? 1. : notional (iValueDate);</span>

<span class="fc bfc" id="L995" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L996">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L998" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L1000" title="1 of 2 branches missed.">		if (0. != dblBump) {</span>
<span class="nc bnc" id="L1001" title="All 2 branches missed.">			if (PRICE_OFF_OF_FUNDING_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1002">				dc = (org.drip.state.discount.MergedDiscountForwardCurve) dc.parallelShiftManifestMeasure</span>
<span class="nc" id="L1003">					(&quot;SwapRate&quot;, dblBump);</span>
<span class="nc bnc" id="L1004" title="All 2 branches missed.">			else if (PRICE_OFF_OF_TREASURY_CURVE == iDiscountCurveType)</span>
<span class="nc" id="L1005">				dc = (org.drip.state.govvie.GovvieCurve) dc.parallelShiftManifestMeasure (&quot;Yield&quot;, dblBump);</span>
		}

<span class="pc bpc" id="L1008" title="1 of 2 branches missed.">		if (null == dc)</span>
<span class="nc" id="L1009">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromDiscountCurve =&gt; Cannot shift Discount Curve&quot;);

<span class="pc bpc" id="L1012" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1013">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L1015" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L1017">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L1019">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L1021">			int iNotionalEndDate = period.endDate();</span>

<span class="fc bfc" id="L1023" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L1024">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L1025">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L1026">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L1029">			org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L1032" title="1 of 2 branches missed.">			if (null == pcm)</span>
<span class="nc" id="L1033">				throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountCurve =&gt; No PCM&quot;);</span>

<span class="fc" id="L1035">			double dblPeriodAnnuity = dc.df (iPeriodPayDate) * pcm.cumulative();</span>

<span class="fc" id="L1037">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L1039">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L1041">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L1043">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L1045" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L1046">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L1047" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L1048">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L1049" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L1051">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc bfc" id="L1053" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L1054">				dblFlatForwardRate = pcm.rate();</span>

<span class="pc bpc" id="L1056" title="1 of 2 branches missed.">			dblPV += period.accrualDCF (iAccrualEndDate) * dblPeriodAnnuity * (bApplyFlatForward ?</span>
<span class="fc" id="L1057">				dblFlatForwardRate : pcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L1059">			dblPV += (dblPeriodStartNotional - dblPeriodEndNotional) * dblPeriodAnnuity;</span>

<span class="fc bfc" id="L1061" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L1062">		}</span>

		try {
<span class="fc bfc" id="L1065" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L1066">				valParams.cashPayDate();</span>
<span class="nc" id="L1067">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1070">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L1071">		}</span>

<span class="fc" id="L1073">		return ((dblPV + dblWorkoutFactor * dc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L1074">			(iWorkoutDate)) / dc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	/**
	 * Constructor: Construct an empty bond object
	 */

	public BondComponent()
<span class="fc" id="L1082">	{</span>
<span class="fc" id="L1083">	}</span>

	@Override public double[] secTreasurySpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1089" title="All 4 branches missed.">		if (null == valParams || null == csqc) return null;</span>

<span class="nc" id="L1091">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1092">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1094" title="All 4 branches missed.">		if (null == mapTSYQuote || 0 == mapTSYQuote.size()) return null;</span>

<span class="nc bnc" id="L1096" title="All 2 branches missed.">		java.lang.String[] astrTreasuryBenchmark = null == _treasuryBenchmarks ? null :</span>
<span class="nc" id="L1097">			_treasuryBenchmarks.secondary();</span>

<span class="nc bnc" id="L1099" title="All 2 branches missed.">		int iNumTreasuryBenchmark = null == astrTreasuryBenchmark ? 0 : astrTreasuryBenchmark.length;</span>
<span class="nc" id="L1100">		double[] adblSecTSYSpread = new double[iNumTreasuryBenchmark];</span>

<span class="nc bnc" id="L1102" title="All 2 branches missed.">		if (0 == iNumTreasuryBenchmark) return null;</span>

<span class="nc bnc" id="L1104" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumTreasuryBenchmark; ++i) {</span>
<span class="nc" id="L1105">			org.drip.param.definition.ProductQuote pqTSYBenchmark = mapTSYQuote.get</span>
<span class="nc" id="L1106">				(astrTreasuryBenchmark[i]);</span>

<span class="nc bnc" id="L1108" title="All 2 branches missed.">			org.drip.param.definition.Quote q = null == pqTSYBenchmark ? null : pqTSYBenchmark.quote</span>
<span class="nc" id="L1109">				(&quot;Yield&quot;);</span>

<span class="nc bnc" id="L1111" title="All 2 branches missed.">			adblSecTSYSpread[i] = null == q ? java.lang.Double.NaN : q.value (&quot;mid&quot;);</span>
		}

<span class="nc" id="L1114">		return adblSecTSYSpread;</span>
	}

	@Override public double effectiveTreasuryBenchmarkYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1124" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1125">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Bad val/mkt Params&quot;);

<span class="nc" id="L1128">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1130" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L1131">			throw new java.lang.Exception</span>
				(&quot;BondComponent::effectiveTreasuryBenchmarkYield =&gt; Invalid Work-out!&quot;);

<span class="nc bnc" id="L1134" title="All 2 branches missed.">		java.lang.String strTreasuryBenchmark = null != _treasuryBenchmarks ? _treasuryBenchmarks.primary() :</span>
			null;

<span class="nc" id="L1137">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1139">		int iWorkoutDate = wi.date();</span>

<span class="nc bnc" id="L1141" title="All 4 branches missed.">		if (null == strTreasuryBenchmark || strTreasuryBenchmark.isEmpty())</span>
<span class="nc" id="L1142">			strTreasuryBenchmark = org.drip.analytics.support.Helper.BaseTsyBmk (iValueDate, iWorkoutDate);</span>

<span class="nc" id="L1144">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.param.definition.ProductQuote&gt; mapTSYQuote</span>
<span class="nc" id="L1145">			= csqc.quoteMap();</span>

<span class="nc bnc" id="L1147" title="All 2 branches missed.">		org.drip.param.definition.ProductQuote pqTSYBenchmark = null != mapTSYQuote &amp;&amp;</span>
<span class="nc bnc" id="L1148" title="All 4 branches missed.">			mapTSYQuote.containsKey (strTreasuryBenchmark) &amp;&amp; !strTreasuryBenchmark.isEmpty() ?</span>
<span class="nc" id="L1149">				mapTSYQuote.get (strTreasuryBenchmark) : null;</span>

<span class="nc bnc" id="L1151" title="All 2 branches missed.">		org.drip.param.definition.Quote q = null != pqTSYBenchmark ? pqTSYBenchmark.quote (&quot;Yield&quot;) : null;</span>

<span class="nc bnc" id="L1153" title="All 2 branches missed.">		if (null != q) return q.value (&quot;mid&quot;);</span>

<span class="nc" id="L1155">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());;</span>

<span class="nc bnc" id="L1157" title="All 2 branches missed.">		return null == gc ? java.lang.Double.NaN : gc.yield (terminationAdjust (iWorkoutDate));</span>
	}

	@Override public boolean setTreasuryBenchmark (
		final org.drip.product.params.TreasuryBenchmarks treasuryBenchmarks)
	{
<span class="pc bpc" id="L1163" title="1 of 2 branches missed.">		return null != (_treasuryBenchmarks = treasuryBenchmarks);</span>
	}

	@Override public org.drip.product.params.TreasuryBenchmarks treasuryBenchmark()
	{
<span class="nc" id="L1168">		return _treasuryBenchmarks;</span>
	}

	@Override public boolean setIdentifierSet (
		final org.drip.product.params.IdentifierSet idParams)
	{
<span class="pc bpc" id="L1174" title="1 of 2 branches missed.">		return null != (_idParams = idParams);</span>
	}

	@Override public org.drip.product.params.IdentifierSet identifierSet()
	{
<span class="nc" id="L1179">		return _idParams;</span>
	}

	@Override public boolean setCouponSetting (
		final org.drip.product.params.CouponSetting couponSetting)
	{
<span class="pc bpc" id="L1185" title="1 of 2 branches missed.">		return null != (_couponSetting = couponSetting);</span>
	}

	@Override public org.drip.product.params.CouponSetting couponSetting()
	{
<span class="nc" id="L1190">		return _couponSetting;</span>
	}

	@Override public boolean setFloaterSetting (
		final org.drip.product.params.FloaterSetting fltParams)
	{
<span class="fc bfc" id="L1196" title="All 2 branches covered.">		return null == (_floaterSetting = fltParams);</span>
	}

	@Override public org.drip.product.params.FloaterSetting floaterSetting()
	{
<span class="fc" id="L1201">		return _floaterSetting;</span>
	}

	@Override public boolean setMarketConvention (
		final org.drip.product.params.QuoteConvention quoteConvention)
	{
<span class="pc bpc" id="L1207" title="1 of 2 branches missed.">		return null == (_quoteConvention = quoteConvention);</span>
	}

	@Override public org.drip.product.params.QuoteConvention marketConvention()
	{
<span class="nc" id="L1212">		return _quoteConvention;</span>
	}

	@Override public boolean setCreditSetting (
		final org.drip.product.params.CreditSetting creditSetting)
	{
<span class="pc bpc" id="L1218" title="1 of 2 branches missed.">		return null == (_creditSetting = creditSetting);</span>
	}

	@Override public org.drip.product.params.CreditSetting creditSetting()
	{
<span class="nc" id="L1223">		return _creditSetting;</span>
	}

	@Override public boolean setTerminationSetting (
		final org.drip.product.params.TerminationSetting terminationSetting)
	{
<span class="pc bpc" id="L1229" title="1 of 2 branches missed.">		return null == (_terminationSetting = terminationSetting);</span>
	}

	@Override public org.drip.product.params.TerminationSetting terminationSetting()
	{
<span class="nc" id="L1234">		return _terminationSetting;</span>
	}

	@Override public boolean setStream (
		final org.drip.product.params.BondStream stream)
	{
<span class="pc bpc" id="L1240" title="1 of 2 branches missed.">		return null != (_stream = stream);</span>
	}

	@Override public org.drip.product.params.BondStream stream()
	{
<span class="fc" id="L1245">		return _stream;</span>
	}

	@Override public boolean setNotionalSetting (
		final org.drip.product.params.NotionalSetting notionalSetting)
	{
<span class="pc bpc" id="L1251" title="1 of 2 branches missed.">		return null == (_notionalSetting = notionalSetting);</span>
	}

	@Override public org.drip.product.params.NotionalSetting notionalSetting()
	{
<span class="nc" id="L1256">		return _notionalSetting;</span>
	}

	@Override public java.lang.String primaryCode()
	{
<span class="pc bpc" id="L1261" title="1 of 2 branches missed.">		return null == _idParams ? null : &quot;BOND.&quot; + _idParams.id();</span>
	}

	@Override public void setPrimaryCode (
		final java.lang.String strCode)
	{
		// _strCode = strCode;
<span class="nc" id="L1268">	}</span>

	@Override public java.lang.String[] secondaryCode()
	{
<span class="fc" id="L1272">		return new java.lang.String[] {_idParams.id()};</span>
	}

	@Override public java.lang.String isin()
	{
<span class="nc bnc" id="L1277" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.isin();</span>
	}

	@Override public java.lang.String cusip()
	{
<span class="nc bnc" id="L1282" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.cusip();</span>
	}

	@Override public java.lang.String name()
	{
<span class="pc bpc" id="L1287" title="1 of 2 branches missed.">		return null == _idParams ? null : _idParams.id();</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; couponCurrency()
	{
<span class="nc" id="L1292">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt; mapCouponCurrency = new</span>
			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.String&gt;();

<span class="nc" id="L1295">		mapCouponCurrency.put (name(), _stream.couponCurrency());</span>

<span class="nc" id="L1297">		return mapCouponCurrency;</span>
	}

	@Override public java.lang.String payCurrency()
	{
<span class="fc" id="L1302">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String principalCurrency()
	{
<span class="nc" id="L1307">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public double notional (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1314" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1315">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1317">		return _notionalSetting.outstandingFactorSchedule().y (iDate);</span>
	}

	@Override public double notional (
		final int iStartDate,
		final int iEndDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1325" title="2 of 4 branches missed.">		if (null == _notionalSetting || null == _notionalSetting.outstandingFactorSchedule())</span>
<span class="nc" id="L1326">			throw new java.lang.Exception (&quot;BondComponent::notional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1328">		return _notionalSetting.outstandingFactorSchedule().y (iStartDate, iEndDate);</span>
	}

	@Override public double initialNotional()
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1334" title="1 of 2 branches missed.">		if (null == _notionalSetting)</span>
<span class="nc" id="L1335">			throw new java.lang.Exception (&quot;BondComponent::initialNotional =&gt; Bad state/inputs&quot;);</span>

<span class="fc" id="L1337">		return _notionalSetting.notionalAmount();</span>
	}

	public double couponFactor (
		final int iDate)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1344" title="1 of 2 branches missed.">		if (null == _couponSetting) return 1.;</span>

<span class="fc" id="L1346">		org.drip.quant.common.Array2D fsCoupon = _couponSetting.factorSchedule();</span>

<span class="fc bfc" id="L1348" title="All 2 branches covered.">		return null == fsCoupon ? 1. : fsCoupon.y (iDate);</span>
	}

	@Override public double recovery (
		final int iDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1356" title="All 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="nc bnc" id="L1358" title="All 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.recovery (iDate) : _creditSetting.recovery();</span>
	}

	@Override public double recovery (
		final int iStartDate,
		final int iEndDate,
		final org.drip.state.credit.CreditCurve cc)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1367" title="1 of 2 branches missed.">		if (null == cc) throw new java.lang.Exception (&quot;BondComponent::recovery: Bad state/inputs&quot;);</span>

<span class="pc bpc" id="L1369" title="1 of 2 branches missed.">		return _creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iStartDate, iEndDate) :</span>
<span class="nc" id="L1370">			_creditSetting.recovery();</span>
	}

	@Override public org.drip.product.params.CreditSetting creditValuationParams()
	{
<span class="fc" id="L1375">		return _creditSetting;</span>
	}

	@Override public org.drip.analytics.output.CompositePeriodCouponMetrics couponMetrics (
		final int iAccrualEndDate,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="fc" id="L1383">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iAccrualEndDate);</span>

<span class="pc bpc" id="L1385" title="1 of 2 branches missed.">		if (null == cp) return null;</span>

<span class="fc" id="L1387">		java.util.List&lt;org.drip.analytics.output.UnitPeriodMetrics&gt; lsUPM = new</span>
			java.util.ArrayList&lt;org.drip.analytics.output.UnitPeriodMetrics&gt;();

		try {
<span class="fc" id="L1391">			lsUPM.add (new org.drip.analytics.output.UnitPeriodMetrics (cp.startDate(), cp.endDate(),</span>
<span class="fc" id="L1392">				cp.couponDCF(), cp.couponMetrics (valParams.valueDate(), csqc).rate(), new</span>
					org.drip.analytics.output.ConvexityAdjustment()));
<span class="nc" id="L1394">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L1395">			e.printStackTrace();</span>

<span class="nc" id="L1397">			return null;</span>
<span class="fc" id="L1398">		}</span>

<span class="fc" id="L1400">		return org.drip.analytics.output.CompositePeriodCouponMetrics.Create (lsUPM);</span>
	}

	@Override public int freq()
	{
<span class="fc" id="L1405">		return couponPeriods().get (0).freq();</span>
	}

	@Override public org.drip.state.identifier.EntityCreditLabel creditLabel()
	{
<span class="fc bfc" id="L1410" title="All 2 branches covered.">		if (null == _creditSetting) return null;</span>

<span class="fc" id="L1412">		java.lang.String strCreditCurveName = _creditSetting.creditCurveName();</span>

<span class="pc bpc" id="L1414" title="1 of 4 branches missed.">		return null == strCreditCurveName  || strCreditCurveName.isEmpty() ? null :</span>
<span class="fc" id="L1415">			org.drip.state.identifier.EntityCreditLabel.Standard (strCreditCurveName, currency());</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
			forwardLabel()
	{
<span class="pc bpc" id="L1422" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1424">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1426" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.ForwardLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;
<span class="fc" id="L1429">			mapForwardLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.ForwardLabel&gt;();

<span class="fc" id="L1432">		mapForwardLabel.put (</span>
<span class="fc" id="L1433">			name(),</span>
			(org.drip.state.identifier.ForwardLabel) floaterLabel
		);

<span class="fc" id="L1437">		return mapForwardLabel;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
			otcFixFloatLabel()
	{
<span class="pc bpc" id="L1444" title="1 of 2 branches missed.">		if (null == _floaterSetting) return null;</span>

<span class="fc" id="L1446">		org.drip.state.identifier.FloaterLabel floaterLabel = _floaterSetting.fri();</span>

<span class="pc bpc" id="L1448" title="1 of 2 branches missed.">		if (!(floaterLabel instanceof org.drip.state.identifier.OTCFixFloatLabel)) return null;</span>

		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;
<span class="fc" id="L1451">			mapOTCFixFloatLabel = new</span>
				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.OTCFixFloatLabel&gt;();

<span class="fc" id="L1454">		mapOTCFixFloatLabel.put (</span>
<span class="fc" id="L1455">			name(),</span>
			(org.drip.state.identifier.OTCFixFloatLabel) floaterLabel
		);

<span class="fc" id="L1459">		return mapOTCFixFloatLabel;</span>
	}

	@Override public org.drip.state.identifier.FundingLabel fundingLabel()
	{
<span class="fc" id="L1464">		return org.drip.state.identifier.FundingLabel.Standard (payCurrency());</span>
	}

	@Override public org.drip.state.identifier.GovvieLabel govvieLabel()
	{
<span class="fc" id="L1469">		return org.drip.state.identifier.GovvieLabel.Standard</span>
<span class="fc" id="L1470">			(org.drip.market.issue.TreasurySettingContainer.CurrencyBenchmarkCode (payCurrency()));</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.FXLabel&gt;
		fxLabel()
	{
<span class="nc" id="L1476">		return null;</span>
	}

	@Override public
		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;org.drip.state.identifier.VolatilityLabel&gt;
			volatilityLabel()
	{
<span class="nc" id="L1483">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate effectiveDate()
	{
<span class="fc" id="L1488">		return _stream.effective();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityDate()
	{
<span class="fc" id="L1493">		return _stream.maturity();</span>
	}

	@Override public org.drip.analytics.date.JulianDate maturityPayDate()
	{
<span class="fc" id="L1498">		return new org.drip.analytics.date.JulianDate (terminationAdjust (maturityDate().julian()));</span>
	}

	@Override public org.drip.analytics.date.JulianDate firstCouponDate()
	{
<span class="fc" id="L1503">		return new org.drip.analytics.date.JulianDate (couponPeriods().get (0).endDate());</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; couponPeriods()
	{
<span class="fc" id="L1508">		return _stream.periods();</span>
	}

	@Override public org.drip.param.valuation.CashSettleParams cashSettleParams()
	{
<span class="nc bnc" id="L1513" title="All 2 branches missed.">		return null == _quoteConvention ? null : _quoteConvention.cashSettleParams();</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlow (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
	{
<span class="nc bnc" id="L1521" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc) return null;</span>

<span class="nc" id="L1523">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1526" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1527" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1529">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1530">				(this, valParams, pricerParams, period.endDate(), csqc);</span>

<span class="nc bnc" id="L1532" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1533">		}</span>

<span class="nc" id="L1535">		return sLP;</span>
	}

	@Override public java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; lossFlowFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
	{
<span class="nc bnc" id="L1545" title="All 6 branches missed.">		if (null == valParams || null == pricerParams || null == csqc ||</span>
<span class="nc bnc" id="L1546" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L1547">			return null;</span>

<span class="nc" id="L1549">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L1551" title="All 2 branches missed.">		if (null == wi) return null;</span>

<span class="nc" id="L1553">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L1555">		int iWorkoutDate = wi.date();</span>

<span class="nc" id="L1557">		java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLP = new</span>
			java.util.ArrayList&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt;();

<span class="nc bnc" id="L1560" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1561" title="All 2 branches missed.">			if (null == period) continue;</span>

<span class="nc" id="L1563">			int iPeriodEndDate = period.endDate();</span>

<span class="nc bnc" id="L1565" title="All 4 branches missed.">			if (null == period || iPeriodEndDate &lt; iValueDate) continue;</span>

<span class="nc bnc" id="L1567" title="All 2 branches missed.">			if (period.startDate() &gt; iWorkoutDate) break;</span>

<span class="nc" id="L1569">			java.util.List&lt;org.drip.analytics.cashflow.LossQuadratureMetrics&gt; sLPSub = period.lossMetrics</span>
<span class="nc" id="L1570">				(this, valParams, pricerParams, iPeriodEndDate, csqc);</span>

<span class="nc bnc" id="L1572" title="All 2 branches missed.">			if (null != sLPSub) sLP.addAll (sLPSub);</span>
<span class="nc" id="L1573">		}</span>

<span class="nc" id="L1575">		return sLP;</span>
	}

	@Override public boolean isFloater()
	{
<span class="fc bfc" id="L1580" title="All 2 branches covered.">		return null == _floaterSetting ? false : true;</span>
	}

	@Override public java.lang.String rateIndex()
	{
<span class="nc bnc" id="L1585" title="All 2 branches missed.">		return null == _floaterSetting ? &quot;&quot; : _floaterSetting.fri().fullyQualifiedName();</span>
	}

	@Override public double currentCoupon()
	{
<span class="nc bnc" id="L1590" title="All 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.currentFullCoupon();</span>
	}

	@Override public double floatSpread()
	{
<span class="pc bpc" id="L1595" title="1 of 2 branches missed.">		return null == _floaterSetting ? java.lang.Double.NaN : _floaterSetting.spread();</span>
	}

	@Override public java.lang.String ticker()
	{
<span class="nc bnc" id="L1600" title="All 2 branches missed.">		return null == _idParams ? null : _idParams.ticker();</span>
	}

	@Override public void setEmbeddedCallSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="pc bpc" id="L1606" title="2 of 4 branches missed.">		if (null == eos || eos.isPut()) return;</span>

<span class="fc" id="L1608">		_eosCall = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="fc" id="L1609">	}</span>

	@Override public void setEmbeddedPutSchedule (
		final org.drip.product.params.EmbeddedOptionSchedule eos)
	{
<span class="nc bnc" id="L1614" title="All 4 branches missed.">		if (null == eos || !eos.isPut()) return;</span>

<span class="nc" id="L1616">		_eosPut = new org.drip.product.params.EmbeddedOptionSchedule (eos);</span>
<span class="nc" id="L1617">	}</span>

	@Override public boolean callable()
	{
<span class="fc bfc" id="L1621" title="All 2 branches covered.">		return null != _eosCall;</span>
	}

	@Override public boolean putable()
	{
<span class="pc bpc" id="L1626" title="1 of 2 branches missed.">		return null != _eosPut;</span>
	}

	@Override public boolean sinkable()
	{
<span class="nc bnc" id="L1631" title="All 2 branches missed.">		return null == _notionalSetting ? false : true;</span>
	}

	@Override public boolean variableCoupon()
	{
<span class="nc bnc" id="L1636" title="All 4 branches missed.">		return null == _couponSetting || null == _couponSetting.couponType() || !&quot;variable&quot;.equalsIgnoreCase</span>
<span class="nc bnc" id="L1637" title="All 2 branches missed.">			(_couponSetting.couponType()) ? false : true;</span>
	}

	@Override public boolean exercised()
	{
<span class="nc bnc" id="L1642" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.exercised();</span>
	}

	@Override public boolean defaulted()
	{
<span class="nc bnc" id="L1647" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.defaulted();</span>
	}

	@Override public boolean perpetual()
	{
<span class="nc bnc" id="L1652" title="All 2 branches missed.">		return null == _terminationSetting ? false : _terminationSetting.perpetual();</span>
	}

	@Override public boolean tradeable (
		final org.drip.param.valuation.ValuationParams valParams)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1659" title="All 2 branches missed.">		if (null == valParams) throw new java.lang.Exception (&quot;BondComponent::tradeable =&gt; invalid Inputs&quot;);</span>

<span class="nc bnc" id="L1661" title="All 4 branches missed.">		return !_terminationSetting.exercised() &amp;&amp; !_terminationSetting.defaulted() &amp;&amp; valParams.valueDate()</span>
<span class="nc bnc" id="L1662" title="All 2 branches missed.">			&lt; maturityDate().julian();</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule callSchedule()
	{
<span class="fc" id="L1667">		return _eosCall;</span>
	}

	@Override public org.drip.product.params.EmbeddedOptionSchedule putSchedule()
	{
<span class="fc" id="L1672">		return _eosPut;</span>
	}

	@Override public java.lang.String couponType()
	{
<span class="nc bnc" id="L1677" title="All 2 branches missed.">		return null == _couponSetting ? &quot;&quot; : _couponSetting.couponType();</span>
	}

	@Override public java.lang.String couponDC()
	{
<span class="pc bpc" id="L1682" title="1 of 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.couponDC();</span>
	}

	@Override public java.lang.String accrualDC()
	{
<span class="nc bnc" id="L1687" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : _stream.accrualDC();</span>
	}

	@Override public java.lang.String maturityType()
	{
<span class="nc bnc" id="L1692" title="All 2 branches missed.">		return null == _stream ? &quot;&quot; : maturityType();</span>
	}

	@Override public org.drip.analytics.date.JulianDate finalMaturity()
	{
<span class="nc bnc" id="L1697" title="All 2 branches missed.">		return null == _stream ? null : new org.drip.analytics.date.JulianDate (_stream.finalMaturityDate());</span>
	}

	@Override public java.lang.String calculationType()
	{
<span class="nc bnc" id="L1702" title="All 2 branches missed.">		return null == _quoteConvention ? &quot;&quot; : _quoteConvention.calculationType();</span>
	}

	@Override public double redemptionValue()
	{
<span class="nc bnc" id="L1707" title="All 2 branches missed.">		return null == _quoteConvention ? java.lang.Double.NaN : _quoteConvention.redemptionValue();</span>
	}

	@Override public java.lang.String currency()
	{
<span class="fc" id="L1712">		return _stream.couponCurrency();</span>
	}

	@Override public java.lang.String redemptionCurrency()
	{
<span class="nc" id="L1717">		return _notionalSetting.denominationCurrency();</span>
	}

	@Override public boolean inFirstCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1724">		return _stream.firstPeriod().contains (iDate);</span>
	}

	@Override public boolean inLastCouponPeriod (
		final int iDate)
		throws java.lang.Exception
	{
<span class="nc" id="L1731">		return _stream.lastPeriod().contains (iDate);</span>
	}

	@Override public java.lang.String floatCouponConvention()
	{
<span class="nc bnc" id="L1736" title="All 2 branches missed.">		return null == _floaterSetting ? null : _floaterSetting.dayCount();</span>
	}

	@Override public org.drip.analytics.date.JulianDate periodFixingDate (
		final int iValueDate)
	{
<span class="nc bnc" id="L1742" title="All 4 branches missed.">		if (null == _floaterSetting || iValueDate &gt;= maturityDate().julian()) return null;</span>

<span class="nc bnc" id="L1744" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc bnc" id="L1745" title="All 2 branches missed.">			if (period.payDate() &lt; iValueDate) continue;</span>

<span class="nc" id="L1747">			org.drip.analytics.cashflow.ComposableUnitPeriod cup = period.periods().get (0);</span>

<span class="nc bnc" id="L1749" title="All 2 branches missed.">			if (!(cup instanceof org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)) continue;</span>

			try {
<span class="nc" id="L1752">				return new org.drip.analytics.date.JulianDate</span>
					(((org.drip.analytics.cashflow.ComposableUnitFloatingPeriod)
<span class="nc" id="L1754">						(cup)).referenceIndexPeriod().fixingDate());</span>
<span class="nc" id="L1755">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
			}
<span class="nc" id="L1758">		}</span>

<span class="nc" id="L1760">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate previousCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="pc bpc" id="L1766" title="2 of 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="fc" id="L1769">			int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="fc bfc" id="L1771" title="All 2 branches covered.">			if (0 == iIndex) return new org.drip.analytics.date.JulianDate (_stream.period (0).startDate());</span>
			
<span class="fc" id="L1773">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex - 1);</span>

<span class="pc bpc" id="L1775" title="1 of 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1776">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L1780">		return null;</span>
	}

	@Override public double previousCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1788" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1789">			throw new java.lang.Exception (&quot;BondComponent::previousCouponRate =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L1791">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1792">			(dt.julian()) - 1);</span>

<span class="nc bnc" id="L1794" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1795">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Cannot find previous period!&quot;);

<span class="nc" id="L1798">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1801" title="All 2 branches missed.">		if (null == cpcm)</span>
<span class="nc" id="L1802">			throw new java.lang.Exception</span>
				(&quot;BondComponent::previousCouponRate =&gt; Invalid previous period metrics!&quot;);

<span class="nc" id="L1805">		return cpcm.rate();</span>
	}

	@Override public org.drip.analytics.date.JulianDate currentCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1811" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1814">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1815">				(dt.julian()));</span>

<span class="nc bnc" id="L1817" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1818">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1821">		return null;</span>
	}

	@Override public org.drip.analytics.date.JulianDate nextCouponDate (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1827" title="All 4 branches missed.">		if (null == dt || dt.julian() &gt; maturityDate().julian()) return null;</span>

		try {
<span class="nc" id="L1830">			org.drip.analytics.cashflow.CompositePeriod period = _stream.period (_stream.periodIndex</span>
<span class="nc" id="L1831">				(dt.julian()) + 1);</span>

<span class="nc bnc" id="L1833" title="All 2 branches missed.">			return null == period ? null : new org.drip.analytics.date.JulianDate (period.payDate());</span>
<span class="nc" id="L1834">		} catch (java.lang.Exception e) {</span>
		}

<span class="nc" id="L1837">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseDateOfType (
		final org.drip.analytics.date.JulianDate dt,
		final boolean bPut)
	{
<span class="nc bnc" id="L1844" title="All 10 branches missed.">		if (null == dt || (bPut &amp;&amp; null == _eosPut) || (!bPut &amp;&amp; null == _eosCall)) return null;</span>

<span class="nc bnc" id="L1846" title="All 2 branches missed.">		org.drip.product.params.EmbeddedOptionSchedule eos = bPut ? _eosPut : _eosCall;</span>

<span class="nc" id="L1848">		int[] aiEOSExerciseDates = eos.dates();</span>

<span class="nc bnc" id="L1850" title="All 4 branches missed.">		if (null == eos || null == aiEOSExerciseDates) return null;</span>

<span class="nc" id="L1852">		int iNumExerciseDates = aiEOSExerciseDates.length;</span>

<span class="nc bnc" id="L1854" title="All 2 branches missed.">		if (0 == iNumExerciseDates) return null;</span>

<span class="nc bnc" id="L1856" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumExerciseDates; ++i) {</span>
<span class="nc bnc" id="L1857" title="All 2 branches missed.">			if (aiEOSExerciseDates[i] - dt.julian() &lt; eos.exerciseNoticePeriod())</span>
<span class="nc" id="L1858">				continue;</span>

			try {
<span class="nc bnc" id="L1861" title="All 2 branches missed.">				return new org.drip.analytics.output.ExerciseInfo (aiEOSExerciseDates[i], eos.factor (i),</span>
					bPut ? org.drip.param.valuation.WorkoutInfo.WO_TYPE_PUT :
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_CALL);
<span class="nc" id="L1864">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1867">				return null;</span>
			}
		}

<span class="nc" id="L1871">		return null;</span>
	}

	@Override public org.drip.analytics.output.ExerciseInfo nextValidExerciseInfo (
		final org.drip.analytics.date.JulianDate dt)
	{
<span class="nc bnc" id="L1877" title="All 2 branches missed.">		if (null == dt) return null;</span>

<span class="nc" id="L1879">		org.drip.analytics.output.ExerciseInfo neiNextCall = nextValidExerciseDateOfType (dt, false);</span>

<span class="nc" id="L1881">		org.drip.analytics.output.ExerciseInfo neiNextPut = nextValidExerciseDateOfType (dt, true);</span>

<span class="nc bnc" id="L1883" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null == neiNextPut) {</span>
			try {
<span class="nc" id="L1885">				return new org.drip.analytics.output.ExerciseInfo (maturityDate().julian(), 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L1887">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L1890">				return null;</span>
			}
		}

<span class="nc bnc" id="L1894" title="All 4 branches missed.">		if (null != neiNextCall &amp;&amp; null == neiNextPut) return neiNextCall;</span>

<span class="nc bnc" id="L1896" title="All 4 branches missed.">		if (null == neiNextCall &amp;&amp; null != neiNextPut) return neiNextPut;</span>

<span class="nc bnc" id="L1898" title="All 2 branches missed.">		return neiNextCall.date() &lt; neiNextPut.date() ? neiNextCall : neiNextPut;</span>
	}

	@Override public double currentCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1906" title="All 4 branches missed.">		if (null == dt || null == csqc)</span>
<span class="nc" id="L1907">			throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc bnc" id="L1909" title="All 2 branches missed.">		if (null != _floaterSetting) {</span>
<span class="nc" id="L1910">			double dblCurrentFullCoupon = _floaterSetting.currentFullCoupon();</span>

<span class="nc bnc" id="L1912" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblCurrentFullCoupon))</span>
<span class="nc" id="L1913">				return dblCurrentFullCoupon;</span>
		}

<span class="nc" id="L1916">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (dt.julian(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1919" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::currentCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1921">		return pcm.rate();</span>
	}

	@Override public double nextCouponRate (
		final org.drip.analytics.date.JulianDate dt,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L1929" title="All 2 branches missed.">		if (null == dt)</span>
<span class="nc" id="L1930">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null val/mkt params!&quot;);</span>

<span class="nc" id="L1932">		int iIndex = _stream.periodIndex (dt.julian());</span>

<span class="nc" id="L1934">		org.drip.analytics.cashflow.CompositePeriod period = _stream.period (iIndex + 1);</span>

<span class="nc bnc" id="L1936" title="All 2 branches missed.">		if (null == period)</span>
<span class="nc" id="L1937">			throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Cannot find next period!&quot;);</span>

<span class="nc" id="L1939">		org.drip.analytics.output.CompositePeriodCouponMetrics pcm = couponMetrics (period.endDate(), new</span>
			org.drip.param.valuation.ValuationParams (dt, dt, &quot;&quot;), csqc);

<span class="nc bnc" id="L1942" title="All 2 branches missed.">		if (null == pcm) throw new java.lang.Exception (&quot;BondComponent::nextCouponRate =&gt; Null PCM!&quot;);</span>

<span class="nc" id="L1944">		return pcm.rate();</span>
	}

	@Override public double accrued (
		final int iDate,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L1952">		org.drip.analytics.date.JulianDate dt = new org.drip.analytics.date.JulianDate (iDate);</span>

<span class="pc bpc" id="L1954" title="1 of 2 branches missed.">		if (iDate &gt;= maturityDate().julian())</span>
<span class="nc" id="L1955">			throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Val date &quot; + dt +</span>
<span class="nc" id="L1956">				&quot; greater than maturity &quot; + maturityDate());</span>

<span class="fc" id="L1958">		org.drip.param.valuation.ValuationParams valParams = new org.drip.param.valuation.ValuationParams</span>
			(dt, dt, &quot;&quot;);

<span class="fc bfc" id="L1961" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L1962">			int iEndDate = period.endDate();</span>

<span class="fc" id="L1964">			int iStartDate = period.startDate();</span>

<span class="fc bfc" id="L1966" title="All 4 branches covered.">			if (iStartDate &lt; iDate &amp;&amp; iEndDate &gt;= iDate) {</span>
<span class="fc" id="L1967">				org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iEndDate,</span>
					valParams, csqc);

<span class="pc bpc" id="L1970" title="1 of 2 branches missed.">				if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; No PCM&quot;);</span>

<span class="fc" id="L1972">				double dblCoupon = cpcm.rate();</span>

<span class="pc bpc" id="L1974" title="1 of 2 branches missed.">				if (!org.drip.quant.common.NumberUtil.IsValid (dblCoupon))</span>
<span class="nc" id="L1975">					throw new java.lang.Exception (&quot;BondComponent::accrued =&gt; Invalid Coupon For &quot; + dt);</span>

<span class="fc" id="L1977">				return period.accrualDCF (iDate) * dblCoupon * notional (iStartDate) * couponFactor</span>
<span class="fc" id="L1978">					(iEndDate);</span>
			}
<span class="fc" id="L1980">		}</span>

<span class="fc" id="L1982">		return 0.;</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L1992" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L1993">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L1995">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L1997" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L1998">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; Val date &quot; +</span>
<span class="nc" id="L1999">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2000">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2002">		int iPeriodEndDate = 0;</span>
<span class="fc" id="L2003">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2004">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2005">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2006">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2008" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2009">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2011" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2013" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2014">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2016" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2018">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2020">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2022">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2023" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2025" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2026">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2027">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2028">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2031">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2034" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2035">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageMaturityDate =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2037">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2039">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2041">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2043">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2045" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2046">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2047" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2048">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2049" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2051">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2053">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2054">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2056" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2057">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2059" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2060">				cpcm.rate()) * couponFactor (iPeriodEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2063">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2064">			iPeriodEndDate += (iAccrualEndDate - iAccrualStartDate);</span>
<span class="fc" id="L2065">			dblTimeWeightedTotalCashflow += iPeriodEndDate * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2067" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2068">		}</span>

<span class="fc" id="L2070">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2072">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2073">		dblTimeWeightedTotalCashflow += iPeriodEndDate * dblTerminalCashflow;</span>
<span class="fc" id="L2074">		return (int) (dblTimeWeightedTotalCashflow / dblTotalCashflow);</span>
	}

	@Override public int weightedAverageMaturityDate (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2082">		return weightedAverageMaturityDate (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2092" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2093">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2095">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2097" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2098">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; Val date &quot; +</span>
<span class="nc" id="L2099">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2100">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2102">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2103">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2104">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2105">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2106">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2108" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2109">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2111" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2113" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2114">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2116" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2118">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2120">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2122">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2123" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2125" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2126">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2127">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2128">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2131">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2134" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2135">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLife =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2137">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2139">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2141">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2143">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L2145" title="1 of 2 branches missed.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="nc" id="L2146">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2147" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2148">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2149" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2151">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2153">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2154">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2156" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2157">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2159" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2160">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional;

<span class="fc" id="L2163">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2164">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2165">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2167" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2168">		}</span>

<span class="fc" id="L2170">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2172">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2173">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2174">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLife (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="fc" id="L2182">		return weightedAverageLife (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2192" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2193">			throw new java.lang.Exception</span>
				(&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Invalid Inputs&quot;);

<span class="fc" id="L2196">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2198" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2199">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifePrincipalOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2200">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2201">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2203">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2204">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2205">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2206">		double dblTimeWeightedTotalCashflow = 0.;</span>

<span class="pc bpc" id="L2208" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2209">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2211" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2213">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2215">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2217">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2218" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2220" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2221">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2222">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2223">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2226">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2228">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2230">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2231">				(iAccrualStartDate);</span>

<span class="fc" id="L2233">			double dblPeriodCashflow = dblPeriodStartNotional - dblPeriodEndNotional;</span>
<span class="fc" id="L2234">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>
<span class="fc" id="L2235">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2236">			dblPeriodEndTime += dblPeriodTimeWidth;</span>

<span class="fc bfc" id="L2238" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2239">		}</span>

<span class="fc" id="L2241">		double dblTerminalCashflow = dblWorkoutFactor * notional (iWorkoutDate);</span>

<span class="fc" id="L2243">		dblTotalCashflow += dblTerminalCashflow;</span>
<span class="fc" id="L2244">		dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblTerminalCashflow;</span>
<span class="fc" id="L2245">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifePrincipalOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2253">		return weightedAverageLifePrincipalOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2263" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2264">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2266">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2268" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2269">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; Val date &quot; +</span>
<span class="nc" id="L2270">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2271">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="fc" id="L2273">		double dblTotalCashflow = 0.;</span>
<span class="fc" id="L2274">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2275">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2276">		double dblTimeWeightedTotalCashflow = 0.;</span>
<span class="fc" id="L2277">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2279" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2280">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2282" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2284" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2285">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2287" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2289">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2291">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2293">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2294" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2296" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2297">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2298">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2299">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2302">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2305" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2306">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCouponOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2308">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2310">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2312">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2314">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2316" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2317">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2318" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2319">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2320" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2322">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2324">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2325">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2327" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2328">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2330" title="1 of 2 branches missed.">			double dblPeriodCashflow = dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2331">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional;</span>

<span class="fc" id="L2333">			dblTotalCashflow += dblPeriodCashflow;</span>
<span class="fc" id="L2334">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2335">			dblTimeWeightedTotalCashflow += dblPeriodEndTime * dblPeriodCashflow;</span>

<span class="fc bfc" id="L2337" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2338">		}</span>

<span class="fc" id="L2340">		return dblTimeWeightedTotalCashflow / dblTotalCashflow;</span>
	}

	@Override public double weightedAverageLifeCouponOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2348">		return weightedAverageLifeCouponOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2358" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2359">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2361">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2363">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2365" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2366">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2368">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2369">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2370">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2371">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2372">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2374" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2375">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2377" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2379" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2380">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2382" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2384">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2386">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2388">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2389" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2391" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2392">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2393">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2394">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2397">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2400" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2401">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeLossOnly =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2403">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2405">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2407">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2409">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2411" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2412">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2413" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2414">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2415" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2417">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2419">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2420">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2422" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2423">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2425" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2426">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2427">					dblPeriodEndNotional) * cc.survival (iPeriodPayDate) * (1. - cc.effectiveRecovery</span>
<span class="fc" id="L2428">						(iPeriodStartDate, period.endDate()));</span>

<span class="fc" id="L2430">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2431">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2432">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2434" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2435">		}</span>

<span class="fc" id="L2437">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * cc.survival</span>
<span class="fc" id="L2438">			(iWorkoutDate) * (1. - cc.recovery (iWorkoutDate));</span>

<span class="fc" id="L2440">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2441">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2442">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeLossOnly (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2450">		return weightedAverageLifeLossOnly (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2460" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L2461">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2463">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L2465">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="pc bpc" id="L2467" title="2 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == cc)</span>
<span class="nc" id="L2468">			throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2470">		double dblPeriodEndTime = 0.;</span>
<span class="fc" id="L2471">		double dblTotalLossCashflow = 0.;</span>
<span class="fc" id="L2472">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2473">		double dblTimeWeightedTotalLossCashflow = 0.;</span>
<span class="fc" id="L2474">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2476" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2477">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2479" title="1 of 2 branches missed.">		boolean bApplyFlatForward = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="pc bpc" id="L2481" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L2482">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2484" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2486">			int iNotionalEndDate = period.endDate();</span>

<span class="fc" id="L2488">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2490">			int iAccrualEndDate = iNotionalEndDate;</span>
<span class="fc bfc" id="L2491" title="All 2 branches covered.">			int iAccrualStartDate = iPeriodStartDate &gt; iValueDate ? iPeriodStartDate : iValueDate;</span>

<span class="fc bfc" id="L2493" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2494">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2495">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2496">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2499">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iAccrualEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2502" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2503">				throw new java.lang.Exception (&quot;BondComponent::weightedAverageLifeCredit =&gt; No CPCM&quot;);</span>

<span class="fc" id="L2505">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2507">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc" id="L2509">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2511">			int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2513" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2514">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="pc bpc" id="L2515" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2516">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L2517" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2519">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2521">			double dblPeriodTimeWidth = period.accrualDCF (iAccrualEndDate) - period.accrualDCF</span>
<span class="fc" id="L2522">				(iAccrualStartDate);</span>

<span class="fc bfc" id="L2524" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2525">				dblFlatForwardRate = cpcm.rate();</span>

<span class="fc" id="L2527">			double dblPeriodSurvival = cc.survival (iPeriodPayDate);</span>

<span class="pc bpc" id="L2529" title="1 of 2 branches missed.">			double dblPeriodLossCashflow = (dblPeriodTimeWidth * (bApplyFlatForward ? dblFlatForwardRate :</span>
<span class="fc" id="L2530">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
					dblPeriodEndNotional) * (dblPeriodSurvival * (1. - cc.effectiveRecovery
<span class="fc" id="L2532">						(iPeriodStartDate, iNotionalEndDate)) + 1. - dblPeriodSurvival);</span>

<span class="fc" id="L2534">			dblPeriodEndTime += dblPeriodTimeWidth;</span>
<span class="fc" id="L2535">			dblTotalLossCashflow += dblPeriodLossCashflow;</span>
<span class="fc" id="L2536">			dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblPeriodLossCashflow;</span>

<span class="fc bfc" id="L2538" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2539">		}</span>

<span class="fc" id="L2541">		double dblTerminalSurvival = cc.survival (iWorkoutDate);</span>

<span class="fc" id="L2543">		double dblTerminalLossCashflow = dblWorkoutFactor * notional (iWorkoutDate) * (dblTerminalSurvival *</span>
<span class="fc" id="L2544">			(1. - cc.recovery (iWorkoutDate)) + 1. - dblTerminalSurvival);</span>

<span class="fc" id="L2546">		dblTotalLossCashflow += dblTerminalLossCashflow;</span>
<span class="fc" id="L2547">		dblTimeWeightedTotalLossCashflow += dblPeriodEndTime * dblTerminalLossCashflow;</span>
<span class="fc" id="L2548">		return dblTimeWeightedTotalLossCashflow / dblTotalLossCashflow;</span>
	}

	@Override public double weightedAverageLifeCredit (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc)
		throws java.lang.Exception
	{
<span class="nc" id="L2556">		return weightedAverageLifeCredit (valParams, csqc, maturityDate().julian(), 1.);</span>
	}

	@Override public double priceFromZeroCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iZeroCurveBaseDC,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2569" title="1 of 2 branches missed.">		if (null == valParams)</span>
<span class="nc" id="L2570">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L2572">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2574" title="1 of 4 branches missed.">		if (iValueDate &gt;= iWorkoutDate || null == csqc || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L2575" title="2 of 4 branches missed.">			(dblWorkoutFactor) || !org.drip.quant.common.NumberUtil.IsValid (dblBump))</span>
<span class="fc" id="L2576">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Inputs &quot; + dblBump);</span>

<span class="fc" id="L2578">		double dblPV = 0.;</span>
<span class="fc" id="L2579">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L2580">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L2581">		org.drip.state.discount.ZeroCurve zc = null;</span>
<span class="fc" id="L2582">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2583">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2585" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2586">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2588" title="1 of 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L2589">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="fc bfc" id="L2591" title="All 2 branches covered.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="fc" id="L2592">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2594" title="1 of 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc bfc" id="L2597" title="All 2 branches covered.">		org.drip.state.discount.DiscountCurve dcBase = ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE ==</span>
<span class="fc" id="L2598">			iZeroCurveBaseDC ? csqc.fundingState (fundingLabel()) : csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L2600" title="All 2 branches covered.">		if (null == dcBase)</span>
<span class="fc" id="L2601">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Invalid Discount Curve&quot;);</span>

		try {
<span class="fc bfc" id="L2604" title="All 2 branches covered.">			iCashPayDate = null != _quoteConvention ? _quoteConvention.settleDate (valParams) :</span>
<span class="fc" id="L2605">				valParams.cashPayDate();</span>
<span class="nc" id="L2606">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2609">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2610">		}</span>

<span class="fc" id="L2612">		java.util.List&lt;org.drip.analytics.cashflow.CompositePeriod&gt; lsCompositePeriod = couponPeriods();</span>

		try {
<span class="fc" id="L2615">			zc = org.drip.state.curve.DerivedZeroRate.FromBaseCurve (freq(), couponDC(), currency(),</span>
<span class="pc bpc" id="L2616" title="1 of 4 branches missed.">				_stream.couponEOMAdjustment(), lsCompositePeriod, terminationAdjust (iWorkoutDate),</span>
					iValueDate, iCashPayDate, dcBase, dblBump, null == vcp ? (null == _quoteConvention ? null
<span class="pc" id="L2618">						: _quoteConvention.valuationCustomizationParams()) : vcp, new</span>
							org.drip.spline.params.SegmentCustomBuilderControl
								(org.drip.spline.stretch.MultiSegmentSequenceBuilder.BASIS_SPLINE_POLYNOMIAL,
									new org.drip.spline.basis.PolynomialFunctionSetParams (2),
<span class="fc" id="L2622">										org.drip.spline.params.SegmentInelasticDesignControl.Create (0, 2),</span>
											new org.drip.spline.params.ResponseScalingShapeControl (true, new
												org.drip.function.r1tor1.QuadraticRationalShapeControl (0.)),
													null));
<span class="nc" id="L2626">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L2627">			e.printStackTrace();</span>
<span class="fc" id="L2628">		}</span>

<span class="pc bpc" id="L2630" title="1 of 2 branches missed.">		if (null == zc)</span>
<span class="nc" id="L2631">			throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; Cannot create shifted ZC&quot;);</span>

<span class="pc bpc" id="L2633" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : lsCompositePeriod) {</span>
<span class="fc" id="L2634">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2636" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2638">			int iPeriodStartDate = period.startDate();</span>

<span class="fc" id="L2640">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2642">			int iAccrualEndDate = period.endDate();</span>

<span class="fc" id="L2644">			int iNotionalEndDate = iAccrualEndDate;</span>
<span class="fc" id="L2645">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc" id="L2647">			double dblPeriodEndNotional = notional (iNotionalEndDate);</span>

<span class="fc bfc" id="L2649" title="All 2 branches covered.">			if (iAccrualEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2650">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L2651">				iAccrualEndDate = iWorkoutDate;</span>
<span class="fc" id="L2652">				iNotionalEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2655">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START ==</span>
<span class="fc bfc" id="L2656" title="All 2 branches covered.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2657">				dblCouponNotional = dblPeriodStartNotional;</span>
<span class="fc" id="L2658">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END ==</span>
<span class="pc bpc" id="L2659" title="1 of 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="fc" id="L2660">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc" id="L2661">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
<span class="nc bnc" id="L2662" title="All 2 branches missed.">				_notionalSetting.periodAmortizationMode())</span>
<span class="nc" id="L2663">				dblCouponNotional = notional (iPeriodStartDate, iNotionalEndDate);</span>

<span class="fc" id="L2665">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2668" title="1 of 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromZeroCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2670" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2671">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2673" title="1 of 2 branches missed.">			dblPV += (period.accrualDCF (iAccrualEndDate) * (bApplyFlatForwardRate ? dblFlatForwardRate :</span>
<span class="fc" id="L2674">				cpcm.rate()) * couponFactor (iNotionalEndDate) * dblCouponNotional + dblPeriodStartNotional -</span>
<span class="fc" id="L2675">					dblPeriodEndNotional) * zc.df (iPeriodPayDate);</span>

<span class="fc bfc" id="L2677" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L2678">		}</span>

<span class="fc" id="L2680">		return ((dblPV + dblWorkoutFactor * zc.df (terminationAdjust (iWorkoutDate)) * notional</span>
<span class="fc" id="L2681">			(iWorkoutDate)) / zc.df (iCashPayDate) - accrued (iValueDate, csqc)) / dblScalingNotional;</span>
	}

	@Override public double priceFromFundingCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="fc" id="L2692">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_FUNDING_CURVE);
	}

	@Override public double priceFromTreasuryCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBump)
		throws java.lang.Exception
	{
<span class="nc" id="L2704">		return priceFromDiscountCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblBump,</span>
			PRICE_OFF_OF_TREASURY_CURVE);
	}

	@Override public double priceFromCreditCurve (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis,
		final boolean bFlat)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L2717" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L2718" title="1 of 4 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblCreditBasis) || null == _creditSetting)</span>
<span class="fc" id="L2719">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2721">		org.drip.state.credit.CreditCurve ccIn = csqc.creditState (creditLabel());</span>

<span class="fc bfc" id="L2723" title="All 2 branches covered.">		if (null == ccIn)</span>
<span class="fc" id="L2724">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L2726">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L2728" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L2729">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No funding curve&quot;);</span>

<span class="fc" id="L2731">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L2733" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L2734">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; Val date &quot; +</span>
<span class="nc" id="L2735">				org.drip.analytics.date.DateUtil.YYYYMMDD (iValueDate) + &quot; greater than Work-out &quot; +</span>
<span class="nc" id="L2736">					org.drip.analytics.date.DateUtil.YYYYMMDD (iWorkoutDate));</span>

<span class="pc bpc" id="L2738" title="1 of 2 branches missed.">		double dblRecoveryToUse = !_creditSetting.useCurveRecovery() ? _creditSetting.recovery() :</span>
			java.lang.Double.NaN;

<span class="pc bpc" id="L2741" title="1 of 2 branches missed.">		org.drip.state.credit.CreditCurve cc = bFlat ? ccIn.flatCurve (dblCreditBasis, true,</span>
			dblRecoveryToUse) : (org.drip.state.credit.CreditCurve) ccIn.parallelShiftManifestMeasure
<span class="fc" id="L2743">				(&quot;SwapRate&quot;, dblCreditBasis);</span>

<span class="pc bpc" id="L2745" title="1 of 2 branches missed.">		if (null == cc)</span>
<span class="nc" id="L2746">			throw new java.lang.Exception</span>
				(&quot;BondComponent::priceFromCreditCurve =&gt; Cannot create adjusted Curve&quot;);

<span class="fc" id="L2749">		double dblPV = 0.;</span>
<span class="fc" id="L2750">		boolean bTerminateCashFlow = false;</span>
<span class="fc" id="L2751">		int iCashPayDate = java.lang.Integer.MIN_VALUE;</span>
<span class="fc" id="L2752">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="pc bpc" id="L2754" title="2 of 4 branches missed.">		double dblScalingNotional = null != _notionalSetting &amp;&amp; _notionalSetting.priceOffOfOriginalNotional()</span>
<span class="fc" id="L2755">			? 1. : notional (iValueDate);</span>

<span class="pc bpc" id="L2757" title="1 of 2 branches missed.">		org.drip.param.valuation.ValuationCustomizationParams vcp = null == _quoteConvention ? null :</span>
<span class="fc" id="L2758">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L2760" title="1 of 2 branches missed.">		boolean bApplyFlatForwardRate = null == vcp ? false : vcp.applyFlatForwardRate();</span>

<span class="fc" id="L2762">		org.drip.param.pricer.CreditPricerParams pricerParams = new org.drip.param.pricer.CreditPricerParams</span>
			(7, null, false, s_iDiscretizationScheme);

<span class="fc" id="L2765">		int iLossPayLag = _creditSetting.lossPayLag();</span>

<span class="fc" id="L2767">		boolean bAccrualOnDefault = _creditSetting.accrualOnDefault();</span>

<span class="fc" id="L2769">		int iPeriodAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="fc bfc" id="L2771" title="All 2 branches covered.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc bfc" id="L2772" title="All 2 branches covered.">			if (bTerminateCashFlow) continue;</span>

<span class="fc" id="L2774">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L2776" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc" id="L2778">			int iPeriodEndDate = period.endDate();</span>

<span class="fc bfc" id="L2780" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L2781">				bTerminateCashFlow = true;</span>
<span class="fc" id="L2782">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L2785">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L2787" title="All 2 branches covered.">			if (iPeriodStartDate &lt; iValueDate) iPeriodStartDate = iValueDate;</span>

<span class="fc" id="L2789">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iPeriodEndDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L2792" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L2793">				throw new java.lang.Exception (&quot;BondComponent::priceFromCreditCurve =&gt; No PCM&quot;);</span>

<span class="fc bfc" id="L2795" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L2796">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L2798" title="1 of 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="fc" id="L2800">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L2802">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L2804">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L2806" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iPeriodAmortizationMode)</span>
<span class="fc" id="L2807">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L2808" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iPeriodAmortizationMode)</span>
<span class="fc" id="L2809">				dblCouponNotional = notional (iPeriodEndDate);</span>
<span class="nc bnc" id="L2810" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE ==</span>
				iPeriodAmortizationMode)
<span class="nc" id="L2812">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc" id="L2814">			dblPV += (period.accrualDCF (iPeriodEndDate) * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblCouponNotional + dblPeriodStartNotional - dblPeriodEndNotional) * dcFunding.df
<span class="fc" id="L2816">					(iPeriodPayDate) * cpcm.cumulative() * cc.survival (iPeriodEndDate);</span>

<span class="fc bfc" id="L2818" title="All 2 branches covered.">			for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this, valParams,</span>
				pricerParams, iPeriodEndDate, csqc)) {
<span class="pc bpc" id="L2820" title="1 of 2 branches missed.">				if (null == lqm) continue;</span>

<span class="fc" id="L2822">				int iSubPeriodEndDate = lqm.endDate();</span>

<span class="fc" id="L2824">				int iSubPeriodStartDate = lqm.startDate();</span>

<span class="fc" id="L2826">				double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
					iSubPeriodEndDate + iLossPayLag);

<span class="fc" id="L2829">				double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="fc" id="L2831">				double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="fc" id="L2832">					(iSubPeriodEndDate);</span>

<span class="fc bfc" id="L2834" title="All 2 branches covered.">				if (bAccrualOnDefault)</span>
<span class="fc" id="L2835">					dblPV += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival * dblSubPeriodDF *</span>
						dblSubPeriodNotional * dblPeriodCoupon;

<span class="pc bpc" id="L2838" title="1 of 2 branches missed.">				dblPV += (_creditSetting.useCurveRecovery() ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
<span class="pc" id="L2839">					iSubPeriodEndDate) : _creditSetting.recovery()) * dblSubPeriodSurvival *</span>
						dblSubPeriodNotional * dblSubPeriodDF;
<span class="fc" id="L2841">			}</span>
<span class="fc" id="L2842">		}</span>

		try {
<span class="pc bpc" id="L2845" title="1 of 2 branches missed.">			iCashPayDate = null == _quoteConvention ? valParams.cashPayDate() : _quoteConvention.settleDate</span>
<span class="fc" id="L2846">				(valParams);</span>
<span class="nc" id="L2847">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L2850">			iCashPayDate = valParams.cashPayDate();</span>
<span class="fc" id="L2851">		}</span>

<span class="fc" id="L2853">		return ((dblPV + dblWorkoutFactor * dcFunding.df (terminationAdjust (iWorkoutDate)) * cc.survival</span>
<span class="fc" id="L2854">			(iWorkoutDate) * notional (iWorkoutDate)) / dcFunding.df (iCashPayDate) - accrued (iValueDate,</span>
				csqc)) / dblScalingNotional;
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2867">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L2868">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double aswFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2878">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2888" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2889">			throw new java.lang.Exception (&quot;BondComponent::aswFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Bond Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2892">		return aswFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2904">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L2905">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double aswFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L2915">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2925" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2926">			throw new java.lang.Exception (&quot;BondComponent::aswFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Credit Basis to Optimal Exercise for bonds w emb option&quot;);

<span class="nc" id="L2929">		return aswFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2941">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L2942">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double aswFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L2952">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2962" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L2963">			throw new java.lang.Exception (&quot;BondComponent::aswFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L2966">		return aswFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L2978">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L2979">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double aswFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L2989">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L2999" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3000">			throw new java.lang.Exception (&quot;BondComponent::aswFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3003">		return aswFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3015">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L3016">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double aswFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3026">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3036" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3037">			throw new java.lang.Exception (&quot;BondComponent::aswFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3040">		return aswFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3052">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L3053">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double aswFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3063">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3073" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3074">			throw new java.lang.Exception (&quot;BondComponent::aswFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3077">		return aswFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3089">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L3090">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double aswFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3100">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3110" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3111">			throw new java.lang.Exception (&quot;BondComponent::aswFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3114">		return aswFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3126">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L3127">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double aswFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3137">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3147" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3148">			throw new java.lang.Exception (&quot;BondComponent::aswFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3151">		return aswFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3163">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double aswFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3174">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3184" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3185">			throw new java.lang.Exception (&quot;BondComponent::aswFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3188">		return aswFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3200">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L3201">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double aswFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3211">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3221" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3222">			throw new java.lang.Exception (&quot;BondComponent::aswFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3225">		return aswFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3237" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L3238" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L3239">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3241">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L3243" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L3244">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3246">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="pc bpc" id="L3249" title="1 of 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; No CPCM&quot;);</span>

<span class="fc" id="L3251">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L3253" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L3254">			throw new java.lang.Exception (&quot;BondComponent::aswFromPrice =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L3256">		return cpcm.rate() - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + 0.0001 *</span>
<span class="fc" id="L3257">			(dblWorkoutFactor - dblPrice) / dcFunding.parSwapDV01 (iWorkoutDate);</span>
	}

	@Override public double aswFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3267">		return aswFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double aswFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3277">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L3279" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3280">			throw new java.lang.Exception</span>
				(&quot;BondComponent::aswFromPriceToOptimalExercise =&gt; Can't determine Optimal Work-out&quot;);

<span class="nc" id="L3283">		return aswFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L3295">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="fc" id="L3296">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double aswFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3306">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3316" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3317">			throw new java.lang.Exception (&quot;BondComponent::aswFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3320">		return aswFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3332">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));
	}

	@Override public double aswFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3343">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3353" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3354">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3357">		return aswFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3369">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L3370">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double aswFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3380">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3390" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3391">			throw new java.lang.Exception (&quot;BondComponent::aswFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3394">		return aswFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3406">		return aswFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L3407">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double aswFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3417">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double aswFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3427" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3428">			throw new java.lang.Exception (&quot;BondComponent::aswFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc ASW from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3431">		return aswFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3443">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L3444">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double bondBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L3454">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3464" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3465">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3468">		return bondBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3480">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3481">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double bondBasisFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L3491">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3501" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3502">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Bond Basis from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3505">		return bondBasisFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3517">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3518">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double bondBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L3529">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3540" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3541">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3544">		return bondBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3557">		return bondBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L3558">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double bondBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3568">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3578" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3579">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3582">		return bondBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3594">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L3595">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double bondBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3605">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3615" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3616">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3619">		return bondBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3631">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L3632">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double bondBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3642">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3652" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3653">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3656">		return bondBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3668">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L3669">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double bondBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3679">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3689" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3690">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3693">		return bondBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3705">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L3706">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double bondBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3716">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3726" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3727">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3730">		return bondBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3742">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L3743">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double bondBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L3753">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3763" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3764">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3767">		return bondBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3779">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L3780">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double bondBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L3790">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3800" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3801">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3804">		return bondBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3816">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L3817">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double bondBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L3827">		return bondBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double bondBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L3837">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>
		
<span class="nc bnc" id="L3839" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L3840">			throw new java.lang.Exception</span>
				(&quot;BondComponent::bondBasisFromPriceToOptimalExercise =&gt; cant calc Work-out info&quot;);

<span class="nc" id="L3843">		return bondBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3855">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L3856">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double bondBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3866">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3876" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3877">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3880">		return bondBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L3892" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L3893">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L3895">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L3896">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double bondBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L3906">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3916" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3917">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3920">		return bondBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3932">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L3933">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double bondBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3943">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3953" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3954">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Bond Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3957">		return bondBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3969">		return bondBasisFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L3970">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double bondBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L3980">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double bondBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L3990" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L3991">			throw new java.lang.Exception (&quot;BondComponent::bondBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Bond Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L3994">		return bondBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4006">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4007">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double convexityFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4017">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4027" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4028">			throw new java.lang.Exception (&quot;BondComponent::convexityFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4031">		return convexityFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4043">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L4044">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double convexityFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4054">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4064" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4065">			throw new java.lang.Exception (&quot;BondComponent::convexityFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4068">		return convexityFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4080">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4081">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double convexityFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4091">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4101" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4102">			throw new java.lang.Exception (&quot;BondComponent::convexityFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4105">		return convexityFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4117">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4118">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double convexityFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4129">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4140" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4141">			throw new java.lang.Exception (&quot;BondComponent::convexityFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Convexity from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4144">		return convexityFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4157">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4158">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double convexityFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4168">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4178" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4179">			throw new java.lang.Exception (&quot;BondComponent::convexityFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4182">		return convexityFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4194">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4195">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double convexityFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4205">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4215" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4216">			throw new java.lang.Exception (&quot;BondComponent::convexityFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4219">		return convexityFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4231">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4232">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double convexityFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4242">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4252" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4253">			throw new java.lang.Exception (&quot;BondComponent::convexityFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4256">		return convexityFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4268">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4269">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double convexityFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4279">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4289" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4290">			throw new java.lang.Exception (&quot;BondComponent::convexityFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4293">		return convexityFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4305">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4306">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double convexityFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4316">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4326" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4327">			throw new java.lang.Exception (&quot;BondComponent::convexityFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4330">		return convexityFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4342">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4343">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double convexityFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4353">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4363" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4364">			throw new java.lang.Exception (&quot;BondComponent::convexityFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4367">		return convexityFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4379">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4380">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double convexityFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4390">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4400" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4401">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4404">		return convexityFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L4416" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L4417">			throw new java.lang.Exception (&quot;BondComponent::convexityFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc" id="L4419">		double dblYield = yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>

<span class="fc" id="L4421">		return (priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield - 0.0001) +</span>
<span class="fc" id="L4422">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001) - 2. *</span>
<span class="fc" id="L4423">				dblPrice) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double convexityFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4433">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4443" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4444">			throw new java.lang.Exception (&quot;BondComponent::calcConvexityFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4447">		return convexityFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4459">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L4460">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double convexityFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4470">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4480" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4481">			throw new java.lang.Exception (&quot;BondComponent::convexityFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4484">		return convexityFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4496">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L4497">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double convexityFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L4507">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4517" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4518">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4521">		return convexityFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4533">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L4534">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double convexityFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4544">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4554" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4555">			throw new java.lang.Exception (&quot;BondComponent::convexityFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4558">		return convexityFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4570">		return convexityFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L4571">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double convexityFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4581">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double convexityFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4591" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4592">			throw new java.lang.Exception (&quot;BondComponent::convexityFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Convexity from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4595">		return convexityFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4607">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L4608">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double creditBasisFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L4618">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4628" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4629">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc Credit Basis from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4632">		return creditBasisFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4644">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4645">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double creditBasisFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L4655">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4665" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4666">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4669">		return creditBasisFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4681">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L4682">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double creditBasisFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L4693">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4705">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Credit Basis from Discnt Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4709">		return creditBasisFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4722">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L4723">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double creditBasisFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4733">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4743" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4744">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4747">		return creditBasisFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4759">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L4760">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double creditBasisFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4770">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4780" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4781">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4784">		return creditBasisFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4796">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L4797">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double creditBasisFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4807">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4817" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4818">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4821">		return creditBasisFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4833">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L4834">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double creditBasisFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4844">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4854" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4855">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4858">		return creditBasisFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4870">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L4871">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double creditBasisFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L4881">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4891" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4892">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4895">		return creditBasisFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4907">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L4908">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double creditBasisFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L4918">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4928" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4929">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4932">		return creditBasisFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4944">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L4945">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double creditBasisFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L4955">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L4965" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L4966">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L4969">		return creditBasisFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L4981">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, false);
	}

	@Override public double creditBasisFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L4992">		return creditBasisFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double creditBasisFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5002">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5004" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5005">			throw new java.lang.Exception</span>
				(&quot;BondComponent::creditBasisFromPriceToOptimalExercise =&gt; cant calc Work-out&quot;);

<span class="nc" id="L5008">		return creditBasisFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L5020">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5021">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double creditBasisFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5031">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5041" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5042">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5045">		return creditBasisFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5057">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L5058">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double creditBasisFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5068">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5078" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5079">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5082">		return creditBasisFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5094">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5095">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double creditBasisFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5105">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws	java.lang.Exception
	{
<span class="nc bnc" id="L5116" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5117">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromYieldSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Credit Basis from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5120">		return creditBasisFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5133">		return creditBasisFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L5134">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double creditBasisFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5144">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double creditBasisFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5154" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5155">			throw new java.lang.Exception (&quot;BondComponent::creditBasisFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Credit Basis from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5158">		return creditBasisFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5170">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L5171">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double discountMarginFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5181">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5191" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5192">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5195">		return discountMarginFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5207">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5208">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double discountMarginFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5218">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5228" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5229">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromBondBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5232">		return discountMarginFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5244">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5245">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double discountMarginFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5255">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5266" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5267">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Crdit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5271">		return discountMarginFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5284">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5285">			yieldFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double discountMarginFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5295">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5305" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5306">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromESpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5309">		return discountMarginFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5321">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5322">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double discountMarginFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5332">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5342" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5343">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromGSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; =&gt; Cant calc Discount Margin from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5346">		return discountMarginFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5358">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5359">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double discountMarginFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5369">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5379" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5380">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromISpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5383">		return discountMarginFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5395">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5396">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double discountMarginFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5406">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5416" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5417">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromJSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5420">		return discountMarginFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5432">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5433">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double discountMarginFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5443">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5453" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5454">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromNSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5457">		return discountMarginFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5469">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L5470">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double discountMarginFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L5480">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5490" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5491">			throw new java.lang.Exception (&quot;BondComponent::calcDiscountMarginFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5494">		return discountMarginFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5506">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L5507">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double discountMarginFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L5517">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5527" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5528">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Discount Margin from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5531">		return discountMarginFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5543">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L5544">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double discountMarginFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L5554">		return discountMarginFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double discountMarginFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L5564">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L5566" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L5567">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L5570">		return discountMarginFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5582">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5583">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double discountMarginFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5593">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5603" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5604">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromTSYSpreadToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Discount Margin from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5607">		return discountMarginFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L5619" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L5620">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5622">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L5624" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L5625">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L5627">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L5629">		int iFreq = freq();</span>

<span class="fc" id="L5631">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L5633" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L5634">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYield =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L5636" title="1 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
<span class="fc" id="L5637">			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblYield - dcFunding.libor (iValueDate,</span>
<span class="fc" id="L5638">				((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblYield - indexRate (iValueDate, csqc,</span>
					(org.drip.analytics.cashflow.CompositeFloatingPeriod) cp);
	}

	@Override public double discountMarginFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L5649">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5659" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5660">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5663">		return discountMarginFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5675">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5676">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double discountMarginFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5686">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5697" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5698">			throw new java.lang.Exception</span>
				(&quot;BondComponent::discountMarginFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Discount Margin from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5702">		return discountMarginFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5715">		return discountMarginFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5716">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double discountMarginFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5726">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double discountMarginFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5736" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5737">			throw new java.lang.Exception (&quot;BondComponent::discountMarginFromZSpreadToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Discount Margin from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5740">		return discountMarginFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5752">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L5753">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double durationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L5763">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5773" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5774">			throw new java.lang.Exception (&quot;BondComponent::durationFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5777">		return durationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5789">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L5790">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double durationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5800">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5810" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5811">			throw new java.lang.Exception (&quot;BondComponent::durationFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5814">		return durationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5826">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5827">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double durationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L5837">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5847" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5848">			throw new java.lang.Exception (&quot;BondComponent::durationFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5851">		return durationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5863">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L5864">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double durationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L5875">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5886" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5887">			throw new java.lang.Exception (&quot;BondComponent::durationFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Duration from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5890">		return durationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5903">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L5904">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double durationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5914">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5924" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5925">			throw new java.lang.Exception (&quot;BondComponent::durationFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5928">		return durationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5940">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L5941">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double durationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5951">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5961" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5962">			throw new java.lang.Exception (&quot;BondComponent::durationFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L5965">		return durationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5977">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L5978">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double durationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L5988">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L5998" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L5999">			throw new java.lang.Exception (&quot;BondComponent::durationFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6002">		return durationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6014">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6015">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double durationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6025">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6035" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6036">			throw new java.lang.Exception (&quot;BondComponent::durationFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6039">		return durationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6051">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6052">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double durationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6062">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6072" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6073">			throw new java.lang.Exception (&quot;BondComponent::durationFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6076">		return durationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6088">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6089">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double durationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6099">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6109" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6110">			throw new java.lang.Exception (&quot;BondComponent::durationFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6113">		return durationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6125">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6126">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double durationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6136">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6146" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6147">			throw new java.lang.Exception (&quot;BondComponent::durationFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6150">		return durationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6162">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
	}

	@Override public double durationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6172">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6182" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6183">			throw new java.lang.Exception (&quot;BondComponent::durationFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6186">		return durationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6198">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6199">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double durationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6209">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6219" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6220">			throw new java.lang.Exception (&quot;BondComponent::durationFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6223">		return durationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6235">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6236">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double durationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6246">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6256" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6257">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6260">		return durationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6272">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6273">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double durationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6283">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6293" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6294">			throw new java.lang.Exception (&quot;BondComponent::durationFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6297">		return durationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6309">		return durationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L6310">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double durationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6320">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double durationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6330" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6331">			throw new java.lang.Exception (&quot;BondComponent::durationFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6334">		return durationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6346">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L6347">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double eSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6357">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6367" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6368">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6371">		return eSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6383">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L6384">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double eSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6394">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6404" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6405">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6408">		return eSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6420">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L6421">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double eSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6431">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6441" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6442">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6445">		return eSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6457">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6458">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double eSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6469">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6480" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6481">			throw new java.lang.Exception</span>
				(&quot;BondComponent::eSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc E Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6485">		return eSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6498">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L6499">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double eSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6509">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6519" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6520">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6523">		return eSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6535">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L6536">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double eSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6546">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6556" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6557">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6560">		return eSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6572">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L6573">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double eSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6583">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6593" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6594">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6597">		return eSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6609">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L6610">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double eSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6620">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6630" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6631">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6634">		return eSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6646">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L6647">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double eSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L6657">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6667" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6668">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6671">		return eSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6683">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L6684">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double eSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L6694">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6704" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6705">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6708">		return eSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6720">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double eSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6731">		return eSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double eSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L6741">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L6743" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L6744">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6747">		return eSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6759">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L6760">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double eSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6770">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6780" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6781">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6784">		return eSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6796">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L6797">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double eSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L6807">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6817" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6818">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6821">		return eSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6833">		return eSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L6834">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double eSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L6844">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double eSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6854" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6855">			throw new java.lang.Exception (&quot;BondComponent::eSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc E Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6858">		return eSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6870">		return gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L6871">			(valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double gSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L6881">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6891" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6892">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6895">		return gSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6907">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L6908">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double gSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6918">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6928" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6929">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6932">		return gSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6944">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L6945">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double gSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L6955">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L6965" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L6966">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L6969">		return gSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6981">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L6982">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double gSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L6993">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7004" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7005">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc G Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7008">		return gSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7021">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7022">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double gSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7032">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7042" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7043">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7046">		return gSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7058">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L7059">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double gSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7069">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7079" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7080">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7083">		return gSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7095">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7096">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double gSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7106">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7116" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7117">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7120">		return gSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7132">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7133">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double gSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7143">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7153" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7154">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7157">		return gSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7169">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7170">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double gSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7180">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7190" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7191">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7194">		return gSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7206">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7207">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double gSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7217">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7227" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7228">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7231">		return gSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7243">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7244">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double gSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7254">		return gSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double gSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7264">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7266" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7267">			throw new java.lang.Exception</span>
				(&quot;BondComponent::gSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7270">		return gSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7282">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7283">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double gSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7293">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7303" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7304">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7307">		return gSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7319" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield) ||</span>
<span class="pc bpc" id="L7320" title="1 of 2 branches missed.">			valParams.valueDate() &gt;= iWorkoutDate)</span>
<span class="nc" id="L7321">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7323">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="fc bfc" id="L7325" title="All 2 branches covered.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L7327">		return dblYield - gc.yield (iWorkoutDate);</span>
	}

	@Override public double gSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7337">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7347" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7348">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7351">		return gSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7363">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7364">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double gSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7374">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7384" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7385">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7388">		return gSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7400">		return gSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7401">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double gSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7411">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double gSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7421" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7422">			throw new java.lang.Exception (&quot;BondComponent::gSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc G Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7425">		return gSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7437">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L7438">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double iSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L7448">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7458" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7459">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7462">		return iSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7474">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L7475">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double iSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7485">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7495" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7496">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7499">		return iSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7511">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L7512">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double iSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L7522">		return iSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7532" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7533">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7536">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7548">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L7549">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double iSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L7560">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7571" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7572">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc I Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7575">		return iSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7588">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L7589">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double iSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7599">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7609" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7610">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7613">		return iSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7625">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L7626">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double iSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7636">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7646" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7647">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7650">		return iSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7662">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L7663">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double iSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7673">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7683" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7684">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7687">		return iSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7699">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L7700">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double iSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7710">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7720" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7721">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7724">		return iSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7736">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L7737">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double iSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L7747">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7757" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7758">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7761">		return iSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7773">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L7774">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double iSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L7784">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7794" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7795">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7798">		return iSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7810">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L7811">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double iSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L7821">		return iSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double iSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L7831">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L7833" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L7834">			throw new java.lang.Exception</span>
				(&quot;BondComponent::iSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L7837">		return iSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7849">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L7850">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double iSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7860">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7870" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7871">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7874">		return iSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L7886" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L7887">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7889">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L7891" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L7892">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L7894">		return dblYield - dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double iSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L7904">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7914" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7915">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7918">		return iSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7930">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L7931">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double iSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7941">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7951" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7952">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7955">		return iSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7967">		return iSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L7968">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double iSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L7978">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double iSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L7988" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L7989">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L7992">		return iSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8004">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L8005">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double jSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8015">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8025" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8026">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8029">		return jSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8041">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L8042">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double jSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8052">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8062" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8063">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8066">		return jSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8078">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L8079">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double jSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8089">		return jSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8099" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8100">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc I Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8103">		return iSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8115">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8116">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double jSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8127">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8138" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8139">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc J Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8142">		return jSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8155">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L8156">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double jSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8166">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8176" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8177">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8180">		return jSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8192">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L8193">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double jSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8203">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8213" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8214">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8217">		return jSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8229">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L8230">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double jSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8240">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8250" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8251">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8254">		return jSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8266">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L8267">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double jSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8277">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8287" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8288">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8291">		return jSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8303">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L8304">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double jSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8314">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8324" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8325">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8328">		return jSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8340">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L8341">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double jSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8351">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8361" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8362">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8365">		return jSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8377">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L8378">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double jSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8388">		return jSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double jSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L8398">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L8400" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L8401">			throw new java.lang.Exception</span>
				(&quot;BondComponent::jSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L8404">		return jSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8416">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L8417">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double jSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8427">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8437" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8438">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8441">		return jSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L8453" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L8454">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8456">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="pc bpc" id="L8458" title="1 of 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L8460">		return dblYield - gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double jSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L8471">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8481" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8482">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8485">		return jSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8497">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L8498">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double jSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8508">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8518" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8519">			throw new java.lang.Exception (&quot;BondComponent::jSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8522">		return jSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8534">		return jSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L8535">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double jSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8545">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double jSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8555" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8556">			throw new java.lang.Exception (&quot;BondComponent::iSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc J Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8559">		return jSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8571">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8572">			yieldFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double macaulayDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L8582">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8592" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8593">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8597">		return macaulayDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8609">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8610">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double macaulayDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8620">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8631" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8632">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8636">		return macaulayDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8649">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8650">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double macaulayDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L8660">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8671" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8672">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8676">		return macaulayDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8689">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8690">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double macaulayDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L8701">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8712" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8713">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8717">		return macaulayDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8730">		return macaulayDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8731">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double macaulayDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8741">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8751" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8752">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8756">		return macaulayDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8768">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8769">			yieldFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double macaulayDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8779">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8789" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8790">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8794">		return macaulayDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8806">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8807">			yieldFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double macaulayDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8817">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8827" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8828">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8832">		return macaulayDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8844">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8845">			yieldFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double macaulayDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8855">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8865" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8866">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8870">		return macaulayDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8882">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8883">			yieldFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double macaulayDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L8893">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8903" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8904">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8908">		return macaulayDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8920">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8921">			yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double macaulayDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L8931">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double mnacaulayDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8941" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8942">			throw new java.lang.Exception</span>
				(&quot;BondComponent::mnacaulayDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8946">		return macaulayDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8958">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L8959">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double macaulayDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L8969">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L8979" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L8980">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L8984">		return macaulayDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L8996">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L8997">			yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double macaulayDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9007">		return macaulayDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double macaulayDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9017">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9019" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9020">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9023">		return macaulayDurationFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9035">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9036">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double macaulayDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9046">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9057" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9058">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9062">		return macaulayDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9075" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor))</span>
<span class="nc" id="L9076">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9078">		int iValueDate = valParams.valueDate();</span>

<span class="pc bpc" id="L9080" title="1 of 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L9081">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L9083">		boolean bFirstPeriod = true;</span>
<span class="fc" id="L9084">		double dblPeriodYearFract = 0.;</span>
<span class="fc" id="L9085">		double dblCumulativePeriodPV = 0.;</span>
<span class="fc" id="L9086">		boolean bTerminateCouponFlow = false;</span>
<span class="fc" id="L9087">		boolean bApplyFlatForwardRate = false;</span>
<span class="fc" id="L9088">		double dblCumulativePeriodDuration = 0.;</span>
<span class="fc" id="L9089">		double dblFlatForwardRate = java.lang.Double.NaN;</span>
<span class="fc" id="L9090">		org.drip.analytics.daycount.ActActDCParams aap = null;</span>
<span class="fc" id="L9091">		org.drip.analytics.cashflow.CompositePeriod periodRef = null;</span>

<span class="fc" id="L9093">		int iFrequency = freq();</span>

<span class="fc" id="L9095">		java.lang.String strDC = couponDC();</span>

<span class="fc" id="L9097">		java.lang.String strCalendar = currency();</span>

<span class="fc" id="L9099">		boolean bApplyCpnEOMAdj = _stream.couponEOMAdjustment();</span>

<span class="pc bpc" id="L9101" title="2 of 4 branches missed.">		if (null == strCalendar || strCalendar.isEmpty()) strCalendar = redemptionCurrency();</span>

<span class="fc bfc" id="L9103" title="All 2 branches covered.">		org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null :</span>
<span class="fc" id="L9104">			_quoteConvention.valuationCustomizationParams();</span>

<span class="pc bpc" id="L9106" title="1 of 2 branches missed.">		if (null != vcp) {</span>
<span class="nc" id="L9107">			strDC = vcp.yieldDayCount();</span>

<span class="nc" id="L9109">			iFrequency = vcp.yieldFreq();</span>

<span class="nc" id="L9111">			strCalendar = vcp.yieldCalendar();</span>

<span class="nc" id="L9113">			bApplyCpnEOMAdj = vcp.applyYieldEOMAdj();</span>

<span class="nc" id="L9115">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
<span class="pc bpc" id="L9116" title="1 of 2 branches missed.">		} else if (null != vcpQuote) {</span>
<span class="nc" id="L9117">			strDC = vcpQuote.yieldDayCount();</span>

<span class="nc" id="L9119">			iFrequency = vcpQuote.yieldFreq();</span>

<span class="nc" id="L9121">			strCalendar = vcpQuote.yieldCalendar();</span>

<span class="nc" id="L9123">			bApplyCpnEOMAdj = vcpQuote.applyYieldEOMAdj();</span>

<span class="nc" id="L9125">			bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="fc" id="L9128">		int iAmortizationMode = _notionalSetting.periodAmortizationMode();</span>

<span class="pc bpc" id="L9130" title="1 of 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="fc" id="L9131">			int iPeriodPayDate = period.payDate();</span>

<span class="fc bfc" id="L9133" title="All 2 branches covered.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="fc bfc" id="L9135" title="All 2 branches covered.">			if (bFirstPeriod) {</span>
<span class="fc" id="L9136">				bFirstPeriod = false;</span>

<span class="fc" id="L9138">				dblPeriodYearFract = period.couponDCF() - period.accrualDCF (iValueDate);</span>
			} else
<span class="fc" id="L9140">				dblPeriodYearFract += period.couponDCF();</span>

<span class="fc" id="L9142">			periodRef = period;</span>

<span class="fc" id="L9144">			int iPeriodEndDate = period.endDate();</span>

<span class="fc" id="L9146">			int iPeriodStartDate = period.startDate();</span>

<span class="fc bfc" id="L9148" title="All 2 branches covered.">			if (iPeriodEndDate &gt;= iWorkoutDate) {</span>
<span class="fc" id="L9149">				bTerminateCouponFlow = true;</span>
<span class="fc" id="L9150">				iPeriodEndDate = iWorkoutDate;</span>
			}

<span class="fc" id="L9153">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="pc bpc" id="L9156" title="1 of 2 branches missed.">			if (null == cpcm)</span>
<span class="nc" id="L9157">				throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYield =&gt; No CPCM&quot;);</span>

<span class="pc bpc" id="L9159" title="1 of 2 branches missed.">			if (null != vcp) {</span>
<span class="nc bnc" id="L9160" title="All 2 branches missed.">				if (null == (aap = vcp.yieldAAP()))</span>
<span class="nc" id="L9161">					aap = new org.drip.analytics.daycount.ActActDCParams (vcp.yieldFreq(), iPeriodEndDate -</span>
						iPeriodStartDate);
<span class="pc bpc" id="L9163" title="1 of 2 branches missed.">			} else if (null != vcpQuote) {</span>
<span class="nc bnc" id="L9164" title="All 2 branches missed.">				if (null == (aap = vcpQuote.yieldAAP()))</span>
<span class="nc" id="L9165">					aap = new org.drip.analytics.daycount.ActActDCParams (vcpQuote.yieldFreq(),</span>
						iPeriodEndDate - iPeriodStartDate);
			} else
<span class="fc" id="L9168">				aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, iPeriodEndDate -</span>
					iPeriodStartDate);

<span class="fc" id="L9171">			double dblYearFract = org.drip.analytics.daycount.Convention.YearFraction (iValueDate,</span>
				iPeriodPayDate, strDC, bApplyCpnEOMAdj, aap, strCalendar);

<span class="fc" id="L9174">			double dblYieldAnnuity = org.drip.analytics.support.Helper.Yield2DF (iFrequency, dblYield,</span>
<span class="fc" id="L9175">				s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract : dblYearFract) * cpcm.cumulative();</span>

<span class="fc" id="L9177">			double dblPeriodStartNotional = notional (iPeriodStartDate);</span>

<span class="fc" id="L9179">			double dblPeriodEndNotional = notional (iPeriodEndDate);</span>

<span class="fc" id="L9181">			double dblCouponNotional = dblPeriodStartNotional;</span>

<span class="fc bfc" id="L9183" title="All 2 branches covered.">			if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_START == iAmortizationMode)</span>
<span class="fc" id="L9184">				dblCouponNotional = notional (iPeriodStartDate);</span>
<span class="pc bpc" id="L9185" title="1 of 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_AT_END == iAmortizationMode)</span>
<span class="fc" id="L9186">				dblCouponNotional = dblPeriodEndNotional;</span>
<span class="nc bnc" id="L9187" title="All 2 branches missed.">			else if (org.drip.product.params.NotionalSetting.PERIOD_AMORT_EFFECTIVE == iAmortizationMode)</span>
<span class="nc" id="L9188">				dblCouponNotional = notional (iPeriodStartDate, iPeriodEndDate);</span>

<span class="fc bfc" id="L9190" title="All 2 branches covered.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="fc" id="L9191">				dblFlatForwardRate = cpcm.rate();</span>

<span class="pc bpc" id="L9193" title="1 of 2 branches missed.">			double dblCouponPV = period.accrualDCF (iPeriodEndDate) * (bApplyFlatForwardRate ?</span>
<span class="fc" id="L9194">				dblFlatForwardRate : cpcm.rate()) * couponFactor (iPeriodEndDate) * dblYieldAnnuity *</span>
					dblCouponNotional;

<span class="fc" id="L9197">			double dblPeriodNotionalPV = (dblPeriodStartNotional - dblPeriodEndNotional) * dblYieldAnnuity;</span>
<span class="fc" id="L9198">			dblCumulativePeriodDuration += dblPeriodYearFract * (dblCouponPV + dblPeriodNotionalPV);</span>
<span class="fc" id="L9199">			dblCumulativePeriodPV += (dblCouponPV + dblPeriodNotionalPV);</span>

<span class="fc bfc" id="L9201" title="All 2 branches covered.">			if (bTerminateCouponFlow) break;</span>
<span class="fc" id="L9202">		}</span>

<span class="pc bpc" id="L9204" title="1 of 2 branches missed.">		if (null != periodRef)</span>
<span class="fc" id="L9205">			aap = new org.drip.analytics.daycount.ActActDCParams (iFrequency, periodRef.endDate() -</span>
<span class="fc" id="L9206">				periodRef.startDate());</span>

<span class="fc" id="L9208">		double dblRedemptionPV = dblWorkoutFactor * org.drip.analytics.support.Helper.Yield2DF (iFrequency,</span>
			dblYield, s_bYieldDFOffofCouponAccrualDCF ? dblPeriodYearFract :
				org.drip.analytics.daycount.Convention.YearFraction (iValueDate, terminationAdjust
<span class="fc" id="L9211">					(iWorkoutDate), strDC, bApplyCpnEOMAdj, aap, strCalendar)) * notional (iWorkoutDate);</span>

<span class="fc" id="L9213">		return (dblCumulativePeriodDuration + dblPeriodYearFract * dblRedemptionPV) / (dblCumulativePeriodPV</span>
			+ dblRedemptionPV);
	}

	@Override public double macaulayDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9224">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9234" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9235">			throw new java.lang.Exception (&quot;BondComponent::macaulayDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Macaulay Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9238">		return macaulayDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9250">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9251">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double macaulayDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9261">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9272" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9273">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9277">		return macaulayDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9290">		return macaulayDurationFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9291">			yieldFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double macaulayDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9301">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double macaulayDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9311" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9312">			throw new java.lang.Exception</span>
				(&quot;BondComponent::macaulayDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Macaulay Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9316">		return macaulayDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9328">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9329">			priceFromASW (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double modifiedDurationFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9339">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9349" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9350">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromASWToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9354">		return modifiedDurationFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9366">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9367">			priceFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double modifiedDurationFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9377">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9388" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9389">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromBondBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9393">		return modifiedDurationFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblBondBasis);
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9406">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9407">			priceFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double modifiedDurationFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9417">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9428" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9429">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromCreditBasisToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Crd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9433">		return modifiedDurationFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9446">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9447">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double modifiedDurationFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L9458">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9469" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9470">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Disc Marg to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9474">		return modifiedDurationFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9487">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9488">			priceFromESpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double modifiedDurationFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9498">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9508" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9509">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromESpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9513">		return modifiedDurationFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9525">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9526">			priceFromGSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double modifiedDurationFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9536">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9546" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9547">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromGSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9551">		return modifiedDurationFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9563">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9564">			priceFromISpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double modifiedDurationFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9574">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9584" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9585">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromISpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9589">		return modifiedDurationFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9601">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9602">			priceFromJSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double modifiedDurationFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9612">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9622" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9623">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromJSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9627">		return modifiedDurationFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9639">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9640">			priceFromNSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double modifiedDurationFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9650">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9660" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9661">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromNSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9665">		return modifiedDurationFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9677">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9678">			priceFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double modifiedDurationFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L9688">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9698" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9699">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromOASToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9703">		return modifiedDurationFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9715">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9716">			yieldFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double modifiedDurationFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L9726">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9736" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9737">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPECSToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9741">		return modifiedDurationFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L9753" title="2 of 4 branches missed.">		if (null == valParams || !org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L9754">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromPrice =&gt; Input inputs&quot;);</span>

<span class="fc bfc" id="L9756" title="All 2 branches covered.">		if (null == _floaterSetting)</span>
<span class="fc" id="L9757">			return (dblPrice - priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9758">				yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) + 0.0001)) /</span>
<span class="fc" id="L9759">					(dblPrice + accrued (valParams.valueDate(), csqc));</span>

<span class="fc" id="L9761">		return (dblPrice - priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L9762">			discountMarginFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice) +</span>
<span class="fc" id="L9763">				0.0001)) / (dblPrice + accrued (valParams.valueDate(), csqc));</span>
	}

	@Override public double modifiedDurationFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L9773">		return modifiedDurationFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double modifiedDurationFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L9783">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L9785" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L9786">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L9789">		return modifiedDurationFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9801">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9802">			priceFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double modifiedDurationFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9812">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9823" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9824">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromTSYSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9828">		return modifiedDurationFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblTSYSpread);
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9841">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9842">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double modifiedDurationFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L9852">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9862" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9863">			throw new java.lang.Exception (&quot;BondComponent::modifiedDurationFromYieldToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Modified Duration from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9866">		return modifiedDurationFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9878">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9879">			priceFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double modifiedDurationFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9889">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9900" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9901">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromYieldSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Yld Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9905">		return modifiedDurationFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblYieldSpread);
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9918">		return modifiedDurationFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L9919">			priceFromZSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double modifiedDurationFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L9929">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double modifiedDurationFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9939" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9940">			throw new java.lang.Exception</span>
				(&quot;BondComponent::modifiedDurationFromZSpreadToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Modified Duration from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9944">		return modifiedDurationFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9956">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L9957">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double nSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L9967">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L9977" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L9978">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L9981">		return nSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L9993">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L9994">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double nSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10004">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10014" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10015">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10018">		return nSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10030">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L10031">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double nSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10041">		return nSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10051" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10052">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10055">		return nSpreadFromCreditBasis (valParams, csqs, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10067">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L10068">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double nSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10079">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10090" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10091">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc N Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10094">		return nSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10107">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L10108">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double nSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10118">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10128" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10129">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10132">		return nSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10144">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L10145">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double nSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10155">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10165" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10166">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10169">		return nSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10181">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L10182">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double nSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10192">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10202" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10203">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10206">		return nSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10218">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L10219">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double nSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10229">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10239" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10240">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10243">		return nSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10255">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L10256">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double nSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L10266">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10276" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10277">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10280">		return nSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10292">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L10293">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double nSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10303">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10313" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10314">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10317">		return nSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10329">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L10330">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double nSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10340">		return nSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double nSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10350">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10352" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10353">			throw new java.lang.Exception</span>
				(&quot;BondComponent::nSpreadFromPriceToOptimalExercise =&gt; Can't do Work-out&quot;);

<span class="nc" id="L10356">		return nSpreadFromYield (valParams, csqc, vcp, wi.date(), wi.factor(), wi.yield());</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10368">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L10369">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double nSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10379">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10389" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10390">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10393">		return nSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L10405" title="2 of 4 branches missed.">		if (null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L10406">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10408">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L10410" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L10411">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYield =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L10413">		return dblYield - dcFunding.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate);</span>
	}

	@Override public double nSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10423">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10433" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10434">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10437">		return nSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10449">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L10450">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double nSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10460">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10470" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10471">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10474">		return nSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10486">		return nSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L10487">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double nSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10497">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double nSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10507" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10508">			throw new java.lang.Exception (&quot;BondComponent::nSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc N Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10511">		return nSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10523">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));
	}

	@Override public double oasFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L10534">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10544" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10545">			throw new java.lang.Exception (&quot;BondComponent::oasFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10548">		return oasFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10560">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L10561">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double oasFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10571">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10581" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10582">			throw new java.lang.Exception (&quot;BondComponent::oasFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Bnd Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10585">		return oasFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10597">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L10598">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double oasFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L10608">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10618" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10619">			throw new java.lang.Exception (&quot;BondComponent::oasFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10622">		return oasFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10634">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L10635">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double oasFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L10645">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10655" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10656">			throw new java.lang.Exception (&quot;BondComponent::oasFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10659">		return oasFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10671">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L10672">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double oasFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10682">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10692" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10693">			throw new java.lang.Exception (&quot;BondComponent::oasFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10696">		return oasFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10708">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L10709">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double oasFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10719">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10729" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10730">			throw new java.lang.Exception (&quot;BondComponent::oasFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10733">		return oasFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10745">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L10746">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double oasFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10756">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10766" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10767">			throw new java.lang.Exception (&quot;BondComponent::oasFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10770">		return oasFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10782">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L10783">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double oasFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10793">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10803" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10804">			throw new java.lang.Exception (&quot;BondComponent::oasFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10807">		return oasFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10819">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L10820">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double oasFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10830">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10840" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10841">			throw new java.lang.Exception (&quot;BondComponent::oasFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10844">		return oasFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10856">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L10857">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double oasFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L10867">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10877" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10878">			throw new java.lang.Exception (&quot;BondComponent::oasFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10881">		return oasFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10893">		return new BondCalibrator (this, false).calibrateOASFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double oasFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L10904">		return oasFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double oasFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L10914">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L10916" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L10917">			throw new java.lang.Exception</span>
				(&quot;BondComponent::oasFromPriceToOptimalExercise - cant calc Work-out&quot;);

<span class="nc" id="L10920">		return oasFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10932">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L10933">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double oasFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L10943">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10953" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10954">			throw new java.lang.Exception (&quot;BondComponent::oasFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from TSY Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10957">		return oasFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L10969">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L10970">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double oasFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L10980">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L10990" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L10991">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L10994">		return oasFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11006">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11007">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double oasFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11017">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11027" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11028">			throw new java.lang.Exception (&quot;BondComponent::oasFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Yield Sprd to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11031">		return oasFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11043">		return oasFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11044">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double oasFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11054">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double oasFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11064" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11065">			throw new java.lang.Exception (&quot;BondComponent::oasFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc OAS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11068">		return oasFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11080">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L11081">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double pecsFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11091">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11101" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11102">			throw new java.lang.Exception (&quot;BondComponent::pecsFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11105">		return pecsFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11117">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L11118">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double pecsFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11128">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11138" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11139">			throw new java.lang.Exception (&quot;BondComponent::pecsFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11142">		return pecsFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11154">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L11155">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double pecsFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11165">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11175" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11176">			throw new java.lang.Exception (&quot;BondComponent::pecsFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11179">		return pecsFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11191">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromDiscountMargin</span>
<span class="nc" id="L11192">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblDiscountMargin));</span>
	}

	@Override public double pecsFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11202">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11212" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11213">			throw new java.lang.Exception (&quot;BondComponent::pecsFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11216">		return pecsFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1., dblDiscountMargin);</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11228">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromESpread</span>
<span class="nc" id="L11229">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double pecsFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11239">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11249" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11250">			throw new java.lang.Exception (&quot;BondComponent::pecsFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11253">		return pecsFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11265">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L11266">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double pecsFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11276">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11286" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11287">			throw new java.lang.Exception (&quot;BondComponent::pecsFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11290">		return pecsFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11302">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L11303">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double pecsFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11313">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11323" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11324">			throw new java.lang.Exception (&quot;BondComponent::pecsFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11327">		return pecsFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11339">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L11340">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double pecsFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11350">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11360" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11361">			throw new java.lang.Exception (&quot;BondComponent::pecsFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11364">		return pecsFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11376">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L11377">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double pecsFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11387">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11397" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11398">			throw new java.lang.Exception (&quot;BondComponent::pecsFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11401">		return pecsFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11413">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L11414">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double pecsFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L11424">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11434" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11435">			throw new java.lang.Exception (&quot;BondComponent::pecsFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11438">		return pecsFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11450">		return new BondCalibrator (this, false).calibrateCreditBasisFromPrice (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice, true);
	}

	@Override public double pecsFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11461">		return pecsFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double pecsFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L11471">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L11473" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L11474">			throw new java.lang.Exception</span>
				(&quot;BondComponent::pecsFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L11477">		return pecsFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11489">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L11490">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double pecsFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11500">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11510" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11511">			throw new java.lang.Exception (&quot;BondComponent::pecsFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11514">		return pecsFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11526">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="nc" id="L11527">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double pecsFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L11537">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11547" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11548">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11551">		return pecsFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11563">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L11564">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double pecsFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11574">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11584" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11585">			throw new java.lang.Exception (&quot;BondComponent::pecsFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11588">		return pecsFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11600">		return pecsFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZSpread</span>
<span class="nc" id="L11601">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double pecsFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11611">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double pecsFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11621" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11622">			throw new java.lang.Exception (&quot;BondComponent::pecsFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc PECS from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11625">		return pecsFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11637" title="All 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="nc bnc" id="L11638" title="All 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblASW))</span>
<span class="nc" id="L11639">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11641">		int iValueDate = valParams.valueDate();</span>

<span class="nc bnc" id="L11643" title="All 2 branches missed.">		if (iValueDate &gt;= iWorkoutDate)</span>
<span class="nc" id="L11644">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11646">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L11648" title="All 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L11649">			throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L11651">		org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate, valParams,</span>
			csqc);

<span class="nc bnc" id="L11654" title="All 2 branches missed.">		if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::priceFromASW =&gt; No CPCM&quot;);</span>

<span class="nc" id="L11656">		return dblWorkoutFactor - 100. * dcFunding.parSwapDV01 (iWorkoutDate) * (dblASW +</span>
<span class="nc" id="L11657">			dcFunding.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) - cpcm.rate());</span>
	}

	@Override public double priceFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L11667">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11677" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11678">			throw new java.lang.Exception (&quot;BondComponent::priceFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11681">		return priceFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11693">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="fc" id="L11694">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double priceFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11704">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11714" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11715">			throw new java.lang.Exception (&quot;BondComponent::priceFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11718">		return priceFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L11730">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblCreditBasis,</span>
			false);
	}

	@Override public double priceFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L11741">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11751" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11752">			throw new java.lang.Exception (&quot;BondComponent::priceFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11755">		return priceFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="fc" id="L11767">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L11768">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double priceFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L11779">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11790" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11791">			throw new java.lang.Exception (&quot;BondComponent::priceFromDiscountMarginToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11794">		return priceFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11807">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L11808">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double priceFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11818">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11828" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11829">			throw new java.lang.Exception (&quot;BondComponent::priceFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11832">		return priceFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11844">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L11845">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double priceFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11855">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11865" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11866">			throw new java.lang.Exception (&quot;BondComponent::priceFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11869">		return priceFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11881">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L11882">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double priceFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11892">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11902" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11903">			throw new java.lang.Exception (&quot;BondComponent::priceFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11906">		return priceFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11918">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L11919">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double priceFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11929">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11939" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11940">			throw new java.lang.Exception (&quot;BondComponent::priceFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11943">		return priceFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11955">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L11956">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double priceFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L11966">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L11976" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L11977">			throw new java.lang.Exception (&quot;BondComponent::priceFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L11980">		return priceFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L11992">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_TREASURIES_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblOAS);
	}

	@Override public double priceFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="fc" id="L12003">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12013" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12014">			throw new java.lang.Exception (&quot;BondComponent::priceFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12017">		return priceFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12029">		return priceFromCreditCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, dblPECS, true);</span>
	}

	@Override public double priceFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12039">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12049" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12050">			throw new java.lang.Exception (&quot;BondComponent::priceFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12053">		return priceFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12065">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="fc" id="L12066">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double priceFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12076">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12086" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12087">			throw new java.lang.Exception (&quot;BondComponent::priceFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12090">		return priceFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12102">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield, false);</span>
	}

	@Override public double priceFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12112">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12122" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12123">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cannot calc exercise px from yld for bonds w emb option&quot;);

<span class="nc" id="L12126">		return priceFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12138">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L12139">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double priceFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12149">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12159" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12160">			throw new java.lang.Exception (&quot;BondComponent::priceFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12163">		return priceFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L12175">		return priceFromZeroCurve (valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE,</span>
			iWorkoutDate, dblWorkoutFactor, dblZSpread);
	}

	@Override public double priceFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12186">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double priceFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12196" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12197">			throw new java.lang.Exception (&quot;BondComponent::priceFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Price from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12200">		return priceFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12212">		return tsySpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12213">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double tsySpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12223">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12233" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12234">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12237">		return tsySpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12249">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L12250">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double tsySpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12260">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12270" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12271">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12274">		return tsySpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12286">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12287">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double tsySpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12297">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12307" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12308">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12311">		return tsySpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12323">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12324">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double tsySpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12335">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12346" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12347">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromDiscountMarginToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc TSY Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12350">		return tsySpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12363">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L12364">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double tsySpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12374">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12384" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12385">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12388">		return tsySpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12400">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L12401">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double tsySpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12411">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12421" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12422">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12425">		return tsySpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12437">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L12438">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double tsySpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12448">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12458" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12459">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12462">		return tsySpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12474">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L12475">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double tsySpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12485">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12495" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12496">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12499">		return tsySpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12511">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L12512">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double tsySpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12522">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12532" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12533">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12536">		return tsySpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12548">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L12549">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double tsySpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L12559">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12569" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12570">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12573">		return tsySpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12585">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L12586">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double tsySpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L12596">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12606" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12607">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12610">		return tsySpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12622">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L12623">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double tsySpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L12633">		return tsySpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double tsySpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L12643">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L12645" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L12646">			throw new java.lang.Exception</span>
				(&quot;BondComponent::tsySpreadFromPriceToOptimalExercise =&gt; Cant determine Work-out&quot;);

<span class="nc" id="L12649">		return tsySpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L12661">		return dblYield - treasuryBenchmarkYield (valParams, csqc, iWorkoutDate);</span>
	}

	@Override public double tsySpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L12671">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12681" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12682">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12685">		return tsySpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12697">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L12698">			yieldFromYieldSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double tsySpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12708">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12718" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12719">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12722">		return tsySpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12734">		return tsySpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L12735">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double tsySpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12745">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double tsySpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12755" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12756">			throw new java.lang.Exception (&quot;BondComponent::tsySpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc TSY Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12759">		return tsySpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12771">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L12772">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L12782">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12792" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12793">			throw new java.lang.Exception (&quot;BondComponent::yieldFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12796">		return yieldFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12808" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblBondBasis))</span>
<span class="nc" id="L12809">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasis =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L12811">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L12812">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblBondBasis;</span>
	}

	@Override public double yieldFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="fc" id="L12822">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12832" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12833">			throw new java.lang.Exception (&quot;BondComponent::yieldFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12836">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12848">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L12849">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L12859">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12869" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12870">			throw new java.lang.Exception (&quot;BondComponent::yieldFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12873">		return yieldFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L12885" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || !org.drip.quant.common.NumberUtil.IsValid (dblWorkoutFactor)</span>
<span class="pc bpc" id="L12886" title="1 of 2 branches missed.">			|| !org.drip.quant.common.NumberUtil.IsValid (dblDiscountMargin))</span>
<span class="nc" id="L12887">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12889">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="pc bpc" id="L12891" title="1 of 2 branches missed.">		if (null == dcFunding)</span>
<span class="nc" id="L12892">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="fc" id="L12894">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L12896">		int iFreq = freq();</span>

<span class="fc" id="L12898">		org.drip.analytics.cashflow.CompositePeriod cp = currentPeriod (iValueDate);</span>

<span class="pc bpc" id="L12900" title="1 of 2 branches missed.">		if (null == cp)</span>
<span class="nc" id="L12901">			throw new java.lang.Exception (&quot;BondComponent::yieldFromDiscountMargin =&gt; Invalid inputs&quot;);</span>

<span class="pc bpc" id="L12903" title="2 of 6 branches missed.">		return null == _floaterSetting || !(cp instanceof</span>
			org.drip.analytics.cashflow.CompositeFloatingPeriod) ? dblDiscountMargin + dcFunding.libor
<span class="fc" id="L12905">				(iValueDate, ((int) (12. / (0 == iFreq ? 2 : iFreq))) + &quot;M&quot;) : dblDiscountMargin + indexRate</span>
<span class="fc" id="L12906">					(iValueDate, csqc, (org.drip.analytics.cashflow.CompositeFloatingPeriod) currentPeriod</span>
<span class="fc" id="L12907">						(iValueDate));</span>
	}

	@Override public double yieldFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12917">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L12928">		return yieldFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12941">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L12942">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblESpread));
	}

	@Override public double yieldFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12953">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12963" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L12964">			throw new java.lang.Exception (&quot;BondComponent::yieldFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L12967">		return yieldFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L12979" title="All 6 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblGSpread) || valParams.valueDate() &gt;= iWorkoutDate</span>
			|| null == csqc)
<span class="nc" id="L12981">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L12983">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L12985" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L12987">		return gc.yield (iWorkoutDate) + dblGSpread;</span>
	}

	@Override public double yieldFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L12997">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13007" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13008">			throw new java.lang.Exception (&quot;BondComponent::yieldFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13011">		return yieldFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13023" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13024" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblISpread))</span>
<span class="nc" id="L13025">			throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13027">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13028">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13030" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromISpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13032">		return dc.estimateManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblISpread;</span>
	}

	@Override public double yieldFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13042">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13052">		return yieldFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13064" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13065" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblJSpread))</span>
<span class="nc" id="L13066">			throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13068">		org.drip.state.govvie.GovvieCurve gc = csqc.govvieState (govvieLabel());</span>

<span class="nc bnc" id="L13070" title="All 2 branches missed.">		if (null == gc) throw new java.lang.Exception (&quot;BondComponent::yieldFromJSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13072">		return dblJSpread + gc.yield (weightedAverageMaturityDate (valParams, csqc, iWorkoutDate,</span>
			dblWorkoutFactor));
	}

	@Override public double yieldFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13083">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13093">		return yieldFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13105" title="All 6 branches missed.">		if (null == valParams || valParams.valueDate() &gt;= iWorkoutDate || null == csqc ||</span>
<span class="nc bnc" id="L13106" title="All 2 branches missed.">			!org.drip.quant.common.NumberUtil.IsValid (dblNSpread))</span>
<span class="nc" id="L13107">			throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13109">		org.drip.state.discount.MergedDiscountForwardCurve dc = csqc.fundingState</span>
<span class="nc" id="L13110">			(org.drip.state.identifier.FundingLabel.Standard (payCurrency()));</span>

<span class="nc bnc" id="L13112" title="All 2 branches missed.">		if (null == dc) throw new java.lang.Exception (&quot;BondComponent::yieldFromNSpread =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L13114">		return dc.proxyManifestMeasure (&quot;SwapRate&quot;, iWorkoutDate) + dblNSpread;</span>
	}

	@Override public double yieldFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13124">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13134">		return yieldFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13146">		return yieldFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS (valParams,</span>
			csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));
	}

	@Override public double yieldFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13157">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13167" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13168">			throw new java.lang.Exception (&quot;BondComponent::yieldFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13171">		return yieldFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13183">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L13184">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13194">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13204" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13205">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13208">		return yieldFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13220">		return new BondCalibrator (this, false).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13231">		return yieldFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13241">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13243" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13244">			throw new java.lang.Exception (&quot;BondComponent::yieldFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13247">		return wi.yield();</span>
	}

	@Override public double yieldFromPriceTC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13259">		return new BondCalibrator (this, true).calibrateYieldFromPrice (valParams, csqc, vcp, iWorkoutDate,</span>
			dblWorkoutFactor, dblPrice);
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13272" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblTSYSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13274">			throw new java.lang.Exception (&quot;BondComponent::calcYieldFromTSYSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13276">		return treasuryBenchmarkYield (valParams, csqc, iWorkoutDate) + dblTSYSpread;</span>
	}

	@Override public double yieldFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13286">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13296" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13297">			throw new java.lang.Exception (&quot;BondComponent::yieldFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13300">		return yieldFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13312" title="2 of 4 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYieldSpread) || valParams.valueDate() &gt;=</span>
			iWorkoutDate)
<span class="nc" id="L13314">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpread =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13316">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromFundingCurve</span>
<span class="fc" id="L13317">			(valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.)) + dblYieldSpread;</span>
	}

	@Override public double yieldFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="fc" id="L13327">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13337" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13338">			throw new java.lang.Exception (&quot;BondComponent::yieldFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13341">		return yieldFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13353">		return yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromZeroCurve</span>
<span class="nc" id="L13354">			(valParams, csqc, vcp, ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate,</span>
				dblWorkoutFactor, dblZSpread));
	}

	@Override public double yieldFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13365">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13375" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13376">			throw new java.lang.Exception (&quot;BondComponent::yieldFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13379">		return yieldFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13391">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13392">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yield01FromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13402">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13412" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13413">			throw new java.lang.Exception (&quot;BondComponent::yield01FromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13416">		return yield01FromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13428">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromBondBasis</span>
<span class="nc" id="L13429">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yield01FromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13439">		return yieldFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13449" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13450">			throw new java.lang.Exception (&quot;BondComponent::yield01FromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13453">		return yield01FromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13465">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromCreditBasis</span>
<span class="nc" id="L13466">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yield01FromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13476">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13486" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13487">			throw new java.lang.Exception (&quot;BondComponent::yield01FromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13490">		return yield01FromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13502">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13503">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yield01FromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L13514">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13525" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13526">			throw new java.lang.Exception (&quot;BondComponent::yield01FromDiscountMarginToOptimalExercise =&gt;&quot; +</span>
				&quot; Cant calc Yield01 from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13529">		return yield01FromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13542">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L13543">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yield01FromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13553">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13563" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13564">			throw new java.lang.Exception (&quot;BondComponent::yield01FromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13567">		return yield01FromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13579">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L13580">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yield01FromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13590">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13600" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13601">			throw new java.lang.Exception (&quot;BondComponent::yield01FromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13604">		return yield01FromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13616">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L13617">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yield01FromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13627">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13637" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13638">			throw new java.lang.Exception (&quot;BondComponent::yield01FromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13641">		return yield01FromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13653">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L13654">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yield01FromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13664">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13674" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13675">			throw new java.lang.Exception (&quot;BondComponent::yield01FromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13678">		return yield01FromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13690">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L13691">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yield01FromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L13701">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13711" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13712">			throw new java.lang.Exception (&quot;BondComponent::yield01FromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13715">		return yield01FromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13727">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L13728">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yield01FromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L13738">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13748" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13749">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13752">		return yield01FromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13764">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="fc" id="L13765">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yield01FromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L13775">		return yield01FromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13785">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L13787" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L13788">			throw new java.lang.Exception (&quot;BondComponent::yield01FromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13791">		return yield01FromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13803">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromTSYSpread</span>
<span class="nc" id="L13804">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yield01FromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L13814">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13824" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13825">			throw new java.lang.Exception (&quot;BondComponent::yield01FromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13828">		return yield01FromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="pc bpc" id="L13840" title="1 of 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L13841">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYield =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L13843">		return priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield) -</span>
<span class="fc" id="L13844">			priceFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield + 0.0001);</span>
	}

	@Override public double yield01FromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L13854">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13864" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13865">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13868">		return yield01FromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13880">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromYieldSpread</span>
<span class="nc" id="L13881">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double yield01FromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13891">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13901" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13902">			throw new java.lang.Exception (&quot;BondComponent::yield01FromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13905">		return yield01FromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13917">		return yield01FromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L13918">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yield01FromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L13928">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yield01FromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13938" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13939">			throw new java.lang.Exception (&quot;BondComponent::yield01FromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield01 from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13942">		return yield01FromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13954">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromASW</span>
<span class="nc" id="L13955">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double yieldSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L13965">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L13975" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L13976">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L13979">		return yieldSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L13991">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L13992">			yieldFromBondBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double yieldSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14002">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14012" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14013">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromBondBasisToOptimalExercise =&gt; &quot;</span>
				+ &quot;Cant calc Yield Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14016">		return yieldSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14028">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14029">			yieldFromCreditBasis (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double yieldSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14039">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14050" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14051">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromCreditBasisToOptimalExercise &quot; +</span>
				&quot;=&gt; Cant calc Yield Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14054">		return yieldSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblCreditBasis);
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14067">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14068">			yieldFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double yieldSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14079">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14090" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14091">			throw new java.lang.Exception</span>
				(&quot;BondComponent::yieldSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Yield Spread from Disc Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14095">		return yieldSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14108">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromESpread</span>
<span class="nc" id="L14109">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblESpread));</span>
	}

	@Override public double yieldSpreadFromESpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14119">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromESpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblESpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14129" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14130">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromESpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from E Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14133">		return yieldSpreadFromESpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblESpread);</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14145">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromGSpread</span>
<span class="nc" id="L14146">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double yieldSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14156">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14166" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14167">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14170">		return yieldSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14182">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromISpread</span>
<span class="nc" id="L14183">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double yieldSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14193">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14203" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14204">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14207">		return yieldSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14219">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromJSpread</span>
<span class="nc" id="L14220">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double yieldSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14230">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14240" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14241">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14244">		return yieldSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14256">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromNSpread</span>
<span class="nc" id="L14257">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double yieldSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14267">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14277" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14278">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14281">		return yieldSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14293">		return yieldSpreadFromOAS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromOAS</span>
<span class="nc" id="L14294">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double yieldSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14304">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14314" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14315">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14318">		return yieldSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14330">		return yieldSpreadFromPECS (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPECS</span>
<span class="nc" id="L14331">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double yieldSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14341">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14351" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14352">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14355">		return yieldSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14367">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromPrice</span>
<span class="nc" id="L14368">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice));</span>
	}

	@Override public double yieldSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14378">		return yieldSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double yieldSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14388">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14390" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14391">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14394">		return yieldSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14406">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14407">			yieldFromTSYSpread (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double yieldSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14417">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14427" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14428">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14431">		return yieldSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14443" title="All 2 branches missed.">		if (!org.drip.quant.common.NumberUtil.IsValid (dblYield))</span>
<span class="nc" id="L14444">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYield =&gt; Invalid Inputs&quot;);</span>

<span class="nc" id="L14446">		return dblYield - yieldFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14447">			priceFromFundingCurve (valParams, csqc, iWorkoutDate, dblWorkoutFactor, 0.));</span>
	}

	@Override public double yieldSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14457">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14467" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14468">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14471">		return yieldSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14483">		return yieldSpreadFromYield (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, yieldFromZSpread</span>
<span class="nc" id="L14484">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblZSpread));</span>
	}

	@Override public double yieldSpreadFromZSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14494">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double yieldSpreadFromZSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblZSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14504" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14505">			throw new java.lang.Exception (&quot;BondComponent::yieldSpreadFromZSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Yield Spread from Z Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14508">		return yieldSpreadFromZSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblZSpread);</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14520">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromASW</span>
<span class="nc" id="L14521">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblASW));</span>
	}

	@Override public double zSpreadFromASW (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc" id="L14531">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromASWToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblASW)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14541" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14542">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromASWToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from ASW to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14545">		return zSpreadFromASW (valParams, csqc, vcp, maturityDate().julian(), 1., dblASW);</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14557">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromBondBasis</span>
<span class="nc" id="L14558">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblBondBasis));</span>
	}

	@Override public double zSpreadFromBondBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14568">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromBondBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblBondBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14578" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14579">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromBondBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Bond Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14582">		return zSpreadFromBondBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblBondBasis);</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14594">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromCreditBasis</span>
<span class="nc" id="L14595">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblCreditBasis));</span>
	}

	@Override public double zSpreadFromCreditBasis (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc" id="L14605">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromCreditBasisToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCreditBasis)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14615" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14616">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromCreditBasisToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Credit Basis to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14619">		return zSpreadFromCreditBasis (valParams, csqc, vcp, maturityDate().julian(), 1., dblCreditBasis);</span>
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14631">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="nc" id="L14632">			priceFromDiscountMargin (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblDiscountMargin));
	}

	@Override public double zSpreadFromDiscountMargin (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc" id="L14643">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromDiscountMarginToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblDiscountMargin)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14654" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14655">			throw new java.lang.Exception</span>
				(&quot;BondComponent::zSpreadFromDiscountMarginToOptimalExercise =&gt; &quot; +
					&quot;Cant calc Z Spread from Discount Margin to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14659">		return zSpreadFromDiscountMargin (valParams, csqc, vcp, maturityDate().julian(), 1.,</span>
			dblDiscountMargin);
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14672">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromGSpread</span>
<span class="nc" id="L14673">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblGSpread));</span>
	}

	@Override public double zSpreadFromGSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14683">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromGSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblGSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14693" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14694">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromGSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from G Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14697">		return zSpreadFromGSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblGSpread);</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14709">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromISpread</span>
<span class="nc" id="L14710">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblISpread));</span>
	}

	@Override public double zSpreadFromISpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14720">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromISpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblISpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14730" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14731">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromISpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from I Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14734">		return zSpreadFromISpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblISpread);</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14746">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromJSpread</span>
<span class="nc" id="L14747">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblJSpread));</span>
	}

	@Override public double zSpreadFromJSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14757">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromJSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblJSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14767" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14768">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromJSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from J Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14771">		return zSpreadFromJSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblJSpread);</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14783">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromNSpread</span>
<span class="nc" id="L14784">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblNSpread));</span>
	}

	@Override public double zSpreadFromNSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14794">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromNSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblNSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14804" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14805">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromNSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from N Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14808">		return zSpreadFromNSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblNSpread);</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14820">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromOAS</span>
<span class="nc" id="L14821">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblOAS));</span>
	}

	@Override public double zSpreadFromOAS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc" id="L14831">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromOASToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblOAS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14841" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14842">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromOASToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from OAS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14845">		return zSpreadFromOAS (valParams, csqc, vcp, maturityDate().julian(), 1., dblOAS);</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14857">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromPECS</span>
<span class="nc" id="L14858">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblPECS));</span>
	}

	@Override public double zSpreadFromPECS (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc" id="L14868">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPECSToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPECS)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14878" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14879">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPECSToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from PECS to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14882">		return zSpreadFromPECS (valParams, csqc, vcp, maturityDate().julian(), 1., dblPECS);</span>
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14894">		return new BondCalibrator (this, false).calibrateZSpreadFromPrice (valParams, csqc, vcp,</span>
			ZERO_OFF_OF_RATES_INSTRUMENTS_DISCOUNT_CURVE, iWorkoutDate, dblWorkoutFactor, dblPrice);
	}

	@Override public double zSpreadFromPrice (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="fc" id="L14905">		return zSpreadFromPrice (valParams, csqc, vcp, maturityDate().julian(), 1., dblPrice);</span>
	}

	@Override public double zSpreadFromPriceToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblPrice)
		throws java.lang.Exception
	{
<span class="nc" id="L14915">		org.drip.param.valuation.WorkoutInfo wi = exerciseYieldFromPrice (valParams, csqc, vcp, dblPrice);</span>

<span class="nc bnc" id="L14917" title="All 2 branches missed.">		if (null == wi)</span>
<span class="nc" id="L14918">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromPriceToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Workout from Price to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14921">		return zSpreadFromPrice (valParams, csqc, vcp, wi.date(), wi.factor(), dblPrice);</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14933">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromTSYSpread</span>
<span class="nc" id="L14934">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblTSYSpread));</span>
	}

	@Override public double zSpreadFromTSYSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L14944">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromTSYSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblTSYSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14954" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14955">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromTSYSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from TSY Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14958">		return zSpreadFromTSYSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblTSYSpread);</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="fc" id="L14970">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYield</span>
<span class="fc" id="L14971">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYield));</span>
	}

	@Override public double zSpreadFromYield (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc" id="L14981">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYield)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L14991" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L14992">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L14995">		return zSpreadFromYield (valParams, csqc, vcp, maturityDate().julian(), 1., dblYield);</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final int iWorkoutDate,
		final double dblWorkoutFactor,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15007">		return zSpreadFromPrice (valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, priceFromYieldSpread</span>
<span class="nc" id="L15008">			(valParams, csqc, vcp, iWorkoutDate, dblWorkoutFactor, dblYieldSpread));</span>
	}

	@Override public double zSpreadFromYieldSpread (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc" id="L15018">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public double zSpreadFromYieldSpreadToOptimalExercise (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblYieldSpread)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15028" title="All 4 branches missed.">		if (null != _eosCall || null != _eosPut)</span>
<span class="nc" id="L15029">			throw new java.lang.Exception (&quot;BondComponent::zSpreadFromYieldSpreadToOptimalExercise =&gt; &quot; +</span>
				&quot;Cant calc Z Spread from Yield Spread to optimal exercise for bonds w emb option&quot;);

<span class="nc" id="L15032">		return zSpreadFromYieldSpread (valParams, csqc, vcp, maturityDate().julian(), 1., dblYieldSpread);</span>
	}

	@Override public org.drip.analytics.output.BondRVMeasures standardMeasures (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.param.valuation.WorkoutInfo wi,
		final double dblPrice)
	{
<span class="pc bpc" id="L15043" title="3 of 6 branches missed.">		if (null == valParams || null == csqs || null == wi || !org.drip.quant.common.NumberUtil.IsValid</span>
<span class="pc bpc" id="L15044" title="1 of 2 branches missed.">			(dblPrice))</span>
<span class="nc" id="L15045">			return null;</span>

<span class="fc" id="L15047">		int iWorkoutDate = wi.date();</span>

<span class="fc" id="L15049">		double dblWorkoutYield = wi.yield();</span>

<span class="fc" id="L15051">		double dblWorkoutFactor = wi.factor();</span>

<span class="pc bpc" id="L15053" title="1 of 2 branches missed.">		if (valParams.valueDate() &gt;= iWorkoutDate) return null;</span>

<span class="fc" id="L15055">		double dblASW = java.lang.Double.NaN;</span>
<span class="fc" id="L15056">		double dblPECS = java.lang.Double.NaN;</span>
<span class="fc" id="L15057">		double dblGSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15058">		double dblISpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15059">		double dblYield01 = java.lang.Double.NaN;</span>
<span class="fc" id="L15060">		double dblZSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15061">		double dblOASpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15062">		double dblBondBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15063">		double dblConvexity = java.lang.Double.NaN;</span>
<span class="fc" id="L15064">		double dblTSYSpread = java.lang.Double.NaN;</span>
<span class="fc" id="L15065">		double dblCreditBasis = java.lang.Double.NaN;</span>
<span class="fc" id="L15066">		double dblDiscountMargin = java.lang.Double.NaN;</span>
<span class="fc" id="L15067">		double dblMacaulayDuration = java.lang.Double.NaN;</span>
<span class="fc" id="L15068">		double dblModifiedDuration = java.lang.Double.NaN;</span>

		try {
<span class="fc" id="L15071">			dblDiscountMargin = discountMarginFromYield (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblWorkoutYield);
<span class="nc" id="L15073">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15075">		}</span>

<span class="fc bfc" id="L15077" title="All 2 branches covered.">		if (null == _floaterSetting) {</span>
			try {
<span class="fc" id="L15079">				dblZSpread = zSpreadFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
					dblPrice);
<span class="nc" id="L15081">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15083">			}</span>
		}

		try {
<span class="fc" id="L15087">			dblOASpread = oasFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15088">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15090">		}</span>

		try {
<span class="fc" id="L15093">			dblISpread = iSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15095">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15097">		}</span>

		try {
<span class="fc" id="L15100">			dblGSpread = gSpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="fc" id="L15102">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15104">		}</span>

		try {
<span class="fc" id="L15107">			dblTSYSpread = tsySpreadFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15109">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15111">		}</span>

		try {
<span class="fc" id="L15114">			dblMacaulayDuration = macaulayDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15116">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15118">		}</span>

		try {
<span class="fc" id="L15121">			dblModifiedDuration = modifiedDurationFromPrice (valParams, csqs, vcp, iWorkoutDate,</span>
				dblWorkoutFactor, dblPrice);
<span class="nc" id="L15123">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15125">		}</span>

		try {
<span class="fc" id="L15128">			dblASW = aswFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);</span>
<span class="fc" id="L15129">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15131">		}</span>

		try {
<span class="fc" id="L15134">			dblConvexity = convexityFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="nc" id="L15136">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15138">		}</span>

		try {
<span class="fc" id="L15141">			dblCreditBasis = creditBasisFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblPrice);
<span class="fc" id="L15143">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15145">		}</span>

		try {
			// dblPECS = pecsFromPrice (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor, dblPrice);
		} catch (java.lang.Exception e) {
			if (!s_bSuppressErrors) e.printStackTrace();
		}

		try {
<span class="fc" id="L15154">			dblBondBasis = bondBasisFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15156">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15158">		}</span>

		try {
<span class="fc" id="L15161">			dblYield01 = yield01FromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
				dblWorkoutYield);
<span class="nc" id="L15163">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
<span class="fc" id="L15165">		}</span>

		try {
<span class="fc" id="L15168">			return new org.drip.analytics.output.BondRVMeasures (dblPrice, dblBondBasis, dblZSpread,</span>
				dblGSpread, dblISpread, dblOASpread, dblTSYSpread, dblDiscountMargin, dblASW, dblCreditBasis,
					dblPECS, dblYield01, dblModifiedDuration, dblMacaulayDuration, dblConvexity, wi);
<span class="nc" id="L15171">		} catch (java.lang.Exception e) {</span>
			if (!s_bSuppressErrors) e.printStackTrace();
		}

<span class="nc" id="L15175">		return null;</span>
	}

	@Override public org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; value (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="pc bpc" id="L15184" title="2 of 4 branches missed.">		if (null == valParams || null == csqs) return null;</span>

<span class="fc bfc" id="L15186" title="All 2 branches covered.">		if (null != pricerParams) {</span>
<span class="fc" id="L15187">			org.drip.param.definition.CalibrationParams calibParams = pricerParams.calibParams();</span>

<span class="fc bfc" id="L15189" title="All 2 branches covered.">			if (null != calibParams) {</span>
<span class="fc" id="L15190">				org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapCalibMeasures =</span>
<span class="fc" id="L15191">					calibMeasures (valParams, pricerParams, csqs, vcp);</span>

<span class="pc bpc" id="L15193" title="1 of 4 branches missed.">				if (null != mapCalibMeasures &amp;&amp; mapCalibMeasures.containsKey (calibParams.measure()))</span>
<span class="fc" id="L15194">					return mapCalibMeasures;</span>
			}
		}

<span class="fc" id="L15198">		org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMeasures = fairMeasures</span>
<span class="fc" id="L15199">			(valParams, pricerParams, csqs, vcp);</span>

<span class="fc bfc" id="L15201" title="All 2 branches covered.">		if (null == mapMeasures) return null;</span>

<span class="fc" id="L15203">		java.lang.String strName = name();</span>

<span class="fc" id="L15205">		org.drip.param.definition.ProductQuote pq = csqs.productQuote (strName);</span>

<span class="fc bfc" id="L15207" title="All 2 branches covered.">		if (null == pq) return mapMeasures;</span>

<span class="fc" id="L15209">		int iMaturityDate = maturityDate().julian();</span>

<span class="pc bpc" id="L15211" title="1 of 2 branches missed.">		if (null == _floaterSetting) {</span>
<span class="fc" id="L15212">			double dblParSpread = (mapMeasures.get (&quot;FairDirtyPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15213">				mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairDirtyDV01&quot;);</span>

<span class="fc" id="L15215">			mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15217">			mapMeasures.put (&quot;FairParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15218">		} else {</span>
<span class="nc bnc" id="L15219" title="All 2 branches missed.">			double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15220">				mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15221">					(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15223">			double dblZeroDiscountMargin = (mapMeasures.get (&quot;FairCleanPV&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15224">				dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15225">					(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15227">			mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15229">			mapMeasures.put (&quot;FairZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
		}

<span class="fc" id="L15232">		org.drip.param.valuation.WorkoutInfo wiMarket = null;</span>

<span class="pc bpc" id="L15234" title="1 of 2 branches missed.">		if (pq.containsQuote (&quot;Price&quot;)) {</span>
<span class="fc" id="L15235">			double dblMarketPrice = pq.quote (&quot;Price&quot;).value (&quot;mid&quot;);</span>

<span class="fc" id="L15237">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblMarketPrice);</span>

<span class="fc" id="L15239">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblMarketPrice);</span>
<span class="pc bnc" id="L15240" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CleanPrice&quot;)) {</span>
<span class="nc" id="L15241">			double dblCleanMarketPrice = pq.quote (&quot;CleanPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15243">			mapMeasures.put (&quot;MarketInputType=CleanPrice&quot;, dblCleanMarketPrice);</span>

<span class="nc" id="L15245">			wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblCleanMarketPrice);</span>
<span class="nc bnc" id="L15246" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;QuotedMargin&quot;)) {</span>
<span class="nc" id="L15247">			double dblQuotedMargin = pq.quote (&quot;QuotedMargin&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15249">			mapMeasures.put (&quot;MarketInputType=QuotedMargin&quot;, dblQuotedMargin);</span>

			try {
<span class="nc" id="L15252">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, priceFromDiscountMargin (valParams,</span>
					csqs, vcp, dblQuotedMargin));
<span class="nc" id="L15254">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();
<span class="nc" id="L15256">			}</span>
<span class="nc bnc" id="L15257" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;DirtyPrice&quot;)) {</span>
			try {
<span class="nc" id="L15259">				double dblDirtyMarketPrice = pq.quote (&quot;DirtyPrice&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15261">				mapMeasures.put (&quot;MarketInputType=DirtyPrice&quot;, dblDirtyMarketPrice);</span>

<span class="nc" id="L15263">				wiMarket = exerciseYieldFromPrice (valParams, csqs, vcp, dblDirtyMarketPrice - accrued</span>
<span class="nc" id="L15264">					(valParams.valueDate(), csqs));</span>
<span class="nc" id="L15265">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15268">				wiMarket = null;</span>
<span class="nc" id="L15269">			}</span>
<span class="nc bnc" id="L15270" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;TSYSpread&quot;)) {</span>
			try {
<span class="nc" id="L15272">				double dblTSYSpread = pq.quote (&quot;TSYSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15274">				mapMeasures.put (&quot;MarketInputType=TSYSpread&quot;, dblTSYSpread);</span>

<span class="nc" id="L15276">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, treasuryBenchmarkYield</span>
<span class="nc" id="L15277">					(valParams, csqs, iMaturityDate) + dblTSYSpread, 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15279">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15282">				wiMarket = null;</span>
<span class="nc" id="L15283">			}</span>
<span class="nc bnc" id="L15284" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;Yield&quot;)) {</span>
			try {
<span class="nc" id="L15286">				double dblYield = pq.quote (&quot;Yield&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15288">				mapMeasures.put (&quot;MarketInputType=Yield&quot;, dblYield);</span>

<span class="nc" id="L15290">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, dblYield, 1.,</span>
					org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15292">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15295">				wiMarket = null;</span>
<span class="nc" id="L15296">			}</span>
<span class="nc bnc" id="L15297" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ZSpread&quot;)) {</span>
			try {
<span class="nc" id="L15299">				double dblZSpread = pq.quote (&quot;ZSpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15301">				mapMeasures.put (&quot;MarketInputType=ZSpread&quot;, dblZSpread);</span>

<span class="nc" id="L15303">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromZSpread</span>
<span class="nc" id="L15304">					(valParams, csqs, vcp, dblZSpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15306">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15309">				wiMarket = null;</span>
<span class="nc" id="L15310">			}</span>
<span class="nc bnc" id="L15311" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;ISpread&quot;)) {</span>
			try {
<span class="nc" id="L15313">				double dblISpread = pq.quote (&quot;ISpread&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15315">				mapMeasures.put (&quot;MarketInputType=ISpread&quot;, dblISpread);</span>

<span class="nc" id="L15317">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromISpread</span>
<span class="nc" id="L15318">					(valParams, csqs, vcp, dblISpread), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15320">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15323">				wiMarket = null;</span>
<span class="nc" id="L15324">			}</span>
<span class="nc bnc" id="L15325" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;CreditBasis&quot;)) {</span>
			try {
<span class="nc" id="L15327">				double dblCreditBasis = pq.quote (&quot;CreditBasis&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15329">				mapMeasures.put (&quot;MarketInputType=CreditBasis&quot;, dblCreditBasis);</span>

<span class="nc" id="L15331">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromCreditBasis</span>
<span class="nc" id="L15332">					(valParams, csqs, vcp, dblCreditBasis), 1.,</span>
						org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15334">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15337">				wiMarket = null;</span>
<span class="nc" id="L15338">			}</span>
<span class="nc bnc" id="L15339" title="All 2 branches missed.">		} else if (pq.containsQuote (&quot;PECS&quot;)) {</span>
			try {
<span class="nc" id="L15341">				double dblCreditBasis = pq.quote (&quot;PECS&quot;).value (&quot;mid&quot;);</span>

<span class="nc" id="L15343">				mapMeasures.put (&quot;MarketInputType=PECS&quot;, dblCreditBasis);</span>

<span class="nc" id="L15345">				wiMarket = new org.drip.param.valuation.WorkoutInfo (iMaturityDate, yieldFromPECS (valParams,</span>
					csqs, vcp, dblCreditBasis), 1., org.drip.param.valuation.WorkoutInfo.WO_TYPE_MATURITY);
<span class="nc" id="L15347">			} catch (java.lang.Exception e) {</span>
				if (!s_bSuppressErrors) e.printStackTrace();

<span class="nc" id="L15350">				wiMarket = null;</span>
<span class="nc" id="L15351">			}</span>
		}

<span class="pc bpc" id="L15354" title="1 of 2 branches missed.">		if (null != wiMarket) {</span>
<span class="fc" id="L15355">			org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapWorkoutMeasures =</span>
<span class="fc" id="L15356">				marketMeasures (valParams, pricerParams, csqs, vcp, wiMarket);</span>

<span class="pc bpc" id="L15358" title="1 of 2 branches missed.">			if (null == _floaterSetting) {</span>
<span class="fc" id="L15359">				double dblParSpread = (mapWorkoutMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="fc" id="L15360">					mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get (&quot;FairCleanDV01&quot;);</span>

<span class="fc" id="L15362">				mapMeasures.put (&quot;ParSpread&quot;, dblParSpread);</span>

<span class="fc" id="L15364">				mapMeasures.put (&quot;MarketParSpread&quot;, dblParSpread);</span>
<span class="fc" id="L15365">			} else {</span>
<span class="nc bnc" id="L15366" title="All 2 branches missed.">				double dblCleanIndexCouponPV = mapMeasures.containsKey (&quot;FairRiskyCleanIndexCouponPV&quot;) ?</span>
<span class="nc" id="L15367">					mapMeasures.get (&quot;FairRiskyCleanIndexCouponPV&quot;) : mapMeasures.get</span>
<span class="nc" id="L15368">						(&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15370">				double dblZeroDiscountMargin = (mapMeasures.get (&quot;Price&quot;) - mapMeasures.get (&quot;FairParPV&quot;) -</span>
<span class="nc" id="L15371">					dblCleanIndexCouponPV - mapMeasures.get (&quot;FairPrincipalPV&quot;)) / mapMeasures.get</span>
<span class="nc" id="L15372">						(&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15374">				mapMeasures.put (&quot;ZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>

<span class="nc" id="L15376">				mapMeasures.put (&quot;MarketZeroDiscountMargin&quot;, dblZeroDiscountMargin);</span>
			}

<span class="fc" id="L15379">			org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapWorkoutMeasures);</span>

<span class="fc" id="L15381">			org.drip.state.credit.CreditCurve cc = csqs.creditState (creditLabel());</span>

<span class="pc bpc" id="L15383" title="1 of 2 branches missed.">			if (null != mapMeasures.get (&quot;FairYield&quot;)) {</span>
<span class="fc" id="L15384">				org.drip.param.market.CurveSurfaceQuoteContainer csqsMarket =</span>
					org.drip.param.creator.MarketParamsBuilder.Create
<span class="fc" id="L15386">						((org.drip.state.discount.MergedDiscountForwardCurve) csqs.fundingState</span>
<span class="fc" id="L15387">							(fundingLabel()).parallelShiftQuantificationMetric (wiMarket.yield() -</span>
<span class="fc" id="L15388">								mapMeasures.get (&quot;FairYield&quot;)), csqs.govvieState (govvieLabel()), cc,</span>
<span class="fc" id="L15389">									strName, csqs.productQuote (strName), csqs.quoteMap(), csqs.fixings());</span>

<span class="pc bpc" id="L15391" title="1 of 2 branches missed.">				if (null != csqsMarket) {</span>
<span class="fc" id="L15392">					org.drip.analytics.output.BondWorkoutMeasures bwmMarket = workoutMeasures (valParams,</span>
<span class="fc" id="L15393">						pricerParams, csqsMarket, wiMarket.date(), wiMarket.factor());</span>

<span class="pc bpc" id="L15395" title="1 of 2 branches missed.">					if (null != bwmMarket) {</span>
<span class="nc" id="L15396">						org.drip.analytics.support.CaseInsensitiveTreeMap&lt;java.lang.Double&gt; mapMarketMeasures</span>
<span class="nc" id="L15397">							= bwmMarket.toMap (&quot;&quot;);</span>

<span class="nc" id="L15399">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMarketMeasures,</span>
<span class="nc" id="L15400">							org.drip.quant.common.CollectionUtil.PrefixKeys (mapMarketMeasures, &quot;Market&quot;));</span>

<span class="nc" id="L15402">						org.drip.quant.common.CollectionUtil.MergeWithMain (mapMeasures, mapMarketMeasures);</span>
					}
				}
			}
		}

<span class="fc" id="L15408">		return mapMeasures;</span>
	}

	@Override public java.util.Set&lt;java.lang.String&gt; measureNames()
	{
<span class="nc" id="L15413">		java.util.Set&lt;java.lang.String&gt; setstrMeasureNames = new java.util.TreeSet&lt;java.lang.String&gt;();</span>

<span class="nc" id="L15415">		setstrMeasureNames.add (&quot;Accrued&quot;);</span>

<span class="nc" id="L15417">		setstrMeasureNames.add (&quot;Accrued01&quot;);</span>

<span class="nc" id="L15419">		setstrMeasureNames.add (&quot;AssetSwapSpread&quot;);</span>

<span class="nc" id="L15421">		setstrMeasureNames.add (&quot;ASW&quot;);</span>

<span class="nc" id="L15423">		setstrMeasureNames.add (&quot;BondBasis&quot;);</span>

<span class="nc" id="L15425">		setstrMeasureNames.add (&quot;CleanCouponPV&quot;);</span>

<span class="nc" id="L15427">		setstrMeasureNames.add (&quot;CleanDV01&quot;);</span>

<span class="nc" id="L15429">		setstrMeasureNames.add (&quot;CleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15431">		setstrMeasureNames.add (&quot;CleanPrice&quot;);</span>

<span class="nc" id="L15433">		setstrMeasureNames.add (&quot;CleanPV&quot;);</span>

<span class="nc" id="L15435">		setstrMeasureNames.add (&quot;Convexity&quot;);</span>

<span class="nc" id="L15437">		setstrMeasureNames.add (&quot;CreditRisklessParPV&quot;);</span>

<span class="nc" id="L15439">		setstrMeasureNames.add (&quot;CreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15441">		setstrMeasureNames.add (&quot;CreditRiskyParPV&quot;);</span>

<span class="nc" id="L15443">		setstrMeasureNames.add (&quot;CreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15445">		setstrMeasureNames.add (&quot;CreditBasis&quot;);</span>

<span class="nc" id="L15447">		setstrMeasureNames.add (&quot;DiscountMargin&quot;);</span>

<span class="nc" id="L15449">		setstrMeasureNames.add (&quot;DefaultExposure&quot;);</span>

<span class="nc" id="L15451">		setstrMeasureNames.add (&quot;DefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15453">		setstrMeasureNames.add (&quot;DirtyCouponPV&quot;);</span>

<span class="nc" id="L15455">		setstrMeasureNames.add (&quot;DirtyDV01&quot;);</span>

<span class="nc" id="L15457">		setstrMeasureNames.add (&quot;DirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15459">		setstrMeasureNames.add (&quot;DirtyPrice&quot;);</span>

<span class="nc" id="L15461">		setstrMeasureNames.add (&quot;DirtyPV&quot;);</span>

<span class="nc" id="L15463">		setstrMeasureNames.add (&quot;Duration&quot;);</span>

<span class="nc" id="L15465">		setstrMeasureNames.add (&quot;DV01&quot;);</span>

<span class="nc" id="L15467">		setstrMeasureNames.add (&quot;ExpectedRecovery&quot;);</span>

<span class="nc" id="L15469">		setstrMeasureNames.add (&quot;FairAccrued&quot;);</span>

<span class="nc" id="L15471">		setstrMeasureNames.add (&quot;FairAccrued01&quot;);</span>

<span class="nc" id="L15473">		setstrMeasureNames.add (&quot;FairAssetSwapSpread&quot;);</span>

<span class="nc" id="L15475">		setstrMeasureNames.add (&quot;FairASW&quot;);</span>

<span class="nc" id="L15477">		setstrMeasureNames.add (&quot;FairBondBasis&quot;);</span>

<span class="nc" id="L15479">		setstrMeasureNames.add (&quot;FairCleanCouponPV&quot;);</span>

<span class="nc" id="L15481">		setstrMeasureNames.add (&quot;FairCleanDV01&quot;);</span>

<span class="nc" id="L15483">		setstrMeasureNames.add (&quot;FairCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15485">		setstrMeasureNames.add (&quot;FairCleanPrice&quot;);</span>

<span class="nc" id="L15487">		setstrMeasureNames.add (&quot;FairCleanPV&quot;);</span>

<span class="nc" id="L15489">		setstrMeasureNames.add (&quot;FairConvexity&quot;);</span>

<span class="nc" id="L15491">		setstrMeasureNames.add (&quot;FairCreditBasis&quot;);</span>

<span class="nc" id="L15493">		setstrMeasureNames.add (&quot;FairCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15495">		setstrMeasureNames.add (&quot;FairCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15497">		setstrMeasureNames.add (&quot;FairCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15499">		setstrMeasureNames.add (&quot;FairCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15501">		setstrMeasureNames.add (&quot;FairDefaultExposure&quot;);</span>

<span class="nc" id="L15503">		setstrMeasureNames.add (&quot;FairDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15505">		setstrMeasureNames.add (&quot;FairDirtyCouponPV&quot;);</span>

<span class="nc" id="L15507">		setstrMeasureNames.add (&quot;FairDirtyDV01&quot;);</span>

<span class="nc" id="L15509">		setstrMeasureNames.add (&quot;FairDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15511">		setstrMeasureNames.add (&quot;FairDirtyPrice&quot;);</span>

<span class="nc" id="L15513">		setstrMeasureNames.add (&quot;FairDirtyPV&quot;);</span>

<span class="nc" id="L15515">		setstrMeasureNames.add (&quot;FairDiscountMargin&quot;);</span>

<span class="nc" id="L15517">		setstrMeasureNames.add (&quot;FairDuration&quot;);</span>

<span class="nc" id="L15519">		setstrMeasureNames.add (&quot;FairDV01&quot;);</span>

<span class="nc" id="L15521">		setstrMeasureNames.add (&quot;FairExpectedRecovery&quot;);</span>

<span class="nc" id="L15523">		setstrMeasureNames.add (&quot;FairFirstIndexRate&quot;);</span>

<span class="nc" id="L15525">		setstrMeasureNames.add (&quot;FairGSpread&quot;);</span>

<span class="nc" id="L15527">		setstrMeasureNames.add (&quot;FairISpread&quot;);</span>

<span class="nc" id="L15529">		setstrMeasureNames.add (&quot;FairLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15531">		setstrMeasureNames.add (&quot;FairMacaulayDuration&quot;);</span>

<span class="nc" id="L15533">		setstrMeasureNames.add (&quot;FairModifiedDuration&quot;);</span>

<span class="nc" id="L15535">		setstrMeasureNames.add (&quot;FairOAS&quot;);</span>

<span class="nc" id="L15537">		setstrMeasureNames.add (&quot;FairOASpread&quot;);</span>

<span class="nc" id="L15539">		setstrMeasureNames.add (&quot;FairOptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15541">		setstrMeasureNames.add (&quot;FairParPV&quot;);</span>

<span class="nc" id="L15543">		setstrMeasureNames.add (&quot;FairParSpread&quot;);</span>

<span class="nc" id="L15545">		setstrMeasureNames.add (&quot;FairPECS&quot;);</span>

<span class="nc" id="L15547">		setstrMeasureNames.add (&quot;FairPrice&quot;);</span>

<span class="nc" id="L15549">		setstrMeasureNames.add (&quot;FairPrincipalPV&quot;);</span>

<span class="nc" id="L15551">		setstrMeasureNames.add (&quot;FairPV&quot;);</span>

<span class="nc" id="L15553">		setstrMeasureNames.add (&quot;FairRecoveryPV&quot;);</span>

<span class="nc" id="L15555">		setstrMeasureNames.add (&quot;FairRisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15557">		setstrMeasureNames.add (&quot;FairRisklessCleanDV01&quot;);</span>

<span class="nc" id="L15559">		setstrMeasureNames.add (&quot;FairRisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15561">		setstrMeasureNames.add (&quot;FairRisklessCleanPV&quot;);</span>

<span class="nc" id="L15563">		setstrMeasureNames.add (&quot;FairRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15565">		setstrMeasureNames.add (&quot;FairRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15567">		setstrMeasureNames.add (&quot;FairRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15569">		setstrMeasureNames.add (&quot;FairRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15571">		setstrMeasureNames.add (&quot;FairRiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15573">		setstrMeasureNames.add (&quot;FairRiskyCleanDV01&quot;);</span>

<span class="nc" id="L15575">		setstrMeasureNames.add (&quot;FairRiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15577">		setstrMeasureNames.add (&quot;FairRiskyCleanPV&quot;);</span>

<span class="nc" id="L15579">		setstrMeasureNames.add (&quot;FairRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15581">		setstrMeasureNames.add (&quot;FairRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15583">		setstrMeasureNames.add (&quot;FairRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15585">		setstrMeasureNames.add (&quot;FairRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15587">		setstrMeasureNames.add (&quot;FairTSYSpread&quot;);</span>

<span class="nc" id="L15589">		setstrMeasureNames.add (&quot;FairWorkoutDate&quot;);</span>

<span class="nc" id="L15591">		setstrMeasureNames.add (&quot;FairWorkoutFactor&quot;);</span>

<span class="nc" id="L15593">		setstrMeasureNames.add (&quot;FairWorkoutType&quot;);</span>

<span class="nc" id="L15595">		setstrMeasureNames.add (&quot;FairWorkoutYield&quot;);</span>

<span class="nc" id="L15597">		setstrMeasureNames.add (&quot;FairYield&quot;);</span>

<span class="nc" id="L15599">		setstrMeasureNames.add (&quot;FairYield01&quot;);</span>

<span class="nc" id="L15601">		setstrMeasureNames.add (&quot;FairYieldBasis&quot;);</span>

<span class="nc" id="L15603">		setstrMeasureNames.add (&quot;FairYieldSpread&quot;);</span>

<span class="nc" id="L15605">		setstrMeasureNames.add (&quot;FairZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15607">		setstrMeasureNames.add (&quot;FairZSpread&quot;);</span>

<span class="nc" id="L15609">		setstrMeasureNames.add (&quot;FirstCouponRate&quot;);</span>

<span class="nc" id="L15611">		setstrMeasureNames.add (&quot;FirstIndexRate&quot;);</span>

<span class="nc" id="L15613">		setstrMeasureNames.add (&quot;GSpread&quot;);</span>

<span class="nc" id="L15615">		setstrMeasureNames.add (&quot;ISpread&quot;);</span>

<span class="nc" id="L15617">		setstrMeasureNames.add (&quot;LossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15619">		setstrMeasureNames.add (&quot;MacaulayDuration&quot;);</span>

<span class="nc" id="L15621">		setstrMeasureNames.add (&quot;MarketAccrued&quot;);</span>

<span class="nc" id="L15623">		setstrMeasureNames.add (&quot;MarketAccrued01&quot;);</span>

<span class="nc" id="L15625">		setstrMeasureNames.add (&quot;MarketCleanCouponPV&quot;);</span>

<span class="nc" id="L15627">		setstrMeasureNames.add (&quot;MarketCleanDV01&quot;);</span>

<span class="nc" id="L15629">		setstrMeasureNames.add (&quot;MarketCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15631">		setstrMeasureNames.add (&quot;MarketCleanPrice&quot;);</span>

<span class="nc" id="L15633">		setstrMeasureNames.add (&quot;MarketCleanPV&quot;);</span>

<span class="nc" id="L15635">		setstrMeasureNames.add (&quot;MarketCreditRisklessParPV&quot;);</span>

<span class="nc" id="L15637">		setstrMeasureNames.add (&quot;MarketCreditRisklessPrincipalPV&quot;);</span>

<span class="nc" id="L15639">		setstrMeasureNames.add (&quot;MarketCreditRiskyParPV&quot;);</span>

<span class="nc" id="L15641">		setstrMeasureNames.add (&quot;MarketCreditRiskyPrincipalPV&quot;);</span>

<span class="nc" id="L15643">		setstrMeasureNames.add (&quot;MarketDefaultExposure&quot;);</span>

<span class="nc" id="L15645">		setstrMeasureNames.add (&quot;MarketDefaultExposureNoRec&quot;);</span>

<span class="nc" id="L15647">		setstrMeasureNames.add (&quot;MarketDirtyCouponPV&quot;);</span>

<span class="nc" id="L15649">		setstrMeasureNames.add (&quot;MarketDirtyDV01&quot;);</span>

<span class="nc" id="L15651">		setstrMeasureNames.add (&quot;MarketDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15653">		setstrMeasureNames.add (&quot;MarketDirtyPrice&quot;);</span>

<span class="nc" id="L15655">		setstrMeasureNames.add (&quot;MarketDirtyPV&quot;);</span>

<span class="nc" id="L15657">		setstrMeasureNames.add (&quot;MarketDV01&quot;);</span>

<span class="nc" id="L15659">		setstrMeasureNames.add (&quot;MarketExpectedRecovery&quot;);</span>

<span class="nc" id="L15661">		setstrMeasureNames.add (&quot;MarketFirstCouponRate&quot;);</span>

<span class="nc" id="L15663">		setstrMeasureNames.add (&quot;MarketFirstIndexRate&quot;);</span>

<span class="nc" id="L15665">		setstrMeasureNames.add (&quot;MarketInputType=CleanPrice&quot;);</span>

<span class="nc" id="L15667">		setstrMeasureNames.add (&quot;MarketInputType=CreditBasis&quot;);</span>

<span class="nc" id="L15669">		setstrMeasureNames.add (&quot;MarketInputType=DirtyPrice&quot;);</span>

<span class="nc" id="L15671">		setstrMeasureNames.add (&quot;MarketInputType=GSpread&quot;);</span>

<span class="nc" id="L15673">		setstrMeasureNames.add (&quot;MarketInputType=ISpread&quot;);</span>

<span class="nc" id="L15675">		setstrMeasureNames.add (&quot;MarketInputType=PECS&quot;);</span>

<span class="nc" id="L15677">		setstrMeasureNames.add (&quot;MarketInputType=QuotedMargin&quot;);</span>

<span class="nc" id="L15679">		setstrMeasureNames.add (&quot;MarketInputType=TSYSpread&quot;);</span>

<span class="nc" id="L15681">		setstrMeasureNames.add (&quot;MarketInputType=Yield&quot;);</span>

<span class="nc" id="L15683">		setstrMeasureNames.add (&quot;MarketInputType=ZSpread&quot;);</span>

<span class="nc" id="L15685">		setstrMeasureNames.add (&quot;MarketLossOnInstantaneousDefault&quot;);</span>

<span class="nc" id="L15687">		setstrMeasureNames.add (&quot;MarketParPV&quot;);</span>

<span class="nc" id="L15689">		setstrMeasureNames.add (&quot;MarketPrincipalPV&quot;);</span>

<span class="nc" id="L15691">		setstrMeasureNames.add (&quot;MarketPV&quot;);</span>

<span class="nc" id="L15693">		setstrMeasureNames.add (&quot;MarketRecoveryPV&quot;);</span>

<span class="nc" id="L15695">		setstrMeasureNames.add (&quot;MarketRisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15697">		setstrMeasureNames.add (&quot;MarketRisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15699">		setstrMeasureNames.add (&quot;MarketRisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15701">		setstrMeasureNames.add (&quot;MarketRisklessDirtyPV&quot;);</span>

<span class="nc" id="L15703">		setstrMeasureNames.add (&quot;MarketRiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15705">		setstrMeasureNames.add (&quot;MarketRiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15707">		setstrMeasureNames.add (&quot;MarketRiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15709">		setstrMeasureNames.add (&quot;MarketRiskyDirtyPV&quot;);</span>

<span class="nc" id="L15711">		setstrMeasureNames.add (&quot;ModifiedDuration&quot;);</span>

<span class="nc" id="L15713">		setstrMeasureNames.add (&quot;OAS&quot;);</span>

<span class="nc" id="L15715">		setstrMeasureNames.add (&quot;OASpread&quot;);</span>

<span class="nc" id="L15717">		setstrMeasureNames.add (&quot;OptionAdjustedSpread&quot;);</span>

<span class="nc" id="L15719">		setstrMeasureNames.add (&quot;ParEquivalentCDSSpread&quot;);</span>

<span class="nc" id="L15721">		setstrMeasureNames.add (&quot;ParPV&quot;);</span>

<span class="nc" id="L15723">		setstrMeasureNames.add (&quot;ParSpread&quot;);</span>

<span class="nc" id="L15725">		setstrMeasureNames.add (&quot;PECS&quot;);</span>

<span class="nc" id="L15727">		setstrMeasureNames.add (&quot;Price&quot;);</span>

<span class="nc" id="L15729">		setstrMeasureNames.add (&quot;PrincipalPV&quot;);</span>

<span class="nc" id="L15731">		setstrMeasureNames.add (&quot;PV&quot;);</span>

<span class="nc" id="L15733">		setstrMeasureNames.add (&quot;RecoveryPV&quot;);</span>

<span class="nc" id="L15735">		setstrMeasureNames.add (&quot;RisklessCleanCouponPV&quot;);</span>

<span class="nc" id="L15737">		setstrMeasureNames.add (&quot;RisklessCleanDV01&quot;);</span>

<span class="nc" id="L15739">		setstrMeasureNames.add (&quot;RisklessCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15741">		setstrMeasureNames.add (&quot;RisklessCleanPV&quot;);</span>

<span class="nc" id="L15743">		setstrMeasureNames.add (&quot;RisklessDirtyCouponPV&quot;);</span>

<span class="nc" id="L15745">		setstrMeasureNames.add (&quot;RisklessDirtyDV01&quot;);</span>

<span class="nc" id="L15747">		setstrMeasureNames.add (&quot;RisklessDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15749">		setstrMeasureNames.add (&quot;RisklessDirtyPV&quot;);</span>

<span class="nc" id="L15751">		setstrMeasureNames.add (&quot;RiskyCleanCouponPV&quot;);</span>

<span class="nc" id="L15753">		setstrMeasureNames.add (&quot;RiskyCleanDV01&quot;);</span>

<span class="nc" id="L15755">		setstrMeasureNames.add (&quot;RiskyCleanIndexCouponPV&quot;);</span>

<span class="nc" id="L15757">		setstrMeasureNames.add (&quot;RiskyCleanPV&quot;);</span>

<span class="nc" id="L15759">		setstrMeasureNames.add (&quot;RiskyDirtyCouponPV&quot;);</span>

<span class="nc" id="L15761">		setstrMeasureNames.add (&quot;RiskyDirtyDV01&quot;);</span>

<span class="nc" id="L15763">		setstrMeasureNames.add (&quot;RiskyDirtyIndexCouponPV&quot;);</span>

<span class="nc" id="L15765">		setstrMeasureNames.add (&quot;RiskyDirtyPV&quot;);</span>

<span class="nc" id="L15767">		setstrMeasureNames.add (&quot;TSYSpread&quot;);</span>

<span class="nc" id="L15769">		setstrMeasureNames.add (&quot;WorkoutDate&quot;);</span>

<span class="nc" id="L15771">		setstrMeasureNames.add (&quot;WorkoutFactor&quot;);</span>

<span class="nc" id="L15773">		setstrMeasureNames.add (&quot;WorkoutType&quot;);</span>

<span class="nc" id="L15775">		setstrMeasureNames.add (&quot;WorkoutYield&quot;);</span>

<span class="nc" id="L15777">		setstrMeasureNames.add (&quot;Yield&quot;);</span>

<span class="nc" id="L15779">		setstrMeasureNames.add (&quot;Yield01&quot;);</span>

<span class="nc" id="L15781">		setstrMeasureNames.add (&quot;YieldBasis&quot;);</span>

<span class="nc" id="L15783">		setstrMeasureNames.add (&quot;YieldSpread&quot;);</span>

<span class="nc" id="L15785">		setstrMeasureNames.add (&quot;ZeroDiscountMargin&quot;);</span>

<span class="nc" id="L15787">		setstrMeasureNames.add (&quot;ZSpread&quot;);</span>

<span class="nc" id="L15789">		return setstrMeasureNames;</span>
	}

	@Override public double pv (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParamsIn,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
		throws java.lang.Exception
	{
<span class="nc bnc" id="L15799" title="All 4 branches missed.">		if (null == valParams || null == csqc)</span>
<span class="nc" id="L15800">			throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc" id="L15802">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L15804">		org.drip.state.discount.MergedDiscountForwardCurve dcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L15806" title="All 2 branches missed.">		if (null == dcFunding) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15808" title="All 2 branches missed.">		int iLossPayLag = null == _creditSetting ? 0 : _creditSetting.lossPayLag();</span>

<span class="nc bnc" id="L15810" title="All 2 branches missed.">		double dblProductRecovery = null == _creditSetting ? java.lang.Double.NaN :</span>
<span class="nc" id="L15811">			_creditSetting.recovery();</span>

<span class="nc bnc" id="L15813" title="All 2 branches missed.">		boolean bUseCurveRecovery = null == _creditSetting ? false : _creditSetting.useCurveRecovery();</span>

<span class="nc bnc" id="L15815" title="All 2 branches missed.">		boolean bAccrualOnDefault = null == _creditSetting ? false : _creditSetting.accrualOnDefault();</span>

<span class="nc" id="L15817">		org.drip.state.credit.CreditCurve cc = csqc.creditState (creditLabel());</span>

<span class="nc" id="L15819">		double dblRecoveryPV = 0.;</span>
<span class="nc" id="L15820">		double dblPrincipalPV = 0.;</span>
<span class="nc" id="L15821">		double dblDirtyCouponPV = 0.;</span>
<span class="nc" id="L15822">		boolean bApplyFlatForwardRate = false;</span>
<span class="nc" id="L15823">		double dblFlatForwardRate = java.lang.Double.NaN;</span>

<span class="nc bnc" id="L15825" title="All 2 branches missed.">		if (null != vcp)</span>
<span class="nc" id="L15826">			bApplyFlatForwardRate = vcp.applyFlatForwardRate();</span>
		else {
<span class="nc bnc" id="L15828" title="All 2 branches missed.">			org.drip.param.valuation.ValuationCustomizationParams vcpQuote = null == _quoteConvention ? null</span>
<span class="nc" id="L15829">				: _quoteConvention.valuationCustomizationParams();</span>

<span class="nc bnc" id="L15831" title="All 2 branches missed.">			if (null != vcpQuote) bApplyFlatForwardRate = vcpQuote.applyFlatForwardRate();</span>
		}

<span class="nc" id="L15834">		int iMaturityDate = maturityDate().julian();</span>

<span class="nc bnc" id="L15836" title="All 2 branches missed.">		org.drip.param.pricer.CreditPricerParams pricerParams = null != pricerParamsIn ? pricerParamsIn : new</span>
			org.drip.param.pricer.CreditPricerParams (7, null, false,
				org.drip.param.pricer.CreditPricerParams.PERIOD_DISCRETIZATION_FULL_COUPON);

<span class="nc bnc" id="L15840" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods()) {</span>
<span class="nc" id="L15841">			int iPeriodPayDate = period.payDate();</span>

<span class="nc bnc" id="L15843" title="All 2 branches missed.">			if (iPeriodPayDate &lt; iValueDate) continue;</span>

<span class="nc" id="L15845">			int iPeriodEndDate = period.endDate();</span>

<span class="nc" id="L15847">			int iPeriodStartDate = period.startDate();</span>

<span class="nc" id="L15849">			org.drip.analytics.output.CompositePeriodCouponMetrics cpcm = couponMetrics (iValueDate,</span>
				valParams, csqc);

<span class="nc bnc" id="L15852" title="All 2 branches missed.">			if (null == cpcm) throw new java.lang.Exception (&quot;BondComponent::pv =&gt; Invalid Inputs!&quot;);</span>

<span class="nc bnc" id="L15854" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblFlatForwardRate))</span>
<span class="nc" id="L15855">				dblFlatForwardRate = cpcm.rate();</span>

<span class="nc bnc" id="L15857" title="All 2 branches missed.">			double dblPeriodCoupon = bApplyFlatForwardRate ? dblFlatForwardRate : cpcm.rate();</span>

<span class="nc" id="L15859">			double dblPeriodAnnuity = dcFunding.df (iPeriodPayDate) * cpcm.cumulative();</span>

<span class="nc" id="L15861">			double dblPeriodDirtyDV01 = 0.0001 * period.accrualDCF (iPeriodEndDate) * dblPeriodAnnuity *</span>
<span class="nc" id="L15862">				notional (iPeriodStartDate);</span>

<span class="nc" id="L15864">			double dblPeriodPrincipalPV = (notional (iPeriodStartDate) - notional (iPeriodEndDate)) *</span>
				dblPeriodAnnuity;

<span class="nc bnc" id="L15867" title="All 4 branches missed.">			if (null != cc &amp;&amp; null != pricerParams) {</span>
<span class="nc bnc" id="L15868" title="All 2 branches missed.">				double dblSurvProb = cc.survival (pricerParams.survivalToPayDate() ? iPeriodPayDate :</span>
					iPeriodEndDate);

<span class="nc" id="L15871">				dblPeriodDirtyDV01 *= dblSurvProb;</span>
<span class="nc" id="L15872">				dblPeriodPrincipalPV *= dblSurvProb;</span>

<span class="nc bnc" id="L15874" title="All 2 branches missed.">				for (org.drip.analytics.cashflow.LossQuadratureMetrics lqm : period.lossMetrics (this,</span>
					valParams, pricerParams, iMaturityDate, csqc)) {
<span class="nc bnc" id="L15876" title="All 2 branches missed.">					if (null == lqm) continue;</span>

<span class="nc" id="L15878">					int iSubPeriodEndDate = lqm.endDate();</span>

<span class="nc" id="L15880">					int iSubPeriodStartDate = lqm.startDate();</span>

<span class="nc" id="L15882">					double dblSubPeriodDF = dcFunding.effectiveDF (iSubPeriodStartDate + iLossPayLag,</span>
						iSubPeriodEndDate + iLossPayLag);

<span class="nc" id="L15885">					double dblSubPeriodNotional = notional (iSubPeriodStartDate, iSubPeriodEndDate);</span>

<span class="nc" id="L15887">					double dblSubPeriodSurvival = cc.survival (iSubPeriodStartDate) - cc.survival</span>
<span class="nc" id="L15888">						(iSubPeriodEndDate);</span>

<span class="nc bnc" id="L15890" title="All 2 branches missed.">					if (bAccrualOnDefault)</span>
<span class="nc" id="L15891">						dblPeriodDirtyDV01 += 0.0001 * lqm.accrualDCF() * dblSubPeriodSurvival *</span>
							dblSubPeriodDF * dblSubPeriodNotional;

<span class="nc bnc" id="L15894" title="All 2 branches missed.">					dblRecoveryPV += (bUseCurveRecovery ? cc.effectiveRecovery (iSubPeriodStartDate,</span>
						iSubPeriodEndDate) : dblProductRecovery) * dblSubPeriodSurvival *
							dblSubPeriodNotional * dblSubPeriodDF;
<span class="nc" id="L15897">				}</span>
			}

<span class="nc" id="L15900">			dblPrincipalPV += dblPeriodPrincipalPV;</span>

<span class="nc" id="L15902">			dblDirtyCouponPV += 10000. * dblPeriodCoupon * couponFactor (iPeriodEndDate) *</span>
				dblPeriodDirtyDV01;
<span class="nc" id="L15904">		}</span>

<span class="nc" id="L15906">		double dblParPV = dcFunding.df (iMaturityDate) * notional (iMaturityDate);</span>

<span class="nc bnc" id="L15908" title="All 4 branches missed.">		if (null != cc &amp;&amp; null != pricerParams) dblParPV *= cc.survival (iMaturityDate);</span>

<span class="nc bnc" id="L15910" title="All 2 branches missed.">		return (dblDirtyCouponPV + dblPrincipalPV + dblParPV + dblRecoveryPV) / dcFunding.df (null !=</span>
<span class="nc" id="L15911">			_quoteConvention ? _quoteConvention.settleDate (valParams) : valParams.cashPayDate());</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian jackDDirtyPVDManifestMeasure (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15920">		return null;</span>
	}

	@Override public org.drip.product.calib.ProductQuoteSet calibQuoteSet (
		final org.drip.state.representation.LatentStateSpecification[] aLSS)
	{
<span class="nc" id="L15926">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15936">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint forwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15946">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fundingForwardPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15956">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint fxPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15966">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint govviePRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15976">		return null;</span>
	}

	@Override public org.drip.state.estimator.PredictorResponseWeightConstraint volatilityPRWC (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final org.drip.product.calib.ProductQuoteSet pqs)
	{
<span class="nc" id="L15986">		return null;</span>
	}

	@Override public org.drip.quant.calculus.WengertJacobian manifestMeasureDFMicroJack (
		final java.lang.String strManifestMeasure,
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.pricer.CreditPricerParams pricerParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
		final org.drip.param.valuation.ValuationCustomizationParams vcp)
	{
<span class="nc" id="L15996">		return null;</span>
	}

	/**
	 * The BondCalibrator implements a calibrator that calibrates the yield, the credit basis, or the Z
	 * 		Spread for the bond given the price input. Calibration happens via either Newton-Raphson method,
	 * 		or via bracketing/root searching.
	 * 
	 * @author Lakshmi Krishnamurthy
	 *
	 */

	public class BondCalibrator {
<span class="fc" id="L16009">		private BondComponent _bond = null;</span>
<span class="fc" id="L16010">		private boolean _bApplyCouponExtension = false;</span>

		/**
		 * Constructor: Construct the calibrator from the parent bond.
		 * 
		 * @param bond Parent
		 * @param bApplyCouponExtension TRUE - Apply the Coupon Extension
		 * 
		 * @throws java.lang.Exception Thrown if the inputs are invalid
		 */

		public BondCalibrator (
			final BondComponent bond,
			final boolean bApplyCouponExtension)
			throws java.lang.Exception
<span class="fc" id="L16025">		{</span>
<span class="pc bpc" id="L16026" title="1 of 2 branches missed.">			if (null == (_bond = bond))</span>
<span class="nc" id="L16027">				throw new java.lang.Exception (&quot;BondComponent::BondCalibrator ctr =&gt; Invalid Inputs&quot;);</span>

<span class="fc" id="L16029">			_bApplyCouponExtension = bApplyCouponExtension;</span>
<span class="fc" id="L16030">		}</span>

		/**
		 * Calibrate the bond yield from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Yield
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibrateYieldFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16056" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16057">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16060">			org.drip.function.definition.R1ToR1 ofYieldToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16061">				(null) {</span>
				@Override public double evaluate (
					final double dblYield)
					throws java.lang.Exception
				{
<span class="fc" id="L16066">					return _bond.priceFromYield (valParams, csqs, vcp, iWorkoutDate, dblWorkoutFactor,</span>
<span class="fc" id="L16067">						dblYield, _bApplyCouponExtension) - dblPrice;</span>
				}
			};

<span class="fc" id="L16071">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
<span class="fc" id="L16072">				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofYieldToPrice, true).findRoot();</span>

<span class="pc bpc" id="L16074" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16075">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofYieldToPrice,</span>
<span class="nc" id="L16076">					true).findRoot();</span>

<span class="pc bpc" id="L16078" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16079">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofYieldToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16081">						true).findRoot();</span>

<span class="pc bpc" id="L16083" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16084">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateYieldFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16087">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price using the root bracketing technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the Z Spread cannot be calibrated
		 */

		public double calibrateZSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16116" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16117">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="pc bpc" id="L16120" title="1 of 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16121">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="fc" id="L16124">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16125">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16130">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16135">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="fc" id="L16137">					true).findRoot();</span>

<span class="pc bpc" id="L16139" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16140">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16141">					true).findRoot();</span>

<span class="pc bpc" id="L16143" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16144">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					new org.drip.function.r1tor1solver.ExecutionControl (ofZSpreadToPrice, new
						org.drip.function.r1tor1solver.ExecutionControlParams (200, false, 1.e-02, 1.e-02,
							1.e-01, 1.e-01)),
								org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16149">									true).findRoot();</span>

<span class="pc bpc" id="L16151" title="2 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16152">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16155">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the Bond OAS from the Market Price using the Root Bracketing Technique.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param vcp Valuation Customization Parameters
		 * @param iZeroCurveBaseDC The Discount Curve to derive the zero curve off of
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The Calibrated OAS
		 * 
		 * @throws java.lang.Exception Thrown if the OAS cannot be calibrated
		 */

		public double calibrateOASFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final org.drip.param.valuation.ValuationCustomizationParams vcp,
			final int iZeroCurveBaseDC,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16184" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16185">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16188">			org.drip.function.definition.R1ToR1 r1ToR1OASToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="fc" id="L16189">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="fc" id="L16194">					return _bond.priceFromZeroCurve (valParams, csqs, vcp, iZeroCurveBaseDC, iWorkoutDate,</span>
						dblWorkoutFactor, dblZSpread) - dblPrice;
				}
			};

<span class="fc" id="L16199">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., r1ToR1OASToPrice,
<span class="fc" id="L16201">					true).findRoot();</span>

<span class="pc bpc" id="L16203" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16204">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBrent (0., r1ToR1OASToPrice,</span>
<span class="fc" id="L16205">					true).findRoot();</span>

<span class="pc bpc" id="L16207" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16208">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., r1ToR1OASToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16210">						true).findRoot();</span>

<span class="pc bpc" id="L16212" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16213">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateOASFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16216">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the discount
		 * 	curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibDiscCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16242" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16243">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateDiscCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc" id="L16246">			org.drip.function.definition.R1ToR1 ofDiscCurveSpreadToPrice = new</span>
<span class="nc" id="L16247">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16252">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16257">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofDiscCurveSpreadToPrice,
<span class="nc" id="L16259">					true).findRoot();</span>

<span class="nc bnc" id="L16261" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16262">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0.,</span>
<span class="nc" id="L16263">					ofDiscCurveSpreadToPrice, true).findRoot();</span>

<span class="nc bnc" id="L16265" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16266">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0.,</span>
					ofDiscCurveSpreadToPrice, null,
						org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16269">							true).findRoot();</span>

<span class="nc bnc" id="L16271" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16272">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibDiscCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16275">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Z Spread from the market price. Calibration is done by bumping the Zero Curve.
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * 
		 * @return The calibrated Z Spread
		 * 
		 * @throws java.lang.Exception Thrown if the yield cannot be calibrated
		 */

		public double calibZeroCurveSpreadFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice)
			throws java.lang.Exception
		{
<span class="nc bnc" id="L16300" title="All 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16301">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateZeroCurveSpreadFromPrice =&gt; Invalid Inputs!&quot;);

<span class="nc bnc" id="L16304" title="All 2 branches missed.">			if (null != _floaterSetting)</span>
<span class="nc" id="L16305">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibZeroCurveSpreadFromPrice =&gt; Z Spread Calculation turned off for floaters!&quot;);

<span class="nc" id="L16308">			org.drip.function.definition.R1ToR1 ofZSpreadToPrice = new org.drip.function.definition.R1ToR1</span>
<span class="nc" id="L16309">				(null) {</span>
				@Override public double evaluate (
					final double dblZSpread)
					throws java.lang.Exception
				{
<span class="nc" id="L16314">					return _bond.priceFromFundingCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblZSpread) - dblPrice;
				}
			};

<span class="nc" id="L16319">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofZSpreadToPrice,
<span class="nc" id="L16321">					true).findRoot();</span>

<span class="nc bnc" id="L16323" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16324">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofZSpreadToPrice,</span>
<span class="nc" id="L16325">					true).findRoot();</span>

<span class="nc bnc" id="L16327" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16328">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofZSpreadToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="nc" id="L16330">						true).findRoot();</span>

<span class="nc bnc" id="L16332" title="All 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="nc" id="L16333">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibZeroCurveSpreadFromPrice =&gt; Cannot get root!&quot;);

<span class="nc" id="L16336">			return rfop.getRoot();</span>
		}

		/**
		 * Calibrate the bond Credit Basis from the market price
		 * 
		 * @param valParams Valuation Parameters
		 * @param csqs Bond Market Parameters
		 * @param iWorkoutDate JulianDate Work-out
		 * @param dblWorkoutFactor Work-out factor
		 * @param dblPrice Price to be calibrated to
		 * @param bFlat TRUE - Calibrate to Flat Curve
		 * 
		 * @return The calibrated Credit Basis
		 * 
		 * @throws java.lang.Exception Thrown if the Credit Basis cannot be calibrated
		 */

		public double calibrateCreditBasisFromPrice (
			final org.drip.param.valuation.ValuationParams valParams,
			final org.drip.param.market.CurveSurfaceQuoteContainer csqs,
			final int iWorkoutDate,
			final double dblWorkoutFactor,
			final double dblPrice,
			final boolean bFlat)
			throws java.lang.Exception
		{
<span class="pc bpc" id="L16363" title="1 of 2 branches missed.">			if (!org.drip.quant.common.NumberUtil.IsValid (dblPrice))</span>
<span class="nc" id="L16364">				throw new java.lang.Exception</span>
					(&quot;BondComponent::BondCalibrator::calibrateCreditBasisFromPrice =&gt; Invalid Inputs!&quot;);

<span class="fc" id="L16367">			org.drip.function.definition.R1ToR1 ofCreditBasisToPrice = new</span>
<span class="fc" id="L16368">				org.drip.function.definition.R1ToR1 (null) {</span>
				@Override public double evaluate (
					final double dblCreditBasis)
					throws java.lang.Exception
				{
<span class="fc" id="L16373">					return _bond.priceFromCreditCurve (valParams, csqs, iWorkoutDate, dblWorkoutFactor,</span>
						dblCreditBasis, bFlat) - dblPrice;
				}
			};

<span class="fc" id="L16378">			org.drip.function.r1tor1solver.FixedPointFinderOutput rfop = new</span>
				org.drip.function.r1tor1solver.FixedPointFinderNewton (0., ofCreditBasisToPrice,
<span class="fc" id="L16380">					true).findRoot();</span>

<span class="pc bpc" id="L16382" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16383">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderZheng (0., ofCreditBasisToPrice,</span>
<span class="fc" id="L16384">					true).findRoot();</span>

<span class="pc bpc" id="L16386" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16387">				rfop = new org.drip.function.r1tor1solver.FixedPointFinderBracketing (0., ofCreditBasisToPrice,</span>
					null, org.drip.function.r1tor1solver.VariateIteratorPrimitive.FALSE_POSITION,
<span class="fc" id="L16389">						true).findRoot();</span>

<span class="pc bpc" id="L16391" title="1 of 4 branches missed.">			if (null == rfop || !rfop.containsRoot())</span>
<span class="fc" id="L16392">				throw new java.lang.Exception</span>
					(&quot;BondComponent.calibrateCreditBasisFromPrice =&gt; Cannot get root!&quot;);

<span class="fc" id="L16395">			return rfop.getRoot();</span>
		}
	}

	/**
	 * Generate the EOS Callable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics callMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16422" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16424">		org.drip.product.params.EmbeddedOptionSchedule eosCall = callSchedule();</span>

<span class="pc bpc" id="L16426" title="1 of 2 branches missed.">		if (null == eosCall) return null;</span>

<span class="fc" id="L16428">		int iNumDimension = gbs.dimension();</span>

<span class="fc" id="L16430">		int iValueDate = valParams.valueDate();</span>

<span class="fc" id="L16432">		int[] aiExerciseDate = eosCall.exerciseDates (iValueDate);</span>

<span class="fc" id="L16434">		double[] adblExercisePrice = eosCall.exerciseFactors (iValueDate);</span>

<span class="pc bpc" id="L16436" title="2 of 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="fc" id="L16438">		double dblOAS = java.lang.Double.NaN;</span>
<span class="fc" id="L16439">		int iNumVertex = aiExerciseDate.length;</span>
<span class="fc" id="L16440">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="fc" id="L16441">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="fc" id="L16442">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="fc" id="L16443">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="fc" id="L16444">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="fc" id="L16445">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="fc" id="L16446">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="fc" id="L16447">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="fc" id="L16448">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="fc" id="L16449">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="fc" id="L16450">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="fc" id="L16451">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="fc" id="L16453">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="fc bfc" id="L16456" title="All 2 branches covered.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="fc bfc" id="L16457" title="All 2 branches covered.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="fc bfc" id="L16458" title="All 2 branches covered.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="pc bpc" id="L16462" title="1 of 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16466">				return null;</span>
<span class="nc" id="L16467">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16468">			e.printStackTrace();</span>

<span class="nc" id="L16470">			return null;</span>
<span class="fc" id="L16471">		}</span>

<span class="fc" id="L16473">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="pc bpc" id="L16475" title="1 of 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="fc" id="L16478">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16479">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16480">			e.printStackTrace();</span>

<span class="nc" id="L16482">			return null;</span>
<span class="fc" id="L16483">		}</span>

<span class="fc bfc" id="L16485" title="All 2 branches covered.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16486">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="pc bpc" id="L16487" title="1 of 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16488">				return null;</span>
		}

<span class="fc" id="L16491">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="fc bfc" id="L16493" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc bfc" id="L16494" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="fc" id="L16496">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="fc" id="L16497">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="fc" id="L16499">				} catch (java.lang.Exception e) {</span>
<span class="fc" id="L16500">					e.printStackTrace();</span>

<span class="fc" id="L16502">					return null;</span>
<span class="fc" id="L16503">				}</span>
			}
		}

<span class="fc bfc" id="L16507" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16508">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="fc" id="L16509">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="fc" id="L16510">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="fc" id="L16512">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="fc bfc" id="L16514" title="All 2 branches covered.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="fc" id="L16515">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="fc" id="L16516">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="fc" id="L16519">					dblExercisePV = (aadblForwardPrice[iPath][iVertex] - adblExercisePrice[iVertex]) *</span>
<span class="fc" id="L16520">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16521">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16522">					e.printStackTrace();</span>
<span class="fc" id="L16523">				}</span>

<span class="fc bfc" id="L16525" title="All 2 branches covered.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="fc" id="L16526">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="fc" id="L16529">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="fc" id="L16530">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="fc" id="L16531">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="fc" id="L16532">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="fc bfc" id="L16537" title="All 2 branches covered.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="fc" id="L16538">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="fc" id="L16541">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16544">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="fc" id="L16547">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16549">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16550">				e.printStackTrace();</span>

<span class="nc" id="L16552">				return null;</span>
<span class="fc" id="L16553">			}</span>

<span class="fc" id="L16555">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="fc" id="L16559">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16563">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16564">			e.printStackTrace();</span>
		}

<span class="nc" id="L16567">		return null;</span>
	}

	/**
	 * Generate the EOS Putable Option Adjusted Metrics
	 * 
	 * @param valParams The Valuation Parameters
	 * @param csqc The Market Parameters
	 * @param vcp The Valuation Customization Parameters
	 * @param dblCleanPrice Clean Price
	 * @param gbs The Govvie Builder Settings
	 * @param deGovvieForward The Govvie Forward Diffusion Evolver
	 * @param iNumPath The Number of Paths
	 * 
	 * @return The Bond EOS Metrics
	 */

	public org.drip.analytics.output.BondEOSMetrics putMetrics (
		final org.drip.param.valuation.ValuationParams valParams,
		final org.drip.param.market.CurveSurfaceQuoteContainer csqc,
		final org.drip.param.valuation.ValuationCustomizationParams vcp,
		final double dblCleanPrice,
		final org.drip.state.sequence.GovvieBuilderSettings gbs,
		final org.drip.measure.process.DiffusionEvolver deGovvieForward,
		final int iNumPath)
	{
<span class="pc bpc" id="L16593" title="3 of 6 branches missed.">		if (null == valParams || null == csqc || null == gbs) return null;</span>

<span class="fc" id="L16595">		org.drip.product.params.EmbeddedOptionSchedule eosPut = putSchedule();</span>

<span class="pc bpc" id="L16597" title="1 of 2 branches missed.">		if (null == eosPut) return null;</span>

<span class="nc" id="L16599">		int iNumDimension = gbs.dimension();</span>

<span class="nc" id="L16601">		int iValueDate = valParams.valueDate();</span>

<span class="nc" id="L16603">		int[] aiExerciseDate = eosPut.exerciseDates (iValueDate);</span>

<span class="nc" id="L16605">		double[] adblExercisePrice = eosPut.exerciseFactors (iValueDate);</span>

<span class="nc bnc" id="L16607" title="All 4 branches missed.">		if (null == aiExerciseDate || null == adblExercisePrice) return null;</span>

<span class="nc" id="L16609">		double dblOAS = java.lang.Double.NaN;</span>
<span class="nc" id="L16610">		int iNumVertex = aiExerciseDate.length;</span>
<span class="nc" id="L16611">		org.drip.state.sequence.PathVertexGovvie pvg = null;</span>
<span class="nc" id="L16612">		double[] adblOptimalExercisePV = new double[iNumPath];</span>
<span class="nc" id="L16613">		int[] aiOptimalExerciseVertexIndex = new int[iNumPath];</span>
<span class="nc" id="L16614">		double[] adblOptimalExerciseOAS = new double[iNumPath];</span>
<span class="nc" id="L16615">		double[] adblOptimalExercisePrice = new double[iNumPath];</span>
<span class="nc" id="L16616">		double[] adblOptimalExerciseOASGap = new double[iNumPath];</span>
<span class="nc" id="L16617">		double[] adblOptimalExerciseDuration = new double[iNumPath];</span>
<span class="nc" id="L16618">		double[] adblOptimalExerciseConvexity = new double[iNumPath];</span>
<span class="nc" id="L16619">		double[][] aadblForwardPrice = new double[iNumPath][iNumVertex];</span>
<span class="nc" id="L16620">		boolean[][] aabExerciseIndicator = new boolean[iNumPath][iNumVertex];</span>
<span class="nc" id="L16621">		double[][] aadblCorrelation = new double[iNumDimension][iNumDimension];</span>
<span class="nc" id="L16622">		org.drip.analytics.date.JulianDate[] adtOptimalExerciseDate = new</span>
			org.drip.analytics.date.JulianDate[iNumPath];
<span class="nc" id="L16624">		org.drip.param.valuation.ValuationParams[] aValParamsEvent = new</span>
			org.drip.param.valuation.ValuationParams[iNumVertex];

<span class="nc bnc" id="L16627" title="All 2 branches missed.">		for (int i = 0; i &lt; iNumDimension; ++i) {</span>
<span class="nc bnc" id="L16628" title="All 2 branches missed.">			for (int j = 0; j &lt; iNumDimension; ++j)</span>
<span class="nc bnc" id="L16629" title="All 2 branches missed.">				aadblCorrelation[i][j] = i == j ? 1. : 0.;</span>
		}

		try {
<span class="nc bnc" id="L16633" title="All 2 branches missed.">			if (null == (pvg = org.drip.state.sequence.PathVertexGovvie.Standard (gbs, new</span>
				org.drip.measure.discrete.CorrelatedPathVertexDimension (new
					org.drip.measure.crng.RandomNumberGenerator(), aadblCorrelation, iNumVertex, iNumPath,
						false, null), deGovvieForward)))
<span class="nc" id="L16637">				return null;</span>
<span class="nc" id="L16638">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16639">			e.printStackTrace();</span>

<span class="nc" id="L16641">			return null;</span>
<span class="nc" id="L16642">		}</span>

<span class="nc" id="L16644">		org.drip.state.govvie.GovvieCurve[][] aaGCPathEvent = pvg.pathVertex (aiExerciseDate);</span>

<span class="nc bnc" id="L16646" title="All 2 branches missed.">		if (null == aaGCPathEvent) return null;</span>

		try {
<span class="nc" id="L16649">			dblOAS = oasFromPrice (valParams, csqc, vcp, dblCleanPrice);</span>
<span class="nc" id="L16650">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16651">			e.printStackTrace();</span>

<span class="nc" id="L16653">			return null;</span>
<span class="nc" id="L16654">		}</span>

<span class="nc bnc" id="L16656" title="All 2 branches missed.">		for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16657">			if (null == (aValParamsEvent[iVertex] = org.drip.param.valuation.ValuationParams.Spot</span>
<span class="nc bnc" id="L16658" title="All 2 branches missed.">				(aiExerciseDate[iVertex])))</span>
<span class="nc" id="L16659">				return null;</span>
		}

<span class="nc" id="L16662">		org.drip.state.discount.MergedDiscountForwardCurve mdfcFunding = csqc.fundingState (fundingLabel());</span>

<span class="nc bnc" id="L16664" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc bnc" id="L16665" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
				try {
<span class="nc" id="L16667">					aadblForwardPrice[iPath][iVertex] = priceFromOAS (aValParamsEvent[iVertex],</span>
<span class="nc" id="L16668">						org.drip.param.creator.MarketParamsBuilder.Create (mdfcFunding,</span>
							aaGCPathEvent[iPath][iVertex], null, null, null, null, null), null, dblOAS);
<span class="nc" id="L16670">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16671">					e.printStackTrace();</span>

<span class="nc" id="L16673">					return null;</span>
<span class="nc" id="L16674">				}</span>
			}
		}

<span class="nc bnc" id="L16678" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16679">			adblOptimalExercisePV[iPath] = 0.;</span>
<span class="nc" id="L16680">			adblOptimalExercisePrice[iPath] = 1.;</span>
<span class="nc" id="L16681">			aiOptimalExerciseVertexIndex[iPath] = iNumVertex;</span>

<span class="nc" id="L16683">			adtOptimalExerciseDate[iPath] = maturityDate();</span>

<span class="nc bnc" id="L16685" title="All 2 branches missed.">			for (int iVertex = 0; iVertex &lt; iNumVertex; ++iVertex) {</span>
<span class="nc" id="L16686">				double dblExercisePV = java.lang.Double.NaN;</span>
<span class="nc" id="L16687">				aabExerciseIndicator[iPath][iVertex] = false;</span>

				try {
<span class="nc" id="L16690">					dblExercisePV = (adblExercisePrice[iVertex] - aadblForwardPrice[iPath][iVertex]) *</span>
<span class="nc" id="L16691">						mdfcFunding.df (aiExerciseDate[iVertex]);</span>
<span class="nc" id="L16692">				} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16693">					e.printStackTrace();</span>
<span class="nc" id="L16694">				}</span>

<span class="nc bnc" id="L16696" title="All 2 branches missed.">				if (dblExercisePV &gt; adblOptimalExercisePV[iPath]) {</span>
<span class="nc" id="L16697">					adtOptimalExerciseDate[iPath] = new org.drip.analytics.date.JulianDate</span>
						(aiExerciseDate[iVertex]);

<span class="nc" id="L16700">					adblOptimalExercisePrice[iPath] = adblExercisePrice[iVertex];</span>
<span class="nc" id="L16701">					aiOptimalExerciseVertexIndex[iPath] = iVertex;</span>
<span class="nc" id="L16702">					adblOptimalExercisePV[iPath] = dblExercisePV;</span>
<span class="nc" id="L16703">					aabExerciseIndicator[iPath][iVertex] = true;</span>
				}
			}
		}

<span class="nc bnc" id="L16708" title="All 2 branches missed.">		for (int iPath = 0; iPath &lt; iNumPath; ++iPath) {</span>
<span class="nc" id="L16709">			int iOptimalExerciseDate = adtOptimalExerciseDate[iPath].julian();</span>

			try {
<span class="nc" id="L16712">				adblOptimalExerciseOAS[iPath] = oasFromPrice (valParams, csqc, null, iOptimalExerciseDate,</span>
					adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16715">				adblOptimalExerciseDuration[iPath] = modifiedDurationFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);

<span class="nc" id="L16718">				adblOptimalExerciseConvexity[iPath] = convexityFromPrice (valParams, csqc, null,</span>
					iOptimalExerciseDate, adblOptimalExercisePrice[iPath], dblCleanPrice);
<span class="nc" id="L16720">			} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16721">				e.printStackTrace();</span>

<span class="nc" id="L16723">				return null;</span>
<span class="nc" id="L16724">			}</span>

<span class="nc" id="L16726">			adblOptimalExerciseOASGap[iPath] = adblOptimalExerciseOAS[iPath] - dblOAS;</span>
		}

		try {
<span class="nc" id="L16730">			return new org.drip.analytics.output.BondEOSMetrics (dblOAS, adblOptimalExercisePrice,</span>
				adblOptimalExercisePV, adblOptimalExerciseOAS, adblOptimalExerciseOASGap,
					adblOptimalExerciseDuration, adblOptimalExerciseConvexity, aadblForwardPrice,
						aabExerciseIndicator);
<span class="nc" id="L16734">		} catch (java.lang.Exception e) {</span>
<span class="nc" id="L16735">			e.printStackTrace();</span>
		}

<span class="nc" id="L16738">		return null;</span>
	}

	@Override public void showPeriods()
		throws java.lang.Exception
	{
<span class="nc bnc" id="L16744" title="All 2 branches missed.">		for (org.drip.analytics.cashflow.CompositePeriod period : couponPeriods())</span>
<span class="nc" id="L16745">			System.out.println (&quot;\t&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.startDate()) +</span>
<span class="nc" id="L16746">				&quot;-&gt;&quot; + org.drip.analytics.date.DateUtil.YYYYMMDD (period.endDate()) + &quot;    &quot; +</span>
<span class="nc" id="L16747">					period.accrualDCF (period.endDate()));</span>
<span class="nc" id="L16748">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>